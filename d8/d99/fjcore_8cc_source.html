<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<title>Analysis Software: JETSCAPE/blob/main/external_packages/fjcore.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script> <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script> 
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-155388685-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-155388685-2');
</script>
</head>
<body>
	<div id="top">
		<!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><a href="https://wiki.bnl.gov/sPHENIX/index.php/Main_Page"><img
								alt="Logo" src="../../sphenix.png" /></a></td>
						<td style="padding-left: 0.5em;">
							<div id="projectname">
								Analysis Software
							</div> 
							<div id="projectbrief">
								Documentation for <a href="https://wiki.bnl.gov/sPHENIX/index.php/Main_Page">sPHENIX</a> simulation software
							</div> 
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Home&#160;page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li><a href="../../usergroup0.html"><span>External&#160;Links</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d8/d99/fjcore_8cc_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">fjcore.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d8/d99/fjcore_8cc.html">Go to the documentation of this file.</a> Or view <a target="top" href="https://github.com/sPHENIX-Collaboration/JETSCAPE/blob/main/external_packages/fjcore.cc">the newest version in sPHENIX GitHub for file fjcore.cc</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// fjcore -- extracted from FastJet v3.2.1 (http://fastjet.fr)</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// fjcore constitutes a digest of the main FastJet functionality.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// The files fjcore.hh and fjcore.cc are meant to provide easy access to these </span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// core functions, in the form of single files and without the need of a full </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// FastJet installation:</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//     g++ main.cc fjcore.cc</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// with main.cc including fjcore.hh.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// A fortran interface, fjcorefortran.cc, is also provided. See the example </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// and the Makefile for instructions.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// The results are expected to be identical to those obtained by linking to</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// the full FastJet distribution.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// NOTE THAT, IN ORDER TO MAKE IT POSSIBLE FOR FJCORE AND THE FULL FASTJET</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// TO COEXIST, THE FORMER USES THE &quot;fjcore&quot; NAMESPACE INSTEAD OF &quot;fastjet&quot;. </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// In particular, fjcore provides:</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//   - access to all native pp and ee algorithms, kt, anti-kt, C/A.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//     For C/A, the NlnN method is available, while anti-kt and kt</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//     are limited to the N^2 one (still the fastest for N &lt; 100k particles)</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//   - access to selectors, for implementing cuts and selections</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//   - access to all functionalities related to pseudojets (e.g. a jet&#39;s</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//     structure or user-defined information)</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// Instead, it does NOT provide:</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//   - jet areas functionality</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//   - background estimation</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//   - access to other algorithms via plugins</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//   - interface to CGAL</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//   - fastjet tools, e.g. filters, taggers</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// If these functionalities are needed, the full FastJet installation must be</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">// used. The code will be fully compatible, with the sole replacement of the</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// header files and of the fjcore namespace with the fastjet one.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// fjcore.hh and fjcore.cc are not meant to be human-readable.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// For documentation, see the full FastJet manual and doxygen at http://fastjet.fr</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">// Like FastJet, fjcore is released under the terms of the GNU General Public</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">// License version 2 (GPLv2). If you use this code as part of work towards a</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// scientific publication, whether directly or contained within another program</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// (e.g. Delphes, MadGraph, SpartyJet, Rivet, LHC collaboration software frameworks, </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">// etc.), you should include a citation to</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//   EPJC72(2012)1896 [arXiv:1111.6097] (FastJet User Manual)</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//   and, optionally, Phys.Lett.B641 (2006) 57 [arXiv:hep-ph/0512210]</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// Copyright (c) 2005-2016, Matteo Cacciari, Gavin P. Salam and Gregory Soyez</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">// This file is part of FastJet.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//  FastJet is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//  it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//  the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//  (at your option) any later version.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//  The algorithms that underlie FastJet have required considerable</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//  development and are described in hep-ph/0512210. If you use</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//  FastJet as part of work towards a scientific publication, please</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//  include a citation to the FastJet paper.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//  FastJet is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//  GNU General Public License for more details.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//  You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">//  along with FastJet. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/db0/fjcore_8hh.html">fjcore.hh</a>&quot;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#ifndef __FJCORE_VERSION_HH__</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a76ccb31465d67655cbf291424258e78c">   80</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define __FJCORE_VERSION_HH__</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include&lt;string&gt;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a02699d6d182f55d63391829cf73a44bf">   83</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="../../d8/d99/fjcore_8cc.html#a02699d6d182f55d63391829cf73a44bf">fastjet_version</a> = <a class="code" href="../../d6/db0/fjcore_8hh.html#a41c62afcda524eb96ff42b83cb0de7d8">FJCORE_PACKAGE_VERSION</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#endif // __FJCORE_VERSION_HH__</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifndef __FJCORE_CLUSTERQUENCE_N2_ICC__</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#ae0a2d2f2fbb39031257e438a36fd5155">   87</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define __FJCORE_CLUSTERQUENCE_N2_ICC__</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor"></span><a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#aad6dd22e156555fa5ae585f5fa050dfa">   89</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> BJ&gt; <span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#aa4aa6374a329330477f733af7b395291">ClusterSequence::_simple_N2_cluster</a>() {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = _jets.size();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  BJ * briefjets = <span class="keyword">new</span> BJ[<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>];</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  BJ * jetA = briefjets, * jetB;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    _bj_set_jetinfo(jetA, <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    jetA++; <span class="comment">// move on to next entry of briefjets</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  BJ * tail = jetA; <span class="comment">// a semaphore for the end of briefjets</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  BJ * head = briefjets; <span class="comment">// a nicer way of naming start</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">for</span> (jetA = head + 1; jetA != tail; jetA++) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    _bj_set_NN_crosscheck(jetA, head, jetA);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">double</span> * diJ = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  jetA = head;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    diJ[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = _bj_diJ(jetA);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    jetA++; <span class="comment">// have jetA follow i</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">int</span> history_location = n-1;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">while</span> (tail != head) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">double</span> diJ_min = diJ[0];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">int</span> diJ_min_jet = 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 1; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">if</span> (diJ[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] &lt; diJ_min) {diJ_min_jet = <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>; diJ_min  = diJ[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];}</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    history_location++;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    jetA = &amp; briefjets[diJ_min_jet];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    jetB = <span class="keyword">static_cast&lt;</span>BJ *<span class="keyword">&gt;</span>(jetA-&gt;NN);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    diJ_min *= _invR2; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">if</span> (jetA &lt; jetB) {<a class="code" href="../../d6/db0/fjcore_8hh.html#ac71f249d840a70f8b3aaffb721843eaa">std::swap</a>(jetA,jetB);}</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordtype">int</span> nn; <span class="comment">// new jet index</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      _do_ij_recombination_step(jetA-&gt;_jets_index, jetB-&gt;_jets_index, diJ_min, nn);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      _bj_set_jetinfo(jetB, nn);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      _do_iB_recombination_step(jetA-&gt;_jets_index, diJ_min);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    tail--; n--;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    *jetA = *tail;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    diJ[jetA - head] = diJ[tail-head];</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">for</span> (BJ * jetI = head; jetI != tail; jetI++) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">if</span> (jetI-&gt;NN == jetA || jetI-&gt;NN == jetB) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        _bj_set_NN_nocross(jetI, head, tail);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        diJ[jetI-head] = _bj_diJ(jetI); <span class="comment">// update diJ </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      } </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = _bj_dist(jetI,jetB);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          <span class="keywordflow">if</span> (jetI != jetB) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            jetI-&gt;NN_dist = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            jetI-&gt;NN = jetB;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            diJ[jetI-head] = _bj_diJ(jetI); <span class="comment">// update diJ...</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          <span class="keywordflow">if</span> (jetI != jetB) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            jetB-&gt;NN_dist = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            jetB-&gt;NN      = jetI;}</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">if</span> (jetI-&gt;NN == tail) {jetI-&gt;NN = jetA;}</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {diJ[jetB-head] = _bj_diJ(jetB);}</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keyword">delete</span>[] diJ;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keyword">delete</span>[] briefjets;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">#endif // __FJCORE_CLUSTERQUENCE_N2_ICC__</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifndef __FJCORE_DYNAMICNEARESTNEIGHBOURS_HH__</span></div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a84cfcd3151c8564ab9949a2c4a21286f">  160</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define __FJCORE_DYNAMICNEARESTNEIGHBOURS_HH__</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include&lt;vector&gt;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">#include&lt;string&gt;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">#include&lt;sstream&gt;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">#include&lt;cassert&gt;</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="code" href="../../d4/dbe/classEtaPhi.html">  167</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d4/dbe/classEtaPhi.html">EtaPhi</a> {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="code" href="../../d4/dbe/classEtaPhi.html#a586910abaf0d1a1e8e58ebe44ec6ca18">  169</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d4/dbe/classEtaPhi.html#a26bb3aa4e086124d66404412822d0b34">first</a>, <a class="code" href="../../d4/dbe/classEtaPhi.html#a586910abaf0d1a1e8e58ebe44ec6ca18">second</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="code" href="../../d4/dbe/classEtaPhi.html#ad4e67daa4dbaac6ffef74825260f1a6f">  170</a></span>&#160;  <a class="code" href="../../d4/dbe/classEtaPhi.html#ad4e67daa4dbaac6ffef74825260f1a6f">EtaPhi</a>() {}</div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="code" href="../../d4/dbe/classEtaPhi.html#a65e97b17b170b2dc29a26e26dcdb83c9">  171</a></span>&#160;  <a class="code" href="../../d4/dbe/classEtaPhi.html#a65e97b17b170b2dc29a26e26dcdb83c9">EtaPhi</a>(<span class="keywordtype">double</span> <a class="code" href="../../d7/da4/namespaceKFPMath.html#a6d2496198d1982fd950acfb79033902b">a</a>, <span class="keywordtype">double</span> <a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>) {<a class="code" href="../../d4/dbe/classEtaPhi.html#a26bb3aa4e086124d66404412822d0b34">first</a> = <a class="code" href="../../d7/da4/namespaceKFPMath.html#a6d2496198d1982fd950acfb79033902b">a</a>; <a class="code" href="../../d4/dbe/classEtaPhi.html#a586910abaf0d1a1e8e58ebe44ec6ca18">second</a> = <a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>;}</div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="code" href="../../d4/dbe/classEtaPhi.html#a67916d70463ddca84b08e143dfb06b84">  172</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d4/dbe/classEtaPhi.html#a67916d70463ddca84b08e143dfb06b84">sanitize</a>() {    </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/dbe/classEtaPhi.html#a586910abaf0d1a1e8e58ebe44ec6ca18">second</a> &lt;  0)     <a class="code" href="../../d4/dbe/classEtaPhi.html#a586910abaf0d1a1e8e58ebe44ec6ca18">second</a> += <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/dbe/classEtaPhi.html#a586910abaf0d1a1e8e58ebe44ec6ca18">second</a> &gt;= <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>) <a class="code" href="../../d4/dbe/classEtaPhi.html#a586910abaf0d1a1e8e58ebe44ec6ca18">second</a> -= <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;};</div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="code" href="../../d8/d94/classDnnError.html">  177</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d8/d94/classDnnError.html">DnnError</a> : <span class="keyword">public</span> <a class="code" href="../../d9/dd6/classError.html">Error</a> {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="code" href="../../d8/d94/classDnnError.html#a24ee8d82d0e29da54533887e45fc2d0f">  179</a></span>&#160;  <a class="code" href="../../d8/d94/classDnnError.html#a24ee8d82d0e29da54533887e45fc2d0f">DnnError</a>(<span class="keyword">const</span> <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a> &amp; message_in) : <a class="code" href="../../d9/dd6/classError.html">Error</a>(message_in) {}</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;};</div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html">  181</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html">DynamicNearestNeighbours</a> {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a9762a280b8ea18d307c39acdfb5beed2">NearestNeighbourIndex</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> ii) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a2b6c193655063a2a2c2603e087df8429">NearestNeighbourDistance</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> ii) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a53cff4eef90b4a25607b67cbb98dc17f">Valid</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d51/dvcs__plot_8C.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#ac4cb369829da8d3d5bcf1796ebf8c6ba">RemoveAndAddPoints</a>(<span class="keyword">const</span> std::vector&lt;int&gt; &amp; indices_to_remove,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                          <span class="keyword">const</span> std::vector&lt;EtaPhi&gt; &amp; points_to_add,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                          std::vector&lt;int&gt; &amp; indices_added,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                          std::vector&lt;int&gt; &amp; indices_of_updated_neighbours) = 0;</div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a485b79ebf4b097ad546895cc2a93b33c">  190</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a485b79ebf4b097ad546895cc2a93b33c">RemovePoint</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> index,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                           std::vector&lt;int&gt; &amp; indices_of_updated_neighbours) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    std::vector&lt;int&gt; indices_added;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    std::vector&lt;EtaPhi&gt; points_to_add;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    std::vector&lt;int&gt; indices_to_remove(1);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    indices_to_remove[0] = <a class="code" href="../../df/d51/dvcs__plot_8C.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#ac4cb369829da8d3d5bcf1796ebf8c6ba">RemoveAndAddPoints</a>(indices_to_remove, points_to_add, indices_added,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                       indices_of_updated_neighbours</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                       );};</div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a5845461780a7ffa9655203b247bb95aa">  199</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a5845461780a7ffa9655203b247bb95aa">RemoveCombinedAddCombination</a>(</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d7b/namespaceActs.html#a324b54b2d52fbc9244d94e305d9203d3a0b93936a59efef879bf69ab34f755964">index1</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d7b/namespaceActs.html#a324b54b2d52fbc9244d94e305d9203d3a312584e16590945fb13813268f963d4a">index2</a>,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                        <span class="keyword">const</span> <a class="code" href="../../d4/dbe/classEtaPhi.html">EtaPhi</a> &amp; newpoint,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                        <span class="keywordtype">int</span> &amp; <a class="code" href="../../da/d7b/namespaceActs.html#a324b54b2d52fbc9244d94e305d9203d3ac618d3184185f1567e2af0bf1e196189">index3</a>,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                        std::vector&lt;int&gt; &amp; indices_of_updated_neighbours) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    std::vector&lt;int&gt; indices_added(1);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    std::vector&lt;EtaPhi&gt; points_to_add(1);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    std::vector&lt;int&gt; indices_to_remove(2);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    indices_to_remove[0] = <a class="code" href="../../da/d7b/namespaceActs.html#a324b54b2d52fbc9244d94e305d9203d3a0b93936a59efef879bf69ab34f755964">index1</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    indices_to_remove[1] = <a class="code" href="../../da/d7b/namespaceActs.html#a324b54b2d52fbc9244d94e305d9203d3a312584e16590945fb13813268f963d4a">index2</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    points_to_add[0] = newpoint;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#ac4cb369829da8d3d5bcf1796ebf8c6ba">RemoveAndAddPoints</a>(indices_to_remove, points_to_add, indices_added,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                       indices_of_updated_neighbours</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                       );</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    index3 = indices_added[0];</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  };</div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#aa1fa11925fb496536ad9c956cbdfaf65">  215</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#aa1fa11925fb496536ad9c956cbdfaf65">~DynamicNearestNeighbours</a> () {}</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;};</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#endif // __FJCORE_DYNAMICNEARESTNEIGHBOURS_HH__</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifndef __FJCORE_SEARCHTREE_HH__</span></div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#aacbb65a7d528911159566b2bd2ec5405">  220</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define __FJCORE_SEARCHTREE_HH__</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include&lt;vector&gt;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">#include&lt;cassert&gt;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">#include&lt;cstddef&gt;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html">  225</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span><a class="code" href="../../d7/d18/classSearchTree.html">SearchTree</a> {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keyword">class </span><a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keyword">class </span><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keyword">class </span><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="../../d7/d18/classSearchTree.html#a4cead9021101b863ad970d7d70814aae">SearchTree</a>(<span class="keyword">const</span> std::vector&lt;T&gt; &amp; <a class="code" href="../../d4/da3/namespacemyAnalysis.html#a9f597e7106ca1fcda16204c112f7f2e0">init</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <a class="code" href="../../d7/d18/classSearchTree.html#a4cead9021101b863ad970d7d70814aae">SearchTree</a>(<span class="keyword">const</span> std::vector&lt;T&gt; &amp; init, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_size);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordtype">void</span> <span class="keyword">remove</span>(<span class="keywordtype">unsigned</span> node_index);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">void</span> <span class="keyword">remove</span>(<span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree::Node</a> * <a class="code" href="../../da/d9f/classnode.html" title="A node in a graph.">node</a>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">void</span> <span class="keyword">remove</span>(<span class="keyword">typename</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">SearchTree::circulator</a> &amp; circ);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> <a class="code" href="../../d7/d18/classSearchTree.html#a17c712e71c65d1aaf0f940398221f283">insert</a>(<span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#ae1a6a8868aedfe9a2fa3c3d6d0fae230">T</a> &amp; <a class="code" href="../../d2/d51/usm_8C.html#a81ab26bb994cec5d6d3d4705f80c0836">value</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#ae5a240bba32b7e16b6b9c357d8c42d9c">  236</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> &amp; <a class="code" href="../../d7/d18/classSearchTree.html#ae5a240bba32b7e16b6b9c357d8c42d9c">operator[]</a>(<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="../../d7/d18/classSearchTree.html#a5905880e2aa4a8ff2ed622f95ee3f6cf">_nodes</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];};</div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a4730e288bf4cc0730a018631b77f4285">  237</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d18/classSearchTree.html#a4730e288bf4cc0730a018631b77f4285">size</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="../../d7/d18/classSearchTree.html#a5905880e2aa4a8ff2ed622f95ee3f6cf">_nodes</a>.size() - <a class="code" href="../../d7/d18/classSearchTree.html#a6c1069ef5d189c7fee9e2e07b809c52d">_available_nodes</a>.size();}</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#ae03e6908758cc32977f3f273a1cdc9b1">verify_structure</a>();</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#a3c8123a341e7f5ca809eb991cede1c6c">verify_structure_linear</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#ac68c900696a09f29fbdd30621a642d63">verify_structure_recursive</a>(<span class="keyword">const</span> Node * , <span class="keyword">const</span> Node * , <span class="keyword">const</span> Node * ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#a5ba49d6fa7b4335696d3670359650ac6">print_elements</a>();</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#ifdef __FJCORE_SEARCHTREE_TRACK_DEPTH</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor"></span>  <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d18/classSearchTree.html#a8c9433f321e374060541a9680d9b9997">max_depth</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _max_depth;};</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a8c9433f321e374060541a9680d9b9997">  245</a></span>&#160;<span class="preprocessor"></span>  <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d18/classSearchTree.html#a8c9433f321e374060541a9680d9b9997">max_depth</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">int</span> <a class="code" href="../../d7/d18/classSearchTree.html#aefb01b23ff527f7165fd05db2e9d61f8">loc</a>(<span class="keyword">const</span> Node * <a class="code" href="../../da/d9f/classnode.html" title="A node in a graph.">node</a>) <span class="keyword">const</span> ;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  Node * <a class="code" href="../../d7/d18/classSearchTree.html#a93eafe3698bd40450db1c40ddfad76ee">_find_predecessor</a>(<span class="keyword">const</span> Node *);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  Node * <a class="code" href="../../d7/d18/classSearchTree.html#add449169ba7ac64a28ba7a9833ac56cd">_find_successor</a>(<span class="keyword">const</span> Node *);</div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a7f2ba2d7879bf8f80fca53890c2a53cb">  250</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> &amp; <a class="code" href="../../d7/d18/classSearchTree.html#a7f2ba2d7879bf8f80fca53890c2a53cb">operator[]</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="../../d7/d18/classSearchTree.html#a5905880e2aa4a8ff2ed622f95ee3f6cf">_nodes</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];};</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  const_circulator <a class="code" href="../../d7/d18/classSearchTree.html#a0929d7e9b39d3a37bac2d4546b5bff53">somewhere</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  circulator <a class="code" href="../../d7/d18/classSearchTree.html#a0929d7e9b39d3a37bac2d4546b5bff53">somewhere</a>();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#aaf22500da9bb34c507de94292131e40d">_initialize</a>(<span class="keyword">const</span> std::vector&lt;T&gt; &amp; init);</div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a5905880e2aa4a8ff2ed622f95ee3f6cf">  255</a></span>&#160;  std::vector&lt;Node&gt; <a class="code" href="../../d7/d18/classSearchTree.html#a5905880e2aa4a8ff2ed622f95ee3f6cf">_nodes</a>;</div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a6c1069ef5d189c7fee9e2e07b809c52d">  256</a></span>&#160;  std::vector&lt;Node *&gt; <a class="code" href="../../d7/d18/classSearchTree.html#a6c1069ef5d189c7fee9e2e07b809c52d">_available_nodes</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a0b6231b4853b19c671ad6a43de6543e5">  257</a></span>&#160;  <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * <a class="code" href="../../d7/d18/classSearchTree.html#a0b6231b4853b19c671ad6a43de6543e5">_top_node</a>;</div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#aafcdf2477cd5051cd331558d41ac4920">  258</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d18/classSearchTree.html#aafcdf2477cd5051cd331558d41ac4920">_n_removes</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#acfe1728c330747510e747ca6eaac6d68">_do_initial_connections</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> this_one, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> scale,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                               <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> left_edge, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> right_edge,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                               <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d95/eventServer_8cc.html#a5081a26baa914156df8541b03d09492e">depth</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">#ifdef __FJCORE_SEARCHTREE_TRACK_DEPTH</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _max_depth;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor"></span>};</div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">  266</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span><a class="code" href="../../d7/d18/classSearchTree.html">SearchTree</a>&lt;<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#ae1a6a8868aedfe9a2fa3c3d6d0fae230">T</a>&gt;::<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a>{</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a50aac878f323703c3ad28120e09ff668">  268</a></span>&#160;  <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a50aac878f323703c3ad28120e09ff668">Node</a>() {}; </div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ade65589df88dd18fe77a2766b41af913">  269</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ade65589df88dd18fe77a2766b41af913" title="default constructor">treelinks_null</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">return</span> ((parent==0) &amp;&amp; (<a class="code" href="../../d9/d3f/mongoose_8cc.html#a6dcfd23083a738f06b03dcd935b272eb">left</a>==0) &amp;&amp; (right==0));};</div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a0e5d32b88849bfb7ff30b12f57b08fca">  271</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a0e5d32b88849bfb7ff30b12f57b08fca">nullify_treelinks</a>() {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    parent = NULL; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="../../d9/d3f/mongoose_8cc.html#a6dcfd23083a738f06b03dcd935b272eb">left</a>   = NULL; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    right  = NULL;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  };</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordtype">void</span> reset_parents_link_to_me(<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * XX);</div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">  277</a></span>&#160;  <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#ae1a6a8868aedfe9a2fa3c3d6d0fae230">T</a>      <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a>;</div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">  278</a></span>&#160;  <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">  279</a></span>&#160;  <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">  280</a></span>&#160;  <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>;</div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ab3a75b30fe66582704c39c1a16ae8dd6">  281</a></span>&#160;  <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ab3a75b30fe66582704c39c1a16ae8dd6">successor</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno"><a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#accb2b125c0e339aa16fb0d2b163c5598">  282</a></span>&#160;  <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#accb2b125c0e339aa16fb0d2b163c5598">predecessor</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;};</div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a121b76835493941a891752ad7c3d268b">  284</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a121b76835493941a891752ad7c3d268b">SearchTree&lt;T&gt;::Node::reset_parents_link_to_me</a>(<span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * XX) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a> == NULL) {<span class="keywordflow">return</span>;}</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> == <span class="keyword">this</span>) {<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> = XX;}</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">else</span> {<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a> = XX;}</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">  289</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span><a class="code" href="../../d7/d18/classSearchTree.html">SearchTree</a>&lt;<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#ae1a6a8868aedfe9a2fa3c3d6d0fae230">T</a>&gt;::<a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a>{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="../../d7/d18/classSearchTree.html">SearchTree</a>&lt;T&gt;::<a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a>;</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a8e29192da130907d6033ed79203b4faf">  292</a></span>&#160;  friend class <a class="code" href="../../d7/d18/classSearchTree.html">SearchTree</a>&lt;T&gt;;</div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a22c45362b80884e7b3964eb72bb1c102">  293</a></span>&#160;  <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a>() : _node(NULL) {}</div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#af301d1f638890d0317013fc95acdd39d">  294</a></span>&#160;  <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#af301d1f638890d0317013fc95acdd39d">circulator</a>(<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * <a class="code" href="../../da/d9f/classnode.html" title="A node in a graph.">node</a>) : _node(node) {}</div>
<div class="line"><a name="l00295"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a9e596771df65a601b9b665bd7e824959">  295</a></span>&#160;  <span class="keyword">const</span> T * <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a9e596771df65a601b9b665bd7e824959">operator-&gt;</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> &amp;(_node-&gt;value);}</div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#adf4c8ce2e46f93184b0e824c99c112a8">  296</a></span>&#160;  T * <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#adf4c8ce2e46f93184b0e824c99c112a8">operator-&gt;</a>() {<span class="keywordflow">return</span> &amp;(_node-&gt;value);}</div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a53ea2c1a8860f2a8dafa0b9aa9f1c154">  297</a></span>&#160;  <span class="keyword">const</span> T &amp; <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a53ea2c1a8860f2a8dafa0b9aa9f1c154">operator*</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _node-&gt;value;}</div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ae3bf0ae25fa5424a353ffff56ce1c4fa">  298</a></span>&#160;  T &amp; <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ae3bf0ae25fa5424a353ffff56ce1c4fa">operator*</a>() {<span class="keywordflow">return</span> _node-&gt;value;}</div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ac4c3a15415d3b572a45355ed106f996c">  299</a></span>&#160;  <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> &amp; <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ac4c3a15415d3b572a45355ed106f996c">operator++</a>() {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    _node = _node-&gt;successor; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;}</div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a4ae815ade517c4c2b439693fd4414e84">  302</a></span>&#160;  <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a4ae815ade517c4c2b439693fd4414e84">operator++</a>(<span class="keywordtype">int</span>) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a88f0887efddd644c8defc1e91456c3c9">tmp</a> = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    _node = _node-&gt;successor; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a88f0887efddd644c8defc1e91456c3c9">tmp</a>;}</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a666225c2819da12d407542ce9ead8d3b">  306</a></span>&#160;  <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> &amp; <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a666225c2819da12d407542ce9ead8d3b">operator--</a>() {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    _node = _node-&gt;predecessor; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;}</div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ad9b3b54231afce2668c6377be00bdd0d">  309</a></span>&#160;  <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ad9b3b54231afce2668c6377be00bdd0d">operator--</a>(<span class="keywordtype">int</span>) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a88f0887efddd644c8defc1e91456c3c9">tmp</a> = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    _node = _node-&gt;predecessor; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a88f0887efddd644c8defc1e91456c3c9">tmp</a>;}</div>
<div class="line"><a name="l00313"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a424ae30771cfcc868362ee9472029cde">  313</a></span>&#160;  <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a424ae30771cfcc868362ee9472029cde">next</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a>(_node-&gt;successor);}</div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a26f1619943f16336311d41317fdc14b6">  315</a></span>&#160;  <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a26f1619943f16336311d41317fdc14b6">previous</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a>(_node-&gt;predecessor);}</div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#aa128c27a86f23db8d11b441a55335f9f">  317</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#aa128c27a86f23db8d11b441a55335f9f">operator!=</a>(<span class="keyword">const</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> &amp; other)<span class="keyword"> const </span>{<span class="keywordflow">return</span> other.<a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ac0085fcb95f87d885d29dcc4a2f65fdf">_node</a> != _node;}</div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ad0c789f3bf609be9de05ddd88aa7b8fb">  318</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ad0c789f3bf609be9de05ddd88aa7b8fb">operator==</a>(<span class="keyword">const</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> &amp; other)<span class="keyword"> const </span>{<span class="keywordflow">return</span> other.<a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ac0085fcb95f87d885d29dcc4a2f65fdf">_node</a> == _node;}</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00320"></a><span class="lineno"><a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ac0085fcb95f87d885d29dcc4a2f65fdf">  320</a></span>&#160;  <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ac0085fcb95f87d885d29dcc4a2f65fdf">_node</a>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;};</div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">  322</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span><a class="code" href="../../d7/d18/classSearchTree.html">SearchTree</a>&lt;<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#ae1a6a8868aedfe9a2fa3c3d6d0fae230">T</a>&gt;::<a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a>{</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a821d12f3b50cec14eeaf2e99e70febb5">  324</a></span>&#160;  <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a821d12f3b50cec14eeaf2e99e70febb5">const_circulator</a>() : _node(NULL) {}</div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#ab348b9168d5fce3174f4a40c853fabbb">  325</a></span>&#160;  <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#ab348b9168d5fce3174f4a40c853fabbb">const_circulator</a>(<span class="keyword">const</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * <a class="code" href="../../da/d9f/classnode.html" title="A node in a graph.">node</a>) : _node(node) {}</div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a80d42aed63f856cc38f1618073b06113">  326</a></span>&#160;  <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a80d42aed63f856cc38f1618073b06113">const_circulator</a>(<span class="keyword">const</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> &amp; circ) :_node(circ._node) {}</div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a195b8ed4c8a559aa9ace17c6a2efcf86">  327</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#ae1a6a8868aedfe9a2fa3c3d6d0fae230">T</a> * <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a195b8ed4c8a559aa9ace17c6a2efcf86">operator-&gt;</a>() {<span class="keywordflow">return</span> &amp;(_node-&gt;value);}</div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#ac21a29c32f7a32ebd61658701080b3a7">  328</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#ae1a6a8868aedfe9a2fa3c3d6d0fae230">T</a> &amp; <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#ac21a29c32f7a32ebd61658701080b3a7">operator*</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _node-&gt;value;}</div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#aebe616b3dd7acf64c29ef34cf79f733d">  329</a></span>&#160;  <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a> &amp; <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#aebe616b3dd7acf64c29ef34cf79f733d">operator++</a>() {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    _node = _node-&gt;successor; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;}</div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a0cabccf92dce7c709c23c6c76abd28cc">  332</a></span>&#160;  <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a0cabccf92dce7c709c23c6c76abd28cc">operator++</a>(<span class="keywordtype">int</span>) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a88f0887efddd644c8defc1e91456c3c9">tmp</a> = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    _node = _node-&gt;successor; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a88f0887efddd644c8defc1e91456c3c9">tmp</a>;}</div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a12032bc87aa1c9c6f99d5168b18728c4">  336</a></span>&#160;  <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a> &amp; <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a12032bc87aa1c9c6f99d5168b18728c4">operator--</a>() {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    _node = _node-&gt;predecessor; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;}</div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a47891428636feda6a1015881c2593f7e">  339</a></span>&#160;  <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a47891428636feda6a1015881c2593f7e">operator--</a>(<span class="keywordtype">int</span>) {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a88f0887efddd644c8defc1e91456c3c9">tmp</a> = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    _node = _node-&gt;predecessor; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a88f0887efddd644c8defc1e91456c3c9">tmp</a>;}</div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a9991c695396bdef49fd5a0e283e71ee9">  343</a></span>&#160;  <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a9991c695396bdef49fd5a0e283e71ee9">next</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a>(_node-&gt;successor);}</div>
<div class="line"><a name="l00345"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a7af1f41c282b517362a8a528aa741b41">  345</a></span>&#160;  <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a7af1f41c282b517362a8a528aa741b41">previous</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a>(_node-&gt;predecessor);}</div>
<div class="line"><a name="l00347"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#ab60cdd696d754d5cd9e8dda81988a6ac">  347</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#ab60cdd696d754d5cd9e8dda81988a6ac">operator!=</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a> &amp; other)<span class="keyword"> const </span>{<span class="keywordflow">return</span> other.<a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a4ce5a2bce9c799f4fefaf1330d4e0d2f">_node</a> != _node;}</div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a2da688858fba5c7c55e7e7f4f7e6e7cd">  348</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a2da688858fba5c7c55e7e7f4f7e6e7cd">operator==</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a> &amp; other)<span class="keyword"> const </span>{<span class="keywordflow">return</span> other.<a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a4ce5a2bce9c799f4fefaf1330d4e0d2f">_node</a> == _node;}</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a4ce5a2bce9c799f4fefaf1330d4e0d2f">  350</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html#a4ce5a2bce9c799f4fefaf1330d4e0d2f">_node</a>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;};</div>
<div class="line"><a name="l00352"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a3b883e9efb8911e9e1276c29d9ad5ce8">  352</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <a class="code" href="../../d7/d18/classSearchTree.html#a4cead9021101b863ad970d7d70814aae">SearchTree&lt;T&gt;::SearchTree</a>(<span class="keyword">const</span> std::vector&lt;T&gt; &amp; <a class="code" href="../../d4/da3/namespacemyAnalysis.html#a9f597e7106ca1fcda16204c112f7f2e0">init</a>,</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_size) :</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <a class="code" href="../../d7/d18/classSearchTree.html#a5905880e2aa4a8ff2ed622f95ee3f6cf">_nodes</a>(max_size) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="../../d7/d18/classSearchTree.html#a6c1069ef5d189c7fee9e2e07b809c52d">_available_nodes</a>.reserve(max_size);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <a class="code" href="../../d7/d18/classSearchTree.html#a6c1069ef5d189c7fee9e2e07b809c52d">_available_nodes</a>.resize(max_size - init.size());</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = init.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; max_size; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="../../d7/d18/classSearchTree.html#a6c1069ef5d189c7fee9e2e07b809c52d">_available_nodes</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>-init.size()] = &amp;(<a class="code" href="../../d7/d18/classSearchTree.html#a5905880e2aa4a8ff2ed622f95ee3f6cf">_nodes</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <a class="code" href="../../d7/d18/classSearchTree.html#aaf22500da9bb34c507de94292131e40d">_initialize</a>(init);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;}</div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a4cead9021101b863ad970d7d70814aae">  362</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <a class="code" href="../../d7/d18/classSearchTree.html#a4cead9021101b863ad970d7d70814aae">SearchTree&lt;T&gt;::SearchTree</a>(<span class="keyword">const</span> std::vector&lt;T&gt; &amp; <a class="code" href="../../d4/da3/namespacemyAnalysis.html#a9f597e7106ca1fcda16204c112f7f2e0">init</a>) :</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  _nodes(init.<a class="code" href="../../d1/d15/ntuple__variables_8C.html#a87a2934e49c05339afd471d382cc6c74">size</a>()), _available_nodes(0) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <a class="code" href="../../d7/d18/classSearchTree.html#a6c1069ef5d189c7fee9e2e07b809c52d">_available_nodes</a>.reserve(init.size());</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="../../d7/d18/classSearchTree.html#aaf22500da9bb34c507de94292131e40d">_initialize</a>(init);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#aaf22500da9bb34c507de94292131e40d">  367</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#aaf22500da9bb34c507de94292131e40d">SearchTree&lt;T&gt;::_initialize</a>(<span class="keyword">const</span> std::vector&lt;T&gt; &amp; <a class="code" href="../../d4/da3/namespacemyAnalysis.html#a9f597e7106ca1fcda16204c112f7f2e0">init</a>) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  _n_removes = 0;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = init.size();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(n&gt;=1);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#ifdef __FJCORE_SEARCHTREE_TRACK_DEPTH</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="preprocessor"></span>  _max_depth     = 0;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 1; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt;<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(!(init[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] &lt; init[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>-1]));</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    _nodes[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].value = init[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    _nodes[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].predecessor = (&amp; (_nodes[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>])) - 1;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    _nodes[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].successor   = (&amp; (_nodes[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>])) + 1;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    _nodes[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].nullify_treelinks();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  _nodes[0].predecessor = (&amp; (_nodes[n-1]));</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  _nodes[n-1].successor = (&amp; (_nodes[0]));</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> scale = (n+1)/2;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> top   = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">std::min</a>(n-1,scale);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  _nodes[top].parent = NULL;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  _top_node = &amp;(_nodes[top]);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  _do_initial_connections(top, scale, 0, n, 0);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;}</div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#aefb01b23ff527f7165fd05db2e9d61f8">  391</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">inline</span>  <span class="keywordtype">int</span> <a class="code" href="../../d7/d18/classSearchTree.html#aefb01b23ff527f7165fd05db2e9d61f8">SearchTree&lt;T&gt;::loc</a>(<span class="keyword">const</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * <a class="code" href="../../da/d9f/classnode.html" title="A node in a graph.">node</a>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> node == NULL? </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      -999 : node - &amp;(_nodes[0]);}</div>
<div class="line"><a name="l00393"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#acfe1728c330747510e747ca6eaac6d68">  393</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#acfe1728c330747510e747ca6eaac6d68">SearchTree&lt;T&gt;::_do_initial_connections</a>(</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> this_one, </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> scale,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> left_edge,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> right_edge,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d95/eventServer_8cc.html#a5081a26baa914156df8541b03d09492e">depth</a></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                         ) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">#ifdef __FJCORE_SEARCHTREE_TRACK_DEPTH</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor"></span>  _max_depth = max(depth, _max_depth);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ref_new_scale = (scale+1)/2;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordtype">unsigned</span> new_scale = ref_new_scale;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordtype">bool</span>     did_child  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">while</span>(<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d9/d3f/mongoose_8cc.html#a6dcfd23083a738f06b03dcd935b272eb">left</a> = this_one - new_scale; <span class="comment">// be careful here to use signed int...</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (left &gt;= static_cast&lt;int&gt;(left_edge) </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        &amp;&amp; _nodes[<a class="code" href="../../d9/d3f/mongoose_8cc.html#a6dcfd23083a738f06b03dcd935b272eb">left</a>].treelinks_null() ) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      _nodes[<a class="code" href="../../d9/d3f/mongoose_8cc.html#a6dcfd23083a738f06b03dcd935b272eb">left</a>].parent = &amp;(_nodes[this_one]);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      _nodes[this_one].left = &amp;(_nodes[<a class="code" href="../../d9/d3f/mongoose_8cc.html#a6dcfd23083a738f06b03dcd935b272eb">left</a>]);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      _do_initial_connections(left, new_scale, left_edge, this_one, depth+1);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      did_child = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_new_scale = new_scale;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    new_scale = (old_new_scale + 1)/2;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span> (new_scale == old_new_scale) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">if</span> (!did_child) {_nodes[this_one].left = NULL;}</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  new_scale = ref_new_scale;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  did_child  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordflow">while</span>(<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> right = this_one + new_scale;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span> (right &lt; right_edge  &amp;&amp; _nodes[right].treelinks_null()) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      _nodes[right].parent = &amp;(_nodes[this_one]);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      _nodes[this_one].right = &amp;(_nodes[right]);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      _do_initial_connections(right, new_scale, this_one+1,right_edge,depth+1);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      did_child = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_new_scale = new_scale;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    new_scale = (old_new_scale + 1)/2;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (new_scale == old_new_scale) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordflow">if</span> (!did_child) {_nodes[this_one].right = NULL;}</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#acb8e801394f89194cf918697ff98bb00">SearchTree&lt;T&gt;::remove</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> node_index) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keyword">remove</span>(&amp;(_nodes[node_index]));</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;}</div>
<div class="line"><a name="l00441"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a5d0294334f691d7826a7279e1df0dfbb">  441</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#acb8e801394f89194cf918697ff98bb00">SearchTree&lt;T&gt;::remove</a>(<a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> &amp; circ) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keyword">remove</span>(circ.<a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#ac0085fcb95f87d885d29dcc4a2f65fdf">_node</a>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#acb8e801394f89194cf918697ff98bb00">SearchTree&lt;T&gt;::remove</a>(<span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * <a class="code" href="../../da/d9f/classnode.html" title="A node in a graph.">node</a>) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(<a class="code" href="../../d1/d15/ntuple__variables_8C.html#a87a2934e49c05339afd471d382cc6c74">size</a>() &gt; 1); <span class="comment">// switch this to throw...?</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(!node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ade65589df88dd18fe77a2766b41af913" title="default constructor">treelinks_null</a>());</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#accb2b125c0e339aa16fb0d2b163c5598">predecessor</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ab3a75b30fe66582704c39c1a16ae8dd6">successor</a> = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ab3a75b30fe66582704c39c1a16ae8dd6">successor</a>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ab3a75b30fe66582704c39c1a16ae8dd6">successor</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#accb2b125c0e339aa16fb0d2b163c5598">predecessor</a> = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#accb2b125c0e339aa16fb0d2b163c5598">predecessor</a>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a> == NULL &amp;&amp; node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> == NULL) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a121b76835493941a891752ad7c3d268b">reset_parents_link_to_me</a>(NULL); </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a> != NULL &amp;&amp; node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> == NULL){</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a121b76835493941a891752ad7c3d268b">reset_parents_link_to_me</a>(node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a> = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>;         </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (_top_node == node) {_top_node = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>;}</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a> == NULL &amp;&amp; node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> != NULL){</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a121b76835493941a891752ad7c3d268b">reset_parents_link_to_me</a>(node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a> = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>;   </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (_top_node == node) {_top_node = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>;}</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    Node * replacement;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordtype">bool</span> use_predecessor = (_n_removes % 2 == 1);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">if</span> (use_predecessor) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      replacement = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#accb2b125c0e339aa16fb0d2b163c5598">predecessor</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(replacement-&gt;right == NULL); <span class="comment">// guaranteed if it&#39;s our predecessor</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">if</span> (replacement != node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">if</span> (replacement-&gt;left != NULL) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;          replacement-&gt;left-&gt;parent = replacement-&gt;parent;}</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        replacement-&gt;reset_parents_link_to_me(replacement-&gt;left);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        replacement-&gt;left   = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      replacement-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a> = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      replacement-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>  = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      replacement = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ab3a75b30fe66582704c39c1a16ae8dd6">successor</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(replacement-&gt;left == NULL); <span class="comment">// guaranteed if it&#39;s our successor</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordflow">if</span> (replacement != node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">if</span> (replacement-&gt;right != NULL) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;          replacement-&gt;right-&gt;parent = replacement-&gt;parent;}</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        replacement-&gt;reset_parents_link_to_me(replacement-&gt;right);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        replacement-&gt;right  = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      replacement-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a> = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      replacement-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>   = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a121b76835493941a891752ad7c3d268b">reset_parents_link_to_me</a>(replacement);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>  != replacement) {node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>  = replacement;}</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> != replacement) {node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a> = replacement;}</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">if</span> (_top_node == node) {_top_node = replacement;}</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a0e5d32b88849bfb7ff30b12f57b08fca">nullify_treelinks</a>();</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#accb2b125c0e339aa16fb0d2b163c5598">predecessor</a> = NULL;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ab3a75b30fe66582704c39c1a16ae8dd6">successor</a>   = NULL;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  _n_removes++;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  _available_nodes.push_back(node);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div>
<div class="line"><a name="l00496"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a17c712e71c65d1aaf0f940398221f283">  496</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">typename</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">SearchTree&lt;T&gt;::circulator</a> <a class="code" href="../../d7/d18/classSearchTree.html#a17c712e71c65d1aaf0f940398221f283">SearchTree&lt;T&gt;::insert</a>(<span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#ae1a6a8868aedfe9a2fa3c3d6d0fae230">T</a> &amp; <a class="code" href="../../d2/d51/usm_8C.html#a81ab26bb994cec5d6d3d4705f80c0836">value</a>) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(_available_nodes.size() &gt; 0);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * node = _available_nodes.back();</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  _available_nodes.pop_back();</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a> = <a class="code" href="../../d2/d51/usm_8C.html#a81ab26bb994cec5d6d3d4705f80c0836">value</a>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * location = _top_node;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * old_location = NULL;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordtype">bool</span>             on_left = <span class="keyword">true</span>; <span class="comment">// (init not needed -- but soothes g++4)</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor">#ifdef __FJCORE_SEARCHTREE_TRACK_DEPTH</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d95/eventServer_8cc.html#a5081a26baa914156df8541b03d09492e">depth</a> = 0;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">while</span>(location != NULL) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor">#ifdef __FJCORE_SEARCHTREE_TRACK_DEPTH</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor"></span>    depth++;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor"></span>    old_location = location;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    on_left = value &lt; location-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">if</span> (on_left) {location = location-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>;}</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">else</span> {location = location-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>;}</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor">#ifdef __FJCORE_SEARCHTREE_TRACK_DEPTH</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor"></span>  _max_depth = max(depth, _max_depth);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor"></span>  node-&gt;parent = old_location;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordflow">if</span> (on_left) {node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a> = node;} </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keywordflow">else</span> {node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> = node;}</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a> = NULL;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> = NULL;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#accb2b125c0e339aa16fb0d2b163c5598">predecessor</a> = _find_predecessor(node);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">if</span> (node-&gt;predecessor != NULL) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    node-&gt;successor = node-&gt;predecessor-&gt;successor;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    node-&gt;predecessor-&gt;successor = node;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    node-&gt;successor-&gt;predecessor = node;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    node-&gt;successor = _find_successor(node);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(node-&gt;successor != NULL); <span class="comment">// can only happen if we&#39;re sole element </span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    node-&gt;predecessor = node-&gt;successor-&gt;predecessor;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    node-&gt;successor-&gt;predecessor = node;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    node-&gt;predecessor-&gt;successor = node;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a>(node);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;}</div>
<div class="line"><a name="l00538"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#ae03e6908758cc32977f3f273a1cdc9b1">  538</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#ae03e6908758cc32977f3f273a1cdc9b1">SearchTree&lt;T&gt;::verify_structure</a>() {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  verify_structure_linear();</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * left_limit = _top_node;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">while</span> (left_limit-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a> != NULL) {left_limit = left_limit-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>;}</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * right_limit = _top_node;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">while</span> (right_limit-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> != NULL) {right_limit = right_limit-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>;}</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  verify_structure_recursive(_top_node, left_limit, right_limit);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div>
<div class="line"><a name="l00546"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#ac68c900696a09f29fbdd30621a642d63">  546</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#ac68c900696a09f29fbdd30621a642d63">SearchTree&lt;T&gt;::verify_structure_recursive</a>(</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                      <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * <a class="code" href="../../d5/d71/namespacefixGDML.html#a3ceb8811bdea2af323513d9f998064f3">element</a>, </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                      <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * left_limit,</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                      <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * right_limit)<span class="keyword">  const </span>{</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(!(element-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a> &lt; left_limit-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a>));</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(!(right_limit-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a> &lt; element-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a>));</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * <a class="code" href="../../d9/d3f/mongoose_8cc.html#a6dcfd23083a738f06b03dcd935b272eb">left</a> = element-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordflow">if</span> (left != NULL) {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(!(element-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a> &lt; left-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a>));</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span> (left != left_limit) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      verify_structure_recursive(left, left_limit, element);}</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">Node</a> * right = element-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="keywordflow">if</span> (right != NULL) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(!(right-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a> &lt; element-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a>));</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">if</span> (right != right_limit) {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      verify_structure_recursive(right, element, right_limit);}</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div>
<div class="line"><a name="l00565"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a3c8123a341e7f5ca809eb991cede1c6c">  565</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#a3c8123a341e7f5ca809eb991cede1c6c">SearchTree&lt;T&gt;::verify_structure_linear</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordtype">unsigned</span> n_top = 0;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordtype">unsigned</span> n_null = 0;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; _nodes.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * node = &amp;(_nodes[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ade65589df88dd18fe77a2766b41af913" title="default constructor">treelinks_null</a>()) {n_null++; <span class="keywordflow">continue</span>;}</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a> == NULL) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      n_top++;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>((node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a> == node) ^ (node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> == node));</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a> != NULL) {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(!(node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a> &lt; node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a> ));}</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> != NULL) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(!(node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a> &lt; node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a> ));}</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(n_top == 1 || (n_top == 0 &amp;&amp; <a class="code" href="../../d1/d15/ntuple__variables_8C.html#a87a2934e49c05339afd471d382cc6c74">size</a>() &lt;= 1) );</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(n_null == _available_nodes.size() ||</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;         (n_null == _available_nodes.size() + 1 &amp;&amp; <a class="code" href="../../d1/d15/ntuple__variables_8C.html#a87a2934e49c05339afd471d382cc6c74">size</a>() == 1));</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div>
<div class="line"><a name="l00585"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a93eafe3698bd40450db1c40ddfad76ee">  585</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * <a class="code" href="../../d7/d18/classSearchTree.html#a93eafe3698bd40450db1c40ddfad76ee">SearchTree&lt;T&gt;::_find_predecessor</a>(<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * node) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * newnode;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a> != NULL) {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    newnode = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">while</span>(newnode-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> != NULL) {newnode = newnode-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>;}</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">return</span> newnode;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * lastnode = node;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    newnode = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">while</span>(newnode != NULL) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="keywordflow">if</span> (newnode-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> == lastnode) {<span class="keywordflow">return</span> newnode;}</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      lastnode = newnode;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      newnode = newnode-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">return</span> newnode;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div>
<div class="line"><a name="l00602"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#add449169ba7ac64a28ba7a9833ac56cd">  602</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * <a class="code" href="../../d7/d18/classSearchTree.html#add449169ba7ac64a28ba7a9833ac56cd">SearchTree&lt;T&gt;::_find_successor</a>(<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * node) {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * newnode;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">if</span> (node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a> != NULL) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    newnode = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">while</span>(newnode-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a> != NULL) {newnode = newnode-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>;}</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">return</span> newnode;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * lastnode = node;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    newnode = node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">while</span>(newnode != NULL) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keywordflow">if</span> (newnode-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a> == lastnode) {<span class="keywordflow">return</span> newnode;}</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      lastnode = newnode;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      newnode = newnode-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">return</span> newnode;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;}</div>
<div class="line"><a name="l00619"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a5ba49d6fa7b4335696d3670359650ac6">  619</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d7/d18/classSearchTree.html#a5ba49d6fa7b4335696d3670359650ac6">SearchTree&lt;T&gt;::print_elements</a>() {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * base_node = &amp;(_nodes[0]);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keyword">typename</span> <a class="code" href="../../da/dd9/classSearchTree_1_1Node.html">SearchTree&lt;T&gt;::Node</a> * node = base_node;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = _nodes.size();</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="keywordflow">for</span>(; node - base_node &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> ; node++) {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <a class="code" href="../../da/d23/msg__buffer_8cc.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;%4d parent:%4d left:%4d right:%4d pred:%4d succ:%4d value:%10.6f\n&quot;</span>,<a class="code" href="../../d2/d51/usm_8C.html#aef1c56d2c342eb820980b683b8c35965">loc</a>(node), <a class="code" href="../../d2/d51/usm_8C.html#aef1c56d2c342eb820980b683b8c35965">loc</a>(node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a9f249357b8463b9116025db9b56b852f">parent</a>), <a class="code" href="../../d2/d51/usm_8C.html#aef1c56d2c342eb820980b683b8c35965">loc</a>(node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#a97c2737b0871b7d03a71b989a0d95fdd">left</a>), <a class="code" href="../../d2/d51/usm_8C.html#aef1c56d2c342eb820980b683b8c35965">loc</a>(node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ae837aea643f28f4900d8abed27049688">right</a>), <a class="code" href="../../d2/d51/usm_8C.html#aef1c56d2c342eb820980b683b8c35965">loc</a>(node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#accb2b125c0e339aa16fb0d2b163c5598">predecessor</a>),<a class="code" href="../../d2/d51/usm_8C.html#aef1c56d2c342eb820980b683b8c35965">loc</a>(node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#ab3a75b30fe66582704c39c1a16ae8dd6">successor</a>),node-&gt;<a class="code" href="../../da/dd9/classSearchTree_1_1Node.html#aab5ab51dd35359f713ce289107f1dff5">value</a>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;}</div>
<div class="line"><a name="l00627"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a5859e81047211ca76c7829b615e069d4">  627</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">typename</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">SearchTree&lt;T&gt;::circulator</a> <a class="code" href="../../d7/d18/classSearchTree.html#a0929d7e9b39d3a37bac2d4546b5bff53">SearchTree&lt;T&gt;::somewhere</a>() {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a>(_top_node);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;}</div>
<div class="line"><a name="l00630"></a><span class="lineno"><a class="code" href="../../d7/d18/classSearchTree.html#a0929d7e9b39d3a37bac2d4546b5bff53">  630</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">typename</span> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">SearchTree&lt;T&gt;::const_circulator</a> <a class="code" href="../../d7/d18/classSearchTree.html#a0929d7e9b39d3a37bac2d4546b5bff53">SearchTree&lt;T&gt;::somewhere</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">const_circulator</a>(_top_node);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;}</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">#endif // __FJCORE_SEARCHTREE_HH__</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifndef __FJCORE_MINHEAP__HH__</span></div>
<div class="line"><a name="l00636"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a77ec83fc2e7bd64831099fe98b7bab03">  636</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define __FJCORE_MINHEAP__HH__</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include&lt;vector&gt;</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="preprocessor">#include&lt;cassert&gt;</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="preprocessor">#include&lt;memory&gt;</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="preprocessor">#include&lt;limits&gt;</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l00642"></a><span class="lineno"><a class="code" href="../../dc/d1f/classMinHeap.html">  642</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../dc/d1f/classMinHeap.html">MinHeap</a> {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00644"></a><span class="lineno"><a class="code" href="../../dc/d1f/classMinHeap.html#abf21517f4d62ca51dbabac101a768b69">  644</a></span>&#160;  <a class="code" href="../../dc/d1f/classMinHeap.html#abf21517f4d62ca51dbabac101a768b69">MinHeap</a> (<span class="keyword">const</span> std::vector&lt;double&gt; &amp; <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#ac2e84dfba3e54d5f20db9c3f103e4be2">values</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_size) :</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="../../dc/d1f/classMinHeap.html#a4ddc783b52f64e75630e21d970e97dbb">_heap</a>(max_size) {<a class="code" href="../../dc/d1f/classMinHeap.html#ab17d0d0299b46930c61adfa52227f10c">initialise</a>(values);}</div>
<div class="line"><a name="l00646"></a><span class="lineno"><a class="code" href="../../dc/d1f/classMinHeap.html#afd192814f1d2a8d7e60e4a0cf78dc419">  646</a></span>&#160;  <a class="code" href="../../dc/d1f/classMinHeap.html#afd192814f1d2a8d7e60e4a0cf78dc419">MinHeap</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_size) : <a class="code" href="../../dc/d1f/classMinHeap.html#a4ddc783b52f64e75630e21d970e97dbb">_heap</a>(max_size) {}</div>
<div class="line"><a name="l00647"></a><span class="lineno"><a class="code" href="../../dc/d1f/classMinHeap.html#a5b6dfd5a46c78b4b54290d8dde74e7ef">  647</a></span>&#160;  <a class="code" href="../../dc/d1f/classMinHeap.html#abf21517f4d62ca51dbabac101a768b69">MinHeap</a> (<span class="keyword">const</span> std::vector&lt;double&gt; &amp; <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#ac2e84dfba3e54d5f20db9c3f103e4be2">values</a>) :</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="../../dc/d1f/classMinHeap.html#a4ddc783b52f64e75630e21d970e97dbb">_heap</a>(values.<a class="code" href="../../d1/d15/ntuple__variables_8C.html#a87a2934e49c05339afd471d382cc6c74">size</a>()) {<a class="code" href="../../dc/d1f/classMinHeap.html#ab17d0d0299b46930c61adfa52227f10c">initialise</a>(values);}</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d1f/classMinHeap.html#ab17d0d0299b46930c61adfa52227f10c">initialise</a>(<span class="keyword">const</span> std::vector&lt;double&gt; &amp; <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#ac2e84dfba3e54d5f20db9c3f103e4be2">values</a>);</div>
<div class="line"><a name="l00650"></a><span class="lineno"><a class="code" href="../../dc/d1f/classMinHeap.html#a0ca99aace4dc34bf64a6bca0408c9b08">  650</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/d1f/classMinHeap.html#a0ca99aace4dc34bf64a6bca0408c9b08">minloc</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="../../dc/d1f/classMinHeap.html#a4ddc783b52f64e75630e21d970e97dbb">_heap</a>[0].<a class="code" href="../../dc/d1f/classMinHeap.html#a0ca99aace4dc34bf64a6bca0408c9b08">minloc</a>) - &amp;(<a class="code" href="../../dc/d1f/classMinHeap.html#a4ddc783b52f64e75630e21d970e97dbb">_heap</a>[0]);}</div>
<div class="line"><a name="l00652"></a><span class="lineno"><a class="code" href="../../dc/d1f/classMinHeap.html#ae17ef2b28154bf277ffef1c4f0e71f12">  652</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">double</span>       <a class="code" href="../../dc/d1f/classMinHeap.html#ae17ef2b28154bf277ffef1c4f0e71f12">minval</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="../../dc/d1f/classMinHeap.html#a4ddc783b52f64e75630e21d970e97dbb">_heap</a>[0].minloc-&gt;value;}</div>
<div class="line"><a name="l00653"></a><span class="lineno"><a class="code" href="../../dc/d1f/classMinHeap.html#a35f609f7122e962fe8d26347b688b54e">  653</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="../../dc/d1f/classMinHeap.html#a35f609f7122e962fe8d26347b688b54e">operator[]</a>(<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="../../dc/d1f/classMinHeap.html#a4ddc783b52f64e75630e21d970e97dbb">_heap</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].value;}</div>
<div class="line"><a name="l00654"></a><span class="lineno"><a class="code" href="../../dc/d1f/classMinHeap.html#a43c188a1357883198388a9713b3d889b">  654</a></span>&#160;  <span class="keywordtype">void</span> <span class="keyword">remove</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/d51/usm_8C.html#aef1c56d2c342eb820980b683b8c35965">loc</a>) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="../../dc/d1f/classMinHeap.html#a389062f6aba4c38b4995271bf0ece469">update</a>(<a class="code" href="../../d2/d51/usm_8C.html#aef1c56d2c342eb820980b683b8c35965">loc</a>,std::numeric_limits&lt;double&gt;::max());};</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d1f/classMinHeap.html#a389062f6aba4c38b4995271bf0ece469">update</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, <span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00658"></a><span class="lineno"><a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html">  658</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html">ValueLoc</a>{</div>
<div class="line"><a name="l00659"></a><span class="lineno"><a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a768ec10c66593f57c3a768b176b29216">  659</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a768ec10c66593f57c3a768b176b29216">value</a>;</div>
<div class="line"><a name="l00660"></a><span class="lineno"><a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">  660</a></span>&#160;    <a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html">ValueLoc</a> * <a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  };</div>
<div class="line"><a name="l00662"></a><span class="lineno"><a class="code" href="../../dc/d1f/classMinHeap.html#a4ddc783b52f64e75630e21d970e97dbb">  662</a></span>&#160;  std::vector&lt;ValueLoc&gt; <a class="code" href="../../dc/d1f/classMinHeap.html#a4ddc783b52f64e75630e21d970e97dbb">_heap</a>;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;};</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="preprocessor">#endif // __FJCORE_MINHEAP__HH__</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifndef __FJCORE_CLOSESTPAIR2DBASE__HH__</span></div>
<div class="line"><a name="l00667"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#ab99ac43266e4018fc45af679f5063829">  667</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define __FJCORE_CLOSESTPAIR2DBASE__HH__</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include&lt;vector&gt;</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l00670"></a><span class="lineno"><a class="code" href="../../de/d92/classCoord2D.html">  670</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">  672</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a>, <a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>;</div>
<div class="line"><a name="l00673"></a><span class="lineno"><a class="code" href="../../de/d92/classCoord2D.html#a145cbd725c616e3f26ad8654ac7abc23">  673</a></span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html#a145cbd725c616e3f26ad8654ac7abc23">Coord2D</a>() : <a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a>(0.0), <a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>(0.0) {};</div>
<div class="line"><a name="l00674"></a><span class="lineno"><a class="code" href="../../de/d92/classCoord2D.html#af19b97ab1fbd8c1762241fded6c17ba4">  674</a></span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html#af19b97ab1fbd8c1762241fded6c17ba4">Coord2D</a>(<span class="keywordtype">double</span> <a class="code" href="../../d7/da4/namespaceKFPMath.html#a6d2496198d1982fd950acfb79033902b">a</a>, <span class="keywordtype">double</span> <a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>): <a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a>(a), <a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>(b) {};</div>
<div class="line"><a name="l00675"></a><span class="lineno"><a class="code" href="../../de/d92/classCoord2D.html#aa07d15a0458cf07744044d697271ad29">  675</a></span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> <a class="code" href="../../de/d92/classCoord2D.html#aa07d15a0458cf07744044d697271ad29">operator-</a>(<span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d92/classCoord2D.html#a145cbd725c616e3f26ad8654ac7abc23">Coord2D</a>(<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a> - other.<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a>,  <a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a> - other.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>);};</div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="code" href="../../de/d92/classCoord2D.html#a528fa1e38304664b99dc582c55fc3680">  677</a></span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> <a class="code" href="../../de/d92/classCoord2D.html#a528fa1e38304664b99dc582c55fc3680">operator+</a>(<span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d92/classCoord2D.html#a145cbd725c616e3f26ad8654ac7abc23">Coord2D</a>(<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a> + other.<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a>,  <a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a> + other.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>);};</div>
<div class="line"><a name="l00679"></a><span class="lineno"><a class="code" href="../../de/d92/classCoord2D.html#a2473253dbaaa31b29d07f53ff50535cb">  679</a></span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> <a class="code" href="../../de/d92/classCoord2D.html#a2473253dbaaa31b29d07f53ff50535cb">operator*</a>(<span class="keywordtype">double</span> factor)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="../../de/d92/classCoord2D.html#a145cbd725c616e3f26ad8654ac7abc23">Coord2D</a>(factor*<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a>,factor*<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>);};</div>
<div class="line"><a name="l00680"></a><span class="lineno"><a class="code" href="../../de/d92/classCoord2D.html#a5d18ff2ebffd81db529196c60d2c7fda">  680</a></span>&#160;  <span class="keyword">friend</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> <a class="code" href="../../de/d92/classCoord2D.html#a5d18ff2ebffd81db529196c60d2c7fda">operator*</a>(<span class="keywordtype">double</span> factor, <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; coord) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d92/classCoord2D.html#a145cbd725c616e3f26ad8654ac7abc23">Coord2D</a>(factor*coord.<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a>,factor*coord.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  }</div>
<div class="line"><a name="l00683"></a><span class="lineno"><a class="code" href="../../de/d92/classCoord2D.html#a67759b582e57e2c2dd596d41fbeaebc1">  683</a></span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> <a class="code" href="../../de/d92/classCoord2D.html#a67759b582e57e2c2dd596d41fbeaebc1">operator/</a>(<span class="keywordtype">double</span> divisor)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d92/classCoord2D.html#a145cbd725c616e3f26ad8654ac7abc23">Coord2D</a>(<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a> / divisor,  <a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a> / divisor);};</div>
<div class="line"><a name="l00685"></a><span class="lineno"><a class="code" href="../../de/d92/classCoord2D.html#ae9a90cc5dd2858b15a5a1b086b4c56ea">  685</a></span>&#160;  <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="../../de/d92/classCoord2D.html#ae9a90cc5dd2858b15a5a1b086b4c56ea">distance2</a>(<span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; <a class="code" href="../../d7/da4/namespaceKFPMath.html#a6d2496198d1982fd950acfb79033902b">a</a>, <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; <a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordtype">double</span> dx = a.<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a> - b.<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a>, <a class="code" href="../../de/de0/matchedfilter_8C.html#abab393945c85bc164c5fdc7c9031e36a">dy</a> = a.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>-b.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">return</span> dx*dx+<a class="code" href="../../de/de0/matchedfilter_8C.html#abab393945c85bc164c5fdc7c9031e36a">dy</a>*<a class="code" href="../../de/de0/matchedfilter_8C.html#abab393945c85bc164c5fdc7c9031e36a">dy</a>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  };</div>
<div class="line"><a name="l00689"></a><span class="lineno"><a class="code" href="../../de/d92/classCoord2D.html#a31a1e0923683aa72d4880bbb5184cda6">  689</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../de/d92/classCoord2D.html#a31a1e0923683aa72d4880bbb5184cda6">distance2</a>(<span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; <a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordtype">double</span> dx = <a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a> - b.<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a>, <a class="code" href="../../de/de0/matchedfilter_8C.html#abab393945c85bc164c5fdc7c9031e36a">dy</a> = <a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>-b.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">return</span> dx*dx+<a class="code" href="../../de/de0/matchedfilter_8C.html#abab393945c85bc164c5fdc7c9031e36a">dy</a>*<a class="code" href="../../de/de0/matchedfilter_8C.html#abab393945c85bc164c5fdc7c9031e36a">dy</a>;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  };</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;};</div>
<div class="line"><a name="l00694"></a><span class="lineno"><a class="code" href="../../d0/d34/classClosestPair2DBase.html">  694</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d0/d34/classClosestPair2DBase.html">ClosestPair2DBase</a> {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d34/classClosestPair2DBase.html#a61f50dc1c04d24d756505db494a63805">closest_pair</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp; ID1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp; ID2, </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                            <span class="keywordtype">double</span> &amp; distance2) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <span class="keyword">remove</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ID) = 0;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d34/classClosestPair2DBase.html#afef5f02c7b3b6227c1e1173a3c4aaf94">insert</a>(<span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; <a class="code" href="../../dc/d59/Proto4ShowerCalibFit_8m.html#a7130b1618285588513fd1ff97884b9d9">position</a>) = 0;</div>
<div class="line"><a name="l00700"></a><span class="lineno"><a class="code" href="../../d0/d34/classClosestPair2DBase.html#acb9e5bd9c6ccb547e8b3047c6eae7bcb">  700</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d34/classClosestPair2DBase.html#acb9e5bd9c6ccb547e8b3047c6eae7bcb">replace</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ID1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ID2, </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                               <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; position) {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keyword">remove</span>(ID1); </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keyword">remove</span>(ID2); </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordtype">unsigned</span> new_ID = <a class="code" href="../../d0/d34/classClosestPair2DBase.html#afef5f02c7b3b6227c1e1173a3c4aaf94">insert</a>(position);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">return</span>(new_ID);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  };</div>
<div class="line"><a name="l00707"></a><span class="lineno"><a class="code" href="../../d0/d34/classClosestPair2DBase.html#a2478e00da3c8df0f1fbee029909a7b17">  707</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d34/classClosestPair2DBase.html#a2478e00da3c8df0f1fbee029909a7b17">replace_many</a>(<span class="keyword">const</span> std::vector&lt;unsigned int&gt; &amp; IDs_to_remove,</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                       <span class="keyword">const</span> std::vector&lt;Coord2D&gt; &amp; new_positions,</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                       std::vector&lt;unsigned int&gt; &amp; new_IDs) {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; IDs_to_remove.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="keyword">remove</span>(IDs_to_remove[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);}</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    new_IDs.resize(0);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; new_positions.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      new_IDs.push_back(<a class="code" href="../../d0/d34/classClosestPair2DBase.html#afef5f02c7b3b6227c1e1173a3c4aaf94">insert</a>(new_positions[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]));}</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d34/classClosestPair2DBase.html#a2998848918e13b95b81ca8736aef06ad">size</a>() = 0;</div>
<div class="line"><a name="l00717"></a><span class="lineno"><a class="code" href="../../d0/d34/classClosestPair2DBase.html#a68a373681700d2d168eeaf53fdf26ee7">  717</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="../../d0/d34/classClosestPair2DBase.html#a68a373681700d2d168eeaf53fdf26ee7">~ClosestPair2DBase</a>() {};</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;};</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="preprocessor">#endif // __FJCORE_CLOSESTPAIR2DBASE__HH__</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifndef __FJCORE_CLOSESTPAIR2D__HH__</span></div>
<div class="line"><a name="l00722"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a28a8e15cf8778bd68aa50bce31443aed">  722</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define __FJCORE_CLOSESTPAIR2D__HH__</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include&lt;vector&gt;</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="preprocessor">#include&lt;stack&gt;</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l00727"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html">  727</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../db/dce/classClosestPair2D.html">ClosestPair2D</a> : <span class="keyword">public</span> <a class="code" href="../../d0/d34/classClosestPair2DBase.html">ClosestPair2DBase</a> {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00729"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#af0f1d6f8e88c3ef7da2006b9d61e2f4b">  729</a></span>&#160;  <a class="code" href="../../db/dce/classClosestPair2D.html#af0f1d6f8e88c3ef7da2006b9d61e2f4b">ClosestPair2D</a>(<span class="keyword">const</span> std::vector&lt;Coord2D&gt; &amp; <a class="code" href="../../d6/d57/namespacetelescope__simulation.html#acbf35efe9e0c9574912e7f0cecb4d570">positions</a>, </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; left_corner, <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; right_corner) {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <a class="code" href="../../db/dce/classClosestPair2D.html#a97e5bde421c6caadd9f73294eb7c74a8">_initialize</a>(positions, left_corner, right_corner, positions.size());</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  };</div>
<div class="line"><a name="l00733"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a24ff6ca290f91e1c642bf131c9515eff">  733</a></span>&#160;  <a class="code" href="../../db/dce/classClosestPair2D.html#af0f1d6f8e88c3ef7da2006b9d61e2f4b">ClosestPair2D</a>(<span class="keyword">const</span> std::vector&lt;Coord2D&gt; &amp; <a class="code" href="../../d6/d57/namespacetelescope__simulation.html#acbf35efe9e0c9574912e7f0cecb4d570">positions</a>, </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; left_corner, <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; right_corner,</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_size) {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <a class="code" href="../../db/dce/classClosestPair2D.html#a97e5bde421c6caadd9f73294eb7c74a8">_initialize</a>(positions, left_corner, right_corner, max_size);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  };</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a04389064ac27e01a9dd52d2041ebc90f">closest_pair</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp; ID1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp; ID2, </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                    <span class="keywordtype">double</span> &amp; distance2) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordtype">void</span> <span class="keyword">remove</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ID);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a6d61a99fae0c1e33afbe4d6874207933">insert</a>(<span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp;);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a59bfcc357d5495ff97cbac3884268519">replace</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ID1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ID2, </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                               <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; <a class="code" href="../../dc/d59/Proto4ShowerCalibFit_8m.html#a7130b1618285588513fd1ff97884b9d9">position</a>);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#ae6c58aed80f1b4b40abc34cd57810728">replace_many</a>(<span class="keyword">const</span> std::vector&lt;unsigned int&gt; &amp; IDs_to_remove,</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                            <span class="keyword">const</span> std::vector&lt;Coord2D&gt; &amp; new_positions,</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                            std::vector&lt;unsigned int&gt; &amp; new_IDs);</div>
<div class="line"><a name="l00747"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#aa6c58d012f1628e2114f0916be4f87e3">  747</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#aa6c58d012f1628e2114f0916be4f87e3">print_tree_depths</a>(std::ostream &amp; outdev)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    outdev    &lt;&lt; <a class="code" href="../../db/dce/classClosestPair2D.html#aa9227f93c6244f4c22879d8d94284933">_trees</a>[0]-&gt;max_depth() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;              &lt;&lt; <a class="code" href="../../db/dce/classClosestPair2D.html#aa9227f93c6244f4c22879d8d94284933">_trees</a>[1]-&gt;max_depth() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;              &lt;&lt; <a class="code" href="../../db/dce/classClosestPair2D.html#aa9227f93c6244f4c22879d8d94284933">_trees</a>[2]-&gt;max_depth() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  };</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a07858a87070cb723d8045ade306d8af2">size</a>();</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a97e5bde421c6caadd9f73294eb7c74a8">_initialize</a>(<span class="keyword">const</span> std::vector&lt;Coord2D&gt; &amp; <a class="code" href="../../d6/d57/namespacetelescope__simulation.html#acbf35efe9e0c9574912e7f0cecb4d570">positions</a>, </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;              <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; left_corner, <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; right_corner,</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_size);</div>
<div class="line"><a name="l00757"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#ac06d435ee1341ab7816f254c918643ca">  757</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#ac06d435ee1341ab7816f254c918643ca">_nshift</a> = 3;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keyword">class </span><a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a>; <span class="comment">// will be defined below</span></div>
<div class="line"><a name="l00759"></a><span class="lineno"><a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html">  759</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span><a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html">triplet</a> {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00761"></a><span class="lineno"><a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html#a18fb3521d880f3845b627a17982a7364">  761</a></span>&#160;    <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#ae1a6a8868aedfe9a2fa3c3d6d0fae230">T</a> &amp; <a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html#a18fb3521d880f3845b627a17982a7364">operator[]</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html#a57bac844847abf4d8289deda94ccc345">_contents</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];};</div>
<div class="line"><a name="l00762"></a><span class="lineno"><a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html#ad669a627129f278512d9f16a66ad0997">  762</a></span>&#160;    <span class="keyword">inline</span>       <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#ae1a6a8868aedfe9a2fa3c3d6d0fae230">T</a> &amp; <a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html#ad669a627129f278512d9f16a66ad0997">operator[]</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>)       {<span class="keywordflow">return</span> <a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html#a57bac844847abf4d8289deda94ccc345">_contents</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];};</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#ae1a6a8868aedfe9a2fa3c3d6d0fae230">T</a> <a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html#a57bac844847abf4d8289deda94ccc345">_contents</a>[<a class="code" href="../../db/dce/classClosestPair2D.html#ac06d435ee1341ab7816f254c918643ca">_nshift</a>];</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  };</div>
<div class="line"><a name="l00766"></a><span class="lineno"><a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html">  766</a></span>&#160;  <span class="keyword">class </span><a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html">Shuffle</a> {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00768"></a><span class="lineno"><a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a55cd75003d1908ef815353dd21b0f943">  768</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a540537134a49b4b580e58bafc472dd48">x</a>, <a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a55cd75003d1908ef815353dd21b0f943">y</a>;</div>
<div class="line"><a name="l00769"></a><span class="lineno"><a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a5a27c0b4e15172d76c293ee91897ab15">  769</a></span>&#160;    <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * <a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a5a27c0b4e15172d76c293ee91897ab15">point</a>;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#ad9a257f82b1659fb549642ff0901f1cf">operator&lt;</a>(<span class="keyword">const</span> <a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html">Shuffle</a> &amp;) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00771"></a><span class="lineno"><a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a4ea9de113b92bd55354ca8841af71d6c">  771</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a4ea9de113b92bd55354ca8841af71d6c">operator+=</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> shift) {<a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a540537134a49b4b580e58bafc472dd48">x</a> += shift; <a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a55cd75003d1908ef815353dd21b0f943">y</a>+= shift;};</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  };</div>
<div class="line"><a name="l00773"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a92b526c8c77f86b54bc50087541d4fd9">  773</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="../../d7/d18/classSearchTree.html">SearchTree&lt;Shuffle&gt;</a>     <a class="code" href="../../db/dce/classClosestPair2D.html#a92b526c8c77f86b54bc50087541d4fd9">Tree</a>;</div>
<div class="line"><a name="l00774"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#aaaad1c05cc9a351d136bfdebce23080b">  774</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">Tree::circulator</a>        <a class="code" href="../../db/dce/classClosestPair2D.html#aaaad1c05cc9a351d136bfdebce23080b">circulator</a>;</div>
<div class="line"><a name="l00775"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#ae3907058bfa5a8afd1ff5091d9d32956">  775</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="../../d8/d9f/classSearchTree_1_1const__circulator.html">Tree::const_circulator</a>  <a class="code" href="../../db/dce/classClosestPair2D.html#ae3907058bfa5a8afd1ff5091d9d32956">const_circulator</a>;</div>
<div class="line"><a name="l00776"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#aa9227f93c6244f4c22879d8d94284933">  776</a></span>&#160;  <a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html">triplet&lt;SharedPtr&lt;Tree&gt;</a> &gt;  <a class="code" href="../../db/dce/classClosestPair2D.html#aa9227f93c6244f4c22879d8d94284933">_trees</a>;</div>
<div class="line"><a name="l00777"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#abe9d7a631e6ea8573af32e18fd0f46a1">  777</a></span>&#160;  <a class="code" href="../../d7/d15/classSharedPtr.html">SharedPtr&lt;MinHeap&gt;</a>     <a class="code" href="../../db/dce/classClosestPair2D.html#abe9d7a631e6ea8573af32e18fd0f46a1">_heap</a>;</div>
<div class="line"><a name="l00778"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a267a355f5ea4d1c13e8a476e6e99db07">  778</a></span>&#160;  std::vector&lt;Point&gt;     <a class="code" href="../../db/dce/classClosestPair2D.html#a267a355f5ea4d1c13e8a476e6e99db07">_points</a>;</div>
<div class="line"><a name="l00779"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#aa41260320950dd7177a1c0a237556fcf">  779</a></span>&#160;  std::stack&lt;Point *&gt;    <a class="code" href="../../db/dce/classClosestPair2D.html#aa41260320950dd7177a1c0a237556fcf">_available_points</a>;</div>
<div class="line"><a name="l00780"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a46a7bdbe5a4869f0093494b683e6a537">  780</a></span>&#160;  std::vector&lt;Point *&gt;   <a class="code" href="../../db/dce/classClosestPair2D.html#a46a7bdbe5a4869f0093494b683e6a537">_points_under_review</a>;</div>
<div class="line"><a name="l00781"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#af2c68d1da56f1043a45ad57405d0ccef">  781</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#af2c68d1da56f1043a45ad57405d0ccef">_remove_heap_entry</a> = 1;</div>
<div class="line"><a name="l00782"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a90169fd70e68361ceb019043a3d15378">  782</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a90169fd70e68361ceb019043a3d15378">_review_heap_entry</a> = 2;</div>
<div class="line"><a name="l00783"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a7efcd5b888d53c5b7fd383194a4b8917">  783</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a7efcd5b888d53c5b7fd383194a4b8917">_review_neighbour</a>  = 4;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a253cdc7d4ba4b1a85caeaa67c04f1439">_add_label</a>(<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * <a class="code" href="../../d8/df7/PHCASeeding_8cc.html#a905ba7eea43764a576ea5db7e8b73b0f">point</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> review_flag);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a96a7ce8c270ec12c8e5710b8a965f6a9">_set_label</a>(<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * <a class="code" href="../../d8/df7/PHCASeeding_8cc.html#a905ba7eea43764a576ea5db7e8b73b0f">point</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> review_flag);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#acfd5661e9dc5b2016e8cf19acb5bd0af">_deal_with_points_to_review</a>();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a123735d62c29e2910cd35233b3fa9bba">_remove_from_search_tree</a>(<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * point_to_remove);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a740cb5b4cf828af93ca2c1e85677314b">_insert_into_search_tree</a>(<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * new_point);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a0e380576e67cc1bacc21781cb007f73c">_point2shuffle</a>(<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> &amp; , <a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html">Shuffle</a> &amp; , <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> shift);</div>
<div class="line"><a name="l00790"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a86051b04641bc4c6aa6c3e63658596d6">  790</a></span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> <a class="code" href="../../db/dce/classClosestPair2D.html#a86051b04641bc4c6aa6c3e63658596d6">_left_corner</a>;</div>
<div class="line"><a name="l00791"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a9dbc06b3353555de6eb8c1d8cd89c1f5">  791</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a9dbc06b3353555de6eb8c1d8cd89c1f5">_range</a>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#ac612d8a47fd7498af7da927dacdc8dc4">_ID</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> *) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00793"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#ad8ffc85dc5cafddd3834397f011696b2">  793</a></span>&#160;  <a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html">triplet&lt;unsigned int&gt;</a> <a class="code" href="../../db/dce/classClosestPair2D.html#ad8ffc85dc5cafddd3834397f011696b2">_shifts</a>;     <span class="comment">// absolute shifts</span></div>
<div class="line"><a name="l00794"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a90b15f1df02f339a1a0d7b89fbdbe213">  794</a></span>&#160;  <a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html">triplet&lt;unsigned int&gt;</a> <a class="code" href="../../db/dce/classClosestPair2D.html#a90b15f1df02f339a1a0d7b89fbdbe213">_rel_shifts</a>; <span class="comment">// shifts relative to previous shift</span></div>
<div class="line"><a name="l00795"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#aa46848e2fde5e78fb052f973013c95ef">  795</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#aa46848e2fde5e78fb052f973013c95ef">_cp_search_range</a>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;};</div>
<div class="line"><a name="l00797"></a><span class="lineno"><a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">  797</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">ClosestPair2D::Point</a> {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00799"></a><span class="lineno"><a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a8909b0f9899c9fc2f16d19f8acfe533a">  799</a></span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a8909b0f9899c9fc2f16d19f8acfe533a">coord</a>;</div>
<div class="line"><a name="l00800"></a><span class="lineno"><a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a7bf9b4cb8817c0df5c600bb361e0d0b1">  800</a></span>&#160;  <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a7bf9b4cb8817c0df5c600bb361e0d0b1">neighbour</a>;</div>
<div class="line"><a name="l00801"></a><span class="lineno"><a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1a99eda4e7cb79696732f6d2bebb9180">  801</a></span>&#160;  <span class="keywordtype">double</span>  <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1a99eda4e7cb79696732f6d2bebb9180">neighbour_dist2</a>;</div>
<div class="line"><a name="l00802"></a><span class="lineno"><a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a754fea3561881d2cb48f4b59b5dbcdc5">  802</a></span>&#160;  <a class="code" href="../../db/dc2/classClosestPair2D_1_1triplet.html">triplet&lt;circulator&gt;</a> <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a754fea3561881d2cb48f4b59b5dbcdc5">circ</a>;</div>
<div class="line"><a name="l00803"></a><span class="lineno"><a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a742e6ad8c8cc31774d2609f8ca94696c">  803</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a742e6ad8c8cc31774d2609f8ca94696c">review_flag</a>;</div>
<div class="line"><a name="l00804"></a><span class="lineno"><a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1e5024bdfed31a5eca34ff2c44dddbd7">  804</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1e5024bdfed31a5eca34ff2c44dddbd7">distance2</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> &amp; other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a8909b0f9899c9fc2f16d19f8acfe533a">coord</a>.<a class="code" href="../../de/d92/classCoord2D.html#ae9a90cc5dd2858b15a5a1b086b4c56ea">distance2</a>(other.<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a8909b0f9899c9fc2f16d19f8acfe533a">coord</a>);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  };</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;};</div>
<div class="line"><a name="l00808"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a537d3b23bbb0630f80363729135c02c2">  808</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#a537d3b23bbb0630f80363729135c02c2">floor_ln2_less</a>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d6/df3/namespaceambiguity__solver__full__chain.html#a5a98ca81ebd6be883836d0c8df079229">x</a>, <span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#ab927965981178aa1fba979a37168db2a">y</a>) {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">if</span> (x&gt;y) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="keywordflow">return</span> (x &lt; (x^y)); <span class="comment">// beware of operator precedence...</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;}</div>
<div class="line"><a name="l00812"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#ac612d8a47fd7498af7da927dacdc8dc4">  812</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#ac612d8a47fd7498af7da927dacdc8dc4">ClosestPair2D::_ID</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * <a class="code" href="../../d8/df7/PHCASeeding_8cc.html#a905ba7eea43764a576ea5db7e8b73b0f">point</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="keywordflow">return</span> point - &amp;(<a class="code" href="../../db/dce/classClosestPair2D.html#a267a355f5ea4d1c13e8a476e6e99db07">_points</a>[0]);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;}</div>
<div class="line"><a name="l00815"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a07858a87070cb723d8045ade306d8af2">  815</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a07858a87070cb723d8045ade306d8af2">ClosestPair2D::size</a>() {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a267a355f5ea4d1c13e8a476e6e99db07">_points</a>.size() - <a class="code" href="../../db/dce/classClosestPair2D.html#aa41260320950dd7177a1c0a237556fcf">_available_points</a>.size();</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;}</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="preprocessor">#endif // __FJCORE_CLOSESTPAIR2D__HH__</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifndef __FJCORE_LAZYTILING9ALT_HH__</span></div>
<div class="line"><a name="l00821"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a3e9e6dcb668901f413171f7702afc632">  821</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define __FJCORE_LAZYTILING9ALT_HH__</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="preprocessor"></span><a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l00823"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a4f014d5727219a7118bf37a8c22be6ec">  823</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#a4f014d5727219a7118bf37a8c22be6ec">tile_edge_security_margin</a>=1.0e-7;</div>
<div class="line"><a name="l00824"></a><span class="lineno"><a class="code" href="../../df/da7/classTiledJet.html">  824</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00826"></a><span class="lineno"><a class="code" href="../../df/da7/classTiledJet.html#a8835c304c97003b0159e3b2686b99151">  826</a></span>&#160;  <span class="keywordtype">double</span>     <a class="code" href="../../df/da7/classTiledJet.html#a4d55d138e2a9c00de4c8a7bebbf22527">eta</a>, <a class="code" href="../../df/da7/classTiledJet.html#a8835c304c97003b0159e3b2686b99151">phi</a>, <a class="code" href="../../df/da7/classTiledJet.html#a370a59a9def2f68b1cdded48eb319471">kt2</a>, <a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l00827"></a><span class="lineno"><a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">  827</a></span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a>, *<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a>, * <a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>; </div>
<div class="line"><a name="l00828"></a><span class="lineno"><a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">  828</a></span>&#160;  <span class="keywordtype">int</span>        <a class="code" href="../../df/da7/classTiledJet.html#adcad53d4a6409c3f08fea864bd84df48">_jets_index</a>, <a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>;</div>
<div class="line"><a name="l00829"></a><span class="lineno"><a class="code" href="../../df/da7/classTiledJet.html#a50d74df8d95d3c60fb9d96c31ddc8d16">  829</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../df/da7/classTiledJet.html#a50d74df8d95d3c60fb9d96c31ddc8d16">_minheap_update_needed</a>;</div>
<div class="line"><a name="l00830"></a><span class="lineno"><a class="code" href="../../df/da7/classTiledJet.html#a3f73f5b46367e34719b3024d36573b54">  830</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../df/da7/classTiledJet.html#a3f73f5b46367e34719b3024d36573b54">label_minheap_update_needed</a>() {<a class="code" href="../../df/da7/classTiledJet.html#a50d74df8d95d3c60fb9d96c31ddc8d16">_minheap_update_needed</a> = <span class="keyword">true</span>;}</div>
<div class="line"><a name="l00831"></a><span class="lineno"><a class="code" href="../../df/da7/classTiledJet.html#aa91ab795c368e78cd37c188ddf2b0eba">  831</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../df/da7/classTiledJet.html#aa91ab795c368e78cd37c188ddf2b0eba">label_minheap_update_done</a>()   {<a class="code" href="../../df/da7/classTiledJet.html#a50d74df8d95d3c60fb9d96c31ddc8d16">_minheap_update_needed</a> = <span class="keyword">false</span>;}</div>
<div class="line"><a name="l00832"></a><span class="lineno"><a class="code" href="../../df/da7/classTiledJet.html#a6a9b6e9d8d9e84ceb95c722b7c892aa0">  832</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="../../df/da7/classTiledJet.html#a6a9b6e9d8d9e84ceb95c722b7c892aa0">minheap_update_needed</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="../../df/da7/classTiledJet.html#a50d74df8d95d3c60fb9d96c31ddc8d16">_minheap_update_needed</a>;}</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;};</div>
<div class="line"><a name="l00834"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a76b336d192d8400d217c25bad45cf77c">  834</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#a76b336d192d8400d217c25bad45cf77c">n_tile_neighbours</a> = 9;</div>
<div class="line"><a name="l00835"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html">  835</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d6/dba/classTile.html">Tile</a> {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00837"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a432cd5cec549df60b2129bd44606e453">  837</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="../../da/d55/TPCRateLayered_8m.html#ac40e4ec8f2a74a2878f06670249eebb8">double</a> (<a class="code" href="../../d6/dba/classTile.html">Tile</a>::*<a class="code" href="../../d6/dba/classTile.html#a432cd5cec549df60b2129bd44606e453">DistToTileFn</a>)(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a>*) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00838"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">  838</a></span>&#160;  <span class="keyword">typedef</span> std::pair&lt;Tile *, DistToTileFn&gt; <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">TileFnPair</a>;</div>
<div class="line"><a name="l00839"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#ae84cc387ca2878997788f69203080653">  839</a></span>&#160;  <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">TileFnPair</a> <a class="code" href="../../d6/dba/classTile.html#ae84cc387ca2878997788f69203080653">begin_tiles</a>[<a class="code" href="../../d8/d99/fjcore_8cc.html#a76b336d192d8400d217c25bad45cf77c">n_tile_neighbours</a>]; </div>
<div class="line"><a name="l00840"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a00380e1cbb97c3050cba2cd536f8e8ff">  840</a></span>&#160;  <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">TileFnPair</a> *  <a class="code" href="../../d6/dba/classTile.html#a00380e1cbb97c3050cba2cd536f8e8ff">surrounding_tiles</a>; </div>
<div class="line"><a name="l00841"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a8bb3c90e69ebdcf4006a4604a0686e8a">  841</a></span>&#160;  <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">TileFnPair</a> *  <a class="code" href="../../d6/dba/classTile.html#a8bb3c90e69ebdcf4006a4604a0686e8a">RH_tiles</a>;  </div>
<div class="line"><a name="l00842"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a329d17e1969ebc71b1b4b5f526c7fbca">  842</a></span>&#160;  <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">TileFnPair</a> *  <a class="code" href="../../d6/dba/classTile.html#a329d17e1969ebc71b1b4b5f526c7fbca">end_tiles</a>; </div>
<div class="line"><a name="l00843"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a7580f851a180f1149b0ea356d01f4ef6">  843</a></span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <a class="code" href="../../d6/dba/classTile.html#a7580f851a180f1149b0ea356d01f4ef6">head</a>;    </div>
<div class="line"><a name="l00844"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a813d13f819ffe7a56b6d9b1c3969fd0f">  844</a></span>&#160;  <span class="keywordtype">bool</span>     <a class="code" href="../../d6/dba/classTile.html#a813d13f819ffe7a56b6d9b1c3969fd0f">tagged</a>;    </div>
<div class="line"><a name="l00845"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a8a2e35acd08e0cd6f4ec833476a06046">  845</a></span>&#160;  <span class="keywordtype">bool</span>     <a class="code" href="../../d6/dba/classTile.html#a8a2e35acd08e0cd6f4ec833476a06046">use_periodic_delta_phi</a>;</div>
<div class="line"><a name="l00846"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a24050e641756be95bc3056567c369740">  846</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/dba/classTile.html#a24050e641756be95bc3056567c369740">max_NN_dist</a>;</div>
<div class="line"><a name="l00847"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a5ed67a95bf42d52d52f220069ff67e86">  847</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/dba/classTile.html#a213dd764e077f3d80099880eb67dae0d">eta_min</a>, <a class="code" href="../../d6/dba/classTile.html#ab7a9c841145708a7c56a4ee2bc3f6c29">eta_max</a>, <a class="code" href="../../d6/dba/classTile.html#a5ed67a95bf42d52d52f220069ff67e86">phi_min</a>, <a class="code" href="../../d6/dba/classTile.html#a63432d21621459990959f4b5acb52f86">phi_max</a>;</div>
<div class="line"><a name="l00848"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a1698b7e24fa015346465b2e6cd2f4586">  848</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/dba/classTile.html#a1698b7e24fa015346465b2e6cd2f4586">distance_to_centre</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> *)<span class="keyword"> const </span>{<span class="keywordflow">return</span> 0;}</div>
<div class="line"><a name="l00849"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a891abfc26f5d46c6c1da3135cbc08c63">  849</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/dba/classTile.html#a891abfc26f5d46c6c1da3135cbc08c63">distance_to_left</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordtype">double</span> deta = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a4d55d138e2a9c00de4c8a7bebbf22527">eta</a> - <a class="code" href="../../d6/dba/classTile.html#a213dd764e077f3d80099880eb67dae0d">eta_min</a>;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">return</span> deta*deta;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  }</div>
<div class="line"><a name="l00853"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a7301bc20be1599cb3fe210feb0f15cc5">  853</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/dba/classTile.html#a7301bc20be1599cb3fe210feb0f15cc5">distance_to_right</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordtype">double</span> deta = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a4d55d138e2a9c00de4c8a7bebbf22527">eta</a> - <a class="code" href="../../d6/dba/classTile.html#ab7a9c841145708a7c56a4ee2bc3f6c29">eta_max</a>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">return</span> deta*deta;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  }</div>
<div class="line"><a name="l00857"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a1a0a8cd91c79d58e06297a8124888700">  857</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/dba/classTile.html#a1a0a8cd91c79d58e06297a8124888700">distance_to_bottom</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8835c304c97003b0159e3b2686b99151">phi</a> - <a class="code" href="../../d6/dba/classTile.html#a5ed67a95bf42d52d52f220069ff67e86">phi_min</a>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">return</span> dphi*<a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  }</div>
<div class="line"><a name="l00861"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a777f229c42135ac9ebf685033a3af918">  861</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/dba/classTile.html#a777f229c42135ac9ebf685033a3af918">distance_to_top</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8835c304c97003b0159e3b2686b99151">phi</a> - <a class="code" href="../../d6/dba/classTile.html#a63432d21621459990959f4b5acb52f86">phi_max</a>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">return</span> dphi*<a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  }</div>
<div class="line"><a name="l00865"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a01d3c18d7fd76ac9b2198f4b421ecc3b">  865</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/dba/classTile.html#a01d3c18d7fd76ac9b2198f4b421ecc3b">distance_to_left_top</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordtype">double</span> deta = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a4d55d138e2a9c00de4c8a7bebbf22527">eta</a> - <a class="code" href="../../d6/dba/classTile.html#a213dd764e077f3d80099880eb67dae0d">eta_min</a>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8835c304c97003b0159e3b2686b99151">phi</a> - <a class="code" href="../../d6/dba/classTile.html#a63432d21621459990959f4b5acb52f86">phi_max</a>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">return</span> deta*deta + dphi*<a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  }</div>
<div class="line"><a name="l00870"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#a97aa7052cf679ded850bf4339190d7f6">  870</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/dba/classTile.html#a97aa7052cf679ded850bf4339190d7f6">distance_to_left_bottom</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordtype">double</span> deta = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a4d55d138e2a9c00de4c8a7bebbf22527">eta</a> - <a class="code" href="../../d6/dba/classTile.html#a213dd764e077f3d80099880eb67dae0d">eta_min</a>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8835c304c97003b0159e3b2686b99151">phi</a> - <a class="code" href="../../d6/dba/classTile.html#a5ed67a95bf42d52d52f220069ff67e86">phi_min</a>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">return</span> deta*deta + dphi*<a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  }</div>
<div class="line"><a name="l00875"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#aabc56b48d79be7881fa5071c2aa19adb">  875</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/dba/classTile.html#aabc56b48d79be7881fa5071c2aa19adb">distance_to_right_top</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordtype">double</span> deta = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a4d55d138e2a9c00de4c8a7bebbf22527">eta</a> - <a class="code" href="../../d6/dba/classTile.html#ab7a9c841145708a7c56a4ee2bc3f6c29">eta_max</a>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8835c304c97003b0159e3b2686b99151">phi</a> - <a class="code" href="../../d6/dba/classTile.html#a63432d21621459990959f4b5acb52f86">phi_max</a>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">return</span> deta*deta + dphi*<a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  }</div>
<div class="line"><a name="l00880"></a><span class="lineno"><a class="code" href="../../d6/dba/classTile.html#aa2cd60d5bd91d4adbc54accac9ca97d7">  880</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/dba/classTile.html#aa2cd60d5bd91d4adbc54accac9ca97d7">distance_to_right_bottom</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordtype">double</span> deta = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a4d55d138e2a9c00de4c8a7bebbf22527">eta</a> - <a class="code" href="../../d6/dba/classTile.html#ab7a9c841145708a7c56a4ee2bc3f6c29">eta_max</a>;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8835c304c97003b0159e3b2686b99151">phi</a> - <a class="code" href="../../d6/dba/classTile.html#a5ed67a95bf42d52d52f220069ff67e86">phi_min</a>;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">return</span> deta*deta + dphi*<a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;};</div>
<div class="line"><a name="l00886"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html">  886</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d9/dae/classLazyTiling9Alt.html">LazyTiling9Alt</a> {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ab913591cbf2ebdf06ca97a54ec474dd8">LazyTiling9Alt</a>(ClusterSequence &amp; cs);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac84f56586f04bf876590c60b0b015806">run</a>();</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00891"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#aa178ac68f7b0cde61f9102276957cdb5">  891</a></span>&#160;  ClusterSequence &amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#aa178ac68f7b0cde61f9102276957cdb5">_cs</a>;</div>
<div class="line"><a name="l00892"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a3d3a32b461c65d2de87fc0bf3f46757b">  892</a></span>&#160;  <span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a3d3a32b461c65d2de87fc0bf3f46757b">_jets</a>;</div>
<div class="line"><a name="l00893"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">  893</a></span>&#160;  std::vector&lt;Tile&gt; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>;</div>
<div class="line"><a name="l00894"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a9fc9bfd272cca34b93ded55e9269fa85">  894</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a9fc9bfd272cca34b93ded55e9269fa85">_Rparam</a>, <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a5f9fae9719f3b1bbdf0d3c12fcd5f2b4">_R2</a>, <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a72e777ed159e2d08314079248787ee07">_invR2</a>;</div>
<div class="line"><a name="l00895"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac32fb405bf33639ccff8298608f61e93">  895</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac32fb405bf33639ccff8298608f61e93">_tiles_eta_min</a>, <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af12c3d5af7b660271ecb42d9ed7ce8f2">_tiles_eta_max</a>;</div>
<div class="line"><a name="l00896"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a8cd3408521104c153b58709bd47b578f">  896</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a311e075e7c55de8df64ec224ab173f48">_tile_size_eta</a>, <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a8cd3408521104c153b58709bd47b578f">_tile_size_phi</a>;</div>
<div class="line"><a name="l00897"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ab44b92c53982b5265ff23b819e723c22">  897</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a07d6b04e9ba468108741f255374824d9">_tile_half_size_eta</a>, <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ab44b92c53982b5265ff23b819e723c22">_tile_half_size_phi</a>;</div>
<div class="line"><a name="l00898"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#acbe0b1edd05c6897941261f4441048dc">  898</a></span>&#160;  <span class="keywordtype">int</span>    <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a>,<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#acbe0b1edd05c6897941261f4441048dc">_tiles_ieta_min</a>,<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af353acf9bd821a65c0c3aa7f1f88b81d">_tiles_ieta_max</a>;</div>
<div class="line"><a name="l00899"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a7860071f55e0ff4cdadd30e13995c0d0">  899</a></span>&#160;  std::vector&lt;TiledJet *&gt; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a7860071f55e0ff4cdadd30e13995c0d0">_jets_for_minheap</a>;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a49b58fbc44131003e18059ae573ffc52">_initialise_tiles</a>();</div>
<div class="line"><a name="l00901"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">  901</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">_tile_index</a> (<span class="keywordtype">int</span> ieta, <span class="keywordtype">int</span> iphi)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">return</span> (ieta-<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#acbe0b1edd05c6897941261f4441048dc">_tiles_ieta_min</a>)*<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                  + (iphi+<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a>) % <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  }</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordtype">void</span>  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a34935a01ded9d31425d43fcbf3047c9e">_bj_remove_from_tiles</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">_tile_index</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#aa66df887c67e0d1025831e9998ea2415">eta</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d6/d34/namespaceActsTests_1_1PropagationDatasets.html#a4722f5524134f5f139681f91e6c50038">phi</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ab06aa2645325f0dc3cf75704834898ec">_tj_set_jetinfo</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet, <span class="keyword">const</span> <span class="keywordtype">int</span> _jets_index);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ae4d08a569f9d9d675d1d37e5492a1e13">_print_tiles</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * briefjets ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a10445c472f9312b1d5c8bf5e02a91eba">_add_neighbours_to_tile_union</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                 std::vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a0b6dca001f406eae6eb03a4b41f6d5c7">_add_untagged_neighbours_to_tile_union</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                 std::vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a494f7447beed4925b4e0cefbda761ee8">_add_untagged_neighbours_to_tile_union_using_max_info</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet, </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                 std::vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#abe7dd3e938c46d2625e2e9a6a8657aa2">_update_jetX_jetI_NN</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetX, <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI, std::vector&lt;TiledJet *&gt; &amp; jets_for_minheap);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a610f988049ee51f745cdd79a0b97df01">_set_NN</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI, std::vector&lt;TiledJet *&gt; &amp; jets_for_minheap);</div>
<div class="line"><a name="l00917"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a79afb75701cc931952234d74e549ddeb">  917</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> J&gt; <span class="keywordtype">double</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a79afb75701cc931952234d74e549ddeb">_bj_diJ</a>(<span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordtype">double</span> kt2 = jet-&gt;kt2;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> (jet-&gt;NN != NULL) {<span class="keywordflow">if</span> (jet-&gt;NN-&gt;kt2 &lt; kt2) {kt2 = jet-&gt;NN-&gt;kt2;}}</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">return</span> jet-&gt;NN_dist * kt2;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  }</div>
<div class="line"><a name="l00922"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a348abcd491a21633330d1e72e418087f">  922</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> J&gt; <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a348abcd491a21633330d1e72e418087f">_bj_set_jetinfo</a>(</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                            <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetA, <span class="keyword">const</span> <span class="keywordtype">int</span> _jets_index)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    jetA-&gt;eta  = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a3d3a32b461c65d2de87fc0bf3f46757b">_jets</a>[_jets_index].rap();</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    jetA-&gt;phi  = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a3d3a32b461c65d2de87fc0bf3f46757b">_jets</a>[_jets_index].phi_02pi();</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    jetA-&gt;kt2  = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#aa178ac68f7b0cde61f9102276957cdb5">_cs</a>.jet_scale_for_algorithm(<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a3d3a32b461c65d2de87fc0bf3f46757b">_jets</a>[_jets_index]);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    jetA-&gt;_jets_index = _jets_index;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    jetA-&gt;NN_dist = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a5f9fae9719f3b1bbdf0d3c12fcd5f2b4">_R2</a>;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    jetA-&gt;NN      = NULL;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  }</div>
<div class="line"><a name="l00931"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a12d687852b9b72130480b27594a10d84">  931</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> J&gt; <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a12d687852b9b72130480b27594a10d84">_bj_dist</a>(</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetA, <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = std::abs(jetA-&gt;phi - jetB-&gt;phi);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordtype">double</span> deta = (jetA-&gt;eta - jetB-&gt;eta);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">if</span> (dphi &gt; <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>) {dphi = <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> - <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;}</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">return</span> dphi*dphi + deta*deta;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  }</div>
<div class="line"><a name="l00938"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a02c2cfced1c947f61aa68860c6a0b46c">  938</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> J&gt; <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a02c2cfced1c947f61aa68860c6a0b46c">_bj_dist_not_periodic</a>(</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetA, <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = jetA-&gt;phi - jetB-&gt;phi;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordtype">double</span> deta = (jetA-&gt;eta - jetB-&gt;eta);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordflow">return</span> dphi*dphi + deta*deta;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;};</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="preprocessor">#endif // __FJCORE_LAZYTILING9ALT_HH__</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifndef __FJCORE_LAZYTILING9_HH__</span></div>
<div class="line"><a name="l00948"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#ace016264c1e0db408338010ebc085507">  948</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define __FJCORE_LAZYTILING9_HH__</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="preprocessor"></span><a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">int</span> NN&gt;</div>
<div class="line"><a name="l00951"></a><span class="lineno"><a class="code" href="../../d9/db1/classTile2Base.html">  951</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d9/db1/classTile2Base.html">Tile2Base</a> {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00953"></a><span class="lineno"><a class="code" href="../../d9/db1/classTile2Base.html#ae1e3c44950c032480fb16783c993ed13">  953</a></span>&#160;  <a class="code" href="../../d9/db1/classTile2Base.html">Tile2Base</a> *   <a class="code" href="../../d9/db1/classTile2Base.html#ae1e3c44950c032480fb16783c993ed13">begin_tiles</a>[<a class="code" href="../../d8/db9/ElectronID_2src_2dataset_2Weights__negative_2TMVAClassification__BDT_8class_8C.html#a170755e30c36be4904106b7bb279b1ec">NN</a>]; </div>
<div class="line"><a name="l00954"></a><span class="lineno"><a class="code" href="../../d9/db1/classTile2Base.html#a68d6a05f16e2d5c423dc97c95b77a4e3">  954</a></span>&#160;  <a class="code" href="../../d9/db1/classTile2Base.html">Tile2Base</a> **  <a class="code" href="../../d9/db1/classTile2Base.html#a68d6a05f16e2d5c423dc97c95b77a4e3">surrounding_tiles</a>; </div>
<div class="line"><a name="l00955"></a><span class="lineno"><a class="code" href="../../d9/db1/classTile2Base.html#ae8c883f4c7a7b721b816068db55c66d8">  955</a></span>&#160;  <a class="code" href="../../d9/db1/classTile2Base.html">Tile2Base</a> **  <a class="code" href="../../d9/db1/classTile2Base.html#ae8c883f4c7a7b721b816068db55c66d8">RH_tiles</a>;  </div>
<div class="line"><a name="l00956"></a><span class="lineno"><a class="code" href="../../d9/db1/classTile2Base.html#af98fbf093794eb40b3dbbc134fd80f56">  956</a></span>&#160;  <a class="code" href="../../d9/db1/classTile2Base.html">Tile2Base</a> **  <a class="code" href="../../d9/db1/classTile2Base.html#af98fbf093794eb40b3dbbc134fd80f56">end_tiles</a>; </div>
<div class="line"><a name="l00957"></a><span class="lineno"><a class="code" href="../../d9/db1/classTile2Base.html#a967234fb4a55f306015eec8ed87f9bfc">  957</a></span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <a class="code" href="../../d9/db1/classTile2Base.html#a967234fb4a55f306015eec8ed87f9bfc">head</a>;    </div>
<div class="line"><a name="l00958"></a><span class="lineno"><a class="code" href="../../d9/db1/classTile2Base.html#adeb2eb8f227cf231ef5694bc183ec9a1">  958</a></span>&#160;  <span class="keywordtype">bool</span>     <a class="code" href="../../d9/db1/classTile2Base.html#adeb2eb8f227cf231ef5694bc183ec9a1">tagged</a>;    </div>
<div class="line"><a name="l00959"></a><span class="lineno"><a class="code" href="../../d9/db1/classTile2Base.html#a0fa522d0d86c555e2645f1be170cb83a">  959</a></span>&#160;  <span class="keywordtype">bool</span>     <a class="code" href="../../d9/db1/classTile2Base.html#a0fa522d0d86c555e2645f1be170cb83a">use_periodic_delta_phi</a>;</div>
<div class="line"><a name="l00960"></a><span class="lineno"><a class="code" href="../../d9/db1/classTile2Base.html#a4f1ab1f745a57b517c847c06011e8281">  960</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d9/db1/classTile2Base.html#a4f1ab1f745a57b517c847c06011e8281">max_NN_dist</a>;</div>
<div class="line"><a name="l00961"></a><span class="lineno"><a class="code" href="../../d9/db1/classTile2Base.html#a6cf288492a7f3b7c2d26c19f9ffb96d9">  961</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d9/db1/classTile2Base.html#a50417c886eb3761eb0d958b4a0ab1036">eta_centre</a>, <a class="code" href="../../d9/db1/classTile2Base.html#a6cf288492a7f3b7c2d26c19f9ffb96d9">phi_centre</a>;</div>
<div class="line"><a name="l00962"></a><span class="lineno"><a class="code" href="../../d9/db1/classTile2Base.html#ac311d587faadada654c06340a5c16d64">  962</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d9/db1/classTile2Base.html#ac311d587faadada654c06340a5c16d64">jet_count</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d7/dc9/namespacetest__fpe.html#a14b0654d69c0b1f363c2e1a8e0ba5b54">count</a> = 0;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jet = <a class="code" href="../../d9/db1/classTile2Base.html#a967234fb4a55f306015eec8ed87f9bfc">head</a>;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">while</span> (jet != 0) {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      count++;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      jet = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/dc9/namespacetest__fpe.html#a14b0654d69c0b1f363c2e1a8e0ba5b54">count</a>;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;};</div>
<div class="line"><a name="l00972"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#aa5fd9f55ee8c0cefa4283945ab248841">  972</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="../../d9/db1/classTile2Base.html">Tile2Base&lt;9&gt;</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#aa5fd9f55ee8c0cefa4283945ab248841">Tile2</a>;</div>
<div class="line"><a name="l00973"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html">  973</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d6/d0c/classLazyTiling9.html">LazyTiling9</a> {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#aa662d71ae8f168ca28ed15288a85bcee">LazyTiling9</a>(ClusterSequence &amp; cs);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a59d38f77750b9265c6f182157130b1cf">run</a>();</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00978"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a63f258516215178970e17bbe2987f8ad">  978</a></span>&#160;  ClusterSequence &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a63f258516215178970e17bbe2987f8ad">_cs</a>;</div>
<div class="line"><a name="l00979"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">  979</a></span>&#160;  <span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>;</div>
<div class="line"><a name="l00980"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">  980</a></span>&#160;  std::vector&lt;Tile2&gt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">int</span> _ncall; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="keywordtype">int</span> _ncall_dtt; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="preprocessor">#endif // INSTRUMENT2</span></div>
<div class="line"><a name="l00985"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">  985</a></span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>, <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>, <a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a>;</div>
<div class="line"><a name="l00986"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">  986</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a>, <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a>;</div>
<div class="line"><a name="l00987"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#aff3c1a2733231c09a9e259c5730928d2">  987</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>, <a class="code" href="../../d6/d0c/classLazyTiling9.html#aff3c1a2733231c09a9e259c5730928d2">_tile_size_phi</a>;</div>
<div class="line"><a name="l00988"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a353ef38de1408b7d50f10f85f9d9dd0e">  988</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a36915a57bffdd5ac16a1390775cdd2b1">_tile_half_size_eta</a>, <a class="code" href="../../d6/d0c/classLazyTiling9.html#a353ef38de1408b7d50f10f85f9d9dd0e">_tile_half_size_phi</a>;</div>
<div class="line"><a name="l00989"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">  989</a></span>&#160;  <span class="keywordtype">int</span>    <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>,<a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>,<a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>;</div>
<div class="line"><a name="l00990"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#ab05da24bce041c33692913e1daf99685">  990</a></span>&#160;  std::vector&lt;TiledJet *&gt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#ab05da24bce041c33692913e1daf99685">_jets_for_minheap</a>;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0e8c176445183a4f9e03ba8ac6b40131">_initialise_tiles</a>();</div>
<div class="line"><a name="l00992"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">  992</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a> (<span class="keywordtype">int</span> ieta, <span class="keywordtype">int</span> iphi)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">return</span> (ieta-<a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>)*<a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                  + (iphi+<a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>) % <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  }</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="keywordtype">void</span>  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#aa66df887c67e0d1025831e9998ea2415">eta</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d6/d34/namespaceActsTests_1_1PropagationDatasets.html#a4722f5524134f5f139681f91e6c50038">phi</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5da6d84f64a7cff12c08700d37f56782">_tj_set_jetinfo</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet, <span class="keyword">const</span> <span class="keywordtype">int</span> _jets_index);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a49c31c2140e3b60cf4d6b90672eb3cf2">_print_tiles</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * briefjets ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#ac279873de61def4b2de5bc273d6ed6a1">_add_neighbours_to_tile_union</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                 std::vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3f62c993b981ade840a9d22a4209fc27">_add_untagged_neighbours_to_tile_union</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                 std::vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#adb795b6cfe7ca3348e4faf5b28c87734">_add_untagged_neighbours_to_tile_union_using_max_info</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet, </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                 std::vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3d193f3e3b51ad0f4b5262b57b71ed43">_distance_to_tile</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * bj, <span class="keyword">const</span> Tile2 *) </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="preprocessor"></span>    ;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="preprocessor"></span>    <span class="keyword">const</span>;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#ab4a0376d864c66c877a3b4559ab5b62b">_update_jetX_jetI_NN</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetX, <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI, std::vector&lt;TiledJet *&gt; &amp; jets_for_minheap);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#ab5cbd2f263244bb145a45e180de3bc99">_set_NN</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI, std::vector&lt;TiledJet *&gt; &amp; jets_for_minheap);</div>
<div class="line"><a name="l01014"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc"> 1014</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> J&gt; <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(<span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordtype">double</span> kt2 = jet-&gt;kt2;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordflow">if</span> (jet-&gt;NN != NULL) {<span class="keywordflow">if</span> (jet-&gt;NN-&gt;kt2 &lt; kt2) {kt2 = jet-&gt;NN-&gt;kt2;}}</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordflow">return</span> jet-&gt;NN_dist * kt2;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  }</div>
<div class="line"><a name="l01019"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a6ac03fa0069b90c9baaa722c8487c74a"> 1019</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> J&gt; <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a6ac03fa0069b90c9baaa722c8487c74a">_bj_set_jetinfo</a>(</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                            <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetA, <span class="keyword">const</span> <span class="keywordtype">int</span> _jets_index)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    jetA-&gt;eta  = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_jets_index].rap();</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    jetA-&gt;phi  = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_jets_index].phi_02pi();</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    jetA-&gt;kt2  = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a63f258516215178970e17bbe2987f8ad">_cs</a>.jet_scale_for_algorithm(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_jets_index]);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    jetA-&gt;_jets_index = _jets_index;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    jetA-&gt;NN_dist = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    jetA-&gt;NN      = NULL;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  }</div>
<div class="line"><a name="l01028"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8"> 1028</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> J&gt; <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetA, <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetB) </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="preprocessor"></span>    {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    _ncall++; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="preprocessor"></span>    <span class="keyword">const</span> {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = std::abs(jetA-&gt;phi - jetB-&gt;phi);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordtype">double</span> deta = (jetA-&gt;eta - jetB-&gt;eta);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordflow">if</span> (dphi &gt; <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>) {dphi = <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> - <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;}</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">return</span> dphi*dphi + deta*deta;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  }</div>
<div class="line"><a name="l01041"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a5acc49ca0da50d3a4fa1b4cab400c990"> 1041</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> J&gt; <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5acc49ca0da50d3a4fa1b4cab400c990">_bj_dist_not_periodic</a>(</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetA, <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetB)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="preprocessor"></span>    {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    _ncall++; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="preprocessor"></span>    <span class="keyword">const</span> {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = jetA-&gt;phi - jetB-&gt;phi;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordtype">double</span> deta = (jetA-&gt;eta - jetB-&gt;eta);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordflow">return</span> dphi*dphi + deta*deta;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  }</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;};</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="preprocessor">#endif // __FJCORE_LAZYTILING9_HH__</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifndef __FJCORE_LAZYTILING25_HH__</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a9392544fb8ed72b89929a8620a4ee3af"> 1057</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define __FJCORE_LAZYTILING25_HH__</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="preprocessor"></span><a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a95b5c80e73e4cd5aa08446a25b9ad528"> 1059</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="../../d9/db1/classTile2Base.html">Tile2Base&lt;25&gt;</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a95b5c80e73e4cd5aa08446a25b9ad528">Tile25</a>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html"> 1060</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d8/dbe/classLazyTiling25.html">LazyTiling25</a> {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <a class="code" href="../../d8/dbe/classLazyTiling25.html">LazyTiling25</a>(ClusterSequence &amp; cs);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a59d38f77750b9265c6f182157130b1cf">run</a>();</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01065"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a69f84d613408c8f4d1917d93d38520cc"> 1065</a></span>&#160;  ClusterSequence &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a69f84d613408c8f4d1917d93d38520cc">_cs</a>;</div>
<div class="line"><a name="l01066"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#aa3dd12e7ad4a1988b0115d69dad372ae"> 1066</a></span>&#160;  <span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#aa3dd12e7ad4a1988b0115d69dad372ae">_jets</a>;</div>
<div class="line"><a name="l01067"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f"> 1067</a></span>&#160;  std::vector&lt;Tile25&gt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">int</span> _ncall; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordtype">int</span> _ncall_dtt; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="preprocessor">#endif // INSTRUMENT2</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a603c707072007bc635053031ecd05c53"> 1072</a></span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">double</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#a603c707072007bc635053031ecd05c53">_Rparam</a>, <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>, <a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a>;</div>
<div class="line"><a name="l01073"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d"> 1073</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d">_tiles_eta_min</a>, <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a>;</div>
<div class="line"><a name="l01074"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#aa5358fd1f9c21e918781c6673f84bd80"> 1074</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>, <a class="code" href="../../d8/dbe/classLazyTiling25.html#aa5358fd1f9c21e918781c6673f84bd80">_tile_size_phi</a>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a9c3d392b1bc47fa3dbdead589d07bce0"> 1075</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a36915a57bffdd5ac16a1390775cdd2b1">_tile_half_size_eta</a>, <a class="code" href="../../d8/dbe/classLazyTiling25.html#a9c3d392b1bc47fa3dbdead589d07bce0">_tile_half_size_phi</a>;</div>
<div class="line"><a name="l01076"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38"> 1076</a></span>&#160;  <span class="keywordtype">int</span>    <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>,<a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38">_tiles_ieta_min</a>,<a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>;</div>
<div class="line"><a name="l01077"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#afbd435815f20d2bc9886934a528f4cad"> 1077</a></span>&#160;  std::vector&lt;TiledJet *&gt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#afbd435815f20d2bc9886934a528f4cad">_jets_for_minheap</a>;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0e8c176445183a4f9e03ba8ac6b40131">_initialise_tiles</a>();</div>
<div class="line"><a name="l01079"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea"> 1079</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea">_tile_index</a> (<span class="keywordtype">int</span> ieta, <span class="keywordtype">int</span> iphi)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordflow">return</span> (ieta-<a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>)*<a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                  + (iphi+<a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>) % <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="keywordtype">void</span>  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#aa66df887c67e0d1025831e9998ea2415">eta</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d6/d34/namespaceActsTests_1_1PropagationDatasets.html#a4722f5524134f5f139681f91e6c50038">phi</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5da6d84f64a7cff12c08700d37f56782">_tj_set_jetinfo</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet, <span class="keyword">const</span> <span class="keywordtype">int</span> _jets_index);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a49c31c2140e3b60cf4d6b90672eb3cf2">_print_tiles</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * briefjets ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#ac279873de61def4b2de5bc273d6ed6a1">_add_neighbours_to_tile_union</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                 std::vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3f62c993b981ade840a9d22a4209fc27">_add_untagged_neighbours_to_tile_union</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                 std::vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#adb795b6cfe7ca3348e4faf5b28c87734">_add_untagged_neighbours_to_tile_union_using_max_info</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet, </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                 std::vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3d193f3e3b51ad0f4b5262b57b71ed43">_distance_to_tile</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * bj, <span class="keyword">const</span> Tile25 *) </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="preprocessor"></span>    ;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="preprocessor"></span>    <span class="keyword">const</span>;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#ab4a0376d864c66c877a3b4559ab5b62b">_update_jetX_jetI_NN</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetX, <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI, std::vector&lt;TiledJet *&gt; &amp; jets_for_minheap);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#ab5cbd2f263244bb145a45e180de3bc99">_set_NN</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI, std::vector&lt;TiledJet *&gt; &amp; jets_for_minheap);</div>
<div class="line"><a name="l01101"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#ae27818af520ed2d440600b9dee6e8961"> 1101</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> J&gt; <span class="keywordtype">double</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#ae27818af520ed2d440600b9dee6e8961">_bj_diJ</a>(<span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordtype">double</span> kt2 = jet-&gt;kt2;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">if</span> (jet-&gt;NN != NULL) {<span class="keywordflow">if</span> (jet-&gt;NN-&gt;kt2 &lt; kt2) {kt2 = jet-&gt;NN-&gt;kt2;}}</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordflow">return</span> jet-&gt;NN_dist * kt2;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  }</div>
<div class="line"><a name="l01106"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#af3084f03141ee0e89e03e8fd209988ea"> 1106</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> J&gt; <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a6ac03fa0069b90c9baaa722c8487c74a">_bj_set_jetinfo</a>(</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                            <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetA, <span class="keyword">const</span> <span class="keywordtype">int</span> _jets_index)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    jetA-&gt;eta  = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_jets_index].rap();</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    jetA-&gt;phi  = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_jets_index].phi_02pi();</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    jetA-&gt;kt2  = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a63f258516215178970e17bbe2987f8ad">_cs</a>.jet_scale_for_algorithm(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_jets_index]);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    jetA-&gt;_jets_index = _jets_index;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    jetA-&gt;NN_dist = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    jetA-&gt;NN      = NULL;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  }</div>
<div class="line"><a name="l01115"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#abe893ef1fe04af04c316bee984bcc68b"> 1115</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> J&gt; <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetA, <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetB) </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="preprocessor"></span>    {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    _ncall++; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="preprocessor"></span>    <span class="keyword">const</span> {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = std::abs(jetA-&gt;phi - jetB-&gt;phi);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordtype">double</span> deta = (jetA-&gt;eta - jetB-&gt;eta);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">if</span> (dphi &gt; <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>) {dphi = <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> - <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;}</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordflow">return</span> dphi*dphi + deta*deta;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  }</div>
<div class="line"><a name="l01128"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#adc8bdafcb773f6257fa47552e6646045"> 1128</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> J&gt; <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5acc49ca0da50d3a4fa1b4cab400c990">_bj_dist_not_periodic</a>(</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetA, <span class="keyword">const</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#abc4f62a83ef45919eae805f79fe6bd86">J</a> * <span class="keyword">const</span> jetB)</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="preprocessor"></span>    {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    _ncall++; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="preprocessor"></span>    <span class="keyword">const</span> {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = jetA-&gt;phi - jetB-&gt;phi;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keywordtype">double</span> deta = (jetA-&gt;eta - jetB-&gt;eta);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">return</span> dphi*dphi + deta*deta;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  }</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;};</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="preprocessor">#endif // __FJCORE_LAZYTILING25_HH__</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifndef __FJCORE_TILINGEXTENT_HH__</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a84c2e045b638d8becff2a4e1177646ab"> 1144</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define __FJCORE_TILINGEXTENT_HH__</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="preprocessor"></span><a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"><a class="code" href="../../da/dd5/classTilingExtent.html"> 1146</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../da/dd5/classTilingExtent.html">TilingExtent</a> {</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <a class="code" href="../../da/dd5/classTilingExtent.html">TilingExtent</a>(ClusterSequence &amp; cs);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <a class="code" href="../../da/dd5/classTilingExtent.html">TilingExtent</a>(<span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp;<a class="code" href="../../d8/d44/Plot-Measured__Energy-EMC_8C.html#a5f26f26553bf8cd4bdde213793d63113">particles</a>);</div>
<div class="line"><a name="l01150"></a><span class="lineno"><a class="code" href="../../da/dd5/classTilingExtent.html#a69f512777159849c7455dd6c68366c9a"> 1150</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../da/dd5/classTilingExtent.html#a69f512777159849c7455dd6c68366c9a">minrap</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _minrap;}</div>
<div class="line"><a name="l01151"></a><span class="lineno"><a class="code" href="../../da/dd5/classTilingExtent.html#a0800e910cd13b69b161525c8864af207"> 1151</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../da/dd5/classTilingExtent.html#a0800e910cd13b69b161525c8864af207">maxrap</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _maxrap;}</div>
<div class="line"><a name="l01152"></a><span class="lineno"><a class="code" href="../../da/dd5/classTilingExtent.html#a73b5f7d0f9d3bb9c2b1a6866e0b5cacc"> 1152</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../da/dd5/classTilingExtent.html#a73b5f7d0f9d3bb9c2b1a6866e0b5cacc">sum_of_binned_squared_multiplicity</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _cumul2;}</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01154"></a><span class="lineno"><a class="code" href="../../da/dd5/classTilingExtent.html#a9362d29d03177e679df06afc40b35d98"> 1154</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../da/dd5/classTilingExtent.html#a9362d29d03177e679df06afc40b35d98">_minrap</a>, _maxrap, _cumul2;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordtype">void</span> _determine_rapidity_extent(<span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp; particles);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;};</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="preprocessor">#endif // __FJCORE_TILINGEXTENT_HH__</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include&lt;limits&gt;</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="preprocessor">#include&lt;iomanip&gt;</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="preprocessor">#include&lt;algorithm&gt;</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a0705f57f2f47bfc194a81b9456144ab2"> 1164</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#a0705f57f2f47bfc194a81b9456144ab2">twopow31</a>      = 2147483648U;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l01166"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a0e380576e67cc1bacc21781cb007f73c"> 1166</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a0e380576e67cc1bacc21781cb007f73c">ClosestPair2D::_point2shuffle</a>(<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> &amp; <a class="code" href="../../d8/df7/PHCASeeding_8cc.html#a905ba7eea43764a576ea5db7e8b73b0f">point</a>, <a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html">Shuffle</a> &amp; shuffle, </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> shift) {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> renorm_point = (point.<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a8909b0f9899c9fc2f16d19f8acfe533a">coord</a> - _left_corner)/_range;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(renorm_point.<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a> &gt;=0);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(renorm_point.<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a> &lt;=1);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(renorm_point.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a> &gt;=0);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(renorm_point.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a> &lt;=1);</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  shuffle.<a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a540537134a49b4b580e58bafc472dd48">x</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(twopow31 * renorm_point.<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a>) + shift;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  shuffle.<a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a55cd75003d1908ef815353dd21b0f943">y</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(twopow31 * renorm_point.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>) + shift;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  shuffle.<a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a5a27c0b4e15172d76c293ee91897ab15">point</a> = &amp;<a class="code" href="../../d8/df7/PHCASeeding_8cc.html#a905ba7eea43764a576ea5db7e8b73b0f">point</a>;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;}</div>
<div class="line"><a name="l01177"></a><span class="lineno"><a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#ad9a257f82b1659fb549642ff0901f1cf"> 1177</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#ad9a257f82b1659fb549642ff0901f1cf">ClosestPair2D::Shuffle::operator&lt;</a>(<span class="keyword">const</span> <a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html">Shuffle</a> &amp; q)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d8/d99/fjcore_8cc.html#a537d3b23bbb0630f80363729135c02c2">floor_ln2_less</a>(<a class="code" href="../../d6/df3/namespaceambiguity__solver__full__chain.html#a5a98ca81ebd6be883836d0c8df079229">x</a> ^ q.<a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a540537134a49b4b580e58bafc472dd48">x</a>, <a class="code" href="../../d7/d87/fasthadv4_8C.html#ab927965981178aa1fba979a37168db2a">y</a> ^ q.<a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a55cd75003d1908ef815353dd21b0f943">y</a>)) {</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="../../d7/d87/fasthadv4_8C.html#ab927965981178aa1fba979a37168db2a">y</a> &lt; q.<a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a55cd75003d1908ef815353dd21b0f943">y</a>);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="../../d6/df3/namespaceambiguity__solver__full__chain.html#a5a98ca81ebd6be883836d0c8df079229">x</a> &lt; q.<a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html#a540537134a49b4b580e58bafc472dd48">x</a>);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  }</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;}</div>
<div class="line"><a name="l01184"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a97e5bde421c6caadd9f73294eb7c74a8"> 1184</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a97e5bde421c6caadd9f73294eb7c74a8">ClosestPair2D::_initialize</a>(<span class="keyword">const</span> std::vector&lt;Coord2D&gt; &amp; <a class="code" href="../../d6/d57/namespacetelescope__simulation.html#acbf35efe9e0c9574912e7f0cecb4d570">positions</a>, </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                             <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; left_corner, </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                             <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; right_corner,</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_size) {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_positions = positions.size();</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(max_size &gt;= n_positions);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  _points.resize(max_size);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = n_positions; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; max_size; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    _available_points.push(&amp;(_points[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]));</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  _left_corner = left_corner;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  _range       = max((right_corner.<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a> - left_corner.<a class="code" href="../../de/d92/classCoord2D.html#a508f860bc8d75e08e6afeb7504220419">x</a>),</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                     (right_corner.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a> - left_corner.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a>));</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  vector&lt;Shuffle&gt; shuffles(n_positions);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; n_positions; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    _points[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].coord = positions[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    _points[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].neighbour_dist2 = numeric_limits&lt;double&gt;::max();</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    _points[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].review_flag = 0;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    _point2shuffle(_points[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>], shuffles[i], 0);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ishift = 0; ishift &lt; _nshift; ishift++) {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;   _shifts[ishift] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(((twopow31*1.0)*ishift)/_nshift);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">if</span> (ishift == 0) {_rel_shifts[ishift] = 0;}</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keywordflow">else</span> {_rel_shifts[ishift] = _shifts[ishift] - _shifts[ishift-1];}</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  }</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  _cp_search_range = 30;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  _points_under_review.reserve(_nshift * _cp_search_range);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ishift = 0; ishift &lt; _nshift; ishift++) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">if</span> (ishift &gt; 0) {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <span class="keywordtype">unsigned</span> rel_shift = _rel_shifts[ishift];</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; shuffles.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        shuffles[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] += rel_shift; }</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <a class="code" href="../../d2/da5/namespaceActs_1_1Experimental_1_1detail_1_1BlueprintHelper.html#a308a6456db2655fc6a1a916696da20c8" title="Sort the nodes in the blueprint container node.">sort</a>(shuffles.begin(), shuffles.end());</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    _trees[ishift] = <a class="code" href="../../d7/d15/classSharedPtr.html">SharedPtr&lt;Tree&gt;</a>(<span class="keyword">new</span> <a class="code" href="../../d7/d18/classSearchTree.html">Tree</a>(shuffles, max_size));</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> circ = _trees[ishift]-&gt;somewhere(), <a class="code" href="../../d7/dde/ctrl_8cpp.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>=circ;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> CP_range = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(_cp_search_range, n_positions-1);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * this_point = circ-&gt;point;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a754fea3561881d2cb48f4b59b5dbcdc5">circ</a>[ishift] = circ;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> other = circ;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; CP_range; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        ++other;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="keywordtype">double</span> dist2 = this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1e5024bdfed31a5eca34ff2c44dddbd7">distance2</a>(*other-&gt;point);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <span class="keywordflow">if</span> (dist2 &lt; this_point-&gt;neighbour_dist2) {</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;          this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1a99eda4e7cb79696732f6d2bebb9180">neighbour_dist2</a> = dist2;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;          this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a7bf9b4cb8817c0df5c600bb361e0d0b1">neighbour</a>       = other-&gt;point;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    } <span class="keywordflow">while</span> (++circ != <a class="code" href="../../d7/dde/ctrl_8cpp.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  }</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  vector&lt;double&gt; mindists2(n_positions);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; n_positions; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    mindists2[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = _points[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].neighbour_dist2;}</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  _heap = <a class="code" href="../../d7/d15/classSharedPtr.html">SharedPtr&lt;MinHeap&gt;</a>(<span class="keyword">new</span> <a class="code" href="../../dc/d1f/classMinHeap.html">MinHeap</a>(mindists2, max_size));</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;}</div>
<div class="line"><a name="l01240"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a04389064ac27e01a9dd52d2041ebc90f"> 1240</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a04389064ac27e01a9dd52d2041ebc90f">ClosestPair2D::closest_pair</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp; ID1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp; ID2, </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                                 <span class="keywordtype">double</span> &amp; distance2)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  ID1 = _heap-&gt;minloc();</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  ID2 = _ID(_points[ID1].neighbour);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  distance2 = _points[ID1].neighbour_dist2;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="keywordflow">if</span> (ID1 &gt; ID2) <a class="code" href="../../d6/db0/fjcore_8hh.html#ac71f249d840a70f8b3aaffb721843eaa">std::swap</a>(ID1,ID2);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;}</div>
<div class="line"><a name="l01247"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a253cdc7d4ba4b1a85caeaa67c04f1439"> 1247</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a253cdc7d4ba4b1a85caeaa67c04f1439">ClosestPair2D::_add_label</a>(<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * <a class="code" href="../../d8/df7/PHCASeeding_8cc.html#a905ba7eea43764a576ea5db7e8b73b0f">point</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> review_flag) {</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="keywordflow">if</span> (point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a742e6ad8c8cc31774d2609f8ca94696c">review_flag</a> == 0) _points_under_review.push_back(point);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a742e6ad8c8cc31774d2609f8ca94696c">review_flag</a> |= review_flag;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;}</div>
<div class="line"><a name="l01251"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a96a7ce8c270ec12c8e5710b8a965f6a9"> 1251</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a96a7ce8c270ec12c8e5710b8a965f6a9">ClosestPair2D::_set_label</a>(<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * <a class="code" href="../../d8/df7/PHCASeeding_8cc.html#a905ba7eea43764a576ea5db7e8b73b0f">point</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> review_flag) {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <span class="keywordflow">if</span> (point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a742e6ad8c8cc31774d2609f8ca94696c">review_flag</a> == 0) _points_under_review.push_back(point);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a742e6ad8c8cc31774d2609f8ca94696c">review_flag</a> = review_flag;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;}</div>
<div class="line"><a name="l01255"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a96ba5f1343a1971a4fd25389e1ead8c9"> 1255</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a96ba5f1343a1971a4fd25389e1ead8c9">ClosestPair2D::remove</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ID) {</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * point_to_remove = &amp; (_points[ID]);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  _remove_from_search_tree(point_to_remove);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  _deal_with_points_to_review();</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;}</div>
<div class="line"><a name="l01260"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a123735d62c29e2910cd35233b3fa9bba"> 1260</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a123735d62c29e2910cd35233b3fa9bba">ClosestPair2D::_remove_from_search_tree</a>(<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * point_to_remove) {</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  _available_points.push(point_to_remove);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  _set_label(point_to_remove, _remove_heap_entry);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> CP_range = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(_cp_search_range, <a class="code" href="../../d1/d15/ntuple__variables_8C.html#a87a2934e49c05339afd471d382cc6c74">size</a>()-1);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ishift = 0; ishift &lt; _nshift; ishift++) {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> removed_circ = point_to_remove-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a754fea3561881d2cb48f4b59b5dbcdc5">circ</a>[ishift];</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> right_end = removed_circ.<a class="code" href="../../db/df3/classSearchTree_1_1circulator.html#a424ae30771cfcc868362ee9472029cde">next</a>();</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    _trees[ishift]-&gt;remove(removed_circ);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> left_end  = right_end, orig_right_end = right_end;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; CP_range; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {left_end--;}</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/d15/ntuple__variables_8C.html#a87a2934e49c05339afd471d382cc6c74">size</a>()-1 &lt; _cp_search_range) {</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      left_end--; right_end--;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    }</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * left_point = left_end-&gt;point;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      <span class="keywordflow">if</span> (left_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a7bf9b4cb8817c0df5c600bb361e0d0b1">neighbour</a> == point_to_remove) {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="comment">// we&#39;ll deal with it later...</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        _add_label(left_point, _review_neighbour);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="comment">// check to see if right point has become its closest neighbour</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="keywordtype">double</span> dist2 = left_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1e5024bdfed31a5eca34ff2c44dddbd7">distance2</a>(*right_end-&gt;point);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="keywordflow">if</span> (dist2 &lt; left_point-&gt;neighbour_dist2) {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;          left_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a7bf9b4cb8817c0df5c600bb361e0d0b1">neighbour</a> = right_end-&gt;point;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;          left_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1a99eda4e7cb79696732f6d2bebb9180">neighbour_dist2</a> = dist2;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;          <span class="comment">// NB: (LESSER) REVIEW NEEDED HERE TOO...</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;          _add_label(left_point, _review_heap_entry);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        }</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      }</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      ++right_end;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    } <span class="keywordflow">while</span> (++left_end != orig_right_end);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  } <span class="comment">// ishift...</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;}</div>
<div class="line"><a name="l01292"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#acfd5661e9dc5b2016e8cf19acb5bd0af"> 1292</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#acfd5661e9dc5b2016e8cf19acb5bd0af">ClosestPair2D::_deal_with_points_to_review</a>() {</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> CP_range = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(_cp_search_range, <a class="code" href="../../d1/d15/ntuple__variables_8C.html#a87a2934e49c05339afd471d382cc6c74">size</a>()-1);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="keywordflow">while</span>(_points_under_review.size() &gt; 0) {</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * this_point = _points_under_review.back();</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    _points_under_review.pop_back();  </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">if</span> (this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a742e6ad8c8cc31774d2609f8ca94696c">review_flag</a> &amp; _remove_heap_entry) {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(!(this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a742e6ad8c8cc31774d2609f8ca94696c">review_flag</a> ^ _remove_heap_entry));</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      _heap-&gt;remove(_ID(this_point));</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    } </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="keywordflow">if</span> (this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a742e6ad8c8cc31774d2609f8ca94696c">review_flag</a> &amp; _review_neighbour) {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1a99eda4e7cb79696732f6d2bebb9180">neighbour_dist2</a> = numeric_limits&lt;double&gt;::max();</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="comment">// among all three shifts</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ishift = 0; ishift &lt; _nshift; ishift++) {</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;          <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> other = this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a754fea3561881d2cb48f4b59b5dbcdc5">circ</a>[ishift];</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;          <span class="comment">// among points within CP_range</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; CP_range; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            ++other;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            <span class="keywordtype">double</span> dist2 = this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1e5024bdfed31a5eca34ff2c44dddbd7">distance2</a>(*other-&gt;point);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            <span class="keywordflow">if</span> (dist2 &lt; this_point-&gt;neighbour_dist2) {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;              this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1a99eda4e7cb79696732f6d2bebb9180">neighbour_dist2</a> = dist2;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;              this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a7bf9b4cb8817c0df5c600bb361e0d0b1">neighbour</a>       = other-&gt;point;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            }</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;          }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      _heap-&gt;update(_ID(this_point), this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1a99eda4e7cb79696732f6d2bebb9180">neighbour_dist2</a>);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    this_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a742e6ad8c8cc31774d2609f8ca94696c">review_flag</a> = 0; </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;}</div>
<div class="line"><a name="l01323"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a6d61a99fae0c1e33afbe4d6874207933"> 1323</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a6d61a99fae0c1e33afbe4d6874207933">ClosestPair2D::insert</a>(<span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; new_coord) {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(_available_points.size() &gt; 0);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * new_point = _available_points.top();</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  _available_points.pop();</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  new_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a8909b0f9899c9fc2f16d19f8acfe533a">coord</a> = new_coord;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  _insert_into_search_tree(new_point);</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  _deal_with_points_to_review();</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <span class="keywordflow">return</span> _ID(new_point);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;}</div>
<div class="line"><a name="l01332"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a59bfcc357d5495ff97cbac3884268519"> 1332</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a59bfcc357d5495ff97cbac3884268519">ClosestPair2D::replace</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ID1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ID2, </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; <a class="code" href="../../dc/d59/Proto4ShowerCalibFit_8m.html#a7130b1618285588513fd1ff97884b9d9">position</a>) {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * point_to_remove = &amp; (_points[ID1]);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  _remove_from_search_tree(point_to_remove);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  point_to_remove = &amp; (_points[ID2]);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  _remove_from_search_tree(point_to_remove);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * new_point = _available_points.top();</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  _available_points.pop();</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  new_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a8909b0f9899c9fc2f16d19f8acfe533a">coord</a> = <a class="code" href="../../dc/d59/Proto4ShowerCalibFit_8m.html#a7130b1618285588513fd1ff97884b9d9">position</a>;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  _insert_into_search_tree(new_point);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  _deal_with_points_to_review();</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordflow">return</span> _ID(new_point);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;}</div>
<div class="line"><a name="l01345"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#ae6c58aed80f1b4b40abc34cd57810728"> 1345</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#ae6c58aed80f1b4b40abc34cd57810728">ClosestPair2D::replace_many</a>(</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                  <span class="keyword">const</span> std::vector&lt;unsigned int&gt; &amp; IDs_to_remove,</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                  <span class="keyword">const</span> std::vector&lt;Coord2D&gt; &amp; new_positions,</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                  std::vector&lt;unsigned int&gt; &amp; new_IDs) {</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; IDs_to_remove.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    _remove_from_search_tree(&amp; (_points[IDs_to_remove[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]]));</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  new_IDs.resize(0);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; new_positions.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * new_point = _available_points.top();</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    _available_points.pop();</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    new_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a8909b0f9899c9fc2f16d19f8acfe533a">coord</a> = new_positions[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    _insert_into_search_tree(new_point);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    new_IDs.push_back(_ID(new_point));</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  _deal_with_points_to_review();</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;}</div>
<div class="line"><a name="l01362"></a><span class="lineno"><a class="code" href="../../db/dce/classClosestPair2D.html#a740cb5b4cf828af93ca2c1e85677314b"> 1362</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/dce/classClosestPair2D.html#a740cb5b4cf828af93ca2c1e85677314b">ClosestPair2D::_insert_into_search_tree</a>(<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * new_point) {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  _set_label(new_point, _review_heap_entry);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  new_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1a99eda4e7cb79696732f6d2bebb9180">neighbour_dist2</a> = numeric_limits&lt;double&gt;::max();</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> CP_range = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(_cp_search_range, <a class="code" href="../../d1/d15/ntuple__variables_8C.html#a87a2934e49c05339afd471d382cc6c74">size</a>()-1);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ishift = 0; ishift &lt; _nshift; ishift++) {</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <a class="code" href="../../d8/db7/classClosestPair2D_1_1Shuffle.html">Shuffle</a> new_shuffle;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    _point2shuffle(*new_point, new_shuffle, _shifts[ishift]);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> new_circ = _trees[ishift]-&gt;insert(new_shuffle);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    new_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a754fea3561881d2cb48f4b59b5dbcdc5">circ</a>[ishift] = new_circ;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> right_edge = new_circ; right_edge++;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <a class="code" href="../../db/df3/classSearchTree_1_1circulator.html">circulator</a> left_edge  = new_circ;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; CP_range; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {left_edge--;}</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * left_point  = left_edge-&gt;point;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html">Point</a> * right_point = right_edge-&gt;point;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keywordtype">double</span> new_dist2 = left_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1e5024bdfed31a5eca34ff2c44dddbd7">distance2</a>(*new_point);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <span class="keywordflow">if</span> (new_dist2 &lt; left_point-&gt;neighbour_dist2) {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        left_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1a99eda4e7cb79696732f6d2bebb9180">neighbour_dist2</a> = new_dist2;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        left_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a7bf9b4cb8817c0df5c600bb361e0d0b1">neighbour</a>       = new_point;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        _add_label(left_point, _review_heap_entry);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      }</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      new_dist2 = new_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1e5024bdfed31a5eca34ff2c44dddbd7">distance2</a>(*right_point);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <span class="keywordflow">if</span> (new_dist2 &lt; new_point-&gt;neighbour_dist2) {</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        new_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a1a99eda4e7cb79696732f6d2bebb9180">neighbour_dist2</a> = new_dist2;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        new_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a7bf9b4cb8817c0df5c600bb361e0d0b1">neighbour</a> = right_point;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="keywordflow">if</span> (left_point-&gt;<a class="code" href="../../d2/d5c/classClosestPair2D_1_1Point.html#a7bf9b4cb8817c0df5c600bb361e0d0b1">neighbour</a> == right_point) {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        _add_label(left_point, _review_neighbour);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      }</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      right_edge++;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    } <span class="keywordflow">while</span> (++left_edge != new_circ);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  }</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;}</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="preprocessor">#include&lt;sstream&gt;</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="preprocessor">#include&lt;fstream&gt;</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="preprocessor">#include&lt;cmath&gt;</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="preprocessor">#include&lt;cstdlib&gt;</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="preprocessor">#include&lt;cassert&gt;</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="preprocessor">#include&lt;string&gt;</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="preprocessor">#include&lt;set&gt;</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;std::ostream * <a class="code" href="../../d3/d25/classClusterSequence.html#aa0aa1028ec168fa59ad316c633a2aecc">ClusterSequence::_fastjet_banner_ostr</a> = &amp;cout;</div>
<div class="line"><a name="l01407"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#aa70027d7fdc15f30f45d7a8ca4c9c488"> 1407</a></span>&#160;<a class="code" href="../../d3/d25/classClusterSequence.html#aa70027d7fdc15f30f45d7a8ca4c9c488">ClusterSequence::~ClusterSequence</a> () {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="keywordflow">if</span> (_structure_shared_ptr){</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html">ClusterSequenceStructure</a>* csi = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html">ClusterSequenceStructure</a>*<span class="keyword">&gt;</span>(_structure_shared_ptr.get()); </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(csi != NULL);</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    csi-&gt;<a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a7d175ed98552615d3deae42f5e6ea6db">set_associated_cs</a>(NULL);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">if</span> (_deletes_self_when_unused) {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      _structure_shared_ptr.set_count(_structure_shared_ptr.use_count() </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                                        + _structure_use_count_after_construction);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;}</div>
<div class="line"><a name="l01418"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#ac1a014c7fe5c4c09c20e4a9a7ebc7ef4"> 1418</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#ac1a014c7fe5c4c09c20e4a9a7ebc7ef4">ClusterSequence::signal_imminent_self_deletion</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(_deletes_self_when_unused);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  _deletes_self_when_unused = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;}</div>
<div class="line"><a name="l01422"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a9ae1f4ee315fc6a04e68c3fb046cb50d"> 1422</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a9ae1f4ee315fc6a04e68c3fb046cb50d">ClusterSequence::_initialise_and_run</a> (</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                                  <span class="keyword">const</span> JetDefinition &amp; jet_def_in,</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp; writeout_combinations) {</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  _decant_options(jet_def_in, writeout_combinations);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  _initialise_and_run_no_decant();</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;}</div>
<div class="line"><a name="l01428"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a726ac1f0a78da15e75a953f6eeb4a4bd"> 1428</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a726ac1f0a78da15e75a953f6eeb4a4bd">ClusterSequence::_initialise_and_run_no_decant</a> () {</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  _fill_initial_history();</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  <span class="keywordflow">if</span> (n_particles() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da0f4ccd310da98c68cf34a32358d1aebe">plugin_algorithm</a>) {</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    _plugin_activated = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    _jet_def.plugin()-&gt;run_clustering( (*<span class="keyword">this</span>) );</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    _plugin_activated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    _update_structure_use_count();</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daedcd9d5d70df13ae53dcb27d5aad15c8">ee_kt_algorithm</a> ||</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;             _jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da89441525addfaac095772d0c60aa18c7">ee_genkt_algorithm</a>) {</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    _strategy = <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aabcb781b77e0792b0d486f3c147dcbfc">N2Plain</a>;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daedcd9d5d70df13ae53dcb27d5aad15c8">ee_kt_algorithm</a>) {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a> &gt; 2.0); </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a> = 1.0;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a> &gt; <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>) {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="comment">// choose a value that ensures that back-to-back particles will</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        <span class="comment">// always recombine </span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <span class="comment">//_R2 = 4.0000000000001;</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a> = 2 * ( 3.0 + cos(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>) );</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>    = 2 * ( 1.0 - cos(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>) );</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      }</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a> = 1.0/<a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    }</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    _simple_N2_cluster_EEBriefJet();</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da23a92de064c0f24fa0cce6bd68a0155d">undefined_jet_algorithm</a>) {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;A ClusterSequence cannot be created with an uninitialised JetDefinition&quot;</span>);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a29d9ba0e499ea8fcd3d7b4e3fdc89b75">Best</a>) {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    _strategy = _best_strategy();</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="preprocessor">#ifdef __FJCORE_DROP_CGAL</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a>) _strategy = <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a15b770f1e5b4524160a50d61e53cb9f3">N2MHTLazy25</a>;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="preprocessor">#endif  // __FJCORE_DROP_CGAL</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="preprocessor"></span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ab67a4313234a25a5bc9f7b889bf3523d">BestFJ30</a>) {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../de/de0/matchedfilter_8C.html#adbcd39725b8d3b6165df7b063e4ae1a0">N</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size();</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(1.0,max(0.1,<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>)*3.3)*N &lt;= 30) {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      _strategy = <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aabcb781b77e0792b0d486f3c147dcbfc">N2Plain</a>;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N &gt; 6200/pow(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>,2.0) &amp;&amp; _jet_def.jet_algorithm() == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae74f7a9631ca0ca733320e8a53deb001">cambridge_algorithm</a>) {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      _strategy = <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ada208e241bc8b44ed231ecb164d78d20">NlnNCam</a>;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="preprocessor">#ifndef __FJCORE_DROP_CGAL</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="preprocessor"></span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((N &gt; 16000/pow(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>,1.15) &amp;&amp; _jet_def.jet_algorithm() != <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da96b6868b5a3c7ef0b91e3baaf3833553">antikt_algorithm</a>)</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;               || N &gt; 35000/pow(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>,1.15)) {</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      _strategy = <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a>;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="preprocessor">#endif  // __FJCORE_DROP_CGAL</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="preprocessor"></span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N &lt;= 450) {</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      _strategy = <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aefd9e1927e345604c969620660f3b097">N2Tiled</a>;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    } <span class="keywordflow">else</span> {                   </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      _strategy = <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a585b490439133166864d3cc21bb32abc">N2MinHeapTiled</a>;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  }</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a> &gt;= <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>) {</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">if</span> (   _strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        || _strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a58dc378cf6d5e6a8d38dc6ba070148e3">NlnN3pi</a></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        || _strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ada208e241bc8b44ed231ecb164d78d20">NlnNCam</a></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        || _strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a677b9290a123f8fbd6c15549c1c3bf20">NlnNCam2pi2R</a></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        || _strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a460b14cceb259c937dc463c7b3814de9">NlnNCam4pi</a>) {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="preprocessor">#ifdef __FJCORE_DROP_CGAL</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="preprocessor"></span>      _strategy = <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a585b490439133166864d3cc21bb32abc">N2MinHeapTiled</a>;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="preprocessor"></span>      _strategy = <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706abc563a09a6fc935aa0674ea603ec1338">NlnN4pi</a>;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="preprocessor">#endif    </span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="keywordflow">if</span> (_jet_def.strategy() != <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a29d9ba0e499ea8fcd3d7b4e3fdc89b75">Best</a> &amp;&amp; _strategy != _jet_def.strategy()) {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      ostringstream oss;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      oss &lt;&lt; <span class="stringliteral">&quot;Cluster strategy &quot;</span> &lt;&lt; strategy_string(_jet_def.strategy())</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; automatically changed to &quot;</span> &lt;&lt; strategy_string()</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; because the former is not supported for R = &quot;</span> &lt;&lt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; &gt;= 2pi&quot;</span>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      _changed_strategy_warning.warn(oss.str());</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    }</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aabcb781b77e0792b0d486f3c147dcbfc">N2Plain</a>) {</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    this-&gt;_simple_N2_cluster_BriefJet();</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aefd9e1927e345604c969620660f3b097">N2Tiled</a>) {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    this-&gt;_faster_tiled_N2_cluster();</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a585b490439133166864d3cc21bb32abc">N2MinHeapTiled</a>) {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    this-&gt;_minheap_faster_tiled_N2_cluster();</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a5b1227103810aa6fdb7a5640042006e4">N2MHTLazy9Alt</a>) {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    _plugin_activated = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <a class="code" href="../../d9/dae/classLazyTiling9Alt.html">LazyTiling9Alt</a> tiling(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    tiling.<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac84f56586f04bf876590c60b0b015806">run</a>();</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    _plugin_activated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a15b770f1e5b4524160a50d61e53cb9f3">N2MHTLazy25</a>) {</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    _plugin_activated = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <a class="code" href="../../d8/dbe/classLazyTiling25.html">LazyTiling25</a> tiling(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    tiling.<a class="code" href="../../d8/dbe/classLazyTiling25.html#af45e2f504bb02eae6f5dffb162aa4bb9">run</a>();</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    _plugin_activated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ac99337e81f8e80196e6b7a9db5ac20b9">N2MHTLazy9</a>) {</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    _plugin_activated = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html">LazyTiling9</a> tiling(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    tiling.<a class="code" href="../../d6/d0c/classLazyTiling9.html#a59d38f77750b9265c6f182157130b1cf">run</a>();</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    _plugin_activated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a75b88839bb68a969f668619e1d8b98a2">N2MHTLazy9AntiKtSeparateGhosts</a>) {</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;N2MHTLazy9AntiKtSeparateGhosts strategy not supported with FJCORE&quot;</span>);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a>) {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    this-&gt;_delaunay_cluster();</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ada208e241bc8b44ed231ecb164d78d20">NlnNCam</a>) {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    this-&gt;_CP2DChan_cluster_2piMultD();</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a58dc378cf6d5e6a8d38dc6ba070148e3">NlnN3pi</a> || _strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706abc563a09a6fc935aa0674ea603ec1338">NlnN4pi</a> ) {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    this-&gt;_delaunay_cluster();</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy ==  <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a03af22ecaad1b3913fa15de1997c3295">N3Dumb</a> ) {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    this-&gt;_really_dumb_cluster();</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa68dd701778b9e2d04344921ddcbc795">N2PoorTiled</a>) {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    this-&gt;_tiled_N2_cluster();</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a460b14cceb259c937dc463c7b3814de9">NlnNCam4pi</a>) {</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    this-&gt;_CP2DChan_cluster();</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a677b9290a123f8fbd6c15549c1c3bf20">NlnNCam2pi2R</a>) {</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    this-&gt;_CP2DChan_cluster_2pi2R();</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    ostringstream <a class="code" href="../../d7/dc7/namespacecheck__license.html#a5d6111870e0d2f540b9458f3674194ff">err</a>;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;Unrecognised value for strategy: &quot;</span>&lt;&lt;_strategy;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(err.str());</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  }</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;}</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d3/d25/classClusterSequence.html#af3a14819be8c719512afe74b0e1f955c">ClusterSequence::_first_time</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<a class="code" href="../../d8/de2/classLimitedWarning.html">LimitedWarning</a> <a class="code" href="../../d3/d25/classClusterSequence.html#af9c7196137fa5649aa19f7a171a00ccc">ClusterSequence::_exclusive_warnings</a>;</div>
<div class="line"><a name="l01547"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#ac6229cdd8451f9d027206f347a64e7c1"> 1547</a></span>&#160;<span class="keywordtype">string</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#ae7294201da07aff23bafb4f7ca719f3b">fastjet_version_string</a>() {</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;FastJet version &quot;</span>+<a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">string</a>(<a class="code" href="../../d8/d99/fjcore_8cc.html#a02699d6d182f55d63391829cf73a44bf">fastjet_version</a>)+<span class="stringliteral">&quot; [fjcore]&quot;</span>;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;}</div>
<div class="line"><a name="l01550"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a87c8f6c75d3c3887f8b73961be28a3bd"> 1550</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a87c8f6c75d3c3887f8b73961be28a3bd">ClusterSequence::print_banner</a>() {</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <span class="keywordflow">if</span> (!_first_time) {<span class="keywordflow">return</span>;}</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  _first_time = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  ostream * ostr = _fastjet_banner_ostr;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <span class="keywordflow">if</span> (!ostr) <span class="keywordflow">return</span>;  </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  (*ostr) &lt;&lt; <span class="stringliteral">&quot;#--------------------------------------------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  (*ostr) &lt;&lt; <span class="stringliteral">&quot;#                     FastJet release &quot;</span> &lt;&lt; <a class="code" href="../../d8/d99/fjcore_8cc.html#a02699d6d182f55d63391829cf73a44bf">fastjet_version</a> &lt;&lt; <span class="stringliteral">&quot; [fjcore]&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  (*ostr) &lt;&lt; <span class="stringliteral">&quot;#                 M. Cacciari, G.P. Salam and G. Soyez                  \n&quot;</span>; </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  (*ostr) &lt;&lt; <span class="stringliteral">&quot;#     A software package for jet finding and analysis at colliders      \n&quot;</span>;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  (*ostr) &lt;&lt; <span class="stringliteral">&quot;#                           http://fastjet.fr                           \n&quot;</span>; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  (*ostr) &lt;&lt; <span class="stringliteral">&quot;#                                                                       \n&quot;</span>;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  (*ostr) &lt;&lt; <span class="stringliteral">&quot;# Please cite EPJC72(2012)1896 [arXiv:1111.6097] if you use this package\n&quot;</span>;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  (*ostr) &lt;&lt; <span class="stringliteral">&quot;# for scientific work and optionally PLB641(2006)57 [hep-ph/0512210].   \n&quot;</span>;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  (*ostr) &lt;&lt; <span class="stringliteral">&quot;#                                                                       \n&quot;</span>;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  (*ostr) &lt;&lt; <span class="stringliteral">&quot;# FastJet is provided without warranty under the terms of the GNU GPLv2.\n&quot;</span>;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  (*ostr) &lt;&lt; <span class="stringliteral">&quot;# It uses T. Chan&#39;s closest pair algorithm, S. Fortune&#39;s Voronoi code&quot;</span>;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="preprocessor">#ifndef __FJCORE_DROP_CGAL</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="preprocessor"></span>  (*ostr) &lt;&lt; <span class="stringliteral">&quot;,\n# CGAL &quot;</span>;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="preprocessor"></span>  (*ostr) &lt;&lt; <span class="stringliteral">&quot;\n# &quot;</span>;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="preprocessor">#endif  // __FJCORE_DROP_CGAL</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="preprocessor"></span>  (*ostr) &lt;&lt; <span class="stringliteral">&quot;and 3rd party plugin jet algorithms. See COPYING file for details.\n&quot;</span>;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  (*ostr) &lt;&lt; <span class="stringliteral">&quot;#--------------------------------------------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  ostr-&gt;flush();</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;}</div>
<div class="line"><a name="l01575"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a34a674a39f9393d31360046b511b9c66"> 1575</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a34a674a39f9393d31360046b511b9c66">ClusterSequence::_decant_options</a>(<span class="keyword">const</span> JetDefinition &amp; jet_def_in,</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp; writeout_combinations) {</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  _jet_def = jet_def_in;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  _writeout_combinations = writeout_combinations;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  _structure_shared_ptr.reset(<span class="keyword">new</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html">ClusterSequenceStructure</a>(<span class="keyword">this</span>));</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  _decant_options_partial();</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;}</div>
<div class="line"><a name="l01582"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a1d56e72740b276aedc0d407229132547"> 1582</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a1d56e72740b276aedc0d407229132547">ClusterSequence::_decant_options_partial</a>() {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <a class="code" href="../../d1/d75/FastJetAlgo_8cc.html#ab4356959570e47606ef981fe186b265c">print_banner</a>();</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  _jet_algorithm = _jet_def.jet_algorithm();</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a> = _jet_def.R();  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>*<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a> = 1.0/<a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  _strategy = _jet_def.strategy();</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  _plugin_activated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  _update_structure_use_count(); <span class="comment">// make sure it&#39;s correct already here</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;}</div>
<div class="line"><a name="l01590"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#aabb2165b83a28d7488feb376827b5c34"> 1590</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#aabb2165b83a28d7488feb376827b5c34">ClusterSequence::_fill_initial_history</a> () {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.reserve(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size()*2);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  _history.reserve(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size()*2);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  _Qtot = 0;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; i &lt; static_cast&lt;int&gt;(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size()) ; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html">history_element</a> <a class="code" href="../../d5/d71/namespacefixGDML.html#a3ceb8811bdea2af323513d9f998064f3">element</a>;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    element.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a64525f01b03a4228c97d3a81a5763036">parent1</a> = InexistentParent;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    element.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a65698121f0159831c064563c1930a94d" title="index in _history where first parent of this jet">parent2</a> = InexistentParent;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    element.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a57507057bb6f8cbaf48a438128fd1299" title="index in _history where second parent of this jet">child</a>   = <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    element.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a2eef7a323a6aa3a9c79553fa8a28b5a4">jetp_index</a> = <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    element.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#ad42ca5ff5a02ddabd30df5bab4dc7b58" title="index in the _jets vector where we will find the">dij</a>     = 0.0;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    element.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#add6b029a2b4a8977b188e9e79ef4b5fc">max_dij_so_far</a> = 0.0;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    _history.push_back(element);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    _jet_def.recombiner()-&gt;preprocess(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].set_cluster_hist_index(i);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    _set_structure_shared_ptr(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[i]);</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    _Qtot += <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].E();</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  }</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  _initial_n = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size();</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  _deletes_self_when_unused = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;}</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="keywordtype">string</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a7c153f8d0e7e57d643d498287c84bada">ClusterSequence::strategy_string</a> (<a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706">Strategy</a> strategy_in)<span class="keyword">  const </span>{</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="keywordtype">string</span> strategy;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <span class="keywordflow">switch</span>(strategy_in) {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a>:</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    strategy = <span class="stringliteral">&quot;NlnN&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a58dc378cf6d5e6a8d38dc6ba070148e3">NlnN3pi</a>:</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    strategy = <span class="stringliteral">&quot;NlnN3pi&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706abc563a09a6fc935aa0674ea603ec1338">NlnN4pi</a>:</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    strategy = <span class="stringliteral">&quot;NlnN4pi&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aabcb781b77e0792b0d486f3c147dcbfc">N2Plain</a>:</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    strategy = <span class="stringliteral">&quot;N2Plain&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aefd9e1927e345604c969620660f3b097">N2Tiled</a>:</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    strategy = <span class="stringliteral">&quot;N2Tiled&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a585b490439133166864d3cc21bb32abc">N2MinHeapTiled</a>:</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    strategy = <span class="stringliteral">&quot;N2MinHeapTiled&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa68dd701778b9e2d04344921ddcbc795">N2PoorTiled</a>:</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    strategy = <span class="stringliteral">&quot;N2PoorTiled&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ac99337e81f8e80196e6b7a9db5ac20b9">N2MHTLazy9</a>:</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    strategy = <span class="stringliteral">&quot;N2MHTLazy9&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a5b1227103810aa6fdb7a5640042006e4">N2MHTLazy9Alt</a>:</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    strategy = <span class="stringliteral">&quot;N2MHTLazy9Alt&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a15b770f1e5b4524160a50d61e53cb9f3">N2MHTLazy25</a>:</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    strategy = <span class="stringliteral">&quot;N2MHTLazy25&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a75b88839bb68a969f668619e1d8b98a2">N2MHTLazy9AntiKtSeparateGhosts</a>:</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    strategy = <span class="stringliteral">&quot;N2MHTLazy9AntiKtSeparateGhosts&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a03af22ecaad1b3913fa15de1997c3295">N3Dumb</a>:</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    strategy = <span class="stringliteral">&quot;N3Dumb&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a460b14cceb259c937dc463c7b3814de9">NlnNCam4pi</a>:</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    strategy = <span class="stringliteral">&quot;NlnNCam4pi&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a677b9290a123f8fbd6c15549c1c3bf20">NlnNCam2pi2R</a>:</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    strategy = <span class="stringliteral">&quot;NlnNCam2pi2R&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ada208e241bc8b44ed231ecb164d78d20">NlnNCam</a>:</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    strategy = <span class="stringliteral">&quot;NlnNCam&quot;</span>; <span class="keywordflow">break</span>; <span class="comment">// 2piMultD</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a020f6302f9232d95b79786faa6cd86c6">plugin_strategy</a>:</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    strategy = <span class="stringliteral">&quot;plugin strategy&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    strategy = <span class="stringliteral">&quot;Unrecognized&quot;</span>;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  }</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <span class="keywordflow">return</span> strategy;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;}  </div>
<div class="line"><a name="l01651"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#ab5a8a3ad679efdb154656e42fe67bf43"> 1651</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d3/d25/classClusterSequence.html#ab5a8a3ad679efdb154656e42fe67bf43">ClusterSequence::jet_scale_for_algorithm</a>(</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                                  <span class="keyword">const</span> PseudoJet &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dad58af04e42221347e2730c01a1013e80">kt_algorithm</a>)             {<span class="keywordflow">return</span> jet.kt2();}</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae74f7a9631ca0ca733320e8a53deb001">cambridge_algorithm</a>) {<span class="keywordflow">return</span> 1.0;}</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da96b6868b5a3c7ef0b91e3baaf3833553">antikt_algorithm</a>) {</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keywordtype">double</span> kt2=jet.kt2();</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="keywordflow">return</span> kt2 &gt; 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-300 ? 1.0/kt2 : 1e300;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae0cc2363837432381a7982a3c8b3121d">genkt_algorithm</a>) {</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keywordtype">double</span> kt2 = jet.kt2();</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../dc/d78/namespacemerge__hashes.html#a63313c3a4f2b0cb6f7cea830c9ff269d">p</a>   = jet_def().extra_param();</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keywordflow">if</span> (p &lt;= 0 &amp;&amp; kt2 &lt; 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-300) kt2 = 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-300; <span class="comment">// dodgy safety check</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keywordflow">return</span> pow(kt2, p);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daae377c765c182e6777f0063d1912e368">cambridge_for_passive_algorithm</a>) {</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="keywordtype">double</span> kt2 = jet.kt2();</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keywordtype">double</span> lim = _jet_def.extra_param();</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keywordflow">if</span> (kt2 &lt; lim*lim &amp;&amp; kt2 != 0.0) {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      <span class="keywordflow">return</span> 1.0/kt2;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    } <span class="keywordflow">else</span> {<span class="keywordflow">return</span> 1.0;}</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  } <span class="keywordflow">else</span> {<span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;Unrecognised jet algorithm&quot;</span>);}</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;}</div>
<div class="line"><a name="l01671"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a24d7b2f4e8386fce84d609fc6e539888"> 1671</a></span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706">Strategy</a> <a class="code" href="../../d3/d25/classClusterSequence.html#a24d7b2f4e8386fce84d609fc6e539888">ClusterSequence::_best_strategy</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/de0/matchedfilter_8C.html#adbcd39725b8d3b6165df7b063e4ae1a0">N</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size();</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  <span class="keywordtype">double</span> bounded_R = max(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>, 0.1);</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <span class="keywordflow">if</span> (N &lt;= 30 || N &lt;= 39.0/(bounded_R + 0.6)) {</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aabcb781b77e0792b0d486f3c147dcbfc">N2Plain</a>;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  } </div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> N_Tiled_to_MHT_lowR             (-45.4947,54.3528,44.6283);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHT_to_MHTLazy9_lowR          (0.677807,-1.05006,10.6994);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHTLazy9_to_MHTLazy25_akt_lowR(0.169967,-0.512589,12.1572);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHTLazy9_to_MHTLazy25_kt_lowR (0.16237,-0.484612,12.3373);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHTLazy9_to_MHTLazy25_cam_lowR = L_MHTLazy9_to_MHTLazy25_kt_lowR;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHTLazy25_to_NlnN_akt_lowR    (0.0472051,-0.22043,15.9196);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHTLazy25_to_NlnN_kt_lowR     (0.118609,-0.326811,14.8287);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHTLazy25_to_NlnN_cam_lowR    (0.10119,-0.295748,14.3924);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../dd/dcb/classClusterSequence_1_1__Line.html">_Line</a>     L_Tiled_to_MHTLazy9_medR         (-1.31304,7.29621);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHTLazy9_to_MHTLazy25_akt_medR = L_MHTLazy9_to_MHTLazy25_akt_lowR;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHTLazy9_to_MHTLazy25_kt_medR  = L_MHTLazy9_to_MHTLazy25_kt_lowR;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHTLazy9_to_MHTLazy25_cam_medR = L_MHTLazy9_to_MHTLazy25_cam_lowR;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHTLazy25_to_NlnN_akt_medR     = L_MHTLazy25_to_NlnN_akt_lowR;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHTLazy25_to_NlnN_kt_medR      = L_MHTLazy25_to_NlnN_kt_lowR;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="../../d9/d5a/classClusterSequence_1_1__Parabola.html">_Parabola</a> L_MHTLazy25_to_NlnN_cam_medR     = L_MHTLazy25_to_NlnN_cam_lowR;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">double</span>    N_Plain_to_MHTLazy9_largeR         = 75;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">double</span>    N_MHTLazy9_to_MHTLazy25_akt_largeR = 700;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">double</span>    N_MHTLazy9_to_MHTLazy25_kt_largeR  = 1000;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">double</span>    N_MHTLazy9_to_MHTLazy25_cam_largeR = 1000;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">double</span>    N_MHTLazy25_to_NlnN_akt_largeR     = 100000;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">double</span>    N_MHTLazy25_to_NlnN_kt_largeR      = 40000;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">double</span>    N_MHTLazy25_to_NlnN_cam_largeR     = 15000;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93d">JetAlgorithm</a> jet_algorithm;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae0cc2363837432381a7982a3c8b3121d">genkt_algorithm</a>) {</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../dc/d78/namespacemerge__hashes.html#a63313c3a4f2b0cb6f7cea830c9ff269d">p</a>   = jet_def().extra_param();</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="keywordflow">if</span> (p &lt; 0.0) jet_algorithm = <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da96b6868b5a3c7ef0b91e3baaf3833553">antikt_algorithm</a>;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keywordflow">else</span>         jet_algorithm =     <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dad58af04e42221347e2730c01a1013e80">kt_algorithm</a>;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daae377c765c182e6777f0063d1912e368">cambridge_for_passive_algorithm</a>) {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    jet_algorithm = <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dad58af04e42221347e2730c01a1013e80">kt_algorithm</a>;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    jet_algorithm = _jet_algorithm;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  }</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  <span class="keywordflow">if</span> (bounded_R &lt; 0.65) {</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="keywordflow">if</span>          (N    &lt; N_Tiled_to_MHT_lowR(bounded_R))              <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aefd9e1927e345604c969620660f3b097">N2Tiled</a>;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="keywordtype">double</span> logN = log(<span class="keywordtype">double</span>(N));</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <span class="keywordflow">if</span>          (logN &lt; L_MHT_to_MHTLazy9_lowR(bounded_R))           <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a585b490439133166864d3cc21bb32abc">N2MinHeapTiled</a>;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      <span class="keywordflow">if</span> (jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da96b6868b5a3c7ef0b91e3baaf3833553">antikt_algorithm</a>){</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        <span class="keywordflow">if</span>      (logN &lt; L_MHTLazy9_to_MHTLazy25_akt_lowR(bounded_R)) <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ac99337e81f8e80196e6b7a9db5ac20b9">N2MHTLazy9</a>;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (logN &lt; L_MHTLazy25_to_NlnN_akt_lowR(bounded_R))     <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a15b770f1e5b4524160a50d61e53cb9f3">N2MHTLazy25</a>;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="keywordflow">else</span>                                                         <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a>;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dad58af04e42221347e2730c01a1013e80">kt_algorithm</a>){</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="keywordflow">if</span>      (logN &lt; L_MHTLazy9_to_MHTLazy25_kt_lowR(bounded_R))  <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ac99337e81f8e80196e6b7a9db5ac20b9">N2MHTLazy9</a>;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (logN &lt; L_MHTLazy25_to_NlnN_kt_lowR(bounded_R))      <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a15b770f1e5b4524160a50d61e53cb9f3">N2MHTLazy25</a>;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        <span class="keywordflow">else</span>                                                         <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a>;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae74f7a9631ca0ca733320e8a53deb001">cambridge_algorithm</a>)  {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <span class="keywordflow">if</span>      (logN &lt; L_MHTLazy9_to_MHTLazy25_cam_lowR(bounded_R)) <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ac99337e81f8e80196e6b7a9db5ac20b9">N2MHTLazy9</a>;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (logN &lt; L_MHTLazy25_to_NlnN_cam_lowR(bounded_R))     <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a15b770f1e5b4524160a50d61e53cb9f3">N2MHTLazy25</a>;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <span class="keywordflow">else</span>                                                         <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ada208e241bc8b44ed231ecb164d78d20">NlnNCam</a>;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bounded_R &lt; 0.5*<a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>) {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="keywordtype">double</span> logN = log(<span class="keywordtype">double</span>(N));</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keywordflow">if</span>      (logN &lt; L_Tiled_to_MHTLazy9_medR(bounded_R))             <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aefd9e1927e345604c969620660f3b097">N2Tiled</a>;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      <span class="keywordflow">if</span> (jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da96b6868b5a3c7ef0b91e3baaf3833553">antikt_algorithm</a>){</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="keywordflow">if</span>      (logN &lt; L_MHTLazy9_to_MHTLazy25_akt_medR(bounded_R)) <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ac99337e81f8e80196e6b7a9db5ac20b9">N2MHTLazy9</a>;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (logN &lt; L_MHTLazy25_to_NlnN_akt_medR(bounded_R))     <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a15b770f1e5b4524160a50d61e53cb9f3">N2MHTLazy25</a>;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <span class="keywordflow">else</span>                                                         <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a>;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dad58af04e42221347e2730c01a1013e80">kt_algorithm</a>){</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        <span class="keywordflow">if</span>      (logN &lt; L_MHTLazy9_to_MHTLazy25_kt_medR(bounded_R))  <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ac99337e81f8e80196e6b7a9db5ac20b9">N2MHTLazy9</a>;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (logN &lt; L_MHTLazy25_to_NlnN_kt_medR(bounded_R))      <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a15b770f1e5b4524160a50d61e53cb9f3">N2MHTLazy25</a>;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <span class="keywordflow">else</span>                                                         <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a>;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae74f7a9631ca0ca733320e8a53deb001">cambridge_algorithm</a>)  {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        <span class="keywordflow">if</span>      (logN &lt; L_MHTLazy9_to_MHTLazy25_cam_medR(bounded_R)) <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ac99337e81f8e80196e6b7a9db5ac20b9">N2MHTLazy9</a>;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (logN &lt; L_MHTLazy25_to_NlnN_cam_medR(bounded_R))     <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a15b770f1e5b4524160a50d61e53cb9f3">N2MHTLazy25</a>;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        <span class="keywordflow">else</span>                                                         <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ada208e241bc8b44ed231ecb164d78d20">NlnNCam</a>;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      }</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    }</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="keywordflow">if</span>      (N    &lt; N_Plain_to_MHTLazy9_largeR)                      <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aabcb781b77e0792b0d486f3c147dcbfc">N2Plain</a>;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      <span class="keywordflow">if</span> (jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da96b6868b5a3c7ef0b91e3baaf3833553">antikt_algorithm</a>){</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <span class="keywordflow">if</span>      (N &lt; N_MHTLazy9_to_MHTLazy25_akt_largeR)             <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ac99337e81f8e80196e6b7a9db5ac20b9">N2MHTLazy9</a>;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N &lt; N_MHTLazy25_to_NlnN_akt_largeR)                 <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a15b770f1e5b4524160a50d61e53cb9f3">N2MHTLazy25</a>;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        <span class="keywordflow">else</span>                                                         <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a>;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dad58af04e42221347e2730c01a1013e80">kt_algorithm</a>){</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        <span class="keywordflow">if</span>      (N &lt; N_MHTLazy9_to_MHTLazy25_kt_largeR)              <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ac99337e81f8e80196e6b7a9db5ac20b9">N2MHTLazy9</a>;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N &lt; N_MHTLazy25_to_NlnN_kt_largeR)                  <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a15b770f1e5b4524160a50d61e53cb9f3">N2MHTLazy25</a>;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        <span class="keywordflow">else</span>                                                         <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a>;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae74f7a9631ca0ca733320e8a53deb001">cambridge_algorithm</a>)  {</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        <span class="keywordflow">if</span>      (N &lt; N_MHTLazy9_to_MHTLazy25_cam_largeR)             <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ac99337e81f8e80196e6b7a9db5ac20b9">N2MHTLazy9</a>;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N &lt; N_MHTLazy25_to_NlnN_cam_largeR)                 <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a15b770f1e5b4524160a50d61e53cb9f3">N2MHTLazy25</a>;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        <span class="keywordflow">else</span>                                                         <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ada208e241bc8b44ed231ecb164d78d20">NlnNCam</a>;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;      }</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    }</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(0 &amp;&amp; <span class="stringliteral">&quot;Code should never reach here&quot;</span>);</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706ac99337e81f8e80196e6b7a9db5ac20b9">N2MHTLazy9</a>;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;}</div>
<div class="line"><a name="l01767"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a3aa8f7e8a1155fe26bd10289d2477940"> 1767</a></span>&#160;ClusterSequence &amp; <a class="code" href="../../d3/d25/classClusterSequence.html#a3aa8f7e8a1155fe26bd10289d2477940">ClusterSequence::operator=</a>(<span class="keyword">const</span> ClusterSequence &amp; cs) {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <span class="keywordflow">if</span> (&amp;cs != <span class="keyword">this</span>) {</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    _deletes_self_when_unused = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    transfer_from_sequence(cs);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  }</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;}</div>
<div class="line"><a name="l01774"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a32288dcd6013942a168a205048ac8c7f"> 1774</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a32288dcd6013942a168a205048ac8c7f">ClusterSequence::transfer_from_sequence</a>(<span class="keyword">const</span> ClusterSequence &amp; from_seq,</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="../../da/d72/classFunctionOfPseudoJet.html">FunctionOfPseudoJet&lt;PseudoJet&gt;</a> * action_on_jets){</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <span class="keywordflow">if</span> (will_delete_self_when_unused()) </div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="keywordflow">throw</span>(<a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;cannot use CS::transfer_from_sequence after a call to delete_self_when_unused()&quot;</span>));</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  _jet_def                 = from_seq._jet_def                ;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  _writeout_combinations   = from_seq._writeout_combinations  ;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  _initial_n               = from_seq._initial_n              ;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>                  = from_seq._Rparam                 ;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>                      = from_seq._R2                     ;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a>                   = from_seq._invR2                  ;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  _strategy                = from_seq._strategy               ;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  _jet_algorithm           = from_seq._jet_algorithm          ;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  _plugin_activated        = from_seq._plugin_activated       ;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="keywordflow">if</span> (action_on_jets)</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>     = (*action_on_jets)(from_seq._jets);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>     = from_seq._jets;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  _history  = from_seq._history;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  _extras   = from_seq._extras;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <span class="keywordflow">if</span> (_structure_shared_ptr) {</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="keywordflow">if</span> (_deletes_self_when_unused) <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;transfer_from_sequence cannot be used for a cluster sequence that deletes self when unused&quot;</span>);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html">ClusterSequenceStructure</a>* csi = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html">ClusterSequenceStructure</a>*<span class="keyword">&gt;</span>(_structure_shared_ptr.get()); </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(csi != NULL);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    csi-&gt;<a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a7d175ed98552615d3deae42f5e6ea6db">set_associated_cs</a>(NULL);</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  }</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  _structure_shared_ptr.reset(<span class="keyword">new</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html">ClusterSequenceStructure</a>(<span class="keyword">this</span>));</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  _update_structure_use_count();</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt;_jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++){</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    _jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].set_cluster_hist_index(from_seq._jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].cluster_hist_index());</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    _set_structure_shared_ptr(_jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;}</div>
<div class="line"><a name="l01806"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#aedb3fa01a30ed8a3d565b02fe8d0df7d"> 1806</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a9883a53cfb89b5ea5531a49629bdc714">ClusterSequence::plugin_record_ij_recombination</a>(</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;           <span class="keywordtype">int</span> jet_i, <span class="keywordtype">int</span> jet_j, <span class="keywordtype">double</span> dij, </div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;           <span class="keyword">const</span> PseudoJet &amp; newjet, <span class="keywordtype">int</span> &amp; newjet_k) {</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  plugin_record_ij_recombination(jet_i, jet_j, dij, newjet_k);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <span class="keywordtype">int</span> tmp_index = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[newjet_k].cluster_hist_index();</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[newjet_k] = newjet;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[newjet_k].set_cluster_hist_index(tmp_index);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  _set_structure_shared_ptr(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[newjet_k]);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;}</div>
<div class="line"><a name="l01815"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a2d4e1b1bfa4bb506fccdef4759ea4cb3"> 1815</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d3/d25/classClusterSequence.html#a2d4e1b1bfa4bb506fccdef4759ea4cb3">ClusterSequence::inclusive_jets</a> (<span class="keyword">const</span> <span class="keywordtype">double</span> ptmin)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="keywordtype">double</span> dcut = ptmin*ptmin;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = _history.size() - 1; <span class="comment">// last jet</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  vector&lt;PseudoJet&gt; jets_local;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dad58af04e42221347e2730c01a1013e80">kt_algorithm</a>) {</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">while</span> (i &gt;= 0) {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="keywordflow">if</span> (_history[i].max_dij_so_far &lt; dcut) {<span class="keywordflow">break</span>;}</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      <span class="keywordflow">if</span> (_history[i].parent2 == BeamJet &amp;&amp; _history[i].dij &gt;= dcut) {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <span class="comment">// for beam jets</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        <span class="keywordtype">int</span> parent1 = _history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].parent1;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        jets_local.push_back(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[parent1].jetp_index]);}</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      i--;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae74f7a9631ca0ca733320e8a53deb001">cambridge_algorithm</a>) {</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="keywordflow">while</span> (i &gt;= 0) {</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      <span class="keywordflow">if</span> (_history[i].parent2 != BeamJet) {<span class="keywordflow">break</span>;}</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;      <span class="keywordtype">int</span> parent1 = _history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].parent1;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;      <span class="keyword">const</span> PseudoJet &amp; jet = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[parent1].jetp_index];</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;      <span class="keywordflow">if</span> (jet.perp2() &gt;= dcut) {jets_local.push_back(jet);}</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      i--;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    }</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da0f4ccd310da98c68cf34a32358d1aebe">plugin_algorithm</a> </div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;             || _jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daedcd9d5d70df13ae53dcb27d5aad15c8">ee_kt_algorithm</a></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;             || _jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da96b6868b5a3c7ef0b91e3baaf3833553">antikt_algorithm</a></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;             || _jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae0cc2363837432381a7982a3c8b3121d">genkt_algorithm</a></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;             || _jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da89441525addfaac095772d0c60aa18c7">ee_genkt_algorithm</a></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;             || _jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daae377c765c182e6777f0063d1912e368">cambridge_for_passive_algorithm</a>) {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="keywordflow">while</span> (i &gt;= 0) {</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      <span class="keywordflow">if</span> (_history[i].parent2 == BeamJet) {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        <span class="keywordtype">int</span> parent1 = _history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].parent1;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        <span class="keyword">const</span> PseudoJet &amp; jet = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[parent1].jetp_index];</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        <span class="keywordflow">if</span> (jet.perp2() &gt;= dcut) {jets_local.push_back(jet);}</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      }</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      i--;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    }</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  } <span class="keywordflow">else</span> {<span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;cs::inclusive_jets(...): Unrecognized jet algorithm&quot;</span>);}</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  <span class="keywordflow">return</span> jets_local;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;}</div>
<div class="line"><a name="l01853"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a327600dabd8aa870469f424deb195934"> 1853</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a327600dabd8aa870469f424deb195934">ClusterSequence::n_exclusive_jets</a> (<span class="keyword">const</span> <span class="keywordtype">double</span> dcut)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = _history.size() - 1; <span class="comment">// last jet</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <span class="keywordflow">while</span> (i &gt;= 0) {</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordflow">if</span> (_history[i].max_dij_so_far &lt;= dcut) {<span class="keywordflow">break</span>;}</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    i--;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  }</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="keywordtype">int</span> stop_point = i + 1;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  <span class="keywordtype">int</span> njets = 2*_initial_n - stop_point;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <span class="keywordflow">return</span> njets;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;}</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d3/d25/classClusterSequence.html#aeab59f7704e20097b126594cee6fd41c">ClusterSequence::exclusive_jets</a> (<span class="keyword">const</span> <span class="keywordtype">double</span> dcut)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  <span class="keywordtype">int</span> njets = n_exclusive_jets(dcut);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  <span class="keywordflow">return</span> exclusive_jets(njets);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;}</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d3/d25/classClusterSequence.html#aeab59f7704e20097b126594cee6fd41c">ClusterSequence::exclusive_jets</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> njets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  <span class="keywordflow">if</span> (njets &gt; _initial_n) {</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    ostringstream <a class="code" href="../../d7/dc7/namespacecheck__license.html#a5d6111870e0d2f540b9458f3674194ff">err</a>;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;Requested &quot;</span> &lt;&lt; njets &lt;&lt; <span class="stringliteral">&quot; exclusive jets, but there were only &quot;</span> </div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        &lt;&lt; _initial_n &lt;&lt; <span class="stringliteral">&quot; particles in the event&quot;</span>;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(err.str());</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  }</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <span class="keywordflow">return</span> exclusive_jets_up_to(njets);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;}</div>
<div class="line"><a name="l01876"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#aa3bcab2a6298320b5ff47d995898ec2a"> 1876</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d3/d25/classClusterSequence.html#aa3bcab2a6298320b5ff47d995898ec2a">ClusterSequence::exclusive_jets_up_to</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> njets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <span class="keywordflow">if</span> (( _jet_def.jet_algorithm() != <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dad58af04e42221347e2730c01a1013e80">kt_algorithm</a>) &amp;&amp;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      ( _jet_def.jet_algorithm() != <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae74f7a9631ca0ca733320e8a53deb001">cambridge_algorithm</a>) &amp;&amp;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      ( _jet_def.jet_algorithm() != <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daedcd9d5d70df13ae53dcb27d5aad15c8">ee_kt_algorithm</a>) &amp;&amp;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      (((_jet_def.jet_algorithm() != <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae0cc2363837432381a7982a3c8b3121d">genkt_algorithm</a>) &amp;&amp; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        (_jet_def.jet_algorithm() != <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da89441525addfaac095772d0c60aa18c7">ee_genkt_algorithm</a>)) || </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;       (_jet_def.extra_param() &lt;0)) &amp;&amp;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      ((_jet_def.jet_algorithm() != <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da0f4ccd310da98c68cf34a32358d1aebe">plugin_algorithm</a>) ||</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;       (!_jet_def.plugin()-&gt;exclusive_sequence_meaningful()))) {</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    _exclusive_warnings.warn(<span class="stringliteral">&quot;dcut and exclusive jets for jet-finders other than kt, C/A or genkt with p&gt;=0 should be interpreted with care.&quot;</span>);</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  }</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="keywordtype">int</span> stop_point = 2*_initial_n - njets;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <span class="keywordflow">if</span> (stop_point &lt; _initial_n) stop_point = _initial_n;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="keywordflow">if</span> (2*_initial_n != static_cast&lt;int&gt;(_history.size())) {</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    ostringstream <a class="code" href="../../d7/dc7/namespacecheck__license.html#a5d6111870e0d2f540b9458f3674194ff">err</a>;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;2*_initial_n != _history.size() -- this endangers internal assumptions!\n&quot;</span>;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(err.str());</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  }</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  vector&lt;PseudoJet&gt; jets_local;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = stop_point; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; _history.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordtype">int</span> parent1 = _history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].parent1;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordflow">if</span> (parent1 &lt; stop_point) {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      jets_local.push_back(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[parent1].jetp_index]);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    }</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <span class="keywordtype">int</span> parent2 = _history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].parent2;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="keywordflow">if</span> (parent2 &lt; stop_point &amp;&amp; parent2 &gt; 0) {</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      jets_local.push_back(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[parent2].jetp_index]);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    }</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  }</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(jets_local.size()) != <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(_initial_n, njets)) {</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    ostringstream <a class="code" href="../../d7/dc7/namespacecheck__license.html#a5d6111870e0d2f540b9458f3674194ff">err</a>;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;ClusterSequence::exclusive_jets: size of returned vector (&quot;</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;         &lt;&lt;jets_local.size()&lt;&lt;<span class="stringliteral">&quot;) does not coincide with requested number of jets (&quot;</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;         &lt;&lt;njets&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(err.str());</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  }</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  <span class="keywordflow">return</span> jets_local;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;}</div>
<div class="line"><a name="l01914"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a9e71c8e6b40500d837b7ebab22b4b0ad"> 1914</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a9e71c8e6b40500d837b7ebab22b4b0ad">ClusterSequence::exclusive_dmerge</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> njets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(njets &gt;= 0);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  <span class="keywordflow">if</span> (njets &gt;= _initial_n) {<span class="keywordflow">return</span> 0.0;}</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  <span class="keywordflow">return</span> _history[2*_initial_n-njets-1].dij;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;}</div>
<div class="line"><a name="l01919"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#ae192a559a87ebfdfb46064888397f387"> 1919</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d3/d25/classClusterSequence.html#ae192a559a87ebfdfb46064888397f387">ClusterSequence::exclusive_dmerge_max</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> njets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(njets &gt;= 0);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <span class="keywordflow">if</span> (njets &gt;= _initial_n) {<span class="keywordflow">return</span> 0.0;}</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  <span class="keywordflow">return</span> _history[2*_initial_n-njets-1].max_dij_so_far;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;}</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../d3/d25/classClusterSequence.html#af2e3251b497c71f7725b3db80ce25556">ClusterSequence::exclusive_subjets</a> </div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;   (<span class="keyword">const</span> PseudoJet &amp; jet, <span class="keyword">const</span> <span class="keywordtype">double</span> dcut)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  set&lt;const history_element*&gt; subhist;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  get_subhist_set(subhist, jet, dcut, 0);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  vector&lt;PseudoJet&gt; subjets;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  subjets.reserve(subhist.size());</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  <span class="keywordflow">for</span> (set&lt;const history_element*&gt;::iterator elem = subhist.begin(); </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;       elem != subhist.end(); elem++) {</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    subjets.push_back(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[(*elem)-&gt;jetp_index]);</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  }</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="keywordflow">return</span> subjets;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;}</div>
<div class="line"><a name="l01936"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a50b56a439ce92dc91d47f81f63841b69"> 1936</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a50b56a439ce92dc91d47f81f63841b69">ClusterSequence::n_exclusive_subjets</a>(<span class="keyword">const</span> PseudoJet &amp; jet, </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> dcut)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  set&lt;const history_element*&gt; subhist;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  get_subhist_set(subhist, jet, dcut, 0);</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <span class="keywordflow">return</span> subhist.size();</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;}</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../d3/d25/classClusterSequence.html#af2e3251b497c71f7725b3db80ce25556">ClusterSequence::exclusive_subjets</a></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;   (<span class="keyword">const</span> PseudoJet &amp; jet, <span class="keywordtype">int</span> nsub)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  vector&lt;PseudoJet&gt; subjets = exclusive_subjets_up_to(jet, nsub);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(subjets.size()) &lt; nsub) {</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    ostringstream <a class="code" href="../../d7/dc7/namespacecheck__license.html#a5d6111870e0d2f540b9458f3674194ff">err</a>;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;Requested &quot;</span> &lt;&lt; nsub &lt;&lt; <span class="stringliteral">&quot; exclusive subjets, but there were only &quot;</span> </div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        &lt;&lt; subjets.size() &lt;&lt; <span class="stringliteral">&quot; particles in the jet&quot;</span>;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(err.str());</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="keywordflow">return</span> subjets;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;}</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../d3/d25/classClusterSequence.html#a77fd124d530d591a5cd7c74400e32850">ClusterSequence::exclusive_subjets_up_to</a></div>
<div class="line"><a name="l01954"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a77fd124d530d591a5cd7c74400e32850"> 1954</a></span>&#160;   (<span class="keyword">const</span> PseudoJet &amp; jet, <span class="keywordtype">int</span> nsub) <span class="keyword">const</span> {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  set&lt;const history_element*&gt; subhist;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  vector&lt;PseudoJet&gt; subjets;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  <span class="keywordflow">if</span> (nsub &lt;  0) <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;Requested a negative number of subjets. This is nonsensical.&quot;</span>);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <span class="keywordflow">if</span> (nsub == 0) <span class="keywordflow">return</span> subjets;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  get_subhist_set(subhist, jet, -1.0, nsub);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  subjets.reserve(subhist.size());</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <span class="keywordflow">for</span> (set&lt;const history_element*&gt;::iterator elem = subhist.begin(); </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;       elem != subhist.end(); elem++) {</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    subjets.push_back(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[(*elem)-&gt;jetp_index]);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  }</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  <span class="keywordflow">return</span> subjets;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;}</div>
<div class="line"><a name="l01967"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a4fc68b17bc9871ba268376ff3e29c35a"> 1967</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a4fc68b17bc9871ba268376ff3e29c35a">ClusterSequence::exclusive_subdmerge</a>(<span class="keyword">const</span> PseudoJet &amp; jet, <span class="keywordtype">int</span> nsub)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  set&lt;const history_element*&gt; subhist;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  get_subhist_set(subhist, jet, -1.0, nsub);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  set&lt;const history_element*&gt;::iterator highest = subhist.end();</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  highest--;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <span class="keywordflow">return</span> (*highest)-&gt;dij;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;}</div>
<div class="line"><a name="l01974"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a6b815f78b73c64a2bf2a3cfe3a32f956"> 1974</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a6b815f78b73c64a2bf2a3cfe3a32f956">ClusterSequence::exclusive_subdmerge_max</a>(<span class="keyword">const</span> PseudoJet &amp; jet, <span class="keywordtype">int</span> nsub)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  set&lt;const history_element*&gt; subhist;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  get_subhist_set(subhist, jet, -1.0, nsub);</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  set&lt;const history_element*&gt;::iterator highest = subhist.end();</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  highest--;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="keywordflow">return</span> (*highest)-&gt;max_dij_so_far;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;}</div>
<div class="line"><a name="l01981"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a4dd00f941d2c143ec45285ded3b866e6"> 1981</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a4dd00f941d2c143ec45285ded3b866e6">ClusterSequence::get_subhist_set</a>(set&lt;const history_element*&gt; &amp; subhist,</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                                     <span class="keyword">const</span>  PseudoJet &amp; jet, </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                                     <span class="keywordtype">double</span> dcut, <span class="keywordtype">int</span> maxjet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(contains(jet));</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  subhist.clear();</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  subhist.insert(&amp;(_history[jet.cluster_hist_index()]));</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <span class="keywordtype">int</span> njet = 1;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    set&lt;const history_element*&gt;::iterator highest = subhist.end();</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a> (highest != subhist.begin()); </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    highest--;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html">history_element</a>* elem = *highest;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <span class="keywordflow">if</span> (njet == maxjet) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <span class="keywordflow">if</span> (elem-&gt;<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a64525f01b03a4228c97d3a81a5763036">parent1</a> &lt; 0)            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <span class="keywordflow">if</span> (elem-&gt;<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#add6b029a2b4a8977b188e9e79ef4b5fc">max_dij_so_far</a> &lt;= dcut) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    subhist.erase(highest);</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    subhist.insert(&amp;(_history[elem-&gt;<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a64525f01b03a4228c97d3a81a5763036">parent1</a>]));</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    subhist.insert(&amp;(_history[elem-&gt;<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a65698121f0159831c064563c1930a94d" title="index in _history where first parent of this jet">parent2</a>]));</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    njet++;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;}</div>
<div class="line"><a name="l02002"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a6deb976819043086ea9ff9e90f66f5aa"> 2002</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a6deb976819043086ea9ff9e90f66f5aa">ClusterSequence::object_in_jet</a>(<span class="keyword">const</span> PseudoJet &amp; <span class="keywordtype">object</span>, </div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                                    <span class="keyword">const</span> PseudoJet &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(contains(<span class="keywordtype">object</span>) &amp;&amp; contains(jet));</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  <span class="keyword">const</span> PseudoJet * this_object = &amp;object;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;  <span class="keyword">const</span> PseudoJet * childp;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  <span class="keywordflow">while</span>(<span class="keyword">true</span>) {</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="keywordflow">if</span> (this_object-&gt;cluster_hist_index() == jet.cluster_hist_index()) {</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (has_child(*this_object, childp)) {</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      this_object = childp;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    }</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  }</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;}</div>
<div class="line"><a name="l02017"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#ab3507a392b7a067bd20e00255e640092"> 2017</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d3/d25/classClusterSequence.html#ab3507a392b7a067bd20e00255e640092">ClusterSequence::has_parents</a>(<span class="keyword">const</span> PseudoJet &amp; jet, PseudoJet &amp; parent1, </div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                              PseudoJet &amp; parent2)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html">history_element</a> &amp; <a class="code" href="../../dd/da4/namespaceadd__histos.html#a9ffe1f3beb7ee305602ee6c99ec12859">hist</a> = _history[jet.cluster_hist_index()];</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a> ((hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a64525f01b03a4228c97d3a81a5763036">parent1</a> &gt;= 0 &amp;&amp; hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a65698121f0159831c064563c1930a94d" title="index in _history where first parent of this jet">parent2</a> &gt;= 0) || </div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;          (hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a64525f01b03a4228c97d3a81a5763036">parent1</a> &lt; 0 &amp;&amp; hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a65698121f0159831c064563c1930a94d" title="index in _history where first parent of this jet">parent2</a> &lt; 0));</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  <span class="keywordflow">if</span> (hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a64525f01b03a4228c97d3a81a5763036">parent1</a> &lt; 0) {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    parent1 = PseudoJet(0.0,0.0,0.0,0.0);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    parent2 = parent1;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    parent1 = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a64525f01b03a4228c97d3a81a5763036">parent1</a>].jetp_index];</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    parent2 = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a65698121f0159831c064563c1930a94d" title="index in _history where first parent of this jet">parent2</a>].jetp_index];</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="keywordflow">if</span> (parent1.perp2() &lt; parent2.perp2()) <a class="code" href="../../d6/db0/fjcore_8hh.html#ac71f249d840a70f8b3aaffb721843eaa">std::swap</a>(parent1,parent2);</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  }</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;}</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a62878c4986d6b1e5cad184b55fb4f251">ClusterSequence::has_child</a>(<span class="keyword">const</span> PseudoJet &amp; jet, PseudoJet &amp; <a class="code" href="../../d5/dea/namespacegtest__filter__unittest.html#a158829096400f19be6d8a3ef8ca8b76a">child</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  <span class="keyword">const</span> PseudoJet * childp;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <span class="keywordtype">bool</span> res = has_child(jet, childp);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <span class="keywordflow">if</span> (res) {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    child = *childp;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    child = PseudoJet(0.0,0.0,0.0,0.0);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  }</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;}</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a62878c4986d6b1e5cad184b55fb4f251">ClusterSequence::has_child</a>(<span class="keyword">const</span> PseudoJet &amp; jet, <span class="keyword">const</span> PseudoJet * &amp; childp)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="keyword">const</span> history_element &amp; <a class="code" href="../../dd/da4/namespaceadd__histos.html#a9ffe1f3beb7ee305602ee6c99ec12859">hist</a> = _history[jet.cluster_hist_index()];</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <span class="keywordflow">if</span> (hist.child &gt;= 0 &amp;&amp; _history[hist.child].jetp_index &gt;= 0) {</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    childp = &amp;(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[hist.child].jetp_index]);</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    childp = NULL;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  }</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;}</div>
<div class="line"><a name="l02054"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a7026ed52b5625d05275b926ff84ba298"> 2054</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a7026ed52b5625d05275b926ff84ba298">ClusterSequence::has_partner</a>(<span class="keyword">const</span> PseudoJet &amp; jet, </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                              PseudoJet &amp; partner)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html">history_element</a> &amp; hist = _history[jet.cluster_hist_index()];</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <span class="keywordflow">if</span> (hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a57507057bb6f8cbaf48a438128fd1299" title="index in _history where second parent of this jet">child</a> &gt;= 0 &amp;&amp; _history[hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a57507057bb6f8cbaf48a438128fd1299" title="index in _history where second parent of this jet">child</a>].parent2 &gt;= 0) {</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html">history_element</a> &amp; child_hist = _history[hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a57507057bb6f8cbaf48a438128fd1299" title="index in _history where second parent of this jet">child</a>];</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">if</span> (child_hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a64525f01b03a4228c97d3a81a5763036">parent1</a> == jet.cluster_hist_index()) {</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      partner = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[child_hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a65698121f0159831c064563c1930a94d" title="index in _history where first parent of this jet">parent2</a>].jetp_index];</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      partner = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[child_hist.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a64525f01b03a4228c97d3a81a5763036">parent1</a>].jetp_index];</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    partner = PseudoJet(0.0,0.0,0.0,0.0);</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  }</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;}</div>
<div class="line"><a name="l02070"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a82d5dda546526d56149d8e003dac2ac2"> 2070</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d3/d25/classClusterSequence.html#a82d5dda546526d56149d8e003dac2ac2">ClusterSequence::constituents</a> (<span class="keyword">const</span> PseudoJet &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  vector&lt;PseudoJet&gt; subjets;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  add_constituents(jet, subjets);</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  <span class="keywordflow">return</span> subjets;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;}</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a68631fa398348aef00242cbef1988c21">ClusterSequence::print_jets_for_root</a>(<span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp; jets_in, </div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                                          ostream &amp; ostr)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets_in.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    ostr &lt;&lt; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;         &lt;&lt; jets_in[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].px() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;         &lt;&lt; jets_in[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].py() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;         &lt;&lt; jets_in[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].pz() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;         &lt;&lt; jets_in[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].E() &lt;&lt; endl;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    vector&lt;PseudoJet&gt; cst = constituents(jets_in[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; cst.size() ; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;      ostr &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;           &lt;&lt; cst[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>].rap() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;           &lt;&lt; cst[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>].phi() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;           &lt;&lt; cst[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>].perp() &lt;&lt; endl;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    }</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    ostr &lt;&lt; <span class="stringliteral">&quot;#END&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  }</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;}</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a68631fa398348aef00242cbef1988c21">ClusterSequence::print_jets_for_root</a>(<span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp; jets_in, </div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a> &amp; <a class="code" href="../../d4/d23/Prototype2_2EMCal_2macros_2EnergyCalibFit_8m.html#a2ff994e16bf9521154de4cf659a3b689">filename</a>,</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a> &amp; <a class="code" href="../../de/d3b/RDBC_2blob_2master_2admin_2makehtml_8C.html#a8c0288707ed90c2275d70e22bd1f16d9">comment</a> )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  std::ofstream ostr(filename.c_str());</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <span class="keywordflow">if</span> (comment != <span class="stringliteral">&quot;&quot;</span>) ostr &lt;&lt; <span class="stringliteral">&quot;# &quot;</span> &lt;&lt; comment &lt;&lt; endl;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  print_jets_for_root(jets_in, ostr);</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;}</div>
<div class="line"><a name="l02100"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#aab3fee0e9bb3f8ef7a48eb555130ec6e"> 2100</a></span>&#160;vector&lt;int&gt; <a class="code" href="../../d3/d25/classClusterSequence.html#aab3fee0e9bb3f8ef7a48eb555130ec6e">ClusterSequence::particle_jet_indices</a>(</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                        <span class="keyword">const</span> vector&lt;PseudoJet&gt; &amp; jets_in)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  vector&lt;int&gt; indices(n_particles());</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipart = 0; ipart &lt; n_particles(); ipart++) </div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    indices[ipart] = -1;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ijet = 0; ijet &lt; jets_in.size(); ijet++) {</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    vector&lt;PseudoJet&gt; jet_constituents(constituents(jets_in[ijet]));</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ip = 0; ip &lt; jet_constituents.size(); ip++) {</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;      <span class="keywordtype">unsigned</span> iclust = jet_constituents[ip].cluster_hist_index();</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;      <span class="keywordtype">unsigned</span> ipart = history()[iclust].jetp_index;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;      indices[ipart] = ijet;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    }</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  }</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  <span class="keywordflow">return</span> indices;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;}</div>
<div class="line"><a name="l02115"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a0d0d83f15feff2a377db8f8d108c319c"> 2115</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a0d0d83f15feff2a377db8f8d108c319c">ClusterSequence::add_constituents</a> (</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;           <span class="keyword">const</span> PseudoJet &amp; jet, vector&lt;PseudoJet&gt; &amp; subjet_vector)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = jet.cluster_hist_index();</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  <span class="keywordtype">int</span> parent1 = _history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].parent1;</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="keywordtype">int</span> parent2 = _history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].parent2;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;  <span class="keywordflow">if</span> (parent1 == InexistentParent) {</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    subjet_vector.push_back(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[i]);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  } </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  add_constituents(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[parent1].jetp_index], subjet_vector);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  <span class="keywordflow">if</span> (parent2 != BeamJet) {</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    add_constituents(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[parent2].jetp_index], subjet_vector);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  }</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;}</div>
<div class="line"><a name="l02129"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#adf940f5a02f44a445b109b17e3450fcb"> 2129</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#adf940f5a02f44a445b109b17e3450fcb">ClusterSequence::_add_step_to_history</a> (</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> parent1, </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> parent2, <span class="keyword">const</span> <span class="keywordtype">int</span> jetp_index,</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">double</span> dij) {</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html">history_element</a> <a class="code" href="../../d5/d71/namespacefixGDML.html#a3ceb8811bdea2af323513d9f998064f3">element</a>;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  element.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a64525f01b03a4228c97d3a81a5763036">parent1</a> = parent1;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  element.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a65698121f0159831c064563c1930a94d" title="index in _history where first parent of this jet">parent2</a> = parent2;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  element.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a2eef7a323a6aa3a9c79553fa8a28b5a4">jetp_index</a> = jetp_index;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  element.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#a57507057bb6f8cbaf48a438128fd1299" title="index in _history where second parent of this jet">child</a> = <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  element.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#ad42ca5ff5a02ddabd30df5bab4dc7b58" title="index in the _jets vector where we will find the">dij</a>   = dij;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  element.<a class="code" href="../../d3/d40/structClusterSequence_1_1history__element.html#add6b029a2b4a8977b188e9e79ef4b5fc">max_dij_so_far</a> = max(dij,_history[_history.size()-1].max_dij_so_far);</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  _history.push_back(element);</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <span class="keywordtype">int</span> local_step = _history.size()-1;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(parent1 &gt;= 0);</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="keywordflow">if</span> (_history[parent1].child != <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>){</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../df/d81/classInternalError.html">InternalError</a>(<span class="stringliteral">&quot;trying to recomine an object that has previsously been recombined&quot;</span>);</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  }</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  _history[parent1].child = local_step;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  <span class="keywordflow">if</span> (parent2 &gt;= 0) {</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keywordflow">if</span> (_history[parent2].child != <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>){</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../df/d81/classInternalError.html">InternalError</a>(<span class="stringliteral">&quot;trying to recomine an object that has previsously been recombined&quot;</span>);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    }</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    _history[parent2].child = local_step;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  }</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  <span class="keywordflow">if</span> (jetp_index != <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>) {</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(jetp_index &gt;= 0);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jetp_index].set_cluster_hist_index(local_step);</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    _set_structure_shared_ptr(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jetp_index]);</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  }</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  <span class="keywordflow">if</span> (_writeout_combinations) {</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    cout &lt;&lt; local_step &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;         &lt;&lt; parent1 &lt;&lt; <span class="stringliteral">&quot; with &quot;</span> &lt;&lt; parent2</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;; y = &quot;</span>&lt;&lt; dij&lt;&lt;endl;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  }</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;}</div>
<div class="line"><a name="l02164"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a0fc0e26c74f64109e2d98d3cff625cdb"> 2164</a></span>&#160;vector&lt;int&gt; <a class="code" href="../../d3/d25/classClusterSequence.html#a0fc0e26c74f64109e2d98d3cff625cdb">ClusterSequence::unique_history_order</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  valarray&lt;int&gt; lowest_constituent(_history.size());</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <span class="keywordtype">int</span> hist_n = _history.size();</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  lowest_constituent = hist_n; <span class="comment">// give it a large number</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; hist_n; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    lowest_constituent[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(lowest_constituent[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>],i); </div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <span class="keywordflow">if</span> (_history[i].child &gt; 0) lowest_constituent[_history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].child] </div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;      = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(lowest_constituent[_history[i].child],lowest_constituent[i]);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  }</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  valarray&lt;bool&gt; extracted(_history.size()); extracted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  vector&lt;int&gt; unique_tree;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  unique_tree.reserve(_history.size());</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; n_particles(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="keywordflow">if</span> (!extracted[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]) {</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      unique_tree.push_back(i);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      extracted[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      _extract_tree_children(i, extracted, lowest_constituent, unique_tree);</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    }</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;  }</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  <span class="keywordflow">return</span> unique_tree;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;}</div>
<div class="line"><a name="l02185"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a67199c743154cbeadf033da987a0d275"> 2185</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a67199c743154cbeadf033da987a0d275">ClusterSequence::_extract_tree_children</a>(</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;       <span class="keywordtype">int</span> <a class="code" href="../../dc/d59/Proto4ShowerCalibFit_8m.html#a7130b1618285588513fd1ff97884b9d9">position</a>, </div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;       valarray&lt;bool&gt; &amp; extracted, </div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;       <span class="keyword">const</span> valarray&lt;int&gt; &amp; lowest_constituent,</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;       vector&lt;int&gt; &amp; unique_tree)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  <span class="keywordflow">if</span> (!extracted[position]) {</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    _extract_tree_parents(position,extracted,lowest_constituent,unique_tree);</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  } </div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  <span class="keywordtype">int</span> child = _history[<a class="code" href="../../dc/d59/Proto4ShowerCalibFit_8m.html#a7130b1618285588513fd1ff97884b9d9">position</a>].child;</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  <span class="keywordflow">if</span> (child  &gt;= 0) _extract_tree_children(child,extracted,lowest_constituent,unique_tree);</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;}</div>
<div class="line"><a name="l02196"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a7bcbfaed2a5f2e910d09b5d5e14a7ca3"> 2196</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d3/d25/classClusterSequence.html#a7bcbfaed2a5f2e910d09b5d5e14a7ca3">ClusterSequence::unclustered_particles</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  vector&lt;PseudoJet&gt; unclustered;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; n_particles() ; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    <span class="keywordflow">if</span> (_history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].child == <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>) </div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      unclustered.push_back(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].jetp_index]);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  }</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  <span class="keywordflow">return</span> unclustered;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;}</div>
<div class="line"><a name="l02204"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#aca8c7b4f50ee5ee4bd28899d994cb14a"> 2204</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d3/d25/classClusterSequence.html#aca8c7b4f50ee5ee4bd28899d994cb14a">ClusterSequence::childless_pseudojets</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  vector&lt;PseudoJet&gt; unclustered;</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; _history.size() ; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keywordflow">if</span> ((_history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].child == <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>) &amp;&amp; (_history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].parent2 != BeamJet))</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;      unclustered.push_back(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_history[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].jetp_index]);</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  }</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;  <span class="keywordflow">return</span> unclustered;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;}</div>
<div class="line"><a name="l02212"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a21a91be49fc3893708d6f5691ad3d301"> 2212</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a21a91be49fc3893708d6f5691ad3d301">ClusterSequence::contains</a>(<span class="keyword">const</span> PseudoJet &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  <span class="keywordflow">return</span> jet.cluster_hist_index() &gt;= 0 </div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    &amp;&amp;   jet.cluster_hist_index() &lt; int(_history.size())</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    &amp;&amp;   jet.has_valid_cluster_sequence()</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    &amp;&amp;   jet.associated_cluster_sequence() == <span class="keyword">this</span>;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;}</div>
<div class="line"><a name="l02218"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a061350953a60d54b61bcc0b1d526fe12"> 2218</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a061350953a60d54b61bcc0b1d526fe12">ClusterSequence::_extract_tree_parents</a>(</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;       <span class="keywordtype">int</span> <a class="code" href="../../dc/d59/Proto4ShowerCalibFit_8m.html#a7130b1618285588513fd1ff97884b9d9">position</a>, </div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;       valarray&lt;bool&gt; &amp; extracted, </div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;       <span class="keyword">const</span> valarray&lt;int&gt; &amp; lowest_constituent,</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;       vector&lt;int&gt; &amp; unique_tree)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  <span class="keywordflow">if</span> (!extracted[position]) {</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    <span class="keywordtype">int</span> parent1 = _history[<a class="code" href="../../dc/d59/Proto4ShowerCalibFit_8m.html#a7130b1618285588513fd1ff97884b9d9">position</a>].parent1;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keywordtype">int</span> parent2 = _history[<a class="code" href="../../dc/d59/Proto4ShowerCalibFit_8m.html#a7130b1618285588513fd1ff97884b9d9">position</a>].parent2;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    <span class="keywordflow">if</span> (parent1 &gt;= 0 &amp;&amp; parent2 &gt;= 0) {</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      <span class="keywordflow">if</span> (lowest_constituent[parent1] &gt; lowest_constituent[parent2]) </div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        <a class="code" href="../../d6/db0/fjcore_8hh.html#ac71f249d840a70f8b3aaffb721843eaa">std::swap</a>(parent1, parent2);</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    }</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="keywordflow">if</span> (parent1 &gt;= 0 &amp;&amp; !extracted[parent1]) </div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      _extract_tree_parents(parent1,extracted,lowest_constituent,unique_tree);</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    <span class="keywordflow">if</span> (parent2 &gt;= 0 &amp;&amp; !extracted[parent2]) </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      _extract_tree_parents(parent2,extracted,lowest_constituent,unique_tree);</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    unique_tree.push_back(position);</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    extracted[<a class="code" href="../../dc/d59/Proto4ShowerCalibFit_8m.html#a7130b1618285588513fd1ff97884b9d9">position</a>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  }</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;}</div>
<div class="line"><a name="l02238"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a8fe2b43437f6af897981439628774e77"> 2238</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a8fe2b43437f6af897981439628774e77">ClusterSequence::_do_ij_recombination_step</a>(</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">int</span> jet_i, <span class="keyword">const</span> <span class="keywordtype">int</span> jet_j, </div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">double</span> dij, </div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                               <span class="keywordtype">int</span> &amp; newjet_k) {</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  PseudoJet newjet(<span class="keyword">false</span>); </div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;  _jet_def.recombiner()-&gt;recombine(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jet_i], <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jet_j], newjet);</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.push_back(newjet);</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  newjet_k = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size()-1;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <span class="keywordtype">int</span> newstep_k = _history.size();</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[newjet_k].set_cluster_hist_index(newstep_k);</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  <span class="keywordtype">int</span> hist_i = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jet_i].cluster_hist_index();</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="keywordtype">int</span> hist_j = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jet_j].cluster_hist_index();</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  _add_step_to_history(<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(hist_i, hist_j), max(hist_i,hist_j),</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                       newjet_k, dij);</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;}</div>
<div class="line"><a name="l02253"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a3e1b0355253a22794ff0f7bd2115e1d6"> 2253</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a3e1b0355253a22794ff0f7bd2115e1d6">ClusterSequence::_do_iB_recombination_step</a>(</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">int</span> jet_i, <span class="keyword">const</span> <span class="keywordtype">double</span> diB) {</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;  _add_step_to_history(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jet_i].cluster_hist_index(),BeamJet,</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                       <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>, diB);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;}</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<a class="code" href="../../d8/de2/classLimitedWarning.html">LimitedWarning</a> <a class="code" href="../../d3/d25/classClusterSequence.html#a026da2302b011deea1c527987cd61311">ClusterSequence::_changed_strategy_warning</a>;</div>
<div class="line"><a name="l02259"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a607a5bc7cee76327db0111c9b56f4f3e"> 2259</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a607a5bc7cee76327db0111c9b56f4f3e">ClusterSequence::_set_structure_shared_ptr</a>(PseudoJet &amp; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>) {</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  j.set_structure_shared_ptr(_structure_shared_ptr);</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  _update_structure_use_count();</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;}</div>
<div class="line"><a name="l02263"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a1b0d85bda4e20e2a60136554fd4d6420"> 2263</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a1b0d85bda4e20e2a60136554fd4d6420">ClusterSequence::_update_structure_use_count</a>() {</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  _structure_use_count_after_construction = _structure_shared_ptr.use_count();</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;}</div>
<div class="line"><a name="l02266"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a34ca8d43c523b21e9e012111a877b55d"> 2266</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a34ca8d43c523b21e9e012111a877b55d">ClusterSequence::delete_self_when_unused</a>() {</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;  <span class="keywordtype">int</span> new_count = _structure_shared_ptr.use_count() - _structure_use_count_after_construction;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;  <span class="keywordflow">if</span> (new_count &lt;= 0) {</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;delete_self_when_unused may only be called if at least one object outside the CS (e.g. a jet) is already associated with the CS&quot;</span>);</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;  }</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;  _structure_shared_ptr.set_count(new_count);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  _deletes_self_when_unused = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;}</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="preprocessor">#include&lt;limits&gt;</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="preprocessor">#include&lt;vector&gt;</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="preprocessor">#include&lt;cmath&gt;</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l02281"></a><span class="lineno"><a class="code" href="../../d9/d5e/namespacePrivate.html"> 2281</a></span>&#160;<span class="keyword">namespace </span>Private {</div>
<div class="line"><a name="l02282"></a><span class="lineno"><a class="code" href="../../d4/dd8/classPrivate_1_1MirrorInfo.html"> 2282</a></span>&#160;  <span class="keyword">class </span><a class="code" href="../../d4/dd8/classPrivate_1_1MirrorInfo.html">MirrorInfo</a>{</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l02284"></a><span class="lineno"><a class="code" href="../../d4/dd8/classPrivate_1_1MirrorInfo.html#a4602abf33cc86e4d2734b6da3068d26e"> 2284</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d4/dd8/classPrivate_1_1MirrorInfo.html#a4602abf33cc86e4d2734b6da3068d26e">orig</a>, mirror;</div>
<div class="line"><a name="l02285"></a><span class="lineno"><a class="code" href="../../d4/dd8/classPrivate_1_1MirrorInfo.html#aa724faeb04d237e2bc1fc39465fc7c71"> 2285</a></span>&#160;    <a class="code" href="../../d4/dd8/classPrivate_1_1MirrorInfo.html#aa724faeb04d237e2bc1fc39465fc7c71">MirrorInfo</a>(<span class="keywordtype">int</span> <a class="code" href="../../d7/da4/namespaceKFPMath.html#a6d2496198d1982fd950acfb79033902b">a</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>) : orig(a), mirror(b) {}</div>
<div class="line"><a name="l02286"></a><span class="lineno"><a class="code" href="../../d4/dd8/classPrivate_1_1MirrorInfo.html#a490df699e4593f7dc9efbcb65a7699ce"> 2286</a></span>&#160;    <a class="code" href="../../d4/dd8/classPrivate_1_1MirrorInfo.html#a490df699e4593f7dc9efbcb65a7699ce">MirrorInfo</a>() : orig(0), mirror(0) {} <span class="comment">// set dummy values to keep static code checkers happy</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  };</div>
<div class="line"><a name="l02288"></a><span class="lineno"><a class="code" href="../../d9/d5e/namespacePrivate.html#a71477d64079417b716ce17a3786567f3"> 2288</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d9/d5e/namespacePrivate.html#a71477d64079417b716ce17a3786567f3">make_mirror</a>(<a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> &amp; <a class="code" href="../../d8/df7/PHCASeeding_8cc.html#a905ba7eea43764a576ea5db7e8b73b0f">point</a>, <span class="keywordtype">double</span> Dlim) {</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    <span class="keywordflow">if</span> (point.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a> &lt; Dlim)       {point.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a> += <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>; <span class="keywordflow">return</span> <span class="keyword">true</span>;}</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>-point.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a> &lt; Dlim) {point.<a class="code" href="../../de/d92/classCoord2D.html#a0db24a6cff02d6c235d58f9b9f8ae90e">y</a> -= <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>; <span class="keywordflow">return</span> <span class="keyword">true</span>;}</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  }</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;}</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;<span class="keyword">using namespace </span>Private;</div>
<div class="line"><a name="l02295"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a07e8cea01e3bb72dd0ecdb4955250475"> 2295</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a07e8cea01e3bb72dd0ecdb4955250475">ClusterSequence::_CP2DChan_limited_cluster</a> (<span class="keywordtype">double</span> Dlim) {</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = _initial_n;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  vector&lt;MirrorInfo&gt;   coordIDs(2*n); <span class="comment">// coord IDs of a given jetID</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  vector&lt;int&gt;          jetIDs(2*n);   <span class="comment">// jet ID for a given coord ID</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;  vector&lt;Coord2D&gt;      coords(2*n);   <span class="comment">// our coordinates (and copies)</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;  <span class="keywordtype">double</span> Dlim4mirror = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(Dlim,<a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;  <span class="keywordtype">double</span> minrap = numeric_limits&lt;double&gt;::max();</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <span class="keywordtype">double</span> maxrap = -minrap;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  <span class="keywordtype">int</span> coord_index = -1;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  <span class="keywordtype">int</span> n_active = 0;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jet_i = 0; jet_i &lt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size(); jet_i++) {</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="keywordflow">if</span> (_history[<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jet_i].cluster_hist_index()].child != <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a> ||</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        (<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jet_i].E() == abs(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jet_i].pz()) &amp;&amp; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;         <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jet_i].perp2() == 0.0)</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        ) {<span class="keywordflow">continue</span>;}</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    n_active++;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    coordIDs[jet_i].orig = ++coord_index;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    coords[coord_index]  = <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a>(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jet_i].rap(), <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jet_i].phi_02pi());</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    jetIDs[coord_index]  = jet_i;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    minrap = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(coords[coord_index].<a class="code" href="../../d6/df3/namespaceambiguity__solver__full__chain.html#a5a98ca81ebd6be883836d0c8df079229">x</a>,minrap);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    maxrap = max(coords[coord_index].x,maxrap);</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> mirror_point(coords[coord_index]);</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d5e/namespacePrivate.html#a71477d64079417b716ce17a3786567f3">make_mirror</a>(mirror_point, Dlim4mirror)) {</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;      coordIDs[jet_i].mirror = ++coord_index;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;      coords[coord_index] = mirror_point;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      jetIDs[coord_index] = jet_i;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;      coordIDs[jet_i].mirror = <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    }</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  }</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  coords.resize(coord_index+1);</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> left_edge(minrap-1.0, -3.15); <span class="comment">// a security margin below  -pi</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> right_edge(maxrap+1.0, 9.45); <span class="comment">// a security margin above 3*pi</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;  <a class="code" href="../../db/dce/classClosestPair2D.html">ClosestPair2D</a> cp(coords, left_edge, right_edge);</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  vector&lt;Coord2D&gt; new_points(2);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  vector&lt;unsigned int&gt; cIDs_to_remove(4);</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  vector&lt;unsigned int&gt; new_cIDs(2);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cID1, cID2;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    <span class="keywordtype">double</span> distance2;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    cp.<a class="code" href="../../db/dce/classClosestPair2D.html#a04389064ac27e01a9dd52d2041ebc90f">closest_pair</a>(cID1,cID2,distance2);</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <span class="keywordflow">if</span> (distance2 &gt; Dlim*Dlim) {<span class="keywordflow">break</span>;}</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    distance2 *= <a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a>;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="keywordtype">int</span> jet_i = jetIDs[cID1];</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    <span class="keywordtype">int</span> jet_j = jetIDs[cID2];</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a> (jet_i != jet_j); <span class="comment">// to catch issue of recombining with mirror point</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    <span class="keywordtype">int</span> newjet_k;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    _do_ij_recombination_step(jet_i, jet_j, distance2, newjet_k);</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    <span class="keywordflow">if</span> (--n_active == 1) {<span class="keywordflow">break</span>;}</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    cIDs_to_remove.resize(0);</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    cIDs_to_remove.push_back(coordIDs[jet_i].orig);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    cIDs_to_remove.push_back(coordIDs[jet_j].orig);</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <span class="keywordflow">if</span> (coordIDs[jet_i].mirror != <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>) </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      cIDs_to_remove.push_back(coordIDs[jet_i].mirror);</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    <span class="keywordflow">if</span> (coordIDs[jet_j].mirror != <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>) </div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;      cIDs_to_remove.push_back(coordIDs[jet_j].mirror);</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> new_point(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[newjet_k].rap(),<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[newjet_k].phi_02pi());</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    new_points.resize(0);</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    new_points.push_back(new_point);</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d5e/namespacePrivate.html#a71477d64079417b716ce17a3786567f3">make_mirror</a>(new_point, Dlim4mirror)) new_points.push_back(new_point);  <span class="comment">//&lt; same warning as before concerning the mirroring</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    cp.<a class="code" href="../../db/dce/classClosestPair2D.html#ae6c58aed80f1b4b40abc34cd57810728">replace_many</a>(cIDs_to_remove, new_points, new_cIDs);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    coordIDs[newjet_k].orig = new_cIDs[0];</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    jetIDs[new_cIDs[0]]       = newjet_k;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    <span class="keywordflow">if</span> (new_cIDs.size() == 2) {</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;      coordIDs[newjet_k].mirror = new_cIDs[1];</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      jetIDs[new_cIDs[1]]         = newjet_k;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    } <span class="keywordflow">else</span> {coordIDs[newjet_k].mirror = <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>;}</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  } <span class="keywordflow">while</span>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;}</div>
<div class="line"><a name="l02364"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a5b53495bff55b932e3123f096aad262e"> 2364</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a5b53495bff55b932e3123f096aad262e">ClusterSequence::_CP2DChan_cluster_2pi2R</a> () {</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;  <span class="keywordflow">if</span> (_jet_algorithm != <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae74f7a9631ca0ca733320e8a53deb001">cambridge_algorithm</a>) <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;CP2DChan clustering method called for a jet-finder that is not the cambridge algorithm&quot;</span>);</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  _CP2DChan_limited_cluster(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>);</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  _do_Cambridge_inclusive_jets();</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;}</div>
<div class="line"><a name="l02369"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a0c752e1ba3f54f41d34b33282f17e8e1"> 2369</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a0c752e1ba3f54f41d34b33282f17e8e1">ClusterSequence::_CP2DChan_cluster_2piMultD</a> () {</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a> &gt;= 0.39) {</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    _CP2DChan_limited_cluster(<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>/2,0.3));</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  }</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;  _CP2DChan_cluster_2pi2R ();</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;}</div>
<div class="line"><a name="l02375"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a8fc6fdbe925ab36b54735e6e6318a1df"> 2375</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a8fc6fdbe925ab36b54735e6e6318a1df">ClusterSequence::_CP2DChan_cluster</a> () {</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <span class="keywordflow">if</span> (_jet_algorithm != <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae74f7a9631ca0ca733320e8a53deb001">cambridge_algorithm</a>) <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;_CP2DChan_cluster called for a jet-finder that is not the cambridge algorithm&quot;</span>);</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size();</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  vector&lt;MirrorInfo&gt;   coordIDs(2*n);  <span class="comment">// link from original to mirror indices</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  vector&lt;int&gt;          jetIDs(2*n);     <span class="comment">// link from mirror to original indices</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  vector&lt;Coord2D&gt;      coords(2*n);   <span class="comment">// our coordinates (and copies)</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  <span class="keywordtype">double</span> minrap = numeric_limits&lt;double&gt;::max();</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;  <span class="keywordtype">double</span> maxrap = -minrap;</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <span class="keywordtype">int</span> coord_index = 0;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].<a class="code" href="../../dc/d43/Proto2ShowerCalibFit_8m.html#a93b7cb110b782e59ebd44f83181b9e0e" title="Modifier of energy of the particle, fP[6].">E</a>() == abs(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].pz()) &amp;&amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].perp2() == 0.0) {</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      coordIDs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = <a class="code" href="../../d4/dd8/classPrivate_1_1MirrorInfo.html">MirrorInfo</a>(BeamJet,BeamJet);</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;      coordIDs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].orig   = coord_index;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;      coordIDs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].mirror = coord_index+1;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;      coords[coord_index]   = <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a>(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].rap(), <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].phi_02pi());</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      coords[coord_index+1] = <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a>(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].rap(), <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].phi_02pi()+<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>);</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      jetIDs[coord_index]   = <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;      jetIDs[coord_index+1] = <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;      minrap = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(coords[coord_index].<a class="code" href="../../d6/df3/namespaceambiguity__solver__full__chain.html#a5a98ca81ebd6be883836d0c8df079229">x</a>,minrap);</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      maxrap = max(coords[coord_index].x,maxrap);</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      coord_index += 2;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    }</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;  }</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = n; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; 2*<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {coordIDs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].orig = <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>;}</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  coords.resize(coord_index);</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> left_edge(minrap-1.0, 0.0);</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a> right_edge(maxrap+1.0, 2*<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>);</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  <a class="code" href="../../db/dce/classClosestPair2D.html">ClosestPair2D</a> cp(coords, left_edge, right_edge);</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;  vector&lt;Coord2D&gt; new_points(2);</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;  vector&lt;unsigned int&gt; cIDs_to_remove(4);</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;  vector&lt;unsigned int&gt; new_cIDs(2);</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cID1, cID2;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    <span class="keywordtype">double</span> distance2;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    cp.<a class="code" href="../../db/dce/classClosestPair2D.html#a04389064ac27e01a9dd52d2041ebc90f">closest_pair</a>(cID1,cID2,distance2);</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    distance2 *= <a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a>;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <span class="keywordflow">if</span> (distance2 &gt; 1.0) {<span class="keywordflow">break</span>;}</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    <span class="keywordtype">int</span> jet_i = jetIDs[cID1];</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    <span class="keywordtype">int</span> jet_j = jetIDs[cID2];</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a> (jet_i != jet_j); <span class="comment">// to catch issue of recombining with mirror point</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    <span class="keywordtype">int</span> newjet_k;</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    _do_ij_recombination_step(jet_i, jet_j, distance2, newjet_k);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    cIDs_to_remove[0] = coordIDs[jet_i].orig;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    cIDs_to_remove[1] = coordIDs[jet_i].mirror;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    cIDs_to_remove[2] = coordIDs[jet_j].orig;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    cIDs_to_remove[3] = coordIDs[jet_j].mirror;</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    new_points[0] = <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a>(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[newjet_k].rap(),<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[newjet_k].phi_02pi());</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    new_points[1] = <a class="code" href="../../de/d92/classCoord2D.html">Coord2D</a>(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[newjet_k].rap(),<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[newjet_k].phi_02pi()+<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>);</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    new_cIDs[0] = cp.<a class="code" href="../../db/dce/classClosestPair2D.html#a59bfcc357d5495ff97cbac3884268519">replace</a>(cIDs_to_remove[0], cIDs_to_remove[2], new_points[0]);</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    new_cIDs[1] = cp.<a class="code" href="../../db/dce/classClosestPair2D.html#a59bfcc357d5495ff97cbac3884268519">replace</a>(cIDs_to_remove[1], cIDs_to_remove[3], new_points[1]);</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    coordIDs[jet_i].orig = <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    coordIDs[jet_j].orig = <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    coordIDs[newjet_k] = <a class="code" href="../../d4/dd8/classPrivate_1_1MirrorInfo.html">MirrorInfo</a>(new_cIDs[0], new_cIDs[1]);</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    jetIDs[new_cIDs[0]] = newjet_k;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    jetIDs[new_cIDs[1]] = newjet_k;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    n--;</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <span class="keywordflow">if</span> (n == 1) {<span class="keywordflow">break</span>;}</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;  } <span class="keywordflow">while</span>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;  _do_Cambridge_inclusive_jets();</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;}</div>
<div class="line"><a name="l02436"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a30428acbe2be27adad0620a211535247"> 2436</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a30428acbe2be27adad0620a211535247">ClusterSequence::_do_Cambridge_inclusive_jets</a> () {</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = _history.size();</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hist_i = 0; hist_i &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; hist_i++) {</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <span class="keywordflow">if</span> (_history[hist_i].child == <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a3316c24e8a79f5def3e85d763ae50854">Invalid</a>) {</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      _do_iB_recombination_step(_history[hist_i].jetp_index, 1.0);</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    }</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  }</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;}</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="preprocessor">#include&lt;sstream&gt;</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="preprocessor">#include&lt;cmath&gt;</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="preprocessor">#include&lt;cassert&gt;</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="preprocessor">#include&lt;memory&gt;</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="preprocessor">#ifndef __FJCORE_DROP_CGAL // in case we do not have the code for CGAL</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &quot;fastjet/internal/Dnn4piCylinder.hh&quot;</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="preprocessor">#include &quot;fastjet/internal/Dnn3piCylinder.hh&quot;</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="preprocessor">#include &quot;fastjet/internal/Dnn2piCylinder.hh&quot;</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="preprocessor">#endif //  __FJCORE_DROP_CGAL </span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="preprocessor"></span><a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l02458"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#abf24d87ea28bfabbeb1dee98bc4db287"> 2458</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#abf24d87ea28bfabbeb1dee98bc4db287">ClusterSequence::_delaunay_cluster</a> () {</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size();</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  vector&lt;EtaPhi&gt; points(n); <span class="comment">// recall EtaPhi is just a typedef&#39;d pair&lt;double&gt;</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    points[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = <a class="code" href="../../d4/dbe/classEtaPhi.html">EtaPhi</a>(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].rap(),<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].phi_02pi());</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    points[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].sanitize(); <span class="comment">// make sure things are in the right range</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  }</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  <a class="code" href="../../d7/d15/classSharedPtr.html">SharedPtr&lt;DynamicNearestNeighbours&gt;</a> DNN;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/dd2/GenFit_2blob_2master_2test_2streamerTest_2main_8cc.html#aa0809dffbdf183a6a189ebb277bf6866">verbose</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="preprocessor">#ifndef __FJCORE_DROP_CGAL // strategy = NlnN* are not supported if we drop CGAL...</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">bool</span> ignore_nearest_is_mirror = (<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a> &lt; <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706abc563a09a6fc935aa0674ea603ec1338">NlnN4pi</a>) {</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    DNN.<a class="code" href="../../d7/d15/classSharedPtr.html#a89b33f48e659f14f4b0ee18eb3d32f4a">reset</a>(<span class="keyword">new</span> Dnn4piCylinder(points,verbose));</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a58dc378cf6d5e6a8d38dc6ba070148e3">NlnN3pi</a>) {</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    DNN.<a class="code" href="../../d7/d15/classSharedPtr.html#a89b33f48e659f14f4b0ee18eb3d32f4a">reset</a>(<span class="keyword">new</span> Dnn3piCylinder(points,ignore_nearest_is_mirror,verbose));</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a>) {</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    DNN.<a class="code" href="../../d7/d15/classSharedPtr.html#a89b33f48e659f14f4b0ee18eb3d32f4a">reset</a>(<span class="keyword">new</span> Dnn2piCylinder(points,ignore_nearest_is_mirror,verbose));</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  } <span class="keywordflow">else</span> </div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (_strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706abc563a09a6fc935aa0674ea603ec1338">NlnN4pi</a> || _strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a58dc378cf6d5e6a8d38dc6ba070148e3">NlnN3pi</a> || _strategy == <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706aa30cbf43a6a14f6c23177811b83ec0ed">NlnN</a>) {</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    ostringstream <a class="code" href="../../d7/dc7/namespacecheck__license.html#a5d6111870e0d2f540b9458f3674194ff">err</a>;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;ERROR: Requested strategy &quot;</span>&lt;&lt;strategy_string()&lt;&lt;<span class="stringliteral">&quot; but it is not&quot;</span>&lt;&lt;endl;</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;       supported because FastJet was compiled without CGAL&quot;</span>&lt;&lt;endl;</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(err.str());</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="preprocessor">#endif // __FJCORE_DROP_CGAL</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="preprocessor"></span>  {</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  }</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;  <a class="code" href="../../d3/d25/classClusterSequence.html#a2f1193367a1aa8c15eae732a3f90991a">DistMap</a> DijMap;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; ii++) {</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    _add_ktdistance_to_map(ii, DijMap, DNN.<a class="code" href="../../d7/d15/classSharedPtr.html#ac747048e189c896c11f0b436d02fc5e1">get</a>());</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;  }</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=0;<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt;<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>;<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <a class="code" href="../../d3/d25/classClusterSequence.html#aa6602a4c67a1427c78b64272731430a0">TwoVertices</a> SmallestDijPair;</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="keywordtype">int</span> jet_i, jet_j;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <span class="keywordtype">double</span> SmallestDij;</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    <span class="keywordtype">bool</span> Valid2;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    <span class="keywordtype">bool</span> recombine_with_beam;</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    <span class="keywordflow">do</span> { </div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      SmallestDij = DijMap.begin()-&gt;first;</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      SmallestDijPair = DijMap.begin()-&gt;second;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;      jet_i = SmallestDijPair.first;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      jet_j = SmallestDijPair.second;</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      <span class="keywordflow">if</span> (verbose) cout &lt;&lt; <span class="stringliteral">&quot;CS_Delaunay found recombination candidate: &quot;</span> &lt;&lt; jet_i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; jet_j &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; SmallestDij &lt;&lt; endl; <span class="comment">// GPS debugging</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      DijMap.erase(DijMap.begin());</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;      recombine_with_beam = (jet_j == BeamJet);</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      <span class="keywordflow">if</span> (!recombine_with_beam) {Valid2 = DNN-&gt;<a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a53cff4eef90b4a25607b67cbb98dc17f">Valid</a>(jet_j);} </div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      <span class="keywordflow">else</span> {Valid2 = <span class="keyword">true</span>;}</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      <span class="keywordflow">if</span> (verbose) cout &lt;&lt; <span class="stringliteral">&quot;CS_Delaunay validities i &amp; j: &quot;</span> &lt;&lt; DNN-&gt;<a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a53cff4eef90b4a25607b67cbb98dc17f">Valid</a>(jet_i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Valid2 &lt;&lt; endl;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    } <span class="keywordflow">while</span> ( !DNN-&gt;<a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a53cff4eef90b4a25607b67cbb98dc17f">Valid</a>(jet_i) || !Valid2);</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <span class="keywordflow">if</span> (! recombine_with_beam) {</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      <span class="keywordtype">int</span> nn; <span class="comment">// will be index of new jet</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      <span class="keywordflow">if</span> (verbose) cout &lt;&lt; <span class="stringliteral">&quot;CS_Delaunay call _do_ij_recomb: &quot;</span> &lt;&lt; jet_i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; jet_j &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; SmallestDij &lt;&lt; endl; <span class="comment">// GPS debug</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      _do_ij_recombination_step(jet_i, jet_j, SmallestDij, nn);</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      <a class="code" href="../../d4/dbe/classEtaPhi.html">EtaPhi</a> newpoint(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[nn].rap(), <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[nn].phi_02pi());</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      newpoint.<a class="code" href="../../d4/dbe/classEtaPhi.html#a67916d70463ddca84b08e143dfb06b84">sanitize</a>(); <span class="comment">// make sure it is in correct range</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      points.push_back(newpoint);</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      <span class="keywordflow">if</span> (verbose) cout &lt;&lt; <span class="stringliteral">&quot;CS_Delaunay call _do_iB_recomb: &quot;</span> &lt;&lt; jet_i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; SmallestDij &lt;&lt; endl; <span class="comment">// GPS debug</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      _do_iB_recombination_step(jet_i, SmallestDij);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    }</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> == n-1) {<span class="keywordflow">break</span>;}</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    vector&lt;int&gt; updated_neighbours;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    <span class="keywordflow">if</span> (! recombine_with_beam) {</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      <span class="keywordtype">int</span> point3;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      DNN-&gt;<a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a5845461780a7ffa9655203b247bb95aa">RemoveCombinedAddCombination</a>(jet_i, jet_j, </div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                                       points[points.size()-1], point3,</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                                       updated_neighbours);</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      <span class="keywordflow">if</span> (static_cast&lt;unsigned int&gt; (point3) != points.size()-1) {</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;INTERNAL ERROR: point3 != points.size()-1&quot;</span>);}</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      DNN-&gt;<a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a485b79ebf4b097ad546895cc2a93b33c">RemovePoint</a>(jet_i, updated_neighbours);</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    }</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    vector&lt;int&gt;::iterator <a class="code" href="../../d5/d0b/changehitformat_8cc.html#a592a0cf34c13b7b53e37c2791a6a982e">it</a> = updated_neighbours.begin();</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    <span class="keywordflow">for</span> (; it != updated_neighbours.end(); ++<a class="code" href="../../d5/d0b/changehitformat_8cc.html#a592a0cf34c13b7b53e37c2791a6a982e">it</a>) {</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;      <span class="keywordtype">int</span> ii = *<a class="code" href="../../d5/d0b/changehitformat_8cc.html#a592a0cf34c13b7b53e37c2791a6a982e">it</a>;</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;      _add_ktdistance_to_map(ii, DijMap, DNN.<a class="code" href="../../d7/d15/classSharedPtr.html#ac747048e189c896c11f0b436d02fc5e1">get</a>());</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    }</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;  } <span class="comment">// end clustering loop </span></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;}</div>
<div class="line"><a name="l02539"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a0a61ceb05affc927c5685eaaf7760be8"> 2539</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a0a61ceb05affc927c5685eaaf7760be8">ClusterSequence::_add_ktdistance_to_map</a>(</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">int</span> ii, </div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;                          <a class="code" href="../../d3/d25/classClusterSequence.html#a2f1193367a1aa8c15eae732a3f90991a">DistMap</a> &amp; DijMap,</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;                          <span class="keyword">const</span> <a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html">DynamicNearestNeighbours</a> * DNN) {</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;  <span class="keywordtype">double</span> yiB = jet_scale_for_algorithm(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[ii]);</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;  <span class="keywordflow">if</span> (yiB == 0.0) {</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    DijMap.insert(<a class="code" href="../../d3/d25/classClusterSequence.html#a1cf6ce0bd232ce21827b027470a1fe25">DijEntry</a>(yiB,  <a class="code" href="../../d3/d25/classClusterSequence.html#aa6602a4c67a1427c78b64272731430a0">TwoVertices</a>(ii,-1)));</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <span class="keywordtype">double</span> DeltaR2 = DNN-&gt;<a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a2b6c193655063a2a2c2603e087df8429">NearestNeighbourDistance</a>(ii) * <a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a>;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    <span class="keywordflow">if</span> (DeltaR2 &gt; 1.0) {</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;      DijMap.insert(<a class="code" href="../../d3/d25/classClusterSequence.html#a1cf6ce0bd232ce21827b027470a1fe25">DijEntry</a>(yiB,  <a class="code" href="../../d3/d25/classClusterSequence.html#aa6602a4c67a1427c78b64272731430a0">TwoVertices</a>(ii,-1)));</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      <span class="keywordtype">double</span> kt2i = jet_scale_for_algorithm(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[ii]);</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;      <span class="keywordtype">int</span> jj = DNN-&gt;<a class="code" href="../../db/dcd/classDynamicNearestNeighbours.html#a9762a280b8ea18d307c39acdfb5beed2">NearestNeighbourIndex</a>(ii);</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      <span class="keywordflow">if</span> (kt2i &lt;= jet_scale_for_algorithm(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[jj])) {</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        <span class="keywordtype">double</span> dij = DeltaR2 * kt2i;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        DijMap.insert(<a class="code" href="../../d3/d25/classClusterSequence.html#a1cf6ce0bd232ce21827b027470a1fe25">DijEntry</a>(dij, <a class="code" href="../../d3/d25/classClusterSequence.html#aa6602a4c67a1427c78b64272731430a0">TwoVertices</a>(ii,jj)));</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      }</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    }</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;  }</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;}</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="preprocessor">#include&lt;cmath&gt;</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="preprocessor">#include&lt;cassert&gt;</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l02567"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#ab188b4169276f06743325196650d126c"> 2567</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#ab188b4169276f06743325196650d126c">ClusterSequence::_really_dumb_cluster</a> () {</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;  vector&lt;PseudoJet *&gt; jetsp(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size());</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;  vector&lt;int&gt;         indices(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size());</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt;<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    jetsp[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    indices[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;  }</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = jetsp.size(); <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> &gt; 0; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>--) {</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    <span class="keywordtype">int</span> ii, jj;</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d8/de4/BoundaryCheckTestsRefs_8hpp.html#a8c17b15efd6e0337c596d98616e9b9da">ymin</a> = jet_scale_for_algorithm(*(jetsp[0]));</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    ii = 0; jj = -2;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;      <span class="keywordtype">double</span> yiB = jet_scale_for_algorithm(*(jetsp[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]));</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;      <span class="keywordflow">if</span> (yiB &lt; ymin) {</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        ymin = yiB; ii = <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>; jj = -2;}</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    }</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; n-1; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a> = <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>+1; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        <span class="comment">//double y = jetsp[i]-&gt;kt_distance(*jetsp[j])*_invR2;</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#ab927965981178aa1fba979a37168db2a">y</a> = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(jet_scale_for_algorithm(*(jetsp[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>])), </div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                       jet_scale_for_algorithm(*(jetsp[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>])))</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                    * jetsp[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]-&gt;plain_distance(*jetsp[j])*<a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a>;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        <span class="keywordflow">if</span> (y &lt; ymin) {ymin = <a class="code" href="../../d7/d87/fasthadv4_8C.html#ab927965981178aa1fba979a37168db2a">y</a>; ii = <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>; jj = <a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>;}</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;      }</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    }</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    <span class="keywordtype">int</span> newn = 2*jetsp.size() - <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    <span class="keywordflow">if</span> (jj &gt;= 0) {</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;      <span class="keywordtype">int</span> nn; <span class="comment">// new jet index</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;      _do_ij_recombination_step(jetsp[ii]-&amp;<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[0], </div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                                jetsp[jj]-&amp;<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[0], ymin, nn);</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      jetsp[ii] = &amp;<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[nn];</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      jetsp[jj] = jetsp[n-1];</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;      indices[ii] = newn;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;      indices[jj] = indices[n-1];</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;      _do_iB_recombination_step(jetsp[ii]-&amp;<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[0], ymin);</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;      jetsp[ii] = jetsp[n-1];</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;      indices[ii] = indices[n-1];</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    }</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;  }</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;}</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l02612"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a17b50e88fa99804bd00e0d43b0263cf3"> 2612</a></span>&#160;<span class="keyword">template</span>&lt;&gt; <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a0815f8587ab3064f7ba02b8dc608f362">ClusterSequence::_bj_set_jetinfo</a>(</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                           <a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html">EEBriefJet</a> * <span class="keyword">const</span> jetA, <span class="keyword">const</span> <span class="keywordtype">int</span> _jets_index)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/d43/Proto2ShowerCalibFit_8m.html#a93b7cb110b782e59ebd44f83181b9e0e" title="Modifier of energy of the particle, fP[6].">E</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_jets_index].E();</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;  <span class="keywordtype">double</span> scale = E*<a class="code" href="../../dc/d43/Proto2ShowerCalibFit_8m.html#a93b7cb110b782e59ebd44f83181b9e0e" title="Modifier of energy of the particle, fP[6].">E</a>; <span class="comment">// the default energy scale for the kt alg</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/d78/namespacemerge__hashes.html#a63313c3a4f2b0cb6f7cea830c9ff269d">p</a>  = jet_def().extra_param(); <span class="comment">// in case we&#39;re ee_genkt</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;  <span class="keywordflow">switch</span> (_jet_algorithm) {</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daedcd9d5d70df13ae53dcb27d5aad15c8">ee_kt_algorithm</a>:</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a> &gt; 2.0); <span class="comment">// force this to be true! [not best place, but works]</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    <span class="keywordflow">break</span>; </div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da89441525addfaac095772d0c60aa18c7">ee_genkt_algorithm</a>:</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <span class="keywordflow">if</span> (p &lt;= 0 &amp;&amp; scale &lt; 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-300) scale = 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-300; <span class="comment">// same dodgy safety as genkt</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    scale = pow(scale,p);</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;Unrecognised jet algorithm&quot;</span>);</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;  }</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;  jetA-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#aa493ec07a25be0221ffbfc515b1313dc">kt2</a>  = scale; <span class="comment">// &quot;kt2&quot; might one day be renamed as &quot;scale&quot; or some such</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../de/de0/matchedfilter_8C.html#a52a54df5ca3fd7da7458d93eb9ece947">norm</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_jets_index].modp2();</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;  <span class="keywordflow">if</span> (norm &gt; 0) {</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    norm = 1.0/sqrt(norm);</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    jetA-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a8d83c032ffafbb79fa33799da8af45b2">nx</a> = norm * <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_jets_index].px();</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    jetA-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a8c09d43a6e3fdddf0dd4364e572bb576">ny</a> = norm * <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_jets_index].py();</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    jetA-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a6d78f161ccf4610c0c322a5b1a8d0a74">nz</a> = norm * <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[_jets_index].pz();</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    jetA-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a8d83c032ffafbb79fa33799da8af45b2">nx</a> = 0.0;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    jetA-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a8c09d43a6e3fdddf0dd4364e572bb576">ny</a> = 0.0;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    jetA-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a6d78f161ccf4610c0c322a5b1a8d0a74">nz</a> = 1.0;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  }</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  jetA-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a9e87bb2ce84930a036e082f53e286b4e">_jets_index</a> = _jets_index;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;  jetA-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#abd4383c11743104f755e3a6d97636d9f">NN_dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;  jetA-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a6eae58a4d08fc68ae866b9af58903753">NN</a>      = NULL;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;}</div>
<div class="line"><a name="l02644"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#af3ebca2dbed20fc382261b34640a3068"> 2644</a></span>&#160;<span class="keyword">template</span>&lt;&gt; <span class="keywordtype">double</span> <a class="code" href="../../d3/d25/classClusterSequence.html#ac3ab6312cfae9d50aa239741bc5221c6">ClusterSequence::_bj_dist</a>(</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;                <span class="keyword">const</span> <a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html">EEBriefJet</a> * <span class="keyword">const</span> jeta, </div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;                <span class="keyword">const</span> <a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html">EEBriefJet</a> * <span class="keyword">const</span> jetb)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = 1.0 </div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    - jeta-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a8d83c032ffafbb79fa33799da8af45b2">nx</a>*jetb-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a8d83c032ffafbb79fa33799da8af45b2">nx</a></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    - jeta-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a8c09d43a6e3fdddf0dd4364e572bb576">ny</a>*jetb-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a8c09d43a6e3fdddf0dd4364e572bb576">ny</a></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    - jeta-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a6d78f161ccf4610c0c322a5b1a8d0a74">nz</a>*jetb-&gt;<a class="code" href="../../d1/d57/structClusterSequence_1_1EEBriefJet.html#a6d78f161ccf4610c0c322a5b1a8d0a74">nz</a>;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;  dist *= 2; <span class="comment">// distance is _2_*min(Ei^2,Ej^2)*(1-cos theta)</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;}</div>
<div class="line"><a name="l02654"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a83eaa93828d22b330fa55216ef7f172b"> 2654</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a83eaa93828d22b330fa55216ef7f172b">ClusterSequence::_simple_N2_cluster_BriefJet</a>() {  </div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;  _simple_N2_cluster&lt;BriefJet&gt;();</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;}</div>
<div class="line"><a name="l02657"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a923682a4a62553a4a3908783d0b4b2f1"> 2657</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a923682a4a62553a4a3908783d0b4b2f1">ClusterSequence::_simple_N2_cluster_EEBriefJet</a>() {  </div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;  _simple_N2_cluster&lt;EEBriefJet&gt;();</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;}</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l02664"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#ad334a2b05bdc4a4a4528f28fa634ccfd"> 2664</a></span>&#160;<a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#ad334a2b05bdc4a4a4528f28fa634ccfd">ClusterSequenceStructure::~ClusterSequenceStructure</a>(){</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;  <span class="keywordflow">if</span> (_associated_cs != NULL </div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;      &amp;&amp; _associated_cs-&gt;will_delete_self_when_unused()) {</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    _associated_cs-&gt;signal_imminent_self_deletion();</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    <span class="keyword">delete</span> _associated_cs;</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;  }</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;}</div>
<div class="line"><a name="l02671"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a129cf734aaf2a6be18e18fc190b3a8b3"> 2671</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a129cf734aaf2a6be18e18fc190b3a8b3">ClusterSequenceStructure::has_valid_cluster_sequence</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;  <span class="keywordflow">return</span> (_associated_cs != NULL);</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;}</div>
<div class="line"><a name="l02674"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#aeedef0dfe318d6809f632c53717b9f32"> 2674</a></span>&#160;<span class="keyword">const</span> ClusterSequence* <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#aeedef0dfe318d6809f632c53717b9f32">ClusterSequenceStructure::associated_cluster_sequence</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;  <span class="keywordflow">return</span> _associated_cs;</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;}</div>
<div class="line"><a name="l02677"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a674abba4a44a26a73080ec68c3ca90cd"> 2677</a></span>&#160;<span class="keyword">const</span> ClusterSequence * <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a674abba4a44a26a73080ec68c3ca90cd">ClusterSequenceStructure::validated_cs</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;  <span class="keywordflow">if</span> (!_associated_cs) </div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;you requested information about the internal structure of a jet, but its associated ClusterSequence has gone out of scope.&quot;</span>);</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;  <span class="keywordflow">return</span> _associated_cs;</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;}</div>
<div class="line"><a name="l02682"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#acead99ab0bcc8c2b70b1a5af89517341"> 2682</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#acead99ab0bcc8c2b70b1a5af89517341">ClusterSequenceStructure::has_partner</a>(<span class="keyword">const</span> PseudoJet &amp;reference, PseudoJet &amp;partner)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;  <span class="keywordflow">return</span> validated_cs()-&gt;has_partner(reference, partner);</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;}</div>
<div class="line"><a name="l02685"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#af8355961737f81a5eae0576d7c9374e2"> 2685</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#af8355961737f81a5eae0576d7c9374e2">ClusterSequenceStructure::has_child</a>(<span class="keyword">const</span> PseudoJet &amp;reference, PseudoJet &amp;child)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;  <span class="keywordflow">return</span> validated_cs()-&gt;has_child(reference, child);</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;}</div>
<div class="line"><a name="l02688"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#af9ac155496eddc987ba098d8075749f5"> 2688</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#af9ac155496eddc987ba098d8075749f5">ClusterSequenceStructure::has_parents</a>(<span class="keyword">const</span> PseudoJet &amp;reference, PseudoJet &amp;parent1, PseudoJet &amp;parent2)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;  <span class="keywordflow">return</span> validated_cs()-&gt;has_parents(reference, parent1, parent2);</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;}</div>
<div class="line"><a name="l02691"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a5047acc15e102a0869baed60af77e5a2"> 2691</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a5047acc15e102a0869baed60af77e5a2">ClusterSequenceStructure::object_in_jet</a>(<span class="keyword">const</span> PseudoJet &amp;reference, <span class="keyword">const</span> PseudoJet &amp;jet)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;  <span class="keywordflow">if</span> ((!has_associated_cluster_sequence()) || (!jet.has_associated_cluster_sequence()))</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;you requested information about the internal structure of a jet, but it is not associated with a ClusterSequence or its associated ClusterSequence has gone out of scope.&quot;</span>); </div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  <span class="keywordflow">if</span> (reference.associated_cluster_sequence() != jet.associated_cluster_sequence()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;  <span class="keywordflow">return</span> validated_cs()-&gt;object_in_jet(reference, jet);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;}</div>
<div class="line"><a name="l02697"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a1562db8df3931b681d733997077fb11d"> 2697</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a1562db8df3931b681d733997077fb11d">ClusterSequenceStructure::has_constituents</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;  <span class="keywordflow">if</span> (!has_associated_cluster_sequence())</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;you requested information about the internal structure of a jet, but it is not associated with a ClusterSequence or its associated ClusterSequence has gone out of scope.&quot;</span>); </div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;}</div>
<div class="line"><a name="l02702"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#ad43409d2f1983bbd5fd1bbf50d2ff68b"> 2702</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#ad43409d2f1983bbd5fd1bbf50d2ff68b">ClusterSequenceStructure::constituents</a>(<span class="keyword">const</span> PseudoJet &amp;reference)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;  <span class="keywordflow">return</span> validated_cs()-&gt;constituents(reference);</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;}</div>
<div class="line"><a name="l02705"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a015c8ceb87ca8df03fa160561d15f46b"> 2705</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a015c8ceb87ca8df03fa160561d15f46b">ClusterSequenceStructure::has_exclusive_subjets</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;  <span class="keywordflow">if</span> (!has_associated_cluster_sequence())</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;you requested information about the internal structure of a jet, but it is not associated with a ClusterSequence or its associated ClusterSequence has gone out of scope.&quot;</span>); </div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;}</div>
<div class="line"><a name="l02710"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a6f0d15c9a29ffb0aaa109fa2307131b8"> 2710</a></span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a6f0d15c9a29ffb0aaa109fa2307131b8">ClusterSequenceStructure::exclusive_subjets</a> (<span class="keyword">const</span> PseudoJet &amp;reference, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; dcut)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;  <span class="keywordflow">return</span> validated_cs()-&gt;exclusive_subjets(reference, dcut);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;}</div>
<div class="line"><a name="l02713"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#ade5114fa54547f44f026dcd76da5b653"> 2713</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#ade5114fa54547f44f026dcd76da5b653">ClusterSequenceStructure::n_exclusive_subjets</a>(<span class="keyword">const</span> PseudoJet &amp;reference, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; dcut)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;  <span class="keywordflow">return</span> validated_cs()-&gt;n_exclusive_subjets(reference, dcut);</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;}</div>
<div class="line"><a name="l02716"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a004da5650a005b45171f38f1aec55439"> 2716</a></span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a004da5650a005b45171f38f1aec55439">ClusterSequenceStructure::exclusive_subjets_up_to</a> (<span class="keyword">const</span> PseudoJet &amp;reference, <span class="keywordtype">int</span> nsub)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;  <span class="keywordflow">return</span> validated_cs()-&gt;exclusive_subjets_up_to(reference, nsub);</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;}</div>
<div class="line"><a name="l02719"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#af9f96570c160c1e610463afe08e608c6"> 2719</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#af9f96570c160c1e610463afe08e608c6">ClusterSequenceStructure::exclusive_subdmerge</a>(<span class="keyword">const</span> PseudoJet &amp;reference, <span class="keywordtype">int</span> nsub)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;  <span class="keywordflow">return</span> validated_cs()-&gt;exclusive_subdmerge(reference, nsub);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;}</div>
<div class="line"><a name="l02722"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#aa878545d68f9285c53457cbc1e11cb77"> 2722</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#aa878545d68f9285c53457cbc1e11cb77">ClusterSequenceStructure::exclusive_subdmerge_max</a>(<span class="keyword">const</span> PseudoJet &amp;reference, <span class="keywordtype">int</span> nsub)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;  <span class="keywordflow">return</span> validated_cs()-&gt;exclusive_subdmerge_max(reference, nsub);</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;}</div>
<div class="line"><a name="l02725"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a978c7eac77bb7bbfd169a5855e358759"> 2725</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a978c7eac77bb7bbfd169a5855e358759">ClusterSequenceStructure::has_pieces</a>(<span class="keyword">const</span> PseudoJet &amp;reference)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;  PseudoJet dummy1, dummy2;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;  <span class="keywordflow">return</span> has_parents(reference, dummy1, dummy2);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;}</div>
<div class="line"><a name="l02729"></a><span class="lineno"><a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a763dc5cc5dda52fc8915e6efe3b3d996"> 2729</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d7/dcf/classClusterSequenceStructure.html#a763dc5cc5dda52fc8915e6efe3b3d996">ClusterSequenceStructure::pieces</a>(<span class="keyword">const</span> PseudoJet &amp;reference)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;  PseudoJet j1, j2;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;  vector&lt;PseudoJet&gt; res;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;  <span class="keywordflow">if</span> (has_parents(reference, j1, j2)){</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    res.push_back(j1);</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    res.push_back(j2);</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;  }</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;  <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;}</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;<span class="preprocessor">#include&lt;vector&gt;</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="preprocessor">#include&lt;cmath&gt;</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="preprocessor">#include&lt;algorithm&gt;</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l02745"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#ab91e151bf380c019839d0be23ced525f"> 2745</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#aa61737f323a3e5b4cc17c71c34d660d9">ClusterSequence::_bj_remove_from_tiles</a>(<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet) {</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;  <a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> * <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[jet-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>];</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;  <span class="keywordflow">if</span> (jet-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#abd3529334fd1bfa1a051cb232d7fba0a">previous</a> == NULL) {</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    tile-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a9099bfa108a1fb360342653671698e34">head</a> = jet-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>;</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    jet-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#abd3529334fd1bfa1a051cb232d7fba0a">previous</a>-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a> = jet-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  }</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;  <span class="keywordflow">if</span> (jet-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a> != NULL) {</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    jet-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#abd3529334fd1bfa1a051cb232d7fba0a">previous</a> = jet-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#abd3529334fd1bfa1a051cb232d7fba0a">previous</a>;</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;  }</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;}</div>
<div class="line"><a name="l02756"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a39b4bf2b32a61f1fb9ec2eb3cb185607"> 2756</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a39b4bf2b32a61f1fb9ec2eb3cb185607">ClusterSequence::_initialise_tiles</a>() {</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;  <span class="keywordtype">double</span> default_size = max(0.1,<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>);</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a> = default_size;</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>   = max(3,<span class="keywordtype">int</span>(floor(<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>/default_size)));</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#aff3c1a2733231c09a9e259c5730928d2">_tile_size_phi</a> = <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> / <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>; <span class="comment">// &gt;= _Rparam and fits in 2pi</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;  <a class="code" href="../../da/dd5/classTilingExtent.html">TilingExtent</a> tiling_analysis(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a> = tiling_analysis.<a class="code" href="../../da/dd5/classTilingExtent.html#a69f512777159849c7455dd6c68366c9a">minrap</a>();</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a> = tiling_analysis.<a class="code" href="../../da/dd5/classTilingExtent.html#a0800e910cd13b69b161525c8864af207">maxrap</a>();</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a> = int(floor(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a>/<a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>));</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a> = int(floor( <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a>/<a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>));</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a> * <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a> * <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.resize((<a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>-<a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>+1)*<a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>);</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ieta = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>; ieta &lt;= <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>; ieta++) {</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iphi = 0; iphi &lt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>; iphi++) {</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;      <a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> * <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[<a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(ieta,iphi)];</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;      tile-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a9099bfa108a1fb360342653671698e34">head</a> = NULL; <span class="comment">// first element of tiles points to itself</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;      tile-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#ab019b1459083d14c2a7f958a2809172e">begin_tiles</a>[0] =  <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>;</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;      <a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> ** pptile = &amp; (tile-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#ab019b1459083d14c2a7f958a2809172e">begin_tiles</a>[0]);</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;      pptile++;</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;      tile-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a6cda518e81462b3952f6c36dd7e72831">surrounding_tiles</a> = pptile;</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;      <span class="keywordflow">if</span> (ieta &gt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>) {</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        <span class="comment">// with the itile subroutine, we can safely run tiles from</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        <span class="comment">// idphi=-1 to idphi=+1, because it takes care of</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        <span class="comment">// negative and positive boundaries</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idphi = -1; idphi &lt;=+1; idphi++) {</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;          *pptile = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[<a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(ieta-1,iphi+idphi)];</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;          pptile++;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;        }       </div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      }</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;      *pptile = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[<a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(ieta,iphi-1)];</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      pptile++;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      tile-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#af7d88c4554184ac0830a59523195ee76">RH_tiles</a> = pptile;</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;      *pptile = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[<a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(ieta,iphi+1)];</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;      pptile++;</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;      <span class="keywordflow">if</span> (ieta &lt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>) {</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idphi = -1; idphi &lt;= +1; idphi++) {</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;          *pptile = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[<a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(ieta+1,iphi+idphi)];</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;          pptile++;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        }       </div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;      }</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;      tile-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a4a1604cbb41e269fe2280c4ec12c124d">end_tiles</a> = pptile;</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      tile-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a679b0f5ae79304f5335bc4fbb512269a">tagged</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    }</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;  }</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;}</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d3/d25/classClusterSequence.html#afc5ee997fddb92c95a95daa68b4e08e6">ClusterSequence::_tile_index</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#aa66df887c67e0d1025831e9998ea2415">eta</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d6/d34/namespaceActsTests_1_1PropagationDatasets.html#a4722f5524134f5f139681f91e6c50038">phi</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;  <span class="keywordtype">int</span> ieta, iphi;</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;  <span class="keywordflow">if</span>      (eta &lt;= <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a>) {ieta = 0;}</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eta &gt;= <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a>) {ieta = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>-<a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>;}</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    ieta = int(((eta - <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a>) / <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>));</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <span class="keywordflow">if</span> (ieta &gt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>-<a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>) {</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      ieta = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>-<a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>;} </div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;  }</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;  iphi = int((phi+<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>)/<a class="code" href="../../d6/d0c/classLazyTiling9.html#aff3c1a2733231c09a9e259c5730928d2">_tile_size_phi</a>) % <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>;</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;  <span class="keywordflow">return</span> (iphi + ieta * <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>);</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;}</div>
<div class="line"><a name="l02814"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#ae8a1b127109fdc4a54480d254c8a792c"> 2814</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#ae8a1b127109fdc4a54480d254c8a792c">ClusterSequence::_tj_set_jetinfo</a>( <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet,</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">int</span> _jets_index) {</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;  _bj_set_jetinfo&lt;&gt;(jet, _jets_index);</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;  jet-&gt;tile_index = <a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(jet-&gt;eta, jet-&gt;phi);</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;  <a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> * <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> = &amp;<a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[jet-&gt;tile_index];</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;  jet-&gt;previous   = NULL;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;  jet-&gt;next       = tile-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a9099bfa108a1fb360342653671698e34">head</a>;</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;  <span class="keywordflow">if</span> (jet-&gt;next != NULL) {jet-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#abd3529334fd1bfa1a051cb232d7fba0a">previous</a> = jet;}</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;  tile-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a9099bfa108a1fb360342653671698e34">head</a>      = jet;</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;}</div>
<div class="line"><a name="l02824"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#aabdd5fe392e8b0c25992b1df6a37a579"> 2824</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#aabdd5fe392e8b0c25992b1df6a37a579">ClusterSequence::_print_tiles</a>(<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * briefjets )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;  <span class="keywordflow">for</span> (vector&lt;Tile&gt;::const_iterator <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.begin(); </div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;       <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> &lt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.end(); <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>++) {</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Tile &quot;</span> &lt;&lt; <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> - <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.begin()&lt;&lt;<span class="stringliteral">&quot; = &quot;</span>;</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    vector&lt;int&gt; list;</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jetI = <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>-&gt;head; jetI != NULL; jetI = jetI-&gt;next) {</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      list.push_back(jetI-briefjets);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    }</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    <a class="code" href="../../d2/da5/namespaceActs_1_1Experimental_1_1detail_1_1BlueprintHelper.html#a308a6456db2655fc6a1a916696da20c8" title="Sort the nodes in the blueprint container node.">sort</a>(list.begin(),list.end());</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; list.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {cout &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;list[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];}</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    cout &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;  }</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;}</div>
<div class="line"><a name="l02837"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a3b3f5988d5d643b328721746272fcc35"> 2837</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a3b3f5988d5d643b328721746272fcc35">ClusterSequence::_add_neighbours_to_tile_union</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;               vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> * <span class="keyword">const</span> * near_tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_index].begin_tiles; </div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;       near_tile != <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_index].end_tiles; near_tile++){</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    tile_union[n_near_tiles] = *near_tile - &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[0];</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    n_near_tiles++;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;  }</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;}</div>
<div class="line"><a name="l02845"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a78274a2ddd3d4df8445a44306187e615"> 2845</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a78274a2ddd3d4df8445a44306187e615">ClusterSequence::_add_untagged_neighbours_to_tile_union</a>(</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;               vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles)  {</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> ** near_tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_index].begin_tiles; </div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;       near_tile != <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_index].end_tiles; near_tile++){</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <span class="keywordflow">if</span> (! (*near_tile)-&gt;tagged) {</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;      (*near_tile)-&gt;tagged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;      tile_union[n_near_tiles] = *near_tile - &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[0];</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;      n_near_tiles++;</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    }</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  }</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;}</div>
<div class="line"><a name="l02857"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a7584abc54015400ecdeac7c7657c8f1d"> 2857</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a7584abc54015400ecdeac7c7657c8f1d">ClusterSequence::_tiled_N2_cluster</a>() {</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0e8c176445183a4f9e03ba8ac6b40131">_initialise_tiles</a>();</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size();</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * briefjets = <span class="keyword">new</span> <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a>[<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>];</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jetA = briefjets, * jetB;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> oldB;</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;  oldB.<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>=0; <span class="comment">// prevents a gcc warning</span></div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;  vector&lt;int&gt; tile_union(3*n_tile_neighbours);</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5da6d84f64a7cff12c08700d37f56782">_tj_set_jetinfo</a>(jetA, <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>);</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    jetA++; <span class="comment">// move on to next entry of briefjets</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  }</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * tail = jetA; <span class="comment">// a semaphore for the end of briefjets</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * head = briefjets; <span class="comment">// a nicer way of naming start</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;  vector&lt;Tile&gt;::const_iterator <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>;</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;  <span class="keywordflow">for</span> (tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.begin(); tile != <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;      <span class="keywordflow">for</span> (jetB = tile-&gt;head; jetB != jetA; jetB = jetB-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetA,jetB);</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a445af237ad84e354a0ca77dd7ea3a79d">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a75c5cb4856186e3b56c11083482efed1">NN</a> = jetB;}</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a445af237ad84e354a0ca77dd7ea3a79d">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      }</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    }</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> ** RTile = tile-&gt;RH_tiles; RTile != tile-&gt;end_tiles; RTile++) {</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;      <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;        <span class="keywordflow">for</span> (jetB = (*RTile)-&gt;head; jetB != NULL; jetB = jetB-&gt;next) {</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetA,jetB);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;          <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a445af237ad84e354a0ca77dd7ea3a79d">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a75c5cb4856186e3b56c11083482efed1">NN</a> = jetB;}</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;          <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a445af237ad84e354a0ca77dd7ea3a79d">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        }</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;      }</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    }</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;  }</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;  <span class="keywordtype">double</span> * diJ = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>];</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;  jetA = head;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;    diJ[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(jetA);</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    jetA++; <span class="comment">// have jetA follow i</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;  }</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  <span class="keywordtype">int</span> history_location = n-1;</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;  <span class="keywordflow">while</span> (tail != head) {</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;    <span class="keywordtype">double</span> diJ_min = diJ[0];</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    <span class="keywordtype">int</span> diJ_min_jet = 0;</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 1; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;      <span class="keywordflow">if</span> (diJ[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] &lt; diJ_min) {diJ_min_jet = <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>; diJ_min  = diJ[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];}</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    }</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    history_location++;</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    jetA = &amp; briefjets[diJ_min_jet];</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    jetB = jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a75c5cb4856186e3b56c11083482efed1">NN</a>;</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    diJ_min *= <a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a>; </div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      <span class="keywordflow">if</span> (jetA &lt; jetB) {<a class="code" href="../../d6/db0/fjcore_8hh.html#ac71f249d840a70f8b3aaffb721843eaa">std::swap</a>(jetA,jetB);}</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      <span class="keywordtype">int</span> nn; <span class="comment">// new jet index</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;      _do_ij_recombination_step(jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a8b5c0bed5c74f9e95cbb745a36dca300">_jets_index</a>, jetB-&gt;_jets_index, diJ_min, nn);</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(jetA);</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;      oldB = * jetB;  <span class="comment">// take a copy because we will need it...</span></div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(jetB);</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5da6d84f64a7cff12c08700d37f56782">_tj_set_jetinfo</a>(jetB, nn); <span class="comment">// also registers the jet in the tiling</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;      _do_iB_recombination_step(jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a8b5c0bed5c74f9e95cbb745a36dca300">_jets_index</a>, diJ_min);</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(jetA);</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    }</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    <span class="keywordtype">int</span> n_near_tiles = 0;</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html#ac279873de61def4b2de5bc273d6ed6a1">_add_neighbours_to_tile_union</a>(jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>, tile_union, n_near_tiles);</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      <span class="keywordtype">bool</span> sort_it = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;      <span class="keywordflow">if</span> (jetB-&gt;tile_index != jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>) {</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        sort_it = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        <a class="code" href="../../d6/d0c/classLazyTiling9.html#ac279873de61def4b2de5bc273d6ed6a1">_add_neighbours_to_tile_union</a>(jetB-&gt;tile_index,tile_union,n_near_tiles);</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;      }</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;      <span class="keywordflow">if</span> (oldB.<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a> != jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a> &amp;&amp; </div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;          oldB.<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a> != jetB-&gt;tile_index) {</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        sort_it = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        <a class="code" href="../../d6/d0c/classLazyTiling9.html#ac279873de61def4b2de5bc273d6ed6a1">_add_neighbours_to_tile_union</a>(oldB.<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>,tile_union,n_near_tiles);</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;      }</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;      <span class="keywordflow">if</span> (sort_it) {</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;        <span class="comment">// sort the tiles before then compressing the list</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;        <a class="code" href="../../d2/da5/namespaceActs_1_1Experimental_1_1detail_1_1BlueprintHelper.html#a308a6456db2655fc6a1a916696da20c8" title="Sort the nodes in the blueprint container node.">sort</a>(tile_union.begin(), tile_union.begin()+n_near_tiles);</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;        <span class="comment">// and now condense the list</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;        <span class="keywordtype">int</span> nnn = 1;</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 1; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; n_near_tiles; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;          <span class="keywordflow">if</span> (tile_union[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] != tile_union[nnn-1]) {</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;            tile_union[nnn] = tile_union[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]; </div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;            nnn++;</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;          }</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;        }</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;        n_near_tiles = nnn;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;      }</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    }</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    tail--; n--;</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    <span class="keywordflow">if</span> (jetA == tail) {</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      *jetA = *tail;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      diJ[jetA - head] = diJ[tail-head];</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      <span class="keywordflow">if</span> (jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#abd3529334fd1bfa1a051cb232d7fba0a">previous</a> == NULL) {</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;        <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>].head = jetA;</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;        jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#abd3529334fd1bfa1a051cb232d7fba0a">previous</a>-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a> = jetA;</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;      }</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      <span class="keywordflow">if</span> (jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a> != NULL) {jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#abd3529334fd1bfa1a051cb232d7fba0a">previous</a> = jetA;}</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    }</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itile = 0; itile &lt; n_near_tiles; itile++) {</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      <a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> * tile_ptr = &amp;<a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_union[itile]];</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jetI = tile_ptr-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a9099bfa108a1fb360342653671698e34">head</a>; jetI != NULL; jetI = jetI-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        <span class="comment">// see if jetI had jetA or jetB as a NN -- if so recalculate the NN</span></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        <span class="keywordflow">if</span> (jetI-&gt;NN == jetA || (jetI-&gt;NN == jetB &amp;&amp; jetB != NULL)) {</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;          jetI-&gt;NN_dist = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>;</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;          jetI-&gt;NN      = NULL;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;          <span class="comment">// now go over tiles that are neighbours of I (include own tile)</span></div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> ** near_tile  = tile_ptr-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#ab019b1459083d14c2a7f958a2809172e">begin_tiles</a>; </div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;                       near_tile != tile_ptr-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a4a1604cbb41e269fe2280c4ec12c124d">end_tiles</a>; near_tile++) {</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;            <span class="comment">// and then over the contents of that tile</span></div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jetJ  = (*near_tile)-&gt;head; </div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;                            jetJ != NULL; jetJ = jetJ-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetI,jetJ);</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist &amp;&amp; jetJ != jetI) {</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;                jetI-&gt;NN_dist = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetI-&gt;NN = jetJ;</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;              }</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;            }</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;          }</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;          diJ[jetI-head] = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(jetI); <span class="comment">// update diJ </span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;        }</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;        <span class="comment">// check whether new jetB is closer than jetI&#39;s current NN and</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;        <span class="comment">// if need to update things</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;        <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetI,jetB);</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;          <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist) {</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;            <span class="keywordflow">if</span> (jetI != jetB) {</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;              jetI-&gt;NN_dist = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;              jetI-&gt;NN = jetB;</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;              diJ[jetI-head] = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(jetI); <span class="comment">// update diJ...</span></div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;            }</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;          }</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;          <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;            <span class="keywordflow">if</span> (jetI != jetB) {</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;              jetB-&gt;NN_dist = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;              jetB-&gt;NN      = jetI;}</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;          }</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;        }</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      }</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    }</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {diJ[jetB-head] = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(jetB);}</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> ** near_tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tail-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>].begin_tiles; </div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;                 near_tile!= <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tail-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>].end_tiles; near_tile++){</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jetJ = (*near_tile)-&gt;head; </div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;                     jetJ != NULL; jetJ = jetJ-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        <span class="keywordflow">if</span> (jetJ-&gt;NN == tail) {jetJ-&gt;NN = jetA;}</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;      }</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    }</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {diJ[jetB-head] = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(jetB);}</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;  }</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;  <span class="keyword">delete</span>[] diJ;</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;  <span class="keyword">delete</span>[] briefjets;</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;}</div>
<div class="line"><a name="l03011"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a628d047f8486d71baa9903bd6df94161"> 3011</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a628d047f8486d71baa9903bd6df94161">ClusterSequence::_faster_tiled_N2_cluster</a>() {</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0e8c176445183a4f9e03ba8ac6b40131">_initialise_tiles</a>();</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size();</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * briefjets = <span class="keyword">new</span> <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a>[<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>];</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jetA = briefjets, * jetB;</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> oldB;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;  oldB.<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>=0; <span class="comment">// prevents a gcc warning</span></div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;  vector&lt;int&gt; tile_union(3*n_tile_neighbours);</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5da6d84f64a7cff12c08700d37f56782">_tj_set_jetinfo</a>(jetA, <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>);</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;    jetA++; <span class="comment">// move on to next entry of briefjets</span></div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;  }</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * head = briefjets; <span class="comment">// a nicer way of naming start</span></div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;  vector&lt;Tile&gt;::const_iterator <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;  <span class="keywordflow">for</span> (tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.begin(); tile != <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;      <span class="keywordflow">for</span> (jetB = tile-&gt;head; jetB != jetA; jetB = jetB-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetA,jetB);</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a445af237ad84e354a0ca77dd7ea3a79d">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a75c5cb4856186e3b56c11083482efed1">NN</a> = jetB;}</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a445af237ad84e354a0ca77dd7ea3a79d">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      }</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    }</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> ** RTile = tile-&gt;RH_tiles; RTile != tile-&gt;end_tiles; RTile++) {</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;      <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        <span class="keywordflow">for</span> (jetB = (*RTile)-&gt;head; jetB != NULL; jetB = jetB-&gt;next) {</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetA,jetB);</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;          <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a445af237ad84e354a0ca77dd7ea3a79d">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a75c5cb4856186e3b56c11083482efed1">NN</a> = jetB;}</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;          <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a445af237ad84e354a0ca77dd7ea3a79d">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;        }</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;      }</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    }</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;  }</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;  <span class="keyword">struct </span>diJ_plus_link {</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    <span class="keywordtype">double</span>     diJ; <span class="comment">// the distance</span></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jet; <span class="comment">// the jet (i) for which we&#39;ve found this distance</span></div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;  };</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;  diJ_plus_link * diJ = <span class="keyword">new</span> diJ_plus_link[<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>];</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;  jetA = head;</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    diJ[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].diJ = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(jetA); <span class="comment">// kt distance * R^2</span></div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    diJ[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].jet = jetA;  <span class="comment">// our compact diJ table will not be in      </span></div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a6cf2372e85f4fea4f173b809a64f06b4">diJ_posn</a> = <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>; <span class="comment">// one-to-one corresp. with non-compact jets,</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    jetA++; <span class="comment">// have jetA follow i </span></div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;  }</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;  <span class="keywordtype">int</span> history_location = n-1;</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;  <span class="keywordflow">while</span> (n &gt; 0) {</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    diJ_plus_link * best, *stop; <span class="comment">// pointers a bit faster than indices</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    <span class="keywordtype">double</span> diJ_min = diJ[0].diJ; <span class="comment">// initialise the best one here.</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;    best = diJ;                  <span class="comment">// and here</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    stop = diJ+<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>;</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    <span class="keywordflow">for</span> (diJ_plus_link * here = diJ+1; here != stop; here++) {</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;      <span class="keywordflow">if</span> (here-&gt;diJ &lt; diJ_min) {best = here; diJ_min  = here-&gt;diJ;}</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;    }</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;    history_location++;</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    jetA = best-&gt;jet;</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;    jetB = jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a75c5cb4856186e3b56c11083482efed1">NN</a>;</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    diJ_min *= <a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a>; </div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;      <span class="keywordflow">if</span> (jetA &lt; jetB) {<a class="code" href="../../d6/db0/fjcore_8hh.html#ac71f249d840a70f8b3aaffb721843eaa">std::swap</a>(jetA,jetB);}</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;      <span class="keywordtype">int</span> nn; <span class="comment">// new jet index</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;      _do_ij_recombination_step(jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a8b5c0bed5c74f9e95cbb745a36dca300">_jets_index</a>, jetB-&gt;_jets_index, diJ_min, nn);</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(jetA);</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;      oldB = * jetB;  <span class="comment">// take a copy because we will need it...</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(jetB);</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5da6d84f64a7cff12c08700d37f56782">_tj_set_jetinfo</a>(jetB, nn); <span class="comment">// cause jetB to become _jets[nn]</span></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      _do_iB_recombination_step(jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a8b5c0bed5c74f9e95cbb745a36dca300">_jets_index</a>, diJ_min);</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(jetA);</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;    }</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    <span class="keywordtype">int</span> n_near_tiles = 0;</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3f62c993b981ade840a9d22a4209fc27">_add_untagged_neighbours_to_tile_union</a>(jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>, </div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;                                           tile_union, n_near_tiles);</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;      <span class="keywordflow">if</span> (jetB-&gt;tile_index != jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>) {</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;        <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3f62c993b981ade840a9d22a4209fc27">_add_untagged_neighbours_to_tile_union</a>(jetB-&gt;tile_index,</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                                               tile_union,n_near_tiles);</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;      }</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;      <span class="keywordflow">if</span> (oldB.<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a> != jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a> &amp;&amp; </div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;          oldB.<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a> != jetB-&gt;tile_index) {</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;        <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3f62c993b981ade840a9d22a4209fc27">_add_untagged_neighbours_to_tile_union</a>(oldB.<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>,</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;                                               tile_union,n_near_tiles);</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;      }</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    }</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;    n--;</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    diJ[<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>].jet-&gt;diJ_posn = jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a6cf2372e85f4fea4f173b809a64f06b4">diJ_posn</a>;</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    diJ[jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a6cf2372e85f4fea4f173b809a64f06b4">diJ_posn</a>] = diJ[<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>];</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itile = 0; itile &lt; n_near_tiles; itile++) {</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;      <a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> * tile_ptr = &amp;<a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_union[itile]];</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;      tile_ptr-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a679b0f5ae79304f5335bc4fbb512269a">tagged</a> = <span class="keyword">false</span>; <span class="comment">// reset tag, since we&#39;re done with unions</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jetI = tile_ptr-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a9099bfa108a1fb360342653671698e34">head</a>; jetI != NULL; jetI = jetI-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;        <span class="comment">// see if jetI had jetA or jetB as a NN -- if so recalculate the NN</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;        <span class="keywordflow">if</span> (jetI-&gt;NN == jetA || (jetI-&gt;NN == jetB &amp;&amp; jetB != NULL)) {</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;          jetI-&gt;NN_dist = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>;</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;          jetI-&gt;NN      = NULL;</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;          <span class="comment">// now go over tiles that are neighbours of I (include own tile)</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> ** near_tile  = tile_ptr-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#ab019b1459083d14c2a7f958a2809172e">begin_tiles</a>; </div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;                       near_tile != tile_ptr-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a4a1604cbb41e269fe2280c4ec12c124d">end_tiles</a>; near_tile++) {</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;            <span class="comment">// and then over the contents of that tile</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jetJ  = (*near_tile)-&gt;head; </div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;                            jetJ != NULL; jetJ = jetJ-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetI,jetJ);</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist &amp;&amp; jetJ != jetI) {</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;                jetI-&gt;NN_dist = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetI-&gt;NN = jetJ;</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;              }</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;            }</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;          }</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;          diJ[jetI-&gt;diJ_posn].diJ = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(jetI); <span class="comment">// update diJ kt-dist</span></div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;        }</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        <span class="comment">// check whether new jetB is closer than jetI&#39;s current NN and</span></div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;        <span class="comment">// if jetI is closer than jetB&#39;s current (evolving) nearest</span></div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        <span class="comment">// neighbour. Where relevant update things</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetI,jetB);</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;          <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist) {</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;            <span class="keywordflow">if</span> (jetI != jetB) {</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;              jetI-&gt;NN_dist = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;              jetI-&gt;NN = jetB;</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;              diJ[jetI-&gt;diJ_posn].diJ = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(jetI); <span class="comment">// update diJ...</span></div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;            }</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;          }</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;          <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;            <span class="keywordflow">if</span> (jetI != jetB) {</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;              jetB-&gt;NN_dist = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;              jetB-&gt;NN      = jetI;}</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;          }</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        }</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;      }</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    }</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {diJ[jetB-&gt;diJ_posn].diJ = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(jetB);}</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;  }</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;  <span class="keyword">delete</span>[] diJ;</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;  <span class="keyword">delete</span>[] briefjets;</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;}</div>
<div class="line"><a name="l03144"></a><span class="lineno"><a class="code" href="../../d3/d25/classClusterSequence.html#a6075bd007f85fd34e770b39ccdca5446"> 3144</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d25/classClusterSequence.html#a6075bd007f85fd34e770b39ccdca5446">ClusterSequence::_minheap_faster_tiled_N2_cluster</a>() {</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0e8c176445183a4f9e03ba8ac6b40131">_initialise_tiles</a>();</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size();</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * briefjets = <span class="keyword">new</span> <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a>[<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>];</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jetA = briefjets, * jetB;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> oldB;</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;  oldB.<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>=0; <span class="comment">// prevents a gcc warning</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;  vector&lt;int&gt; tile_union(3*n_tile_neighbours);</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5da6d84f64a7cff12c08700d37f56782">_tj_set_jetinfo</a>(jetA, <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>);</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;    jetA++; <span class="comment">// move on to next entry of briefjets</span></div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;  }</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;  <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * head = briefjets; <span class="comment">// a nicer way of naming start</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  vector&lt;Tile&gt;::const_iterator <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>;</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;  <span class="keywordflow">for</span> (tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.begin(); tile != <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;      <span class="keywordflow">for</span> (jetB = tile-&gt;head; jetB != jetA; jetB = jetB-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetA,jetB);</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a445af237ad84e354a0ca77dd7ea3a79d">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a75c5cb4856186e3b56c11083482efed1">NN</a> = jetB;}</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a445af237ad84e354a0ca77dd7ea3a79d">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;      }</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    }</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> ** RTile = tile-&gt;RH_tiles; RTile != tile-&gt;end_tiles; RTile++) {</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;      <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;        <span class="keywordflow">for</span> (jetB = (*RTile)-&gt;head; jetB != NULL; jetB = jetB-&gt;next) {</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetA,jetB);</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;          <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a445af237ad84e354a0ca77dd7ea3a79d">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a75c5cb4856186e3b56c11083482efed1">NN</a> = jetB;}</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;          <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a445af237ad84e354a0ca77dd7ea3a79d">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;        }</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;      }</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    }</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;  }</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;  vector&lt;double&gt; diJs(n);</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    diJs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(&amp;briefjets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;    briefjets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a547e146feffee67f091f0c88764d9e4c">label_minheap_update_done</a>();</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;  }</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;  <a class="code" href="../../dc/d1f/classMinHeap.html">MinHeap</a> minheap(diJs);</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;  vector&lt;TiledJet *&gt; jets_for_minheap;</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;  jets_for_minheap.reserve(n); </div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;  <span class="keywordtype">int</span> history_location = n-1;</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;  <span class="keywordflow">while</span> (n &gt; 0) {</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    <span class="keywordtype">double</span> diJ_min = minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#ae17ef2b28154bf277ffef1c4f0e71f12">minval</a>() *<a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a>;</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    jetA = head + minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#a0ca99aace4dc34bf64a6bca0408c9b08">minloc</a>();</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;    history_location++;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    jetB = jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a75c5cb4856186e3b56c11083482efed1">NN</a>;</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;      <span class="keywordflow">if</span> (jetA &lt; jetB) {<a class="code" href="../../d6/db0/fjcore_8hh.html#ac71f249d840a70f8b3aaffb721843eaa">std::swap</a>(jetA,jetB);}</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;      <span class="keywordtype">int</span> nn; <span class="comment">// new jet index</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      _do_ij_recombination_step(jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a8b5c0bed5c74f9e95cbb745a36dca300">_jets_index</a>, jetB-&gt;_jets_index, diJ_min, nn);</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(jetA);</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;      oldB = * jetB;  <span class="comment">// take a copy because we will need it...</span></div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(jetB);</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5da6d84f64a7cff12c08700d37f56782">_tj_set_jetinfo</a>(jetB, nn); <span class="comment">// cause jetB to become _jets[nn]</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;      _do_iB_recombination_step(jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a8b5c0bed5c74f9e95cbb745a36dca300">_jets_index</a>, diJ_min);</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(jetA);</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    }</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#a43c188a1357883198388a9713b3d889b">remove</a>(jetA-head);</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    <span class="keywordtype">int</span> n_near_tiles = 0;</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3f62c993b981ade840a9d22a4209fc27">_add_untagged_neighbours_to_tile_union</a>(jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>, </div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;                                           tile_union, n_near_tiles);</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      <span class="keywordflow">if</span> (jetB-&gt;tile_index != jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>) {</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3f62c993b981ade840a9d22a4209fc27">_add_untagged_neighbours_to_tile_union</a>(jetB-&gt;tile_index,</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;                                               tile_union,n_near_tiles);</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      }</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;      <span class="keywordflow">if</span> (oldB.<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a> != jetA-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a> &amp;&amp; </div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;          oldB.<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a> != jetB-&gt;tile_index) {</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;        <span class="comment">// GS: the line below generates a warning that oldB.tile_index</span></div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;        <span class="comment">// may be used uninitialised. However, to reach this point, we</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;        <span class="comment">// ned jetB != NULL (see test a few lines above) and is jetB</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;        <span class="comment">// !=NULL, one would have gone through &quot;oldB = *jetB before</span></div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;        <span class="comment">// (see piece of code ~20 line above), so the index is</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;        <span class="comment">// initialised. We do not do anything to avoid the warning to</span></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;        <span class="comment">// avoid any potential speed impact.</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;        <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3f62c993b981ade840a9d22a4209fc27">_add_untagged_neighbours_to_tile_union</a>(oldB.<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#ab8ad4d4db5211efd0947ece32373b643">tile_index</a>,</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;                                               tile_union,n_near_tiles);</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;      }</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      jetB-&gt;label_minheap_update_needed();</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;      jets_for_minheap.push_back(jetB);</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;    }</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itile = 0; itile &lt; n_near_tiles; itile++) {</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;      <a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> * tile_ptr = &amp;<a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_union[itile]];</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;      tile_ptr-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a679b0f5ae79304f5335bc4fbb512269a">tagged</a> = <span class="keyword">false</span>; <span class="comment">// reset tag, since we&#39;re done with unions</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jetI = tile_ptr-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a9099bfa108a1fb360342653671698e34">head</a>; jetI != NULL; jetI = jetI-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;        <span class="comment">// see if jetI had jetA or jetB as a NN -- if so recalculate the NN</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;        <span class="keywordflow">if</span> (jetI-&gt;NN == jetA || (jetI-&gt;NN == jetB &amp;&amp; jetB != NULL)) {</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;          jetI-&gt;NN_dist = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>;</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;          jetI-&gt;NN      = NULL;</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;          <span class="comment">// label jetI as needing heap action...</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;          <span class="keywordflow">if</span> (!jetI-&gt;minheap_update_needed()) {</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;            jetI-&gt;label_minheap_update_needed();</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;            jets_for_minheap.push_back(jetI);}</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;          <span class="comment">// now go over tiles that are neighbours of I (include own tile)</span></div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html">Tile</a> ** near_tile  = tile_ptr-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#ab019b1459083d14c2a7f958a2809172e">begin_tiles</a>; </div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;                       near_tile != tile_ptr-&gt;<a class="code" href="../../d2/d76/structClusterSequence_1_1Tile.html#a4a1604cbb41e269fe2280c4ec12c124d">end_tiles</a>; near_tile++) {</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;            <span class="comment">// and then over the contents of that tile</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jetJ  = (*near_tile)-&gt;head; </div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;                            jetJ != NULL; jetJ = jetJ-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#aead37984d2a5451bc6a85f3495aebfef">next</a>) {</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetI,jetJ);</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist &amp;&amp; jetJ != jetI) {</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;                jetI-&gt;NN_dist = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetI-&gt;NN = jetJ;</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;              }</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;            }</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;          }</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;        }</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;        <span class="comment">// check whether new jetB is closer than jetI&#39;s current NN and</span></div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;        <span class="comment">// if jetI is closer than jetB&#39;s current (evolving) nearest</span></div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;        <span class="comment">// neighbour. Where relevant update things</span></div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;        <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetI,jetB);</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;          <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist) {</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;            <span class="keywordflow">if</span> (jetI != jetB) {</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;              jetI-&gt;NN_dist = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;              jetI-&gt;NN = jetB;</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;              <span class="comment">// label jetI as needing heap action...</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;              <span class="keywordflow">if</span> (!jetI-&gt;minheap_update_needed()) {</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;                jetI-&gt;label_minheap_update_needed();</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;                jets_for_minheap.push_back(jetI);}</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;            }</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;          }</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;          <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;            <span class="keywordflow">if</span> (jetI != jetB) {</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;              jetB-&gt;NN_dist = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;              jetB-&gt;NN      = jetI;}</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;          }</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;        }</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      }</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    }</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    <span class="keywordflow">while</span> (jets_for_minheap.size() &gt; 0) {</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;      <a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html">TiledJet</a> * jetI = jets_for_minheap.back(); </div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;      jets_for_minheap.pop_back();</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;      minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#a389062f6aba4c38b4995271bf0ece469">update</a>(jetI-head, <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(jetI));</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;      jetI-&gt;<a class="code" href="../../d6/da9/classClusterSequence_1_1TiledJet.html#a547e146feffee67f091f0c88764d9e4c">label_minheap_update_done</a>();</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;    }</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;    n--;</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;  }</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;  <span class="keyword">delete</span>[] briefjets;</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;}</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l03287"></a><span class="lineno"><a class="code" href="../../df/d74/classCompositeJetStructure.html#aec520691062265316e68e1310af10f62"> 3287</a></span>&#160;<a class="code" href="../../df/d74/classCompositeJetStructure.html#a71e46cc41d6964332261d69d235905af">CompositeJetStructure::CompositeJetStructure</a>(<span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp; initial_pieces, </div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="../../d2/d7e/classJetDefinition_1_1Recombiner.html">JetDefinition::Recombiner</a> * recombiner)</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;  : _pieces(initial_pieces){</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;  <span class="keywordflow">if</span> (recombiner){};  <span class="comment">// ugly trick to prevent a gcc warning</span></div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;  <a class="code" href="../../df/d74/classCompositeJetStructure.html#a71f906708ea0950e3bb66777a4bde111" title="pointer to the 4-vector jet area">_area_4vector_ptr</a> = 0;</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;}</div>
<div class="line"><a name="l03293"></a><span class="lineno"><a class="code" href="../../df/d74/classCompositeJetStructure.html#a310e4cca0d1f7b161e2fe91d629505d4"> 3293</a></span>&#160;<a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a> <a class="code" href="../../df/d74/classCompositeJetStructure.html#a310e4cca0d1f7b161e2fe91d629505d4">CompositeJetStructure::description</a>()<span class="keyword"> const</span>{ </div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;  <span class="keywordtype">string</span> <a class="code" href="../../d7/d38/ZipTests_8cpp.html#a2a98c1fe01d4f15bb6333773fbbe879c">str</a> = <span class="stringliteral">&quot;Composite PseudoJet&quot;</span>;</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d7/d38/ZipTests_8cpp.html#a2a98c1fe01d4f15bb6333773fbbe879c">str</a>; </div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;}</div>
<div class="line"><a name="l03297"></a><span class="lineno"><a class="code" href="../../df/d74/classCompositeJetStructure.html#a17358f13eb6abf1630b124c963168bbd"> 3297</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../df/d74/classCompositeJetStructure.html#a17358f13eb6abf1630b124c963168bbd">CompositeJetStructure::has_constituents</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../df/d74/classCompositeJetStructure.html#a092ba3e18258fb8261fedce3db02bd03" title="the pieces building the jet">_pieces</a>.size()!=0;</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;}</div>
<div class="line"><a name="l03300"></a><span class="lineno"><a class="code" href="../../df/d74/classCompositeJetStructure.html#a6769081b882f729f28bf114e3b66ed32"> 3300</a></span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../df/d74/classCompositeJetStructure.html#a6769081b882f729f28bf114e3b66ed32">CompositeJetStructure::constituents</a>(<span class="keyword">const</span> PseudoJet &amp; <span class="comment">/*jet*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;  vector&lt;PseudoJet&gt; all_constituents;</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../df/d74/classCompositeJetStructure.html#a092ba3e18258fb8261fedce3db02bd03" title="the pieces building the jet">_pieces</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/d74/classCompositeJetStructure.html#a092ba3e18258fb8261fedce3db02bd03" title="the pieces building the jet">_pieces</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].<a class="code" href="../../df/d74/classCompositeJetStructure.html#a17358f13eb6abf1630b124c963168bbd">has_constituents</a>()){</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;      vector&lt;PseudoJet&gt; constits = <a class="code" href="../../df/d74/classCompositeJetStructure.html#a092ba3e18258fb8261fedce3db02bd03" title="the pieces building the jet">_pieces</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].constituents();</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;      copy(constits.begin(), constits.end(), back_inserter(all_constituents));</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;      all_constituents.push_back(<a class="code" href="../../df/d74/classCompositeJetStructure.html#a092ba3e18258fb8261fedce3db02bd03" title="the pieces building the jet">_pieces</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    }</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;  }</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;  <span class="keywordflow">return</span> all_constituents;</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;}</div>
<div class="line"><a name="l03312"></a><span class="lineno"><a class="code" href="../../df/d74/classCompositeJetStructure.html#ad9039f5839590215c915c01c10012b48"> 3312</a></span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../df/d74/classCompositeJetStructure.html#ad9039f5839590215c915c01c10012b48">CompositeJetStructure::pieces</a>(<span class="keyword">const</span> PseudoJet &amp; <span class="comment">/*jet*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../df/d74/classCompositeJetStructure.html#a092ba3e18258fb8261fedce3db02bd03" title="the pieces building the jet">_pieces</a>;</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;}</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d9/dd6/classError.html#acef17e92a466c14a57f74edfb3166585" title="do we print anything?">Error::_print_errors</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d9/dd6/classError.html#a784873fc7ac030ed460bf7b5af280faf" title="do we print the backtrace?">Error::_print_backtrace</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;ostream * <a class="code" href="../../d9/dd6/classError.html#a5d5bd5612a734822d2e22505a15a8c41" title="the output stream (cerr if not set)">Error::_default_ostr</a> = &amp; cerr;</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;<span class="preprocessor">#if (!defined(FJCORE_HAVE_EXECINFO_H)) || defined(__FJCORE__)</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../d8/de2/classLimitedWarning.html">LimitedWarning</a> <a class="code" href="../../d9/dd6/classError.html#a647cd81ad923c106a6506590dfc4adc1">Error::_execinfo_undefined</a>;</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"><a class="code" href="../../d9/dd6/classError.html#accd611f3ddae0828adeb6ca251113ffd"> 3325</a></span>&#160;<span class="preprocessor"></span><a class="code" href="../../d9/dd6/classError.html#aca339d00ad8481fb4c184f0ece42698b">Error::Error</a>(<span class="keyword">const</span> <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a> &amp; message_in) {</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;  _message = message_in; </div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;  <span class="keywordflow">if</span> (_print_errors &amp;&amp; _default_ostr){</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    ostringstream oss;</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    oss &lt;&lt; <span class="stringliteral">&quot;fjcore::Error:  &quot;</span>&lt;&lt; message_in &lt;&lt; endl;</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    *_default_ostr &lt;&lt; oss.str();</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    _default_ostr-&gt;flush(); </div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;  }</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;}</div>
<div class="line"><a name="l03334"></a><span class="lineno"><a class="code" href="../../d9/dd6/classError.html#a4a947b9cf734ae29726c6fd550de233f"> 3334</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/dd6/classError.html#a4a947b9cf734ae29726c6fd550de233f">Error::set_print_backtrace</a>(<span class="keywordtype">bool</span> enabled) {</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;<span class="preprocessor">#if (!defined(FJCORE_HAVE_EXECINFO_H)) || defined(__FJCORE__)</span></div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (enabled) {</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;    _execinfo_undefined.warn(<span class="stringliteral">&quot;Error::set_print_backtrace(true) will not work with this build of FastJet&quot;</span>);</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;  }</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;<span class="preprocessor">#endif    </span></div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;<span class="preprocessor"></span>  _print_backtrace = enabled;</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;}</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;<span class="preprocessor">#include&lt;sstream&gt;</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../dc/d1c/classJetDefinition.html#aff5c8f808dc55c1dba3be1245d280c75">JetDefinition::max_allowable_R</a> = 1000.0;</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;<a class="code" href="../../dc/d1c/classJetDefinition.html#a8dbb37b160f41cd86aa6828953dec031">JetDefinition::JetDefinition</a>(<a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93d">JetAlgorithm</a> jet_algorithm_in, </div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;                             <span class="keywordtype">double</span> R_in, </div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;                             <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490">RecombinationScheme</a> recomb_scheme_in,</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;                             <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706">Strategy</a> strategy_in,</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;                             <span class="keywordtype">int</span> nparameters) :</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;  _jet_algorithm(jet_algorithm_in), _Rparam(R_in), _strategy(strategy_in) {</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;  <span class="keywordflow">if</span> (_jet_algorithm == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daedcd9d5d70df13ae53dcb27d5aad15c8">ee_kt_algorithm</a>) {</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    _Rparam = 4.0; <span class="comment">// introduce a fictional R that ensures that</span></div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;    <span class="keywordflow">if</span> (R_in &gt; max_allowable_R) {</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;      ostringstream oss;</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;      oss &lt;&lt; <span class="stringliteral">&quot;Requested R = &quot;</span> &lt;&lt; R_in &lt;&lt; <span class="stringliteral">&quot; for jet definition is larger than max_allowable_R = &quot;</span> &lt;&lt; max_allowable_R;</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html#aca339d00ad8481fb4c184f0ece42698b">Error</a>(oss.str());</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;    }</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;  }</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nparameters_expected = n_parameters_for_algorithm(jet_algorithm_in);</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;  <span class="keywordflow">if</span> (nparameters != (<span class="keywordtype">int</span>) nparameters_expected){</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    ostringstream oss;</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;    oss &lt;&lt; <span class="stringliteral">&quot;The jet algorithm you requested (&quot;</span></div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;        &lt;&lt; jet_algorithm_in &lt;&lt; <span class="stringliteral">&quot;) should be constructed with &quot;</span> &lt;&lt; nparameters_expected </div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; parameter(s) but was called with &quot;</span> &lt;&lt; nparameters &lt;&lt; <span class="stringliteral">&quot; parameter(s)\n&quot;</span>;</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html#aca339d00ad8481fb4c184f0ece42698b">Error</a>(oss.str()); </div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;  }</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a> (_strategy  != <a class="code" href="../../d6/db0/fjcore_8hh.html#acf7192c608527efb8f8dedf0a3f2e706a020f6302f9232d95b79786faa6cd86c6">plugin_strategy</a>);</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;  _plugin = NULL;</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;  set_recombination_scheme(recomb_scheme_in);</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;  set_extra_param(0.0); <span class="comment">// make sure it&#39;s defined</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;}</div>
<div class="line"><a name="l03380"></a><span class="lineno"><a class="code" href="../../dc/d1c/classJetDefinition.html#afe6952777a46e50dede66143e6114d96"> 3380</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dc/d1c/classJetDefinition.html#afe6952777a46e50dede66143e6114d96">JetDefinition::is_spherical</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;  <span class="keywordflow">if</span> (jet_algorithm() == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da0f4ccd310da98c68cf34a32358d1aebe">plugin_algorithm</a>) {</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    <span class="keywordflow">return</span> plugin()-&gt;is_spherical();</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    <span class="keywordflow">return</span> (jet_algorithm() == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daedcd9d5d70df13ae53dcb27d5aad15c8">ee_kt_algorithm</a> ||  <span class="comment">// as of 2013-02-14, the two</span></div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;            jet_algorithm() == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da89441525addfaac095772d0c60aa18c7">ee_genkt_algorithm</a>  <span class="comment">// native spherical algorithms</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;            );</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;  }</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;}</div>
<div class="line"><a name="l03389"></a><span class="lineno"><a class="code" href="../../dc/d1c/classJetDefinition.html#aac916c25ae728010896212412097cf12"> 3389</a></span>&#160;<span class="keywordtype">string</span> <a class="code" href="../../dc/d1c/classJetDefinition.html#aac916c25ae728010896212412097cf12">JetDefinition::description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;  ostringstream <a class="code" href="../../dc/d3a/namespaceperf__headwind.html#a3c3a6fb35b8e673951d58558de221069">name</a>;</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;  name &lt;&lt; description_no_recombiner();</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;  <span class="keywordflow">if</span> ((jet_algorithm() == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da0f4ccd310da98c68cf34a32358d1aebe">plugin_algorithm</a>) || (jet_algorithm() == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da23a92de064c0f24fa0cce6bd68a0155d">undefined_jet_algorithm</a>)){</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;    <span class="keywordflow">return</span> name.str();</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;  }</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;  <span class="keywordflow">if</span> (n_parameters_for_algorithm(jet_algorithm()) == 0)</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;    name &lt;&lt; <span class="stringliteral">&quot; with &quot;</span>;</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;  <span class="keywordflow">else</span> </div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;    name &lt;&lt; <span class="stringliteral">&quot; and &quot;</span>;</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;  name &lt;&lt; recombiner()-&gt;description();</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;  <span class="keywordflow">return</span> name.str();</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;}</div>
<div class="line"><a name="l03402"></a><span class="lineno"><a class="code" href="../../dc/d1c/classJetDefinition.html#a9119f757cde03b7a232b16eecb09a134"> 3402</a></span>&#160;<span class="keywordtype">string</span> <a class="code" href="../../dc/d1c/classJetDefinition.html#a9119f757cde03b7a232b16eecb09a134">JetDefinition::description_no_recombiner</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;  ostringstream <a class="code" href="../../dc/d3a/namespaceperf__headwind.html#a3c3a6fb35b8e673951d58558de221069">name</a>;</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;  <span class="keywordflow">if</span> (jet_algorithm() == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da0f4ccd310da98c68cf34a32358d1aebe">plugin_algorithm</a>) {</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;    <span class="keywordflow">return</span> plugin()-&gt;description();</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (jet_algorithm() == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da23a92de064c0f24fa0cce6bd68a0155d">undefined_jet_algorithm</a>) {</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;uninitialised JetDefinition (jet_algorithm=undefined_jet_algorithm)&quot;</span> ;</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;  }</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;  name &lt;&lt; algorithm_description(jet_algorithm());</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;  <span class="keywordflow">switch</span> (n_parameters_for_algorithm(jet_algorithm())){</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;  <span class="keywordflow">case</span> 0: name &lt;&lt; <span class="stringliteral">&quot; (NB: no R)&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;  <span class="keywordflow">case</span> 1: name &lt;&lt; <span class="stringliteral">&quot; with R = &quot;</span> &lt;&lt; <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#ae59b76c1f970dcff51a86a3151204764">R</a>(); <span class="keywordflow">break</span>; <span class="comment">// the parameter is always R</span></div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;  <span class="keywordflow">case</span> 2: </div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;    name &lt;&lt; <span class="stringliteral">&quot; with R = &quot;</span> &lt;&lt; <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#ae59b76c1f970dcff51a86a3151204764">R</a>();</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    <span class="keywordflow">if</span> (jet_algorithm() == <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daae377c765c182e6777f0063d1912e368">cambridge_for_passive_algorithm</a>){</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;      name &lt;&lt; <span class="stringliteral">&quot;and a special hack whereby particles with kt &lt; &quot;</span> </div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;           &lt;&lt; extra_param() &lt;&lt; <span class="stringliteral">&quot;are treated as passive ghosts&quot;</span>;</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;      name &lt;&lt; <span class="stringliteral">&quot;, p = &quot;</span> &lt;&lt; extra_param();</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;    }</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;  };</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;  <span class="keywordflow">return</span> name.str();</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;}</div>
<div class="line"><a name="l03424"></a><span class="lineno"><a class="code" href="../../dc/d1c/classJetDefinition.html#a8166ef5f8ba220e8488b094cc57348b9"> 3424</a></span>&#160;<span class="keywordtype">string</span> <a class="code" href="../../dc/d1c/classJetDefinition.html#a8166ef5f8ba220e8488b094cc57348b9">JetDefinition::algorithm_description</a>(<span class="keyword">const</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93d">JetAlgorithm</a> jet_alg){</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;  ostringstream <a class="code" href="../../dc/d3a/namespaceperf__headwind.html#a3c3a6fb35b8e673951d58558de221069">name</a>;</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;  <span class="keywordflow">switch</span> (jet_alg){</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da0f4ccd310da98c68cf34a32358d1aebe">plugin_algorithm</a>:                <span class="keywordflow">return</span> <span class="stringliteral">&quot;plugin algorithm&quot;</span>;</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dad58af04e42221347e2730c01a1013e80">kt_algorithm</a>:                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Longitudinally invariant kt algorithm&quot;</span>;</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae74f7a9631ca0ca733320e8a53deb001">cambridge_algorithm</a>:             <span class="keywordflow">return</span> <span class="stringliteral">&quot;Longitudinally invariant Cambridge/Aachen algorithm&quot;</span>;</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da96b6868b5a3c7ef0b91e3baaf3833553">antikt_algorithm</a>:                <span class="keywordflow">return</span> <span class="stringliteral">&quot;Longitudinally invariant anti-kt algorithm&quot;</span>;</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae0cc2363837432381a7982a3c8b3121d">genkt_algorithm</a>:                 <span class="keywordflow">return</span> <span class="stringliteral">&quot;Longitudinally invariant generalised kt algorithm&quot;</span>;</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daae377c765c182e6777f0063d1912e368">cambridge_for_passive_algorithm</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;Longitudinally invariant Cambridge/Aachen algorithm&quot;</span>;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daedcd9d5d70df13ae53dcb27d5aad15c8">ee_kt_algorithm</a>:                 <span class="keywordflow">return</span> <span class="stringliteral">&quot;e+e- kt (Durham) algorithm (NB: no R)&quot;</span>;</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da89441525addfaac095772d0c60aa18c7">ee_genkt_algorithm</a>:              <span class="keywordflow">return</span> <span class="stringliteral">&quot;e+e- generalised kt algorithm&quot;</span>;</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da23a92de064c0f24fa0cce6bd68a0155d">undefined_jet_algorithm</a>:         <span class="keywordflow">return</span> <span class="stringliteral">&quot;undefined jet algorithm&quot;</span>;</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;JetDefinition::algorithm_description(): unrecognized jet_algorithm&quot;</span>);</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;  };</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;}</div>
<div class="line"><a name="l03440"></a><span class="lineno"><a class="code" href="../../dc/d1c/classJetDefinition.html#a9767f88e4bfb9db0cfa273aa4b629558"> 3440</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/d1c/classJetDefinition.html#a9767f88e4bfb9db0cfa273aa4b629558">JetDefinition::n_parameters_for_algorithm</a>(<span class="keyword">const</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93d">JetAlgorithm</a> jet_alg){</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;  <span class="keywordflow">switch</span> (jet_alg) {</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93daedcd9d5d70df13ae53dcb27d5aad15c8">ee_kt_algorithm</a>:    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93dae0cc2363837432381a7982a3c8b3121d">genkt_algorithm</a>:</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#aab63b8ab22ff040949752ce9f876f93da89441525addfaac095772d0c60aa18c7">ee_genkt_algorithm</a>: <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;  <span class="keywordflow">default</span>:                 <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;  };</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;}</div>
<div class="line"><a name="l03448"></a><span class="lineno"><a class="code" href="../../dc/d1c/classJetDefinition.html#a7c15269d6dceca3f642752b46a8ee8ad"> 3448</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d1c/classJetDefinition.html#a7c15269d6dceca3f642752b46a8ee8ad">JetDefinition::set_recombination_scheme</a>(</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;                               <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490">RecombinationScheme</a> recomb_scheme) {</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;  _default_recombiner = <a class="code" href="../../d2/dc3/classJetDefinition_1_1DefaultRecombiner.html">JetDefinition::DefaultRecombiner</a>(recomb_scheme);</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;  <span class="keywordflow">if</span> (_shared_recombiner) _shared_recombiner.reset();</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;  _recombiner = 0;</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;}</div>
<div class="line"><a name="l03454"></a><span class="lineno"><a class="code" href="../../dc/d1c/classJetDefinition.html#a3265ba4d447756b1c31d3124023d3524"> 3454</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d1c/classJetDefinition.html#aa399dc1f660371fc15487a430e9a33ed">JetDefinition::set_recombiner</a>(<span class="keyword">const</span> JetDefinition &amp;other_jet_def){</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(other_jet_def._recombiner || </div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;         other_jet_def.recombination_scheme() != <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490aaa4df7ba42fcd0a215d3cb9aa31c6366">external_scheme</a>);</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;  <span class="keywordflow">if</span> (other_jet_def._recombiner == 0){</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;    set_recombination_scheme(other_jet_def.recombination_scheme());</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;  }</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;  _recombiner = other_jet_def._recombiner;</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;  _default_recombiner = <a class="code" href="../../d2/dc3/classJetDefinition_1_1DefaultRecombiner.html">DefaultRecombiner</a>(<a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490aaa4df7ba42fcd0a215d3cb9aa31c6366">external_scheme</a>);</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;  _shared_recombiner.reset(other_jet_def._shared_recombiner);</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;}</div>
<div class="line"><a name="l03465"></a><span class="lineno"><a class="code" href="../../dc/d1c/classJetDefinition.html#aa017c17f82302e6ba43d091f89491445"> 3465</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dc/d1c/classJetDefinition.html#aa017c17f82302e6ba43d091f89491445">JetDefinition::has_same_recombiner</a>(<span class="keyword">const</span> JetDefinition &amp;other_jd)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490">RecombinationScheme</a> &amp; scheme = recombination_scheme();</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;  <span class="keywordflow">if</span> (other_jd.recombination_scheme() != scheme) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;  <span class="keywordflow">return</span> (scheme != <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490aaa4df7ba42fcd0a215d3cb9aa31c6366">external_scheme</a>) </div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    || (recombiner() == other_jd.recombiner());</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;}</div>
<div class="line"><a name="l03471"></a><span class="lineno"><a class="code" href="../../dc/d1c/classJetDefinition.html#a84563e5be79ba7e18fcd8ff0fb880988"> 3471</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d1c/classJetDefinition.html#a84563e5be79ba7e18fcd8ff0fb880988">JetDefinition::delete_recombiner_when_unused</a>(){</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;  <span class="keywordflow">if</span> (_recombiner == 0){</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;tried to call JetDefinition::delete_recombiner_when_unused() for a JetDefinition without a user-defined recombination scheme&quot;</span>);</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_shared_recombiner.get()) {</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;Error in JetDefinition::delete_recombiner_when_unused: the recombiner is already scheduled for deletion when unused (or was already set as shared)&quot;</span>);</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;  }</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;  _shared_recombiner.reset(_recombiner);</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;}</div>
<div class="line"><a name="l03479"></a><span class="lineno"><a class="code" href="../../dc/d1c/classJetDefinition.html#ac8a9eb579720aefb7de5610d89f4bb69"> 3479</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d1c/classJetDefinition.html#ac8a9eb579720aefb7de5610d89f4bb69">JetDefinition::delete_plugin_when_unused</a>(){</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;  <span class="keywordflow">if</span> (_plugin == 0){</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;tried to call JetDefinition::delete_plugin_when_unused() for a JetDefinition without a plugin&quot;</span>);</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;  }</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;  _plugin_shared.reset(_plugin);</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;}</div>
<div class="line"><a name="l03485"></a><span class="lineno"><a class="code" href="../../d2/dc3/classJetDefinition_1_1DefaultRecombiner.html#a7f9df7b694f398ec43d2e6190ac6eb0b"> 3485</a></span>&#160;<span class="keywordtype">string</span> <a class="code" href="../../d2/dc3/classJetDefinition_1_1DefaultRecombiner.html#a7f9df7b694f398ec43d2e6190ac6eb0b">JetDefinition::DefaultRecombiner::description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="../../d2/dc3/classJetDefinition_1_1DefaultRecombiner.html#a63b7eb28cf3312e75e7116b1edcf7313">_recomb_scheme</a>) {</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490a64978fea61650f1d5330ecaea413dbdb">E_scheme</a>:</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;E scheme recombination&quot;</span>;</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490aa59cf7f9b0203c4451e93fe110e7d82e">pt_scheme</a>:</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;pt scheme recombination&quot;</span>;</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490aa57e7cea38208eb7d9edc107d15d207b">pt2_scheme</a>:</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;pt2 scheme recombination&quot;</span>;</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490a8d79ad768071e988b17903ca1679317b">Et_scheme</a>:</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Et scheme recombination&quot;</span>;</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490a35a37b2335f10240ace313e416fb1f0d">Et2_scheme</a>:</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Et2 scheme recombination&quot;</span>;</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490abe65844458f98af3a3f4bacdb0d7d694">BIpt_scheme</a>:</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;boost-invariant pt scheme recombination&quot;</span>;</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490a127e859422d8cd70b6dc430c561a125c">BIpt2_scheme</a>:</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;boost-invariant pt2 scheme recombination&quot;</span>;</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490af314709be09112425b7820255b328cd0">WTA_pt_scheme</a>:</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;pt-ordered Winner-Takes-All recombination&quot;</span>;</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490aa5cabf0f4b56d0b4e16442b839276123">WTA_modp_scheme</a>:</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;|3-momentum|-ordered Winner-Takes-All recombination&quot;</span>;</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;    ostringstream <a class="code" href="../../d7/dc7/namespacecheck__license.html#a5d6111870e0d2f540b9458f3674194ff">err</a>;</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;DefaultRecombiner: unrecognized recombination scheme &quot;</span> </div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;        &lt;&lt; <a class="code" href="../../d2/dc3/classJetDefinition_1_1DefaultRecombiner.html#a63b7eb28cf3312e75e7116b1edcf7313">_recomb_scheme</a>;</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(err.str());</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;  }</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;}</div>
<div class="line"><a name="l03512"></a><span class="lineno"><a class="code" href="../../d2/dc3/classJetDefinition_1_1DefaultRecombiner.html#a4a703e63bd4e8370ce1d4ed7f136cb15"> 3512</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dc3/classJetDefinition_1_1DefaultRecombiner.html#a4a703e63bd4e8370ce1d4ed7f136cb15">JetDefinition::DefaultRecombiner::recombine</a>(</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;           <span class="keyword">const</span> PseudoJet &amp; pa, <span class="keyword">const</span> PseudoJet &amp; pb,</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;           PseudoJet &amp; pab)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;  <span class="keywordtype">double</span> weighta, weightb;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;  <span class="keywordflow">switch</span>(_recomb_scheme) {</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490a64978fea61650f1d5330ecaea413dbdb">E_scheme</a>:</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;    pab.reset(pa.px()+pb.px(),</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;              pa.py()+pb.py(),</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;              pa.pz()+pb.pz(),</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;              pa.E ()+pb.E ());</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490aa59cf7f9b0203c4451e93fe110e7d82e">pt_scheme</a>:</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490a8d79ad768071e988b17903ca1679317b">Et_scheme</a>:</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490abe65844458f98af3a3f4bacdb0d7d694">BIpt_scheme</a>:</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;    weighta = pa.perp(); </div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;    weightb = pb.perp();</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490aa57e7cea38208eb7d9edc107d15d207b">pt2_scheme</a>:</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490a35a37b2335f10240ace313e416fb1f0d">Et2_scheme</a>:</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490a127e859422d8cd70b6dc430c561a125c">BIpt2_scheme</a>:</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;    weighta = pa.perp2(); </div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;    weightb = pb.perp2();</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490af314709be09112425b7820255b328cd0">WTA_pt_scheme</a>:{</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;    <span class="keyword">const</span> PseudoJet &amp; phard = (pa.pt2() &gt;= pb.pt2()) ? pa : pb;</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;    pab.reset_PtYPhiM(pa.pt()+pb.pt(), </div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;                      phard.rap(), phard.phi(), phard.m());</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;    <span class="keywordflow">return</span>;}</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490aa5cabf0f4b56d0b4e16442b839276123">WTA_modp_scheme</a>:{</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;    <span class="keywordtype">bool</span> a_hardest = (pa.modp2() &gt;= pb.modp2());</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;    <span class="keyword">const</span> PseudoJet &amp; phard = a_hardest ? pa : pb;</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    <span class="keyword">const</span> PseudoJet &amp; psoft = a_hardest ? pb : pa;</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    <span class="keywordtype">double</span> modp_hard = phard.modp();</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    <span class="keywordtype">double</span> modp_ab = modp_hard + psoft.modp();</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;    <span class="keywordflow">if</span> (phard.modp2()==0.0){</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;      pab.reset(0.0, 0.0, 0.0, phard.m());</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;      <span class="keywordtype">double</span> scale = modp_ab/modp_hard;</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;      pab.reset(phard.px()*scale, phard.py()*scale, phard.pz()*scale,</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;                sqrt(modp_ab*modp_ab + phard.m2()));</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    }</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;    <span class="keywordflow">return</span>;}</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;    ostringstream <a class="code" href="../../d7/dc7/namespacecheck__license.html#a5d6111870e0d2f540b9458f3674194ff">err</a>;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;DefaultRecombiner: unrecognized recombination scheme &quot;</span> </div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;        &lt;&lt; _recomb_scheme;</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(err.str());</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;  }</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;  <span class="keywordtype">double</span> perp_ab = pa.perp() + pb.perp();</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;  <span class="keywordflow">if</span> (perp_ab != 0.0) { <span class="comment">// weights also non-zero...</span></div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;    <span class="keywordtype">double</span> y_ab    = (weighta * pa.rap() + weightb * pb.rap())/(weighta+weightb);</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    <span class="keywordtype">double</span> phi_a = pa.phi(), phi_b = pb.phi();</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    <span class="keywordflow">if</span> (phi_a - phi_b &gt; <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>)  phi_b += <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>;</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    <span class="keywordflow">if</span> (phi_a - phi_b &lt; -<a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>) phi_b -= <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>;</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;    <span class="keywordtype">double</span> phi_ab = (weighta * phi_a + weightb * phi_b)/(weighta+weightb);</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    pab.reset_PtYPhiM(perp_ab,y_ab,phi_ab);</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">// weights are zero</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;    pab.reset(0.0, 0.0, 0.0, 0.0);</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;  }</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;}</div>
<div class="line"><a name="l03572"></a><span class="lineno"><a class="code" href="../../d2/dc3/classJetDefinition_1_1DefaultRecombiner.html#ad16e17069aa92550e87fcac6ed139ce8"> 3572</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dc3/classJetDefinition_1_1DefaultRecombiner.html#ad16e17069aa92550e87fcac6ed139ce8">JetDefinition::DefaultRecombiner::preprocess</a>(PseudoJet &amp; <a class="code" href="../../dc/d78/namespacemerge__hashes.html#a63313c3a4f2b0cb6f7cea830c9ff269d">p</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;  <span class="keywordflow">switch</span>(_recomb_scheme) {</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490a64978fea61650f1d5330ecaea413dbdb">E_scheme</a>:</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490abe65844458f98af3a3f4bacdb0d7d694">BIpt_scheme</a>:</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490a127e859422d8cd70b6dc430c561a125c">BIpt2_scheme</a>:</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490af314709be09112425b7820255b328cd0">WTA_pt_scheme</a>:</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490aa5cabf0f4b56d0b4e16442b839276123">WTA_modp_scheme</a>:</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490aa59cf7f9b0203c4451e93fe110e7d82e">pt_scheme</a>:</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490aa57e7cea38208eb7d9edc107d15d207b">pt2_scheme</a>:</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    {</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;      <span class="keywordtype">double</span> newE = sqrt(p.perp2()+p.pz()*p.pz());</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;      p.reset_momentum(p.px(), p.py(), p.pz(), newE);</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    }</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490a8d79ad768071e988b17903ca1679317b">Et_scheme</a>:</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a758f0736442d35efcda9ef796b83c490a35a37b2335f10240ace313e416fb1f0d">Et2_scheme</a>:</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    {</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;      <span class="keywordtype">double</span> rescale = p.E()/sqrt(p.perp2()+p.pz()*p.pz());</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;      p.reset_momentum(rescale*p.px(), rescale*p.py(), rescale*p.pz(), p.E());</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;    }</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    ostringstream <a class="code" href="../../d7/dc7/namespacecheck__license.html#a5d6111870e0d2f540b9458f3674194ff">err</a>;</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;DefaultRecombiner: unrecognized recombination scheme &quot;</span> </div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;        &lt;&lt; _recomb_scheme;</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(err.str());</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;  }</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;}</div>
<div class="line"><a name="l03601"></a><span class="lineno"><a class="code" href="../../db/deb/classJetDefinition_1_1Plugin.html#a39dbf14a0a7583ea7c480df05dcab10a"> 3601</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/deb/classJetDefinition_1_1Plugin.html#a39dbf14a0a7583ea7c480df05dcab10a">JetDefinition::Plugin::set_ghost_separation_scale</a>(<span class="keywordtype">double</span> <span class="comment">/*scale*/</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;set_ghost_separation_scale not supported&quot;</span>);</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;}</div>
<div class="line"><a name="l03604"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc"> 3604</a></span>&#160;PseudoJet <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(<span class="keyword">const</span> vector&lt;PseudoJet&gt; &amp; pieces, <span class="keyword">const</span> <a class="code" href="../../d2/d7e/classJetDefinition_1_1Recombiner.html">JetDefinition::Recombiner</a> &amp; <a class="code" href="../../dc/d1c/classJetDefinition.html#ab7c1f6eb174dc4c595fee5a2bb8c3407">recombiner</a>){</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;  PseudoJet result;  <span class="comment">// automatically initialised to 0</span></div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;  <span class="keywordflow">if</span> (pieces.size()&gt;0){</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    result = pieces[0];</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=1; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt;pieces.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++)</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;      recombiner.<a class="code" href="../../d2/d7e/classJetDefinition_1_1Recombiner.html#ab464439a588af8626f46edb659103674">plus_equal</a>(result, pieces[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;  }</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;  <a class="code" href="../../df/d74/classCompositeJetStructure.html">CompositeJetStructure</a> *cj_struct = <span class="keyword">new</span> <a class="code" href="../../df/d74/classCompositeJetStructure.html">CompositeJetStructure</a>(pieces, &amp;recombiner);</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;  result.set_structure_shared_ptr(<a class="code" href="../../d7/d15/classSharedPtr.html">SharedPtr&lt;PseudoJetStructureBase&gt;</a>(cj_struct));</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;}</div>
<div class="line"><a name="l03615"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a42f3e7ff4b949572f7e688a49fad370e"> 3615</a></span>&#160;PseudoJet <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(<span class="keyword">const</span> PseudoJet &amp; j1, </div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;               <span class="keyword">const</span> <a class="code" href="../../d2/d7e/classJetDefinition_1_1Recombiner.html">JetDefinition::Recombiner</a> &amp; <a class="code" href="../../dc/d1c/classJetDefinition.html#ab7c1f6eb174dc4c595fee5a2bb8c3407">recombiner</a>){</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(vector&lt;PseudoJet&gt;(1,j1), recombiner);</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;}</div>
<div class="line"><a name="l03619"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#ad6e26e032e77d3da94664e5c8e3cee47"> 3619</a></span>&#160;PseudoJet <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(<span class="keyword">const</span> PseudoJet &amp; j1, <span class="keyword">const</span> PseudoJet &amp; j2, </div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;               <span class="keyword">const</span> <a class="code" href="../../d2/d7e/classJetDefinition_1_1Recombiner.html">JetDefinition::Recombiner</a> &amp; <a class="code" href="../../dc/d1c/classJetDefinition.html#ab7c1f6eb174dc4c595fee5a2bb8c3407">recombiner</a>){</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;  vector&lt;PseudoJet&gt; pieces;</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;  pieces.push_back(j1);</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;  pieces.push_back(j2);</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(pieces, recombiner);</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;}</div>
<div class="line"><a name="l03626"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a6e6f6159cf2860644989d7c5d7abe8c8"> 3626</a></span>&#160;PseudoJet <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(<span class="keyword">const</span> PseudoJet &amp; j1, <span class="keyword">const</span> PseudoJet &amp; j2, <span class="keyword">const</span> PseudoJet &amp; j3, </div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;               <span class="keyword">const</span> <a class="code" href="../../d2/d7e/classJetDefinition_1_1Recombiner.html">JetDefinition::Recombiner</a> &amp; <a class="code" href="../../dc/d1c/classJetDefinition.html#ab7c1f6eb174dc4c595fee5a2bb8c3407">recombiner</a>){</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;  vector&lt;PseudoJet&gt; pieces;</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;  pieces.push_back(j1);</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;  pieces.push_back(j2);</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;  pieces.push_back(j3);</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(pieces, recombiner);</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;}</div>
<div class="line"><a name="l03634"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a37c9e7c2911f3fe8f0f07fe8d5e184f9"> 3634</a></span>&#160;PseudoJet <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(<span class="keyword">const</span> PseudoJet &amp; j1, <span class="keyword">const</span> PseudoJet &amp; j2, <span class="keyword">const</span> PseudoJet &amp; j3, <span class="keyword">const</span> PseudoJet &amp; j4,</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;               <span class="keyword">const</span> <a class="code" href="../../d2/d7e/classJetDefinition_1_1Recombiner.html">JetDefinition::Recombiner</a> &amp; <a class="code" href="../../dc/d1c/classJetDefinition.html#ab7c1f6eb174dc4c595fee5a2bb8c3407">recombiner</a>){</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;  vector&lt;PseudoJet&gt; pieces;</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;  pieces.push_back(j1);</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;  pieces.push_back(j2);</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;  pieces.push_back(j3);</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;  pieces.push_back(j4);</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(pieces, recombiner);</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;}</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a></div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;ostream * <a class="code" href="../../d8/de2/classLimitedWarning.html#a8145cd3a774c320c32b74f61f9048b1d">LimitedWarning::_default_ostr</a> = &amp;cerr;</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;std::list&lt; LimitedWarning::Summary &gt; <a class="code" href="../../d8/de2/classLimitedWarning.html#af662e28036e264e5a03995ec9decd301">LimitedWarning::_global_warnings_summary</a>;</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d8/de2/classLimitedWarning.html#a73c6eea8d941b045394532f0f7ed04b7">LimitedWarning::_max_warn_default</a> = 5;</div>
<div class="line"><a name="l03651"></a><span class="lineno"><a class="code" href="../../d8/de2/classLimitedWarning.html#aa05cc6acd20cd0eec3a33c701681d922"> 3651</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de2/classLimitedWarning.html#ac858b637107072e00c5bdb32a6ff056e">LimitedWarning::warn</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * warning, std::ostream * ostr) {</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;  <span class="keywordflow">if</span> (_this_warning_summary == 0) {</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;    _global_warnings_summary.push_back(<a class="code" href="../../d7/d3c/Summary_8C.html#ae0eb25a38b2d167ff37fdbd187e54526">Summary</a>(warning, 0));</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;    _this_warning_summary = &amp; (_global_warnings_summary.back());</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;  }</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;  <span class="keywordflow">if</span> (_n_warn_so_far &lt; _max_warn) {</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;    ostringstream warnstr;</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    warnstr &lt;&lt; <span class="stringliteral">&quot;WARNING from FastJet: &quot;</span>;</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;    warnstr &lt;&lt; warning;</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;    _n_warn_so_far++;</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;    <span class="keywordflow">if</span> (_n_warn_so_far == _max_warn) warnstr &lt;&lt; <span class="stringliteral">&quot; (LAST SUCH WARNING)&quot;</span>;</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;    warnstr &lt;&lt; std::endl;</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;    <span class="keywordflow">if</span> (ostr) {</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;      (*ostr) &lt;&lt; warnstr.str();</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;      ostr-&gt;flush(); <span class="comment">// get something written to file even if the program aborts</span></div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;    }</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;  }</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;  <span class="keywordflow">if</span> (_this_warning_summary-&gt;second &lt; numeric_limits&lt;unsigned&gt;::max()) {</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;    _this_warning_summary-&gt;second++;</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;  }</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;}</div>
<div class="line"><a name="l03672"></a><span class="lineno"><a class="code" href="../../d8/de2/classLimitedWarning.html#ae2df8b168dd5fe0f63bada7e6f921d88"> 3672</a></span>&#160;<span class="keywordtype">string</span> <a class="code" href="../../d8/de2/classLimitedWarning.html#ae2df8b168dd5fe0f63bada7e6f921d88">LimitedWarning::summary</a>() {</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;  ostringstream <a class="code" href="../../d7/d38/ZipTests_8cpp.html#a2a98c1fe01d4f15bb6333773fbbe879c">str</a>;</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;  <span class="keywordflow">for</span> (list&lt;Summary&gt;::const_iterator <a class="code" href="../../d5/d0b/changehitformat_8cc.html#a592a0cf34c13b7b53e37c2791a6a982e">it</a> = _global_warnings_summary.begin();</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;       <a class="code" href="../../d5/d0b/changehitformat_8cc.html#a592a0cf34c13b7b53e37c2791a6a982e">it</a> != _global_warnings_summary.end(); <a class="code" href="../../d5/d0b/changehitformat_8cc.html#a592a0cf34c13b7b53e37c2791a6a982e">it</a>++) {</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;    str &lt;&lt; <a class="code" href="../../d5/d0b/changehitformat_8cc.html#a592a0cf34c13b7b53e37c2791a6a982e">it</a>-&gt;second &lt;&lt; <span class="stringliteral">&quot; times: &quot;</span> &lt;&lt; <a class="code" href="../../d5/d0b/changehitformat_8cc.html#a592a0cf34c13b7b53e37c2791a6a982e">it</a>-&gt;first &lt;&lt; endl;</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;  }</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;  <span class="keywordflow">return</span> str.str();</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;}</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;<span class="preprocessor">#include&lt;cmath&gt;</span></div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;<span class="preprocessor">#include&lt;limits&gt;</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l03686"></a><span class="lineno"><a class="code" href="../../dc/d1f/classMinHeap.html#ab17d0d0299b46930c61adfa52227f10c"> 3686</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d1f/classMinHeap.html#ab17d0d0299b46930c61adfa52227f10c">MinHeap::initialise</a>(<span class="keyword">const</span> std::vector&lt;double&gt; &amp; <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#ac2e84dfba3e54d5f20db9c3f103e4be2">values</a>){</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = values.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; _heap.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;    _heap[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].value = std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    _heap[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].minloc = &amp;(_heap[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;  }</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; values.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;    _heap[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].value = values[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;    _heap[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].minloc = &amp;(_heap[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;  }</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = _heap.size()-1; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &gt; 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>--) {</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;    <a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html">ValueLoc</a> * parent = &amp;(_heap[(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>-1)/2]);</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;    <a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html">ValueLoc</a> * here   = &amp;(_heap[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;    <span class="keywordflow">if</span> (here-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a>-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a768ec10c66593f57c3a768b176b29216">value</a> &lt; parent-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a>-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a768ec10c66593f57c3a768b176b29216">value</a>) {</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;      parent-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a> = here-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a>;</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;    }</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;  }</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;}</div>
<div class="line"><a name="l03703"></a><span class="lineno"><a class="code" href="../../dc/d1f/classMinHeap.html#a389062f6aba4c38b4995271bf0ece469"> 3703</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d1f/classMinHeap.html#a389062f6aba4c38b4995271bf0ece469">MinHeap::update</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/d51/usm_8C.html#aef1c56d2c342eb820980b683b8c35965">loc</a>, <span class="keywordtype">double</span> new_value) {</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(loc &lt; _heap.size());</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;  <a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html">ValueLoc</a> * <a class="code" href="../../d7/dde/ctrl_8cpp.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a> = &amp;(_heap[<a class="code" href="../../d2/d51/usm_8C.html#aef1c56d2c342eb820980b683b8c35965">loc</a>]);</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;  <span class="keywordflow">if</span> (start-&gt;minloc != start &amp;&amp; !(new_value &lt; start-&gt;minloc-&gt;value)) {</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;    start-&gt;value = new_value;</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;  }</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;  start-&gt;value = new_value;</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;  start-&gt;minloc = <a class="code" href="../../d7/dde/ctrl_8cpp.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>;</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;  <span class="keywordtype">bool</span> change_made = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;  <a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html">ValueLoc</a> * heap_end = (&amp;(_heap[0])) + _heap.size();</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;  <span class="keywordflow">while</span>(change_made) {</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    <a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html">ValueLoc</a> * here = &amp;(_heap[<a class="code" href="../../d2/d51/usm_8C.html#aef1c56d2c342eb820980b683b8c35965">loc</a>]);</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;    change_made     = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;    <span class="keywordflow">if</span> (here-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a> == start) {</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;      here-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a> = here; change_made = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;    }</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;    <a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html">ValueLoc</a> * child = &amp;(_heap[2*loc+1]);</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;    <span class="keywordflow">if</span> (child &lt; heap_end &amp;&amp; child-&gt;minloc-&gt;value &lt; here-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a>-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a768ec10c66593f57c3a768b176b29216">value</a> ) {</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;      here-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a> = child-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a>;</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;      change_made = <span class="keyword">true</span>;}</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    child++;</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;    <span class="keywordflow">if</span> (child &lt; heap_end &amp;&amp; child-&gt;minloc-&gt;value &lt; here-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a>-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a768ec10c66593f57c3a768b176b29216">value</a> ) {</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;      here-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a> = child-&gt;<a class="code" href="../../d4/d56/structMinHeap_1_1ValueLoc.html#a84f1a409c8f1ec8299635b0053364bbc">minloc</a>;</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;      change_made = <span class="keyword">true</span>;}</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    <span class="keywordflow">if</span> (loc == 0) {<span class="keywordflow">break</span>;}</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;    loc = (loc-1)/2;</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;  }</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;}</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;<span class="preprocessor">#include&lt;valarray&gt;</span></div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;<span class="preprocessor">#include&lt;sstream&gt;</span></div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;<span class="preprocessor">#include&lt;cmath&gt;</span></div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;<span class="preprocessor">#include&lt;algorithm&gt;</span></div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;<span class="preprocessor">#include &lt;cstdarg&gt;</span></div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;<a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet::PseudoJet</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> px_in, <span class="keyword">const</span> <span class="keywordtype">double</span> py_in, <span class="keyword">const</span> <span class="keywordtype">double</span> pz_in, <span class="keyword">const</span> <span class="keywordtype">double</span> E_in) {</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;  _E  = E_in ;</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;  _px = px_in;</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;  _py = py_in;</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;  _pz = pz_in;</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;  this-&gt;_finish_init();</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;  _reset_indices();</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;}</div>
<div class="line"><a name="l03749"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a4055d2b56c94122f6f39350b54c97051"> 3749</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a4055d2b56c94122f6f39350b54c97051">PseudoJet::_finish_init</a> () {</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;  _kt2 = this-&gt;px()*this-&gt;px() + this-&gt;py()*this-&gt;py();</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;  _phi = <a class="code" href="../../d6/db0/fjcore_8hh.html#ae625ec08df09a247982d6172d76c7cc1">pseudojet_invalid_phi</a>;</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;  _rap = <a class="code" href="../../d6/db0/fjcore_8hh.html#afb9ee98cb88bc781d358adfbab8ccf47">pseudojet_invalid_rap</a>;</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;}</div>
<div class="line"><a name="l03754"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#aff778da442fb162c2ba2d81ea0ba3100"> 3754</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d30/classPseudoJet.html#aff778da442fb162c2ba2d81ea0ba3100">PseudoJet::_set_rap_phi</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;  <span class="keywordflow">if</span> (_kt2 == 0.0) {</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;    _phi = 0.0; } </div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;    _phi = atan2(this-&gt;py(),this-&gt;px());</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;  }</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;  <span class="keywordflow">if</span> (_phi &lt; 0.0) {_phi += <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>;}</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;  <span class="keywordflow">if</span> (_phi &gt;= <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>) {_phi -= <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>;} <span class="comment">// can happen if phi=-|eps&lt;1e-15|?</span></div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dc/d43/Proto2ShowerCalibFit_8m.html#a93b7cb110b782e59ebd44f83181b9e0e" title="Modifier of energy of the particle, fP[6].">E</a>() == abs(this-&gt;pz()) &amp;&amp; _kt2 == 0) {</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;    <span class="keywordtype">double</span> MaxRapHere = <a class="code" href="../../d6/db0/fjcore_8hh.html#a41257cec267f67ea632cba761b151898">MaxRap</a> + abs(this-&gt;pz());</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;    <span class="keywordflow">if</span> (this-&gt;pz() &gt;= 0.0) {_rap = MaxRapHere;} <span class="keywordflow">else</span> {_rap = -MaxRapHere;}</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;    <span class="keywordtype">double</span> effective_m2 = max(0.0,<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a42a562233a5d6d8b02e6321db94c6229">m2</a>()); <span class="comment">// force non tachyonic mass</span></div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;    <span class="keywordtype">double</span> E_plus_pz    = _E + abs(_pz); <span class="comment">// the safer of p+, p-</span></div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;    _rap = 0.5*log((_kt2 + effective_m2)/(E_plus_pz*E_plus_pz));</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;    <span class="keywordflow">if</span> (_pz &gt; 0) {_rap = - _rap;}</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;  }</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;}</div>
<div class="line"><a name="l03772"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a803d3c1e6b0691c5c95616deac64f014"> 3772</a></span>&#160;valarray&lt;double&gt; <a class="code" href="../../dd/d30/classPseudoJet.html#a803d3c1e6b0691c5c95616deac64f014">PseudoJet::four_mom</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;  valarray&lt;double&gt; mom(4);</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;  mom[0] = _px;</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;  mom[1] = _py;</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;  mom[2] = _pz;</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;  mom[3] = _E ;</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;  <span class="keywordflow">return</span> mom;</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;}</div>
<div class="line"><a name="l03780"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a7af990c82bfc99533d317a7071d16ba4"> 3780</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a7af990c82bfc99533d317a7071d16ba4">PseudoJet::operator () </a>(<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;  <span class="keywordflow">switch</span>(i) {</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d4/d89/namespaceTauVsDIS__MachineLearning__Differentiation.html#ad4b212db4eb2404b1a0c93cd8e847ec0">X</a>:</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;    <span class="keywordflow">return</span> px();</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d4/d89/namespaceTauVsDIS__MachineLearning__Differentiation.html#ab473e80a6c9ad394263a594bdb826366">Y</a>:</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;    <span class="keywordflow">return</span> py();</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d3/d67/namespaceSVM__v1.html#aa3a8888ac1af12bb22cec6dacbd64dd1">Z</a>:</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;    <span class="keywordflow">return</span> pz();</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#ae1a6a8868aedfe9a2fa3c3d6d0fae230">T</a>:</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>();</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;    ostringstream <a class="code" href="../../d7/dc7/namespacecheck__license.html#a5d6111870e0d2f540b9458f3674194ff">err</a>;</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;PseudoJet subscripting: bad index (&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(err.str());</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;  }</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;  <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;}  </div>
<div class="line"><a name="l03797"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a0820b29a59b196563b82931f7cb70e5c"> 3797</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a0820b29a59b196563b82931f7cb70e5c">PseudoJet::pseudorapidity</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;  <span class="keywordflow">if</span> (px() == 0.0 &amp;&amp; py() ==0.0) <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a41257cec267f67ea632cba761b151898">MaxRap</a>;</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;  <span class="keywordflow">if</span> (pz() == 0.0) <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/d34/namespaceActsTests_1_1PropagationDatasets.html#a6bf99c39b54ef8ee8852d75bed834249">theta</a> = atan(<a class="code" href="../../df/da1/namespaceActs_1_1VectorHelpers.html#a9d0d7e35444d5f4a0ae7accb0a2c70db">perp</a>()/pz());</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;  <span class="keywordflow">if</span> (theta &lt; 0) theta += <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>;</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;  <span class="keywordflow">return</span> -log(tan(theta/2));</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;}</div>
<div class="line"><a name="l03804"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a81524e1e5f9862cc3095b340ec60ebed"> 3804</a></span>&#160;PseudoJet <a class="code" href="../../d0/d61/PHTimeStamp_8cc.html#aa148fe21fa203ee54be0c34ef8be35ae">operator+ </a>(<span class="keyword">const</span> PseudoJet &amp; jet1, <span class="keyword">const</span> PseudoJet &amp; jet2) {</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;  <span class="keywordflow">return</span> PseudoJet(jet1.px()+jet2.px(),</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;                   jet1.py()+jet2.py(),</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;                   jet1.pz()+jet2.pz(),</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;                   jet1.E() +jet2.E()  );</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;} </div>
<div class="line"><a name="l03810"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a1102c16ab5adf4895bd589e528e34dd4"> 3810</a></span>&#160;PseudoJet <a class="code" href="../../d0/d61/PHTimeStamp_8cc.html#a7e798c97bc574c871fb47fc1e0a614a0">operator- </a>(<span class="keyword">const</span> PseudoJet &amp; jet1, <span class="keyword">const</span> PseudoJet &amp; jet2) {</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;  <span class="keywordflow">return</span> PseudoJet(jet1.px()-jet2.px(),</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;                   jet1.py()-jet2.py(),</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;                   jet1.pz()-jet2.pz(),</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;                   jet1.E() -jet2.E()  );</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;} </div>
<div class="line"><a name="l03816"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a21c5e5345ad908516f32efe62dd26403"> 3816</a></span>&#160;PseudoJet <a class="code" href="../../da/d7b/namespaceActs.html#a75e0f8b70f2049a83af6fcefd0f8093e">operator* </a>(<span class="keywordtype">double</span> coeff, <span class="keyword">const</span> PseudoJet &amp; jet) {</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;  jet._ensure_valid_rap_phi(); </div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;  PseudoJet coeff_times_jet(jet);</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;  coeff_times_jet *= coeff;</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;  <span class="keywordflow">return</span> coeff_times_jet;</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;} </div>
<div class="line"><a name="l03822"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#acad976fee954588d5d9c510e6cf695a0"> 3822</a></span>&#160;PseudoJet <a class="code" href="../../da/d7b/namespaceActs.html#a75e0f8b70f2049a83af6fcefd0f8093e">operator* </a>(<span class="keyword">const</span> PseudoJet &amp; jet, <span class="keywordtype">double</span> coeff) {</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;  <span class="keywordflow">return</span> coeff*jet;</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;} </div>
<div class="line"><a name="l03825"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a795b654e94a8cf22042b8dc0accd14ec"> 3825</a></span>&#160;PseudoJet <a class="code" href="../../d8/d99/fjcore_8cc.html#a702784c745187a21471cda1d60035063">operator/ </a>(<span class="keyword">const</span> PseudoJet &amp; jet, <span class="keywordtype">double</span> coeff) {</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;  <span class="keywordflow">return</span> (1.0/coeff)*jet;</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;} </div>
<div class="line"><a name="l03828"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#ae6f8e3e2b1f65b887e9bc1d537e44d68"> 3828</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ae6f8e3e2b1f65b887e9bc1d537e44d68">PseudoJet::operator*=</a>(<span class="keywordtype">double</span> coeff) {</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;  _ensure_valid_rap_phi(); </div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;  _px *= coeff;</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;  _py *= coeff;</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;  _pz *= coeff;</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;  _E  *= coeff;</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;  _kt2*= coeff*coeff;</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;}</div>
<div class="line"><a name="l03836"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#ab28af52ba19b144573f51a9bcdbb2a49"> 3836</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab28af52ba19b144573f51a9bcdbb2a49">PseudoJet::operator/=</a>(<span class="keywordtype">double</span> coeff) {</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;  (*this) *= 1.0/coeff;</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;}</div>
<div class="line"><a name="l03839"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a04babc2ba8801d050d2f4f97be92e953"> 3839</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a04babc2ba8801d050d2f4f97be92e953">PseudoJet::operator+=</a>(<span class="keyword">const</span> PseudoJet &amp; other_jet) {</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;  _px += other_jet._px;</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;  _py += other_jet._py;</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;  _pz += other_jet._pz;</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;  _E  += other_jet._E ;</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;  _finish_init(); <span class="comment">// we need to recalculate phi,rap,kt2</span></div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;}</div>
<div class="line"><a name="l03846"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#ac749cb8339d8f00c7df2d271f4d6e074"> 3846</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ac749cb8339d8f00c7df2d271f4d6e074">PseudoJet::operator-=</a>(<span class="keyword">const</span> PseudoJet &amp; other_jet) {</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;  _px -= other_jet._px;</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;  _py -= other_jet._py;</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;  _pz -= other_jet._pz;</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;  _E  -= other_jet._E ;</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;  _finish_init(); <span class="comment">// we need to recalculate phi,rap,kt2</span></div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;}</div>
<div class="line"><a name="l03853"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a10cd38917234fa50a1a1280503246495"> 3853</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../da/d7b/namespaceActs.html#a94241ccd802eac63b86136385729a509">operator==</a>(<span class="keyword">const</span> PseudoJet &amp; <a class="code" href="../../d7/da4/namespaceKFPMath.html#a6d2496198d1982fd950acfb79033902b">a</a>, <span class="keyword">const</span> PseudoJet &amp; <a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>) {</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;  <span class="keywordflow">if</span> (a.px() != b.px()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;  <span class="keywordflow">if</span> (a.py() != b.py()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;  <span class="keywordflow">if</span> (a.pz() != b.pz()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;  <span class="keywordflow">if</span> (a.E () != b.E ()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;  <span class="keywordflow">if</span> (a.user_index()    != b.user_index()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;  <span class="keywordflow">if</span> (a.cluster_hist_index() != b.cluster_hist_index()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;  <span class="keywordflow">if</span> (a.user_info_ptr() != b.user_info_ptr()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;  <span class="keywordflow">if</span> (a.structure_ptr() != b.structure_ptr()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;}</div>
<div class="line"><a name="l03864"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#ae6371a0664a6a95037e05abbd2a0b9b3"> 3864</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../da/d7b/namespaceActs.html#a94241ccd802eac63b86136385729a509">operator==</a>(<span class="keyword">const</span> PseudoJet &amp; jet, <span class="keyword">const</span> <span class="keywordtype">double</span> val) {</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;  <span class="keywordflow">if</span> (val != 0) </div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;comparing a PseudoJet with a non-zero constant (double) is not allowed.&quot;</span>);</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;  <span class="keywordflow">return</span> (jet.px() == 0 &amp;&amp; jet.py() == 0 &amp;&amp; </div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;          jet.pz() == 0 &amp;&amp; jet.E() == 0);</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;}</div>
<div class="line"><a name="l03870"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a7eafdd09e82e9279c4ccc928d2d551ac"> 3870</a></span>&#160;PseudoJet &amp; <a class="code" href="../../dd/d30/classPseudoJet.html#a7eafdd09e82e9279c4ccc928d2d551ac">PseudoJet::boost</a>(<span class="keyword">const</span> PseudoJet &amp; prest) {</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;  <span class="keywordflow">if</span> (prest.px() == 0.0 &amp;&amp; prest.py() == 0.0 &amp;&amp; prest.pz() == 0.0) </div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;  <span class="keywordtype">double</span> m_local = prest.m();</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(m_local != 0);</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;  <span class="keywordtype">double</span> pf4  = (  px()*prest.px() + py()*prest.py()</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;                 + pz()*prest.pz() + <a class="code" href="../../dc/d43/Proto2ShowerCalibFit_8m.html#a93b7cb110b782e59ebd44f83181b9e0e" title="Modifier of energy of the particle, fP[6].">E</a>()*prest.E() )/m_local;</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;  <span class="keywordtype">double</span> fn   = (pf4 + <a class="code" href="../../dc/d43/Proto2ShowerCalibFit_8m.html#a93b7cb110b782e59ebd44f83181b9e0e" title="Modifier of energy of the particle, fP[6].">E</a>()) / (prest.E() + m_local);</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;  _px +=  fn*prest.px();</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;  _py +=  fn*prest.py();</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;  _pz +=  fn*prest.pz();</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;  _E = pf4;</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;  _finish_init(); <span class="comment">// we need to recalculate phi,rap,kt2</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;}</div>
<div class="line"><a name="l03885"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a9cb32f1cd64dfe1b1d98bfd5b3ffd9b9"> 3885</a></span>&#160;PseudoJet &amp; <a class="code" href="../../dd/d30/classPseudoJet.html#a9cb32f1cd64dfe1b1d98bfd5b3ffd9b9">PseudoJet::unboost</a>(<span class="keyword">const</span> PseudoJet &amp; prest) {</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;  <span class="keywordflow">if</span> (prest.px() == 0.0 &amp;&amp; prest.py() == 0.0 &amp;&amp; prest.pz() == 0.0) </div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;  <span class="keywordtype">double</span> m_local = prest.m();</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(m_local != 0);</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;  <span class="keywordtype">double</span> pf4  = ( -px()*prest.px() - py()*prest.py()</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;                 - pz()*prest.pz() + <a class="code" href="../../dc/d43/Proto2ShowerCalibFit_8m.html#a93b7cb110b782e59ebd44f83181b9e0e" title="Modifier of energy of the particle, fP[6].">E</a>()*prest.E() )/m_local;</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;  <span class="keywordtype">double</span> fn   = (pf4 + <a class="code" href="../../dc/d43/Proto2ShowerCalibFit_8m.html#a93b7cb110b782e59ebd44f83181b9e0e" title="Modifier of energy of the particle, fP[6].">E</a>()) / (prest.E() + m_local);</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;  _px -=  fn*prest.px();</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;  _py -=  fn*prest.py();</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;  _pz -=  fn*prest.pz();</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;  _E = pf4;</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;  _finish_init(); <span class="comment">// we need to recalculate phi,rap,kt2</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;}</div>
<div class="line"><a name="l03900"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a23d1a9794f89af81f5ba8c59c0017b7b"> 3900</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#acc6487ea900026b60c883a25ec2985e1">have_same_momentum</a>(<span class="keyword">const</span> PseudoJet &amp; jeta, <span class="keyword">const</span> PseudoJet &amp; jetb) {</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;  <span class="keywordflow">return</span> jeta.px() == jetb.px()</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;    &amp;&amp;   jeta.py() == jetb.py()</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;    &amp;&amp;   jeta.pz() == jetb.pz()</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;    &amp;&amp;   jeta.E()  == jetb.E();</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;}</div>
<div class="line"><a name="l03906"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#abee9313ce11ff5eff4a3140a756f56ff"> 3906</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d30/classPseudoJet.html#abee9313ce11ff5eff4a3140a756f56ff">PseudoJet::set_cached_rap_phi</a>(<span class="keywordtype">double</span> rap_in, <span class="keywordtype">double</span> <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a94624f146d416fff98e8592e17ba2426">phi_in</a>) {</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;  _rap = rap_in; _phi = <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a94624f146d416fff98e8592e17ba2426">phi_in</a>;</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;  <span class="keywordflow">if</span> (_phi &gt;= <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>) _phi -= <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>;</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;  <span class="keywordflow">if</span> (_phi &lt; 0)      _phi += <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>;</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;}</div>
<div class="line"><a name="l03911"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#aef196e511f150662fa4f1764727d87c1"> 3911</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d30/classPseudoJet.html#aef196e511f150662fa4f1764727d87c1">PseudoJet::reset_momentum_PtYPhiM</a>(<span class="keywordtype">double</span> pt_in, <span class="keywordtype">double</span> y_in, <span class="keywordtype">double</span> <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a94624f146d416fff98e8592e17ba2426">phi_in</a>, <span class="keywordtype">double</span> m_in) {</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(phi_in &lt; 2*twopi &amp;&amp; phi_in &gt; -<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>);</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;  <span class="keywordtype">double</span> ptm = (m_in == 0) ? pt_in : sqrt(pt_in*pt_in+m_in*m_in);</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;  <span class="keywordtype">double</span> exprap = exp(y_in);</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;  <span class="keywordtype">double</span> pminus = ptm/exprap;</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;  <span class="keywordtype">double</span> pplus  = ptm*exprap;</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;  <span class="keywordtype">double</span> px_local = pt_in*cos(phi_in);</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;  <span class="keywordtype">double</span> py_local = pt_in*sin(phi_in);</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;  reset_momentum(px_local,py_local,0.5*(pplus-pminus),0.5*(pplus+pminus));</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;  set_cached_rap_phi(y_in,phi_in);</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;}</div>
<div class="line"><a name="l03922"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#abce8e46e2899c908e0a3f417ca3d629b"> 3922</a></span>&#160;PseudoJet <a class="code" href="../../d8/d99/fjcore_8cc.html#a48c37566797057ca798bf1b594ae899c">PtYPhiM</a>(<span class="keywordtype">double</span> <a class="code" href="../../da/dfb/namespacephysmon__track__finding__ttbar.html#a7d6c8b4d417ed50c799a1e0fd32d9ce2">pt</a>, <span class="keywordtype">double</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#ab927965981178aa1fba979a37168db2a">y</a>, <span class="keywordtype">double</span> phi, <span class="keywordtype">double</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#aa0b5dd062eddcdda72af1809b341ab0f">m</a>) {</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(phi &lt; 2*twopi &amp;&amp; phi &gt; -<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>);</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;  <span class="keywordtype">double</span> ptm = (m == 0) ? pt : sqrt(pt*pt+m*m);</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;  <span class="keywordtype">double</span> exprap = exp(y);</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;  <span class="keywordtype">double</span> pminus = ptm/exprap;</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;  <span class="keywordtype">double</span> pplus  = ptm*exprap;</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;  <span class="keywordtype">double</span> px = pt*cos(phi);</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;  <span class="keywordtype">double</span> py = pt*sin(phi);</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;  PseudoJet mom(px,py,0.5*(pplus-pminus),0.5*(pplus+pminus));</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;  mom.set_cached_rap_phi(y,phi);</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;  <span class="keywordflow">return</span> mom;</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;}</div>
<div class="line"><a name="l03934"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a27d55f1f8b12d617f04bd3eb54624e90"> 3934</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a27d55f1f8b12d617f04bd3eb54624e90">PseudoJet::kt_distance</a>(<span class="keyword">const</span> PseudoJet &amp; other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d2/d5a/ExaTrkXEdgeBuildingTest_8cpp.html#a6c3fdf667362d0fcd29829e3a34003f8">distance</a> = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(_kt2, other._kt2);</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = abs(<a class="code" href="../../d6/d34/namespaceActsTests_1_1PropagationDatasets.html#a4722f5524134f5f139681f91e6c50038">phi</a>() - other.phi());</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;  <span class="keywordflow">if</span> (dphi &gt; <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>) {dphi = <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> - <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;}</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;  <span class="keywordtype">double</span> drap = rap() - other.rap();</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;  distance = distance * (dphi*dphi + drap*drap);</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d2/d5a/ExaTrkXEdgeBuildingTest_8cpp.html#a6c3fdf667362d0fcd29829e3a34003f8">distance</a>;</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;}</div>
<div class="line"><a name="l03942"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#adbc2ecc9f1cf8614c41e79dea05e96db"> 3942</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#adbc2ecc9f1cf8614c41e79dea05e96db">PseudoJet::plain_distance</a>(<span class="keyword">const</span> PseudoJet &amp; other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = abs(<a class="code" href="../../d6/d34/namespaceActsTests_1_1PropagationDatasets.html#a4722f5524134f5f139681f91e6c50038">phi</a>() - other.phi());</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;  <span class="keywordflow">if</span> (dphi &gt; <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>) {dphi = <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> - <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;}</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;  <span class="keywordtype">double</span> drap = rap() - other.rap();</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;  <span class="keywordflow">return</span> (dphi*dphi + drap*drap);</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;}</div>
<div class="line"><a name="l03948"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a1add85f93c2e0c6f46fa9b7b2df52437"> 3948</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a1add85f93c2e0c6f46fa9b7b2df52437">PseudoJet::delta_phi_to</a>(<span class="keyword">const</span> PseudoJet &amp; other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = other.phi() - <a class="code" href="../../d6/d34/namespaceActsTests_1_1PropagationDatasets.html#a4722f5524134f5f139681f91e6c50038">phi</a>();</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;  <span class="keywordflow">if</span> (dphi &gt;  <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>) dphi -= <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>;</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;  <span class="keywordflow">if</span> (dphi &lt; -<a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>) dphi += <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>;</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;}</div>
<div class="line"><a name="l03954"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a97b4ed3fd1ab4d7f55d0c511db2fdcbd"> 3954</a></span>&#160;<span class="keywordtype">string</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a97b4ed3fd1ab4d7f55d0c511db2fdcbd">PseudoJet::description</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;  <span class="keywordflow">if</span> (!_structure)</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;standard PseudoJet (with no associated clustering information)&quot;</span>;</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;  <span class="keywordflow">return</span> _structure-&gt;description();</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;}</div>
<div class="line"><a name="l03959"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a8db40050bf824580890265d0b257856d"> 3959</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a8db40050bf824580890265d0b257856d">PseudoJet::has_associated_cluster_sequence</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;  <span class="keywordflow">return</span> (_structure) &amp;&amp; (_structure-&gt;has_associated_cluster_sequence());</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;}</div>
<div class="line"><a name="l03962"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#af198a44337034d0cfc158fab880a3917"> 3962</a></span>&#160;<span class="keyword">const</span> ClusterSequence* <a class="code" href="../../dd/d30/classPseudoJet.html#af198a44337034d0cfc158fab880a3917">PseudoJet::associated_cluster_sequence</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;  <span class="keywordflow">if</span> (! has_associated_cluster_sequence()) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;  <span class="keywordflow">return</span> _structure-&gt;associated_cluster_sequence();</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;}</div>
<div class="line"><a name="l03966"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#ad25d9fb5d8a127a9fe5ff25f9845539a"> 3966</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ad25d9fb5d8a127a9fe5ff25f9845539a">PseudoJet::has_valid_cluster_sequence</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;  <span class="keywordflow">return</span> (_structure) &amp;&amp; (_structure-&gt;has_valid_cluster_sequence());</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;}</div>
<div class="line"><a name="l03969"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a4a1e5c6a1bb6daca2eb52240fcac973e"> 3969</a></span>&#160;<span class="keyword">const</span> ClusterSequence * <a class="code" href="../../dd/d30/classPseudoJet.html#a4a1e5c6a1bb6daca2eb52240fcac973e">PseudoJet::validated_cs</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;validated_cs();</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;}</div>
<div class="line"><a name="l03972"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#af302834bcd155770e9d57f78ca90e192"> 3972</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d30/classPseudoJet.html#af302834bcd155770e9d57f78ca90e192">PseudoJet::set_structure_shared_ptr</a>(<span class="keyword">const</span> <a class="code" href="../../d7/d15/classSharedPtr.html">SharedPtr&lt;PseudoJetStructureBase&gt;</a> &amp;structure_in){</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;  _structure = structure_in;</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;}</div>
<div class="line"><a name="l03975"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#ad75e1bf33e1d2d65b8ae0be5871d954e"> 3975</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ad75e1bf33e1d2d65b8ae0be5871d954e">PseudoJet::has_structure</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;  <span class="keywordflow">return</span> bool(_structure);</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;}</div>
<div class="line"><a name="l03978"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a023cbc7d4b669d8340a4a7fc7e88e770"> 3978</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html">PseudoJetStructureBase</a>* <a class="code" href="../../dd/d30/classPseudoJet.html#a023cbc7d4b669d8340a4a7fc7e88e770">PseudoJet::structure_ptr</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;  <span class="keywordflow">return</span> _structure.get();</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;}</div>
<div class="line"><a name="l03981"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a8d678d92d546fc998c4eb1c8f79787b8"> 3981</a></span>&#160;<a class="code" href="../../dc/dee/classPseudoJetStructureBase.html">PseudoJetStructureBase</a>* <a class="code" href="../../dd/d30/classPseudoJet.html#a8d678d92d546fc998c4eb1c8f79787b8">PseudoJet::structure_non_const_ptr</a>(){</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;  <span class="keywordflow">return</span> _structure.get();</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;}</div>
<div class="line"><a name="l03984"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a516d29f11bb95f95d39551bcefea8465"> 3984</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html">PseudoJetStructureBase</a>* <a class="code" href="../../dd/d30/classPseudoJet.html#a516d29f11bb95f95d39551bcefea8465">PseudoJet::validated_structure_ptr</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;  <span class="keywordflow">if</span> (!_structure) </div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;Trying to access the structure of a PseudoJet which has no associated structure&quot;</span>);</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;  <span class="keywordflow">return</span> _structure.get();</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;}</div>
<div class="line"><a name="l03989"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#ae1f1fc414a4a9df421aa20b463863aee"> 3989</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../d7/d15/classSharedPtr.html">SharedPtr&lt;PseudoJetStructureBase&gt;</a> &amp; <a class="code" href="../../dd/d30/classPseudoJet.html#ae1f1fc414a4a9df421aa20b463863aee">PseudoJet::structure_shared_ptr</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;  <span class="keywordflow">return</span> _structure;</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;}</div>
<div class="line"><a name="l03992"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a0513e788eb37807e3011b161da66ebe1"> 3992</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a0513e788eb37807e3011b161da66ebe1">PseudoJet::has_partner</a>(PseudoJet &amp;partner)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;has_partner(*<span class="keyword">this</span>, partner);</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;}</div>
<div class="line"><a name="l03995"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a194832d38aa07df0b9855cbc6a337baf"> 3995</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a194832d38aa07df0b9855cbc6a337baf">PseudoJet::has_child</a>(PseudoJet &amp;child)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;has_child(*<span class="keyword">this</span>, child);</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;}</div>
<div class="line"><a name="l03998"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a2c1bad8cbe1ccd51ddbe22aa3f97fcd8"> 3998</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a2c1bad8cbe1ccd51ddbe22aa3f97fcd8">PseudoJet::has_parents</a>(PseudoJet &amp;parent1, PseudoJet &amp;parent2)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;has_parents(*<span class="keyword">this</span>, parent1, parent2);</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;}</div>
<div class="line"><a name="l04001"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a88877328e1a438e3c4a980c48326ce3b"> 4001</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a88877328e1a438e3c4a980c48326ce3b">PseudoJet::contains</a>(<span class="keyword">const</span> PseudoJet &amp;constituent)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;object_in_jet(constituent, *<span class="keyword">this</span>);</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;}</div>
<div class="line"><a name="l04004"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#af6898ea33b46c076f846017add5bb81c"> 4004</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dd/d30/classPseudoJet.html#af6898ea33b46c076f846017add5bb81c">PseudoJet::is_inside</a>(<span class="keyword">const</span> PseudoJet &amp;jet)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;object_in_jet(*<span class="keyword">this</span>, jet);</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;}</div>
<div class="line"><a name="l04007"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#ac74a5cc61f97926d4db41145c0c54c00"> 4007</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ac74a5cc61f97926d4db41145c0c54c00">PseudoJet::has_constituents</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;  <span class="keywordflow">return</span> (_structure) &amp;&amp; (_structure-&gt;has_constituents());</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;}</div>
<div class="line"><a name="l04010"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a3f23a4d6637dac97e4394d9263c393a1"> 4010</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../dd/d30/classPseudoJet.html#a3f23a4d6637dac97e4394d9263c393a1">PseudoJet::constituents</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;constituents(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;}</div>
<div class="line"><a name="l04013"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a2dc486b0990f38244f838b00d00ac1c3"> 4013</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a2dc486b0990f38244f838b00d00ac1c3">PseudoJet::has_exclusive_subjets</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;  <span class="keywordflow">return</span> (_structure) &amp;&amp; (_structure-&gt;has_exclusive_subjets());</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;}</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../dd/d30/classPseudoJet.html#aa26f1df6327a599cfe142560a62ea0c9">PseudoJet::exclusive_subjets</a> (<span class="keyword">const</span> <span class="keywordtype">double</span> dcut)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;exclusive_subjets(*<span class="keyword">this</span>, dcut);</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;}</div>
<div class="line"><a name="l04019"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#ab32058648ce618e80fc838453b058317"> 4019</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab32058648ce618e80fc838453b058317">PseudoJet::n_exclusive_subjets</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> dcut)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;n_exclusive_subjets(*<span class="keyword">this</span>, dcut);</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;}</div>
<div class="line"><a name="l04022"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a28ea9abe1a211cc9f059faba85a89253"> 4022</a></span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../dd/d30/classPseudoJet.html#a28ea9abe1a211cc9f059faba85a89253">PseudoJet::exclusive_subjets_up_to</a> (<span class="keywordtype">int</span> nsub)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;exclusive_subjets_up_to(*<span class="keyword">this</span>, nsub);</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;}</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../dd/d30/classPseudoJet.html#aa26f1df6327a599cfe142560a62ea0c9">PseudoJet::exclusive_subjets</a> (<span class="keywordtype">int</span> nsub)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;  vector&lt;PseudoJet&gt; subjets = exclusive_subjets_up_to(nsub);</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;  <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(subjets.size()) &lt; nsub) {</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;    ostringstream <a class="code" href="../../d7/dc7/namespacecheck__license.html#a5d6111870e0d2f540b9458f3674194ff">err</a>;</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;Requested &quot;</span> &lt;&lt; nsub &lt;&lt; <span class="stringliteral">&quot; exclusive subjets, but there were only &quot;</span> </div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;        &lt;&lt; subjets.size() &lt;&lt; <span class="stringliteral">&quot; particles in the jet&quot;</span>;</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(err.str());</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;  }</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;  <span class="keywordflow">return</span> subjets;</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;}</div>
<div class="line"><a name="l04035"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a631d3da2d7f715d175ad82394ee5a664"> 4035</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a631d3da2d7f715d175ad82394ee5a664">PseudoJet::exclusive_subdmerge</a>(<span class="keywordtype">int</span> nsub)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;exclusive_subdmerge(*<span class="keyword">this</span>, nsub);</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;}</div>
<div class="line"><a name="l04038"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#ab09867e7feb12daa6def2f7bf1bd280b"> 4038</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab09867e7feb12daa6def2f7bf1bd280b">PseudoJet::exclusive_subdmerge_max</a>(<span class="keywordtype">int</span> nsub)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;exclusive_subdmerge_max(*<span class="keyword">this</span>, nsub);</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;}</div>
<div class="line"><a name="l04041"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#ac9dbca33a7b73e3b97f05383e598cdc4"> 4041</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ac9dbca33a7b73e3b97f05383e598cdc4">PseudoJet::has_pieces</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;  <span class="keywordflow">return</span> ((_structure) &amp;&amp; (_structure-&gt;has_pieces(*<span class="keyword">this</span>)));</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;}</div>
<div class="line"><a name="l04044"></a><span class="lineno"><a class="code" href="../../dd/d30/classPseudoJet.html#a2def08c4fd9e92bcf659ba57a2593085"> 4044</a></span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../dd/d30/classPseudoJet.html#a2def08c4fd9e92bcf659ba57a2593085">PseudoJet::pieces</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;  <span class="keywordflow">return</span> validated_structure_ptr()-&gt;pieces(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;}</div>
<div class="line"><a name="l04047"></a><span class="lineno"><a class="code" href="../../dd/dae/classPseudoJet_1_1InexistentUserInfo.html#a74ad149424e83c50801ce665ac526c8c"> 4047</a></span>&#160;<a class="code" href="../../dd/dae/classPseudoJet_1_1InexistentUserInfo.html#a74ad149424e83c50801ce665ac526c8c">PseudoJet::InexistentUserInfo::InexistentUserInfo</a>() : <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;you attempted to perform a dynamic cast of a PseudoJet&#39;s extra info, but the extra info pointer was null&quot;</span>)</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;{}</div>
<div class="line"><a name="l04049"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a65a79f2d79908eafacf6d809b7bed048"> 4049</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#a50b718e9849a0e65a7ba18238eae7cb0">sort_indices</a>(vector&lt;int&gt; &amp; indices, </div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;                         <span class="keyword">const</span> vector&lt;double&gt; &amp; <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#ac2e84dfba3e54d5f20db9c3f103e4be2">values</a>) {</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;  <a class="code" href="../../d3/db9/classIndexedSortHelper.html">IndexedSortHelper</a> index_sort_helper(&amp;values);</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;  <a class="code" href="../../d2/da5/namespaceActs_1_1Experimental_1_1detail_1_1BlueprintHelper.html#a308a6456db2655fc6a1a916696da20c8" title="Sort the nodes in the blueprint container node.">sort</a>(indices.begin(), indices.end(), index_sort_helper);</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;}</div>
<div class="line"><a name="l04054"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a853e87d0af75ed0873ba452d99b785f6"> 4054</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d8/d99/fjcore_8cc.html#aaa1779308e764374ef0211cf4b7c116b">sorted_by_pt</a>(<span class="keyword">const</span> vector&lt;PseudoJet&gt; &amp; jets) {</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;  vector&lt;double&gt; minus_kt2(jets.size());</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {minus_kt2[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = -jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].kt2();}</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a699fe719dea3330c828ef1aea2a26d91">objects_sorted_by_values</a>(jets, minus_kt2);</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;}</div>
<div class="line"><a name="l04059"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a9372ff88810f4094fd42a6c2671d3080"> 4059</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d8/d99/fjcore_8cc.html#ae97882cd47773d77ab401fc35a0e7554">sorted_by_rapidity</a>(<span class="keyword">const</span> vector&lt;PseudoJet&gt; &amp; jets) {</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;  vector&lt;double&gt; rapidities(jets.size());</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {rapidities[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].rap();}</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a699fe719dea3330c828ef1aea2a26d91">objects_sorted_by_values</a>(jets, rapidities);</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;}</div>
<div class="line"><a name="l04064"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a5ff7ccfaaa8b59ddb5c9957f7e683815"> 4064</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d8/d99/fjcore_8cc.html#a20ce1d78e852147ef59262c13d3ae713">sorted_by_E</a>(<span class="keyword">const</span> vector&lt;PseudoJet&gt; &amp; jets) {</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;  vector&lt;double&gt; energies(jets.size());</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {energies[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = -jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].E();}</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a699fe719dea3330c828ef1aea2a26d91">objects_sorted_by_values</a>(jets, energies);</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;}</div>
<div class="line"><a name="l04069"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a8bf598c777a645671cb0caef3eeff3d7"> 4069</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../d8/d99/fjcore_8cc.html#aa1d1001136f5741ba9baf324e73adada">sorted_by_pz</a>(<span class="keyword">const</span> vector&lt;PseudoJet&gt; &amp; jets) {</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;  vector&lt;double&gt; <a class="code" href="../../dd/d30/classPseudoJet.html#a4dd54da333a59f56b1d163096d4fa2a1">pz</a>(jets.size());</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {<a class="code" href="../../dd/d30/classPseudoJet.html#a4dd54da333a59f56b1d163096d4fa2a1">pz</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].pz();}</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a699fe719dea3330c828ef1aea2a26d91">objects_sorted_by_values</a>(jets, <a class="code" href="../../dd/d30/classPseudoJet.html#a4dd54da333a59f56b1d163096d4fa2a1">pz</a>);</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;}</div>
<div class="line"><a name="l04074"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a5769084fdc5b6471246637b3802149f0"> 4074</a></span>&#160;<a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(<span class="keyword">const</span> vector&lt;PseudoJet&gt; &amp; <a class="code" href="../../dd/d30/classPseudoJet.html#a2def08c4fd9e92bcf659ba57a2593085">pieces</a>){</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;  <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> result;  <span class="comment">// automatically initialised to 0</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt;pieces.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++)</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;    result += pieces[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;  <a class="code" href="../../df/d74/classCompositeJetStructure.html">CompositeJetStructure</a> *cj_struct = <span class="keyword">new</span> <a class="code" href="../../df/d74/classCompositeJetStructure.html">CompositeJetStructure</a>(pieces);</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;  result.set_structure_shared_ptr(<a class="code" href="../../d7/d15/classSharedPtr.html">SharedPtr&lt;PseudoJetStructureBase&gt;</a>(cj_struct));</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;}</div>
<div class="line"><a name="l04082"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a81fde2616dadca9b6acdf99573338c97"> 4082</a></span>&#160;<a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; j1){</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(vector&lt;PseudoJet&gt;(1,j1));</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;}</div>
<div class="line"><a name="l04085"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#acaaa9892910841d74489524ea2b5cedb"> 4085</a></span>&#160;<a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; j1, <span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; j2){</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;  vector&lt;PseudoJet&gt; <a class="code" href="../../dd/d30/classPseudoJet.html#a2def08c4fd9e92bcf659ba57a2593085">pieces</a>;</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;  pieces.reserve(2);</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;  pieces.push_back(j1);</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;  pieces.push_back(j2);</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(pieces);</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;}</div>
<div class="line"><a name="l04092"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#abbba980ed37ceacf8a508032b743b723"> 4092</a></span>&#160;<a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; j1, <span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; j2, <span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; j3){</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;  vector&lt;PseudoJet&gt; <a class="code" href="../../dd/d30/classPseudoJet.html#a2def08c4fd9e92bcf659ba57a2593085">pieces</a>;</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;  pieces.reserve(3);</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;  pieces.push_back(j1);</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;  pieces.push_back(j2);</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;  pieces.push_back(j3);</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(pieces);</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;}</div>
<div class="line"><a name="l04100"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a669428dcdc83021ab40ce1eb69a86bb1"> 4100</a></span>&#160;<a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; j1, <span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; j2, <span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; j3, <span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; j4){</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;  vector&lt;PseudoJet&gt; <a class="code" href="../../dd/d30/classPseudoJet.html#a2def08c4fd9e92bcf659ba57a2593085">pieces</a>;</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;  pieces.reserve(4);</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;  pieces.push_back(j1);</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;  pieces.push_back(j2);</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;  pieces.push_back(j3);</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;  pieces.push_back(j4);</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/d99/fjcore_8cc.html#ace0f2d08f557c8e9e4f5bc645f3de8cc">join</a>(pieces);</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;}</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l04112"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a570fbf6948402ca0d672c54633d09a7f"> 4112</a></span>&#160;<span class="keyword">const</span> ClusterSequence* <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a570fbf6948402ca0d672c54633d09a7f">PseudoJetStructureBase::associated_cluster_sequence</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;}</div>
<div class="line"><a name="l04115"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a5b47130423b536632a0703ce085a58ed"> 4115</a></span>&#160;<span class="keyword">const</span> ClusterSequence * <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a5b47130423b536632a0703ce085a58ed">PseudoJetStructureBase::validated_cs</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;This PseudoJet structure is not associated with a valid ClusterSequence&quot;</span>);</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;}</div>
<div class="line"><a name="l04118"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#ae3b426b58cd7e07e53c0af8d36865791"> 4118</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#ae3b426b58cd7e07e53c0af8d36865791">PseudoJetStructureBase::has_partner</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*reference */</span>, <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*partner*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;This PseudoJet structure has no implementation for has_partner&quot;</span>);</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;}</div>
<div class="line"><a name="l04121"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a8ec7f69b47d15771788a5603d3f477f3"> 4121</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a8ec7f69b47d15771788a5603d3f477f3">PseudoJetStructureBase::has_child</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*reference*/</span>, <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*child*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;This PseudoJet structure has no implementation for has_child&quot;</span>);</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;}</div>
<div class="line"><a name="l04124"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a07cdff63c6ecdd623213370f96a5f6e4"> 4124</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a07cdff63c6ecdd623213370f96a5f6e4">PseudoJetStructureBase::has_parents</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*reference*/</span>, <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp;<span class="comment">/*parent1*/</span>, <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp;<span class="comment">/*parent2*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;This PseudoJet structure has no implementation for has_parents&quot;</span>);</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;}</div>
<div class="line"><a name="l04127"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#aa7b234ef68a9a1f0c3f3c81155ed2a5e"> 4127</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#aa7b234ef68a9a1f0c3f3c81155ed2a5e">PseudoJetStructureBase::object_in_jet</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*reference*/</span>, <span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*jet*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;This PseudoJet structure has no implementation for is_inside&quot;</span>);</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;}</div>
<div class="line"><a name="l04130"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a5a0f76ea7f17eaa5c3206334e8069c7b"> 4130</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a5a0f76ea7f17eaa5c3206334e8069c7b">PseudoJetStructureBase::constituents</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp;<span class="comment">/*reference*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;This PseudoJet structure has no implementation for constituents&quot;</span>);</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;}</div>
<div class="line"><a name="l04133"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#adbccc43ccb42a2574847a0cc17c65be7"> 4133</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#adbccc43ccb42a2574847a0cc17c65be7">PseudoJetStructureBase::exclusive_subjets</a> (<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*reference*/</span>, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; <span class="comment">/*dcut*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;This PseudoJet structure has no implementation for exclusive_subjets&quot;</span>);</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;}</div>
<div class="line"><a name="l04136"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a99e8089bacb1b3b299b278ee98ae9eb6"> 4136</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a99e8089bacb1b3b299b278ee98ae9eb6">PseudoJetStructureBase::n_exclusive_subjets</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*reference*/</span>, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; <span class="comment">/*dcut*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;This PseudoJet structure has no implementation for n_exclusive_subjets&quot;</span>);</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;}</div>
<div class="line"><a name="l04139"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#ac2787c7675efc5f18fb049a64796d1e1"> 4139</a></span>&#160;vector&lt;PseudoJet&gt; <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#ac2787c7675efc5f18fb049a64796d1e1">PseudoJetStructureBase::exclusive_subjets_up_to</a> (<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*reference*/</span>, <span class="keywordtype">int</span> <span class="comment">/*nsub*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;This PseudoJet structure has no implementation for exclusive_subjets&quot;</span>);</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;}</div>
<div class="line"><a name="l04142"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#afa73584b7a4cea0f40440c5e829745c3"> 4142</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#afa73584b7a4cea0f40440c5e829745c3">PseudoJetStructureBase::exclusive_subdmerge</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*reference*/</span>, <span class="keywordtype">int</span> <span class="comment">/*nsub*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;This PseudoJet structure has no implementation for exclusive_submerge&quot;</span>);</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;}</div>
<div class="line"><a name="l04145"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#aec3f8a5fc755b76f0f3968d1fc2c3341"> 4145</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#aec3f8a5fc755b76f0f3968d1fc2c3341">PseudoJetStructureBase::exclusive_subdmerge_max</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*reference*/</span>, <span class="keywordtype">int</span> <span class="comment">/*nsub*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;This PseudoJet structure has no implementation for exclusive_submerge_max&quot;</span>);</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;}</div>
<div class="line"><a name="l04148"></a><span class="lineno"><a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a449c05b426fa5e0c66c39eaf38925e34"> 4148</a></span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../dc/dee/classPseudoJetStructureBase.html#a449c05b426fa5e0c66c39eaf38925e34">PseudoJetStructureBase::pieces</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; <span class="comment">/*reference*/</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;This PseudoJet structure has no implementation for pieces&quot;</span>);  </div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;}</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l04156"></a><span class="lineno"><a class="code" href="../../d1/d54/classSelector.html#a44956a59dca866ab513a8cfa613e3aa2"> 4156</a></span>&#160;std::vector&lt;PseudoJet&gt; <a class="code" href="../../d1/d54/classSelector.html#a9767c83ad25e0d42ecd2bcd8e0567612">Selector::operator()</a>(<span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp; jets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;  std::vector&lt;PseudoJet&gt; result;</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;  <span class="keyword">const</span> SelectorWorker * worker_local = validated_worker();</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;  <span class="keywordflow">if</span> (worker_local-&gt;applies_jet_by_jet()) {</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    <span class="keywordflow">for</span> (std::vector&lt;PseudoJet&gt;::const_iterator jet = jets.begin(); </div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;         jet != jets.end(); jet++) {</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;      <span class="keywordflow">if</span> (worker_local-&gt;pass(*jet)) result.push_back(*jet);</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;    }</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;    std::vector&lt;const PseudoJet *&gt; jetptrs(jets.size());</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;      jetptrs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = &amp; jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;    }</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;    worker_local-&gt;terminator(jetptrs);</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jetptrs.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;      <span class="keywordflow">if</span> (jetptrs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]) result.push_back(jets[i]);</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;    }</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;  }</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;}</div>
<div class="line"><a name="l04176"></a><span class="lineno"><a class="code" href="../../d1/d54/classSelector.html#a496ea6a1153814993af2b99e8992e4c1"> 4176</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d54/classSelector.html#a496ea6a1153814993af2b99e8992e4c1">Selector::count</a>(<span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp; jets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = 0;</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;  <span class="keyword">const</span> SelectorWorker * worker_local = validated_worker();</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;  <span class="keywordflow">if</span> (worker_local-&gt;applies_jet_by_jet()) {</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;      <span class="keywordflow">if</span> (worker_local-&gt;pass(jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>])) n++;</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;    }</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;    std::vector&lt;const PseudoJet *&gt; jetptrs(jets.size());</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;      jetptrs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = &amp; jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;    }</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;    worker_local-&gt;terminator(jetptrs);</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jetptrs.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;      <span class="keywordflow">if</span> (jetptrs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]) n++;</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    }</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;  }</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>;</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;}</div>
<div class="line"><a name="l04195"></a><span class="lineno"><a class="code" href="../../d1/d54/classSelector.html#a7a90aadcba92ac45aa7c58d7207499b8"> 4195</a></span>&#160;<a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> <a class="code" href="../../d1/d54/classSelector.html#a7a90aadcba92ac45aa7c58d7207499b8">Selector::sum</a>(<span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp; jets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;  <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> this_sum(0,0,0,0);</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;  <span class="keyword">const</span> SelectorWorker * worker_local = validated_worker();</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;  <span class="keywordflow">if</span> (worker_local-&gt;applies_jet_by_jet()) {</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;      <span class="keywordflow">if</span> (worker_local-&gt;pass(jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>])) this_sum += jets[i];</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;    }</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;    std::vector&lt;const PseudoJet *&gt; jetptrs(jets.size());</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;      jetptrs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = &amp; jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;    }</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;    worker_local-&gt;terminator(jetptrs);</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jetptrs.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;      <span class="keywordflow">if</span> (jetptrs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]) this_sum += jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;    }</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;  }</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;  <span class="keywordflow">return</span> this_sum;</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;}</div>
<div class="line"><a name="l04214"></a><span class="lineno"><a class="code" href="../../d1/d54/classSelector.html#a90de8051cfcb389f876d5dcabb7447e6"> 4214</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d1/d54/classSelector.html#a90de8051cfcb389f876d5dcabb7447e6">Selector::scalar_pt_sum</a>(<span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp; jets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;  <span class="keywordtype">double</span> this_sum = 0.0;</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;  <span class="keyword">const</span> SelectorWorker * worker_local = validated_worker();</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;  <span class="keywordflow">if</span> (worker_local-&gt;applies_jet_by_jet()) {</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;      <span class="keywordflow">if</span> (worker_local-&gt;pass(jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>])) this_sum += jets[i].<a class="code" href="../../dd/d30/classPseudoJet.html#acf79a067fd3145b6b5ca261fab2d4384">pt</a>();</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;    }</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;    std::vector&lt;const PseudoJet *&gt; jetptrs(jets.size());</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;      jetptrs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = &amp; jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;    }</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;    worker_local-&gt;terminator(jetptrs);</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jetptrs.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;      <span class="keywordflow">if</span> (jetptrs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]) this_sum += jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].pt();</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;    }</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;  }</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;  <span class="keywordflow">return</span> this_sum;</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;}</div>
<div class="line"><a name="l04233"></a><span class="lineno"><a class="code" href="../../d1/d54/classSelector.html#ad83bb32f54d81818beae6a1096d735ac"> 4233</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d54/classSelector.html#ad83bb32f54d81818beae6a1096d735ac">Selector::sift</a>(<span class="keyword">const</span> std::vector&lt;PseudoJet&gt; &amp; jets,</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;                    std::vector&lt;PseudoJet&gt; &amp; jets_that_pass,</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;                    std::vector&lt;PseudoJet&gt; &amp; jets_that_fail</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;                    )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;  <span class="keyword">const</span> SelectorWorker * worker_local = validated_worker();</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;  jets_that_pass.clear();</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;  jets_that_fail.clear();</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;  <span class="keywordflow">if</span> (worker_local-&gt;applies_jet_by_jet()) {</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;      <span class="keywordflow">if</span> (worker_local-&gt;pass(jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>])) {</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;        jets_that_pass.push_back(jets[i]);</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;        jets_that_fail.push_back(jets[i]);</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;      }</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;    }</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;    std::vector&lt;const PseudoJet *&gt; jetptrs(jets.size());</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;      jetptrs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = &amp; jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;    }</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;    worker_local-&gt;terminator(jetptrs);</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; jetptrs.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;      <span class="keywordflow">if</span> (jetptrs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]) {</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;        jets_that_pass.push_back(jets[i]);</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;        jets_that_fail.push_back(jets[i]);</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;      }</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;    }</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;  }</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;}</div>
<div class="line"><a name="l04263"></a><span class="lineno"><a class="code" href="../../da/de9/classSelectorWorker.html#a1e6532ff275b2f3253100f1d763ed214"> 4263</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../da/de9/classSelectorWorker.html#a1e6532ff275b2f3253100f1d763ed214">SelectorWorker::has_finite_area</a>()<span class="keyword"> const </span>{ </div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;  <span class="keywordflow">if</span> (! is_geometric()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;  <span class="keywordtype">double</span> rapmin, rapmax;</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;  get_rapidity_extent(rapmin, rapmax);</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;  <span class="keywordflow">return</span> (rapmax != std::numeric_limits&lt;double&gt;::infinity())</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;    &amp;&amp;  (-rapmin != std::numeric_limits&lt;double&gt;::infinity());</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;}</div>
<div class="line"><a name="l04270"></a><span class="lineno"><a class="code" href="../../d3/db1/classSW__Identity.html"> 4270</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d3/db1/classSW__Identity.html">SW_Identity</a> : <span class="keyword">public</span> SelectorWorker {</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04272"></a><span class="lineno"><a class="code" href="../../d3/db1/classSW__Identity.html#acb4f69b5cb494de02c39ece0b9ccd6ec"> 4272</a></span>&#160;  <a class="code" href="../../d3/db1/classSW__Identity.html#acb4f69b5cb494de02c39ece0b9ccd6ec">SW_Identity</a>(){}</div>
<div class="line"><a name="l04273"></a><span class="lineno"><a class="code" href="../../d3/db1/classSW__Identity.html#ad37a02ddb4c162ebd41ead6d7025e375"> 4273</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d3/db1/classSW__Identity.html#ad37a02ddb4c162ebd41ead6d7025e375">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp;)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;  }</div>
<div class="line"><a name="l04276"></a><span class="lineno"><a class="code" href="../../d3/db1/classSW__Identity.html#a409c287a99200c17e2d021be4d98a845"> 4276</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d3/db1/classSW__Identity.html#a409c287a99200c17e2d021be4d98a845">terminator</a>(vector&lt;const PseudoJet *&gt; &amp;)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;  }</div>
<div class="line"><a name="l04279"></a><span class="lineno"><a class="code" href="../../d3/db1/classSW__Identity.html#a44ced7040f59047a77e5bc2f96ebe4fb"> 4279</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d3/db1/classSW__Identity.html#a44ced7040f59047a77e5bc2f96ebe4fb">description</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;Identity&quot;</span>;}</div>
<div class="line"><a name="l04280"></a><span class="lineno"><a class="code" href="../../d3/db1/classSW__Identity.html#a140ee1a9f9fbf430d3dbc8f48f4cac98"> 4280</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d3/db1/classSW__Identity.html#a140ee1a9f9fbf430d3dbc8f48f4cac98">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;};</div>
<div class="line"><a name="l04282"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#ae88e659c544ed71467efdb62c34a9c22"> 4282</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#ae88e659c544ed71467efdb62c34a9c22">SelectorIdentity</a>() {</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d3/db1/classSW__Identity.html">SW_Identity</a>);</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;}</div>
<div class="line"><a name="l04285"></a><span class="lineno"><a class="code" href="../../dc/d8d/classSW__Not.html"> 4285</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../dc/d8d/classSW__Not.html">SW_Not</a> : <span class="keyword">public</span> <a class="code" href="../../da/de9/classSelectorWorker.html">SelectorWorker</a> {</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04287"></a><span class="lineno"><a class="code" href="../../dc/d8d/classSW__Not.html#add3b1f711acfbc460ca057cc95e13591"> 4287</a></span>&#160;  <a class="code" href="../../dc/d8d/classSW__Not.html#add3b1f711acfbc460ca057cc95e13591">SW_Not</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; <a class="code" href="../../d5/d1e/namespacephysmon__simulation.html#afe07c0feff8b9ad0d479f54ff63a1a0d">s</a>) : _s(s) {}</div>
<div class="line"><a name="l04288"></a><span class="lineno"><a class="code" href="../../dc/d8d/classSW__Not.html#a2faa630ebb0e16bdef95e6472beaf432"> 4288</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="../../da/de9/classSelectorWorker.html">SelectorWorker</a>* <a class="code" href="../../dc/d8d/classSW__Not.html#a2faa630ebb0e16bdef95e6472beaf432">copy</a>(){ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="../../dc/d8d/classSW__Not.html">SW_Not</a>(*<span class="keyword">this</span>);}</div>
<div class="line"><a name="l04289"></a><span class="lineno"><a class="code" href="../../dc/d8d/classSW__Not.html#a6ac332cdb2325d92da4d76945af98e66"> 4289</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../dc/d8d/classSW__Not.html#a6ac332cdb2325d92da4d76945af98e66">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;    <span class="keywordflow">if</span> (!applies_jet_by_jet())</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;Cannot apply this selector worker to an individual jet&quot;</span>);</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;    <span class="keywordflow">return</span> ! _s.pass(jet);</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;  } </div>
<div class="line"><a name="l04294"></a><span class="lineno"><a class="code" href="../../dc/d8d/classSW__Not.html#a2bbb141da36a452a34e22abeac49404d"> 4294</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../dc/d8d/classSW__Not.html#a2bbb141da36a452a34e22abeac49404d">applies_jet_by_jet</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _s.applies_jet_by_jet();}</div>
<div class="line"><a name="l04295"></a><span class="lineno"><a class="code" href="../../dc/d8d/classSW__Not.html#a1d6107f491e1100fe25f92edb2471612"> 4295</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d8d/classSW__Not.html#a1d6107f491e1100fe25f92edb2471612">terminator</a>(vector&lt;const PseudoJet *&gt; &amp; jets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;    <span class="keywordflow">if</span> (applies_jet_by_jet()){</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;      <a class="code" href="../../da/de9/classSelectorWorker.html#a958fe544c3496693139beafdcaa80b9d">SelectorWorker::terminator</a>(jets);</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;    }</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;    vector&lt;const PseudoJet *&gt; s_jets = jets;</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;    _s.worker()-&gt;terminator(s_jets);</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt;s_jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++){</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;      <span class="keywordflow">if</span> (s_jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]) jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = NULL;</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;    }</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;  }</div>
<div class="line"><a name="l04306"></a><span class="lineno"><a class="code" href="../../dc/d8d/classSW__Not.html#ac9be29af21b01c6b7bee2b67277d2496"> 4306</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../dc/d8d/classSW__Not.html#ac9be29af21b01c6b7bee2b67277d2496">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    ostr &lt;&lt; <span class="stringliteral">&quot;!(&quot;</span> &lt;&lt; _s.description() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;  }</div>
<div class="line"><a name="l04311"></a><span class="lineno"><a class="code" href="../../dc/d8d/classSW__Not.html#a27fca7d8f92126d3af5de97350e15af6"> 4311</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../dc/d8d/classSW__Not.html#a27fca7d8f92126d3af5de97350e15af6">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _s.is_geometric();}</div>
<div class="line"><a name="l04312"></a><span class="lineno"><a class="code" href="../../dc/d8d/classSW__Not.html#a7fcbf1af30731b60f7653e90b3085522"> 4312</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../dc/d8d/classSW__Not.html#a7fcbf1af30731b60f7653e90b3085522">takes_reference</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _s.takes_reference();}</div>
<div class="line"><a name="l04313"></a><span class="lineno"><a class="code" href="../../dc/d8d/classSW__Not.html#a3a65d7cf5ba91028c1d00d7eaf97ee1b"> 4313</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d8d/classSW__Not.html#a3a65d7cf5ba91028c1d00d7eaf97ee1b">set_reference</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp;<a class="code" href="../../d2/df6/namespacecheck__smearing__config.html#aa205168f21e7dcfd80fde5c07d7e9ab9">ref</a>) { _s.set_reference(ref);}</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04315"></a><span class="lineno"><a class="code" href="../../dc/d8d/classSW__Not.html#a1f46270a4cfa14b2279c71be0e90979d"> 4315</a></span>&#160;  <a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../dc/d8d/classSW__Not.html#a1f46270a4cfa14b2279c71be0e90979d">_s</a>;</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;};</div>
<div class="line"><a name="l04317"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a97bcadc34483b581ac248b940c923bd7"> 4317</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a97bcadc34483b581ac248b940c923bd7">operator!</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; <a class="code" href="../../d5/d1e/namespacephysmon__simulation.html#afe07c0feff8b9ad0d479f54ff63a1a0d">s</a>) {</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../dc/d8d/classSW__Not.html">SW_Not</a>(s));</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;}</div>
<div class="line"><a name="l04320"></a><span class="lineno"><a class="code" href="../../d3/d7a/classSW__BinaryOperator.html"> 4320</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d3/d7a/classSW__BinaryOperator.html">SW_BinaryOperator</a>: <span class="keyword">public</span> <a class="code" href="../../da/de9/classSelectorWorker.html">SelectorWorker</a> {</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04322"></a><span class="lineno"><a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#a2d60b872e60711fc589ec15188091b24"> 4322</a></span>&#160;  <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#a2d60b872e60711fc589ec15188091b24">SW_BinaryOperator</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s1, <span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s2) : _s1(s1), _s2(s2) {</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;    _applies_jet_by_jet = _s1.applies_jet_by_jet() &amp;&amp; _s2.applies_jet_by_jet();</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;    _takes_reference = _s1.takes_reference() || _s2.takes_reference();</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;    _is_geometric = _s1.is_geometric() &amp;&amp; _s2.is_geometric();</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;  }</div>
<div class="line"><a name="l04327"></a><span class="lineno"><a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#ae8ad0431b1d36fb7efdb854721540f32"> 4327</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#ae8ad0431b1d36fb7efdb854721540f32">applies_jet_by_jet</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _applies_jet_by_jet;}</div>
<div class="line"><a name="l04328"></a><span class="lineno"><a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#a2bbbd6eb5b624a773f6a2755fb9483d0"> 4328</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#a2bbbd6eb5b624a773f6a2755fb9483d0">takes_reference</a>()<span class="keyword"> const</span>{ </div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;    <span class="keywordflow">return</span> _takes_reference;</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;  }</div>
<div class="line"><a name="l04331"></a><span class="lineno"><a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#ae2a7e8d2c8b1384ed90e298316de63c1"> 4331</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#ae2a7e8d2c8b1384ed90e298316de63c1">set_reference</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp;centre){</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;    _s1.set_reference(centre);</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;    _s2.set_reference(centre);</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;  }</div>
<div class="line"><a name="l04335"></a><span class="lineno"><a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#a87ee1a8746819e2b408d0ee61637bec6"> 4335</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#a87ee1a8746819e2b408d0ee61637bec6">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _is_geometric;} </div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04337"></a><span class="lineno"><a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#a840535b58dda0c6fd5814244a4270232"> 4337</a></span>&#160;  <a class="code" href="../../d1/d54/classSelector.html">Selector</a> _s1, <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#a840535b58dda0c6fd5814244a4270232">_s2</a>;</div>
<div class="line"><a name="l04338"></a><span class="lineno"><a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#a356ce801a64354dcb11cdd85f7f25851"> 4338</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#a356ce801a64354dcb11cdd85f7f25851">_applies_jet_by_jet</a>;</div>
<div class="line"><a name="l04339"></a><span class="lineno"><a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#a2f9a6ff9cac6feb61718d7077c2289fb"> 4339</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#a2f9a6ff9cac6feb61718d7077c2289fb">_takes_reference</a>;</div>
<div class="line"><a name="l04340"></a><span class="lineno"><a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#abfd3492c8b48352767676f5143f6297a"> 4340</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html#abfd3492c8b48352767676f5143f6297a">_is_geometric</a>;</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;};</div>
<div class="line"><a name="l04342"></a><span class="lineno"><a class="code" href="../../d8/d21/classSW__And.html"> 4342</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d8/d21/classSW__And.html">SW_And</a>: <span class="keyword">public</span> <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html">SW_BinaryOperator</a> {</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04344"></a><span class="lineno"><a class="code" href="../../d8/d21/classSW__And.html#aa03c7baad30cfdc741be1a69bfcfec88"> 4344</a></span>&#160;  <a class="code" href="../../d8/d21/classSW__And.html#aa03c7baad30cfdc741be1a69bfcfec88">SW_And</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s1, <span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s2) : <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html">SW_BinaryOperator</a>(s1,s2){}</div>
<div class="line"><a name="l04345"></a><span class="lineno"><a class="code" href="../../d8/d21/classSW__And.html#a3fa9ddf1819f2b0ddbfd206aa89045e9"> 4345</a></span>&#160;  <span class="keyword">virtual</span> SelectorWorker* <a class="code" href="../../d8/d21/classSW__And.html#a3fa9ddf1819f2b0ddbfd206aa89045e9">copy</a>(){ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="../../d8/d21/classSW__And.html">SW_And</a>(*<span class="keyword">this</span>);}</div>
<div class="line"><a name="l04346"></a><span class="lineno"><a class="code" href="../../d8/d21/classSW__And.html#a37db26dca63413def690bb058ff7a18e"> 4346</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d8/d21/classSW__And.html#a37db26dca63413def690bb058ff7a18e">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;    <span class="keywordflow">if</span> (!applies_jet_by_jet())</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;Cannot apply this selector worker to an individual jet&quot;</span>);</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;    <span class="keywordflow">return</span> _s1.pass(jet) &amp;&amp; _s2.pass(jet);</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;  }</div>
<div class="line"><a name="l04351"></a><span class="lineno"><a class="code" href="../../d8/d21/classSW__And.html#ae1e532e9566205143925bc761ad548f2"> 4351</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d21/classSW__And.html#ae1e532e9566205143925bc761ad548f2">terminator</a>(vector&lt;const PseudoJet *&gt; &amp; jets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;    <span class="keywordflow">if</span> (applies_jet_by_jet()){</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;      <a class="code" href="../../da/de9/classSelectorWorker.html#a958fe544c3496693139beafdcaa80b9d">SelectorWorker::terminator</a>(jets);</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;    }</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;    vector&lt;const PseudoJet *&gt; s1_jets = jets;</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;    _s1.worker()-&gt;terminator(s1_jets);</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;    _s2.worker()-&gt;terminator(jets);</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt;jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++){</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;      <span class="keywordflow">if</span> (! s1_jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]) jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = NULL;</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;    }</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;  }</div>
<div class="line"><a name="l04363"></a><span class="lineno"><a class="code" href="../../d8/d21/classSW__And.html#aa7832995d6fcbef8cbee62c91b907c4e"> 4363</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d21/classSW__And.html#aa7832995d6fcbef8cbee62c91b907c4e">get_rapidity_extent</a>(<span class="keywordtype">double</span> &amp; rapmin, <span class="keywordtype">double</span> &amp; rapmax)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    <span class="keywordtype">double</span> s1min, s1max, s2min, s2max;</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    _s1.get_rapidity_extent(s1min, s1max);</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;    _s2.get_rapidity_extent(s2min, s2max);</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;    rapmax = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(s1max, s2max);</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;    rapmin = max(s1min, s2min);</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;  }</div>
<div class="line"><a name="l04370"></a><span class="lineno"><a class="code" href="../../d8/d21/classSW__And.html#aadbe7a42ffefe127b3b82645ee0d4f73"> 4370</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d8/d21/classSW__And.html#aadbe7a42ffefe127b3b82645ee0d4f73">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;    ostr &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; _s1.description() &lt;&lt; <span class="stringliteral">&quot; &amp;&amp; &quot;</span> &lt;&lt; _s2.description() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;  }</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;};</div>
<div class="line"><a name="l04376"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#aca9db349c79e0b5581d7a4bbf2b30f13"> 4376</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#aca9db349c79e0b5581d7a4bbf2b30f13">operator&amp;&amp;</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s1, <span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s2) {</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d8/d21/classSW__And.html">SW_And</a>(s1,s2));</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;}</div>
<div class="line"><a name="l04379"></a><span class="lineno"><a class="code" href="../../de/da7/classSW__Or.html"> 4379</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../de/da7/classSW__Or.html">SW_Or</a>: <span class="keyword">public</span> <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html">SW_BinaryOperator</a> {</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04381"></a><span class="lineno"><a class="code" href="../../de/da7/classSW__Or.html#a8df5361e05ac383d0b162b32e79113ff"> 4381</a></span>&#160;  <a class="code" href="../../de/da7/classSW__Or.html#a8df5361e05ac383d0b162b32e79113ff">SW_Or</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s1, <span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s2) : <a class="code" href="../../d3/d7a/classSW__BinaryOperator.html">SW_BinaryOperator</a>(s1,s2) {}</div>
<div class="line"><a name="l04382"></a><span class="lineno"><a class="code" href="../../de/da7/classSW__Or.html#a28045ca4f36c3c67939dc1eb956620fc"> 4382</a></span>&#160;  <span class="keyword">virtual</span> SelectorWorker* <a class="code" href="../../de/da7/classSW__Or.html#a28045ca4f36c3c67939dc1eb956620fc">copy</a>(){ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="../../de/da7/classSW__Or.html">SW_Or</a>(*<span class="keyword">this</span>);}</div>
<div class="line"><a name="l04383"></a><span class="lineno"><a class="code" href="../../de/da7/classSW__Or.html#a8405508663e9bd316e59f9b9668d2955"> 4383</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../de/da7/classSW__Or.html#a8405508663e9bd316e59f9b9668d2955">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;    <span class="keywordflow">if</span> (!applies_jet_by_jet())</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;Cannot apply this selector worker to an individual jet&quot;</span>);</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;    <span class="keywordflow">return</span> _s1.pass(jet) || _s2.pass(jet);</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;  }</div>
<div class="line"><a name="l04388"></a><span class="lineno"><a class="code" href="../../de/da7/classSW__Or.html#a10107b597278ecd7d7c12cbd6c5a0080"> 4388</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../de/da7/classSW__Or.html#a10107b597278ecd7d7c12cbd6c5a0080">applies_jet_by_jet</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;    <span class="keywordflow">return</span> _s1.applies_jet_by_jet() &amp;&amp; _s2.applies_jet_by_jet();</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;  }</div>
<div class="line"><a name="l04391"></a><span class="lineno"><a class="code" href="../../de/da7/classSW__Or.html#af2a2aeb2c99ec2fbe54a5615428d1592"> 4391</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../de/da7/classSW__Or.html#af2a2aeb2c99ec2fbe54a5615428d1592">terminator</a>(vector&lt;const PseudoJet *&gt; &amp; jets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;    <span class="keywordflow">if</span> (applies_jet_by_jet()){</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;      <a class="code" href="../../da/de9/classSelectorWorker.html#a958fe544c3496693139beafdcaa80b9d">SelectorWorker::terminator</a>(jets);</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;    }</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;    vector&lt;const PseudoJet *&gt; s1_jets = jets;</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    _s1.worker()-&gt;terminator(s1_jets);</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;    _s2.worker()-&gt;terminator(jets);</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt;jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++){</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;      <span class="keywordflow">if</span> (s1_jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]) jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = s1_jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;    }</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;  }</div>
<div class="line"><a name="l04403"></a><span class="lineno"><a class="code" href="../../de/da7/classSW__Or.html#ac9bb98db87b04630e81fa82194a59536"> 4403</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../de/da7/classSW__Or.html#ac9bb98db87b04630e81fa82194a59536">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;    ostr &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; _s1.description() &lt;&lt; <span class="stringliteral">&quot; || &quot;</span> &lt;&lt; _s2.description() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;  }</div>
<div class="line"><a name="l04408"></a><span class="lineno"><a class="code" href="../../de/da7/classSW__Or.html#a1736240d67ab8a318b0eb383727e4437"> 4408</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../de/da7/classSW__Or.html#a1736240d67ab8a318b0eb383727e4437">get_rapidity_extent</a>(<span class="keywordtype">double</span> &amp; rapmin, <span class="keywordtype">double</span> &amp; rapmax)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;    <span class="keywordtype">double</span> s1min, s1max, s2min, s2max;</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;    _s1.get_rapidity_extent(s1min, s1max);</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;    _s2.get_rapidity_extent(s2min, s2max);</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;    rapmax = max(s1max, s2max);</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;    rapmin = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a083dd2aecaca88f85c7db3b9d8a123b3">min</a>(s1min, s2min);</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;  }</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;};</div>
<div class="line"><a name="l04416"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#ae78b3b71326573ea84de9dd45c2d6c4d"> 4416</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#ae78b3b71326573ea84de9dd45c2d6c4d">operator ||</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s1, <span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s2) {</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../de/da7/classSW__Or.html">SW_Or</a>(s1,s2));</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;}</div>
<div class="line"><a name="l04419"></a><span class="lineno"><a class="code" href="../../d7/d54/classSW__Mult.html"> 4419</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d7/d54/classSW__Mult.html">SW_Mult</a>: <span class="keyword">public</span> <a class="code" href="../../d8/d21/classSW__And.html">SW_And</a> {</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04421"></a><span class="lineno"><a class="code" href="../../d7/d54/classSW__Mult.html#aae7f07dfd44f23c75b8e80ad95caff23"> 4421</a></span>&#160;  <a class="code" href="../../d7/d54/classSW__Mult.html#aae7f07dfd44f23c75b8e80ad95caff23">SW_Mult</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s1, <span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s2) : <a class="code" href="../../d8/d21/classSW__And.html">SW_And</a>(s1,s2) {}</div>
<div class="line"><a name="l04422"></a><span class="lineno"><a class="code" href="../../d7/d54/classSW__Mult.html#a51a497dd74f005bade5861d198f8b2d2"> 4422</a></span>&#160;  <span class="keyword">virtual</span> SelectorWorker* <a class="code" href="../../d7/d54/classSW__Mult.html#a51a497dd74f005bade5861d198f8b2d2">copy</a>(){ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="../../d7/d54/classSW__Mult.html">SW_Mult</a>(*<span class="keyword">this</span>);}</div>
<div class="line"><a name="l04423"></a><span class="lineno"><a class="code" href="../../d7/d54/classSW__Mult.html#a181b4fab199a40b848884d5b480c8e9d"> 4423</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d54/classSW__Mult.html#a181b4fab199a40b848884d5b480c8e9d">terminator</a>(vector&lt;const PseudoJet *&gt; &amp; jets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;    <span class="keywordflow">if</span> (applies_jet_by_jet()){</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;      <a class="code" href="../../da/de9/classSelectorWorker.html#a958fe544c3496693139beafdcaa80b9d">SelectorWorker::terminator</a>(jets);</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;    }</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;    _s2.worker()-&gt;terminator(jets);</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;    _s1.worker()-&gt;terminator(jets);</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;  }</div>
<div class="line"><a name="l04431"></a><span class="lineno"><a class="code" href="../../d7/d54/classSW__Mult.html#a2b10534a9f7d73fa00079e84823fff98"> 4431</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d7/d54/classSW__Mult.html#a2b10534a9f7d73fa00079e84823fff98">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;    ostr &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; _s1.description() &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; _s2.description() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;  }</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;};</div>
<div class="line"><a name="l04437"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a8041dec578763609faef568f2ba1eb3a"> 4437</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../dd/d30/classPseudoJet.html#a21c5e5345ad908516f32efe62dd26403">operator*</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s1, <span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; s2) {</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d7/d54/classSW__Mult.html">SW_Mult</a>(s1,s2));</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;}</div>
<div class="line"><a name="l04440"></a><span class="lineno"><a class="code" href="../../d2/d48/classQuantityBase.html"> 4440</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>{</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04442"></a><span class="lineno"><a class="code" href="../../d2/d48/classQuantityBase.html#ac6f8ca6d4dae9ef3d87d6914033d5574"> 4442</a></span>&#160;  <a class="code" href="../../d2/d48/classQuantityBase.html#ac6f8ca6d4dae9ef3d87d6914033d5574">QuantityBase</a>(<span class="keywordtype">double</span> q) : _q(q){}</div>
<div class="line"><a name="l04443"></a><span class="lineno"><a class="code" href="../../d2/d48/classQuantityBase.html#a85fe6305955ea14b50895ede69062385"> 4443</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="../../d2/d48/classQuantityBase.html#a85fe6305955ea14b50895ede69062385">~QuantityBase</a>(){}</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a7af990c82bfc99533d317a7071d16ba4">operator()</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet ) <span class="keyword">const</span> =0;</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a97b4ed3fd1ab4d7f55d0c511db2fdcbd">description</a>() <span class="keyword">const</span> =0;</div>
<div class="line"><a name="l04446"></a><span class="lineno"><a class="code" href="../../d2/d48/classQuantityBase.html#a9b4b52d19a8a91196294c08ceac1a91a"> 4446</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d2/d48/classQuantityBase.html#a9b4b52d19a8a91196294c08ceac1a91a">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">false</span>;}</div>
<div class="line"><a name="l04447"></a><span class="lineno"><a class="code" href="../../d2/d48/classQuantityBase.html#a94a64768638ba908dc0249d5b7d6342c"> 4447</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d2/d48/classQuantityBase.html#a94a64768638ba908dc0249d5b7d6342c">comparison_value</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _q;}</div>
<div class="line"><a name="l04448"></a><span class="lineno"><a class="code" href="../../d2/d48/classQuantityBase.html#ab1851e984ccea66c3968bb7935deb8fc"> 4448</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d2/d48/classQuantityBase.html#ab1851e984ccea66c3968bb7935deb8fc">description_value</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> comparison_value();}</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04450"></a><span class="lineno"><a class="code" href="../../d2/d48/classQuantityBase.html#ad2c112a41de43fadd03d13d53a2854a1"> 4450</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d2/d48/classQuantityBase.html#ad2c112a41de43fadd03d13d53a2854a1">_q</a>;</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;};  </div>
<div class="line"><a name="l04452"></a><span class="lineno"><a class="code" href="../../d6/d29/classQuantitySquareBase.html"> 4452</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d6/d29/classQuantitySquareBase.html">QuantitySquareBase</a> : <span class="keyword">public</span> <a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>{</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04454"></a><span class="lineno"><a class="code" href="../../d6/d29/classQuantitySquareBase.html#aa5bc479118a5eeffa29dd798b96b8e2e"> 4454</a></span>&#160;  <a class="code" href="../../d6/d29/classQuantitySquareBase.html#aa5bc479118a5eeffa29dd798b96b8e2e">QuantitySquareBase</a>(<span class="keywordtype">double</span> sqrtq) : <a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>(sqrtq*sqrtq), _sqrtq(sqrtq){}</div>
<div class="line"><a name="l04455"></a><span class="lineno"><a class="code" href="../../d6/d29/classQuantitySquareBase.html#aba7b9ef41f9ef4db7f717114a2ae5a7b"> 4455</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d6/d29/classQuantitySquareBase.html#aba7b9ef41f9ef4db7f717114a2ae5a7b">description_value</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _sqrtq;}</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04457"></a><span class="lineno"><a class="code" href="../../d6/d29/classQuantitySquareBase.html#aa6dfd9a0701391f5daeb486103153d27"> 4457</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/d29/classQuantitySquareBase.html#aa6dfd9a0701391f5daeb486103153d27">_sqrtq</a>;</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;};  </div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> QuantityType&gt;</div>
<div class="line"><a name="l04460"></a><span class="lineno"><a class="code" href="../../d5/ddc/classSW__QuantityMin.html"> 4460</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d5/ddc/classSW__QuantityMin.html">SW_QuantityMin</a> : <span class="keyword">public</span> SelectorWorker{</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04462"></a><span class="lineno"><a class="code" href="../../d5/ddc/classSW__QuantityMin.html#ab3d528671acdb1e5832825206cd479ae"> 4462</a></span>&#160;  <a class="code" href="../../d5/ddc/classSW__QuantityMin.html#ab3d528671acdb1e5832825206cd479ae">SW_QuantityMin</a>(<span class="keywordtype">double</span> qmin) : _qmin(qmin) {}</div>
<div class="line"><a name="l04463"></a><span class="lineno"><a class="code" href="../../d5/ddc/classSW__QuantityMin.html#acb6904401651f659b11aa596896d8238"> 4463</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/ddc/classSW__QuantityMin.html#acb6904401651f659b11aa596896d8238">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{<span class="keywordflow">return</span> _qmin(jet) &gt;= _qmin.comparison_value();}</div>
<div class="line"><a name="l04464"></a><span class="lineno"><a class="code" href="../../d5/ddc/classSW__QuantityMin.html#a2c532d8cabcdf58c2e626267cfcff711"> 4464</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d5/ddc/classSW__QuantityMin.html#a2c532d8cabcdf58c2e626267cfcff711">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;    ostr &lt;&lt; _qmin.description() &lt;&lt; <span class="stringliteral">&quot; &gt;= &quot;</span> &lt;&lt; _qmin.description_value();</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;  }</div>
<div class="line"><a name="l04469"></a><span class="lineno"><a class="code" href="../../d5/ddc/classSW__QuantityMin.html#ae10e5caf92193829183958608e1ff511"> 4469</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/ddc/classSW__QuantityMin.html#ae10e5caf92193829183958608e1ff511">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _qmin.is_geometric();}</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04471"></a><span class="lineno"><a class="code" href="../../d5/ddc/classSW__QuantityMin.html#a34010322e10ddf9f05b346706607c801"> 4471</a></span>&#160;  QuantityType <a class="code" href="../../d5/ddc/classSW__QuantityMin.html#a34010322e10ddf9f05b346706607c801" title="the cut">_qmin</a>;     </div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;};</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> QuantityType&gt;</div>
<div class="line"><a name="l04474"></a><span class="lineno"><a class="code" href="../../d0/ded/classSW__QuantityMax.html"> 4474</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d0/ded/classSW__QuantityMax.html">SW_QuantityMax</a> : <span class="keyword">public</span> SelectorWorker {</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04476"></a><span class="lineno"><a class="code" href="../../d0/ded/classSW__QuantityMax.html#afdb22b1746aef1601f1c5a8b3ca568a9"> 4476</a></span>&#160;  <a class="code" href="../../d0/ded/classSW__QuantityMax.html#afdb22b1746aef1601f1c5a8b3ca568a9">SW_QuantityMax</a>(<span class="keywordtype">double</span> qmax) : _qmax(qmax) {}</div>
<div class="line"><a name="l04477"></a><span class="lineno"><a class="code" href="../../d0/ded/classSW__QuantityMax.html#a81afc4b3953ef232f353006241d3c1cd"> 4477</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d0/ded/classSW__QuantityMax.html#a81afc4b3953ef232f353006241d3c1cd">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{<span class="keywordflow">return</span> _qmax(jet) &lt;= _qmax.comparison_value();}</div>
<div class="line"><a name="l04478"></a><span class="lineno"><a class="code" href="../../d0/ded/classSW__QuantityMax.html#a66317963036b1a120e968a7101ccd5cb"> 4478</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d0/ded/classSW__QuantityMax.html#a66317963036b1a120e968a7101ccd5cb">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;    ostr &lt;&lt; _qmax.description() &lt;&lt; <span class="stringliteral">&quot; &lt;= &quot;</span> &lt;&lt; _qmax.description_value();</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;  }</div>
<div class="line"><a name="l04483"></a><span class="lineno"><a class="code" href="../../d0/ded/classSW__QuantityMax.html#af745b0f7ffb36353f2e45911d13f00d5"> 4483</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d0/ded/classSW__QuantityMax.html#af745b0f7ffb36353f2e45911d13f00d5">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _qmax.is_geometric();}</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04485"></a><span class="lineno"><a class="code" href="../../d0/ded/classSW__QuantityMax.html#a34660a1c6a4f5b2b6988cde239699fbd"> 4485</a></span>&#160;  QuantityType <a class="code" href="../../d0/ded/classSW__QuantityMax.html#a34660a1c6a4f5b2b6988cde239699fbd" title="the cut">_qmax</a>;   </div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;};</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> QuantityType&gt;</div>
<div class="line"><a name="l04488"></a><span class="lineno"><a class="code" href="../../de/d4f/classSW__QuantityRange.html"> 4488</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../de/d4f/classSW__QuantityRange.html">SW_QuantityRange</a> : <span class="keyword">public</span> <a class="code" href="../../da/de9/classSelectorWorker.html">SelectorWorker</a> {</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04490"></a><span class="lineno"><a class="code" href="../../de/d4f/classSW__QuantityRange.html#a33812157d9a91a5945f2a2ccbfc78d6c"> 4490</a></span>&#160;  <a class="code" href="../../de/d4f/classSW__QuantityRange.html#a33812157d9a91a5945f2a2ccbfc78d6c">SW_QuantityRange</a>(<span class="keywordtype">double</span> qmin, <span class="keywordtype">double</span> qmax) : _qmin(qmin), _qmax(qmax) {}</div>
<div class="line"><a name="l04491"></a><span class="lineno"><a class="code" href="../../de/d4f/classSW__QuantityRange.html#a3461b31b75c08c74acc665b87e6cd2c4"> 4491</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../de/d4f/classSW__QuantityRange.html#a3461b31b75c08c74acc665b87e6cd2c4">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;    <span class="keywordtype">double</span> q = _qmin(jet); <span class="comment">// we could identically use _qmax</span></div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;    <span class="keywordflow">return</span> (q &gt;= _qmin.comparison_value()) &amp;&amp; (q &lt;= _qmax.comparison_value());</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;  }</div>
<div class="line"><a name="l04495"></a><span class="lineno"><a class="code" href="../../de/d4f/classSW__QuantityRange.html#a20b9a44769da954066dd3c1aeecb4d8f"> 4495</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../de/d4f/classSW__QuantityRange.html#a20b9a44769da954066dd3c1aeecb4d8f">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;    ostr &lt;&lt; _qmin.description_value() &lt;&lt; <span class="stringliteral">&quot; &lt;= &quot;</span> &lt;&lt; _qmin.description() &lt;&lt; <span class="stringliteral">&quot; &lt;= &quot;</span> &lt;&lt; _qmax.description_value();</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;  }</div>
<div class="line"><a name="l04500"></a><span class="lineno"><a class="code" href="../../de/d4f/classSW__QuantityRange.html#a261c72b20660b14f29da6ec985fa5804"> 4500</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../de/d4f/classSW__QuantityRange.html#a261c72b20660b14f29da6ec985fa5804">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _qmin.is_geometric();}</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04502"></a><span class="lineno"><a class="code" href="../../de/d4f/classSW__QuantityRange.html#a9ad7e94f3e1b4416944ecdeb382b88ef"> 4502</a></span>&#160;  QuantityType <a class="code" href="../../de/d4f/classSW__QuantityRange.html#a9ad7e94f3e1b4416944ecdeb382b88ef">_qmin</a>;   <span class="comment">// the lower cut </span></div>
<div class="line"><a name="l04503"></a><span class="lineno"><a class="code" href="../../de/d4f/classSW__QuantityRange.html#a9db15c97e9808f9f7195f1c8d48fe93f"> 4503</a></span>&#160;  QuantityType <a class="code" href="../../de/d4f/classSW__QuantityRange.html#a9db15c97e9808f9f7195f1c8d48fe93f">_qmax</a>;   <span class="comment">// the upper cut</span></div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;};</div>
<div class="line"><a name="l04505"></a><span class="lineno"><a class="code" href="../../de/ddf/classQuantityPt2.html"> 4505</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../de/ddf/classQuantityPt2.html">QuantityPt2</a> : <span class="keyword">public</span> <a class="code" href="../../d6/d29/classQuantitySquareBase.html">QuantitySquareBase</a>{</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04507"></a><span class="lineno"><a class="code" href="../../de/ddf/classQuantityPt2.html#a1116c94cfeec2aa11e13ffa1e632873d"> 4507</a></span>&#160;  <a class="code" href="../../de/ddf/classQuantityPt2.html#a1116c94cfeec2aa11e13ffa1e632873d">QuantityPt2</a>(<span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#acf79a067fd3145b6b5ca261fab2d4384">pt</a>) : <a class="code" href="../../d6/d29/classQuantitySquareBase.html">QuantitySquareBase</a>(pt){}</div>
<div class="line"><a name="l04508"></a><span class="lineno"><a class="code" href="../../de/ddf/classQuantityPt2.html#a94a5dd9fabc0c1b4ba0f5a846d95fee5"> 4508</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../de/ddf/classQuantityPt2.html#a94a5dd9fabc0c1b4ba0f5a846d95fee5">operator()</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> jet.perp2();}</div>
<div class="line"><a name="l04509"></a><span class="lineno"><a class="code" href="../../de/ddf/classQuantityPt2.html#a326afd2e422bb8170eaf24ef384b48af"> 4509</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../de/ddf/classQuantityPt2.html#a326afd2e422bb8170eaf24ef384b48af">description</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;pt&quot;</span>;}</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;};  </div>
<div class="line"><a name="l04511"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#af490022ce575c7cf89c105359453cd63"> 4511</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#af490022ce575c7cf89c105359453cd63" title="select objects with pt &gt;= ptmin">SelectorPtMin</a>(<span class="keywordtype">double</span> ptmin) {</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d5/ddc/classSW__QuantityMin.html">SW_QuantityMin&lt;QuantityPt2&gt;</a>(ptmin));</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;}</div>
<div class="line"><a name="l04514"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a31281b45e88af2969ba5fe0d7e0dfb81"> 4514</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a31281b45e88af2969ba5fe0d7e0dfb81" title="select objects with pt &lt;= ptmax">SelectorPtMax</a>(<span class="keywordtype">double</span> ptmax) {</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d0/ded/classSW__QuantityMax.html">SW_QuantityMax&lt;QuantityPt2&gt;</a>(ptmax));</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;}</div>
<div class="line"><a name="l04517"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a6ffc58c26fad4a0eb43fa5329a3163cd"> 4517</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a6ffc58c26fad4a0eb43fa5329a3163cd" title="select objects with ptmin &lt;= pt &lt;= ptmax">SelectorPtRange</a>(<span class="keywordtype">double</span> ptmin, <span class="keywordtype">double</span> ptmax) {</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../de/d4f/classSW__QuantityRange.html">SW_QuantityRange&lt;QuantityPt2&gt;</a>(ptmin, ptmax));</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;}</div>
<div class="line"><a name="l04520"></a><span class="lineno"><a class="code" href="../../d4/d24/classQuantityEt2.html"> 4520</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d4/d24/classQuantityEt2.html">QuantityEt2</a> : <span class="keyword">public</span> <a class="code" href="../../d6/d29/classQuantitySquareBase.html">QuantitySquareBase</a>{</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04522"></a><span class="lineno"><a class="code" href="../../d4/d24/classQuantityEt2.html#a4c224913005745ab1e7043dae54dd181"> 4522</a></span>&#160;  <a class="code" href="../../d4/d24/classQuantityEt2.html#a4c224913005745ab1e7043dae54dd181">QuantityEt2</a>(<span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a05a9b41b6f04bcfefaebba40c11ba5d6">Et</a>) : <a class="code" href="../../d6/d29/classQuantitySquareBase.html">QuantitySquareBase</a>(Et){}</div>
<div class="line"><a name="l04523"></a><span class="lineno"><a class="code" href="../../d4/d24/classQuantityEt2.html#a0666fa1bfe2cb79807078950e5005ded"> 4523</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d4/d24/classQuantityEt2.html#a0666fa1bfe2cb79807078950e5005ded">operator()</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> jet.Et2();}</div>
<div class="line"><a name="l04524"></a><span class="lineno"><a class="code" href="../../d4/d24/classQuantityEt2.html#aca10fbc2c01ad880d344f35f7a0c2fc0"> 4524</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d4/d24/classQuantityEt2.html#aca10fbc2c01ad880d344f35f7a0c2fc0">description</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;Et&quot;</span>;}</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;};  </div>
<div class="line"><a name="l04526"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a69ab7d8d3b0e0a5d013a47c3342ecbe0"> 4526</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a69ab7d8d3b0e0a5d013a47c3342ecbe0" title="select objects with Et &gt;= Etmin">SelectorEtMin</a>(<span class="keywordtype">double</span> Etmin) {</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d5/ddc/classSW__QuantityMin.html">SW_QuantityMin&lt;QuantityEt2&gt;</a>(Etmin));</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;}</div>
<div class="line"><a name="l04529"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#acd6736edf5616a63b08bef5f04814fc8"> 4529</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#acd6736edf5616a63b08bef5f04814fc8" title="select objects with Et &lt;= Etmax">SelectorEtMax</a>(<span class="keywordtype">double</span> Etmax) {</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d0/ded/classSW__QuantityMax.html">SW_QuantityMax&lt;QuantityEt2&gt;</a>(Etmax));</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;}</div>
<div class="line"><a name="l04532"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#aacb9ef68e76b33c8ecff1e9b5f6c1e50"> 4532</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#aacb9ef68e76b33c8ecff1e9b5f6c1e50" title="select objects with Etmin &lt;= Et &lt;= Etmax">SelectorEtRange</a>(<span class="keywordtype">double</span> Etmin, <span class="keywordtype">double</span> Etmax) {</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../de/d4f/classSW__QuantityRange.html">SW_QuantityRange&lt;QuantityEt2&gt;</a>(Etmin, Etmax));</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;}</div>
<div class="line"><a name="l04535"></a><span class="lineno"><a class="code" href="../../de/def/classQuantityE.html"> 4535</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../de/def/classQuantityE.html">QuantityE</a> : <span class="keyword">public</span> <a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>{</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04537"></a><span class="lineno"><a class="code" href="../../de/def/classQuantityE.html#ae8d7840856a6ad02ceeb09ae8a9593a1"> 4537</a></span>&#160;  <a class="code" href="../../de/def/classQuantityE.html#ae8d7840856a6ad02ceeb09ae8a9593a1">QuantityE</a>(<span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a120774cd696910d41dfc8d6a1e347263">E</a>) : <a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>(E){}</div>
<div class="line"><a name="l04538"></a><span class="lineno"><a class="code" href="../../de/def/classQuantityE.html#aee9423e3bd6058247fe3855c24797e6f"> 4538</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../de/def/classQuantityE.html#aee9423e3bd6058247fe3855c24797e6f">operator()</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> jet.E();}</div>
<div class="line"><a name="l04539"></a><span class="lineno"><a class="code" href="../../de/def/classQuantityE.html#a3a6e597f3fc9c7f411c90fc1cc3c0d44"> 4539</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../de/def/classQuantityE.html#a3a6e597f3fc9c7f411c90fc1cc3c0d44">description</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;E&quot;</span>;}</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;};  </div>
<div class="line"><a name="l04541"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a1e1329c3463780616c97fa90bef0e6d0"> 4541</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a1e1329c3463780616c97fa90bef0e6d0" title="select objects with E &gt;= Emin">SelectorEMin</a>(<span class="keywordtype">double</span> Emin) {</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d5/ddc/classSW__QuantityMin.html">SW_QuantityMin&lt;QuantityE&gt;</a>(Emin));</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;}</div>
<div class="line"><a name="l04544"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a224d97ca54fa0c858bf4afd2e31d7261"> 4544</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a224d97ca54fa0c858bf4afd2e31d7261" title="select objects with E &lt;= Emax">SelectorEMax</a>(<span class="keywordtype">double</span> Emax) {</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d0/ded/classSW__QuantityMax.html">SW_QuantityMax&lt;QuantityE&gt;</a>(Emax));</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;}</div>
<div class="line"><a name="l04547"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#ab61be5ea54dc1e3353c479cdd4a17efb"> 4547</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#ab61be5ea54dc1e3353c479cdd4a17efb" title="select objects with Emin &lt;= E &lt;= Emax">SelectorERange</a>(<span class="keywordtype">double</span> Emin, <span class="keywordtype">double</span> Emax) {</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../de/d4f/classSW__QuantityRange.html">SW_QuantityRange&lt;QuantityE&gt;</a>(Emin, Emax));</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;}</div>
<div class="line"><a name="l04550"></a><span class="lineno"><a class="code" href="../../db/d55/classQuantityM2.html"> 4550</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../db/d55/classQuantityM2.html">QuantityM2</a> : <span class="keyword">public</span> <a class="code" href="../../d6/d29/classQuantitySquareBase.html">QuantitySquareBase</a>{</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04552"></a><span class="lineno"><a class="code" href="../../db/d55/classQuantityM2.html#a98e869dfeb957c89e646adb3d763b573"> 4552</a></span>&#160;  <a class="code" href="../../db/d55/classQuantityM2.html#a98e869dfeb957c89e646adb3d763b573">QuantityM2</a>(<span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a056cffa90b7ae9fd0e576a8fe0903fc5">m</a>) : <a class="code" href="../../d6/d29/classQuantitySquareBase.html">QuantitySquareBase</a>(m){}</div>
<div class="line"><a name="l04553"></a><span class="lineno"><a class="code" href="../../db/d55/classQuantityM2.html#aa739c32c368dfc73362915f482519ba3"> 4553</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../db/d55/classQuantityM2.html#aa739c32c368dfc73362915f482519ba3">operator()</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> jet.m2();}</div>
<div class="line"><a name="l04554"></a><span class="lineno"><a class="code" href="../../db/d55/classQuantityM2.html#a218efdeb7275692b8e46e4071d3e3c01"> 4554</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../db/d55/classQuantityM2.html#a218efdeb7275692b8e46e4071d3e3c01">description</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;mass&quot;</span>;}</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;};  </div>
<div class="line"><a name="l04556"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a2bea2ec67e97390962a61354ab4c72fa"> 4556</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a4e1a990d8ce77cbd134ac4ef6859ff93" title="select objects with Mass &gt;= Mmin">SelectorMassMin</a>(<span class="keywordtype">double</span> mmin) {</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d5/ddc/classSW__QuantityMin.html">SW_QuantityMin&lt;QuantityM2&gt;</a>(mmin));</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;}</div>
<div class="line"><a name="l04559"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a88f4e6b3362c5cadeb453ac922816195"> 4559</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a864f96f94db921160e59ac45b7b1adb7" title="select objects with Mass &lt;= Mmax">SelectorMassMax</a>(<span class="keywordtype">double</span> mmax) {</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d0/ded/classSW__QuantityMax.html">SW_QuantityMax&lt;QuantityM2&gt;</a>(mmax));</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;}</div>
<div class="line"><a name="l04562"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#ab097094d1802c5327f122011561aa176"> 4562</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#aa0ae15e9c689dd66af6856fd3e86b8de" title="select objects with Mmin &lt;= Mass &lt;= Mmax">SelectorMassRange</a>(<span class="keywordtype">double</span> mmin, <span class="keywordtype">double</span> mmax) {</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../de/d4f/classSW__QuantityRange.html">SW_QuantityRange&lt;QuantityM2&gt;</a>(mmin, mmax));</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;}</div>
<div class="line"><a name="l04565"></a><span class="lineno"><a class="code" href="../../d2/dba/classQuantityRap.html"> 4565</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d2/dba/classQuantityRap.html">QuantityRap</a> : <span class="keyword">public</span> <a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>{</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04567"></a><span class="lineno"><a class="code" href="../../d2/dba/classQuantityRap.html#a4baa59828d53c54744252214d67943c3"> 4567</a></span>&#160;  <a class="code" href="../../d2/dba/classQuantityRap.html#a4baa59828d53c54744252214d67943c3">QuantityRap</a>(<span class="keywordtype">double</span> <a class="code" href="../../dd/d30/classPseudoJet.html#a49adafe202c449223cd63981b48f3609">rap</a>) : <a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>(rap){}</div>
<div class="line"><a name="l04568"></a><span class="lineno"><a class="code" href="../../d2/dba/classQuantityRap.html#a80d850dbab9d14f748b466ac8ce9e5d1"> 4568</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d2/dba/classQuantityRap.html#a80d850dbab9d14f748b466ac8ce9e5d1">operator()</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> jet.rap();}</div>
<div class="line"><a name="l04569"></a><span class="lineno"><a class="code" href="../../d2/dba/classQuantityRap.html#aa35354ac58ac3450826d06d23303bdb5"> 4569</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d2/dba/classQuantityRap.html#aa35354ac58ac3450826d06d23303bdb5">description</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;rap&quot;</span>;}</div>
<div class="line"><a name="l04570"></a><span class="lineno"><a class="code" href="../../d2/dba/classQuantityRap.html#a01db6b8daa98a2390a8b20f5afdb7f2a"> 4570</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d2/dba/classQuantityRap.html#a01db6b8daa98a2390a8b20f5afdb7f2a">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;};  </div>
<div class="line"><a name="l04572"></a><span class="lineno"><a class="code" href="../../d8/de4/classSW__RapMin.html"> 4572</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d8/de4/classSW__RapMin.html">SW_RapMin</a> : <span class="keyword">public</span> <a class="code" href="../../d5/ddc/classSW__QuantityMin.html">SW_QuantityMin</a>&lt;QuantityRap&gt;{</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04574"></a><span class="lineno"><a class="code" href="../../d8/de4/classSW__RapMin.html#ad15526967d3597def28265dff69f7b8b"> 4574</a></span>&#160;  <a class="code" href="../../d8/de4/classSW__RapMin.html#ad15526967d3597def28265dff69f7b8b">SW_RapMin</a>(<span class="keywordtype">double</span> rapmin) : <a class="code" href="../../d5/ddc/classSW__QuantityMin.html">SW_QuantityMin</a>&lt;<a class="code" href="../../d2/dba/classQuantityRap.html">QuantityRap</a>&gt;(rapmin){}</div>
<div class="line"><a name="l04575"></a><span class="lineno"><a class="code" href="../../d8/de4/classSW__RapMin.html#acfbf2f3b877b419bb2a950944273aa00"> 4575</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/de4/classSW__RapMin.html#acfbf2f3b877b419bb2a950944273aa00">get_rapidity_extent</a>(<span class="keywordtype">double</span> &amp;rapmin, <span class="keywordtype">double</span> &amp; rapmax)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;    rapmax = std::numeric_limits&lt;double&gt;::max();     </div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;    rapmin = _qmin.comparison_value();</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;  }</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;};</div>
<div class="line"><a name="l04580"></a><span class="lineno"><a class="code" href="../../de/d83/classSW__RapMax.html"> 4580</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../de/d83/classSW__RapMax.html">SW_RapMax</a> : <span class="keyword">public</span> <a class="code" href="../../d0/ded/classSW__QuantityMax.html">SW_QuantityMax</a>&lt;QuantityRap&gt;{</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04582"></a><span class="lineno"><a class="code" href="../../de/d83/classSW__RapMax.html#ab6be6218366a7d56caa5a1f89d3d57fc"> 4582</a></span>&#160;  <a class="code" href="../../de/d83/classSW__RapMax.html#ab6be6218366a7d56caa5a1f89d3d57fc">SW_RapMax</a>(<span class="keywordtype">double</span> rapmax) : <a class="code" href="../../d0/ded/classSW__QuantityMax.html">SW_QuantityMax</a>&lt;<a class="code" href="../../d2/dba/classQuantityRap.html">QuantityRap</a>&gt;(rapmax){}</div>
<div class="line"><a name="l04583"></a><span class="lineno"><a class="code" href="../../de/d83/classSW__RapMax.html#a9068ee5e61e280fb404b555f6d8654ef"> 4583</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d83/classSW__RapMax.html#a9068ee5e61e280fb404b555f6d8654ef">get_rapidity_extent</a>(<span class="keywordtype">double</span> &amp;rapmin, <span class="keywordtype">double</span> &amp; rapmax)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;    rapmax = _qmax.comparison_value(); </div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;    rapmin = -std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;  }</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;};</div>
<div class="line"><a name="l04588"></a><span class="lineno"><a class="code" href="../../d4/d6d/classSW__RapRange.html"> 4588</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d4/d6d/classSW__RapRange.html">SW_RapRange</a> : <span class="keyword">public</span> <a class="code" href="../../de/d4f/classSW__QuantityRange.html">SW_QuantityRange</a>&lt;QuantityRap&gt;{</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04590"></a><span class="lineno"><a class="code" href="../../d4/d6d/classSW__RapRange.html#a70e40f582fee1c5d14923e01b75bb86c"> 4590</a></span>&#160;  <a class="code" href="../../d4/d6d/classSW__RapRange.html#a70e40f582fee1c5d14923e01b75bb86c">SW_RapRange</a>(<span class="keywordtype">double</span> rapmin, <span class="keywordtype">double</span> rapmax) : <a class="code" href="../../de/d4f/classSW__QuantityRange.html">SW_QuantityRange</a>&lt;<a class="code" href="../../d2/dba/classQuantityRap.html">QuantityRap</a>&gt;(rapmin, rapmax){</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(rapmin&lt;=rapmax);</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;  }</div>
<div class="line"><a name="l04593"></a><span class="lineno"><a class="code" href="../../d4/d6d/classSW__RapRange.html#a2c6a61f008fe3df2a4114b369a0985ea"> 4593</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d4/d6d/classSW__RapRange.html#a2c6a61f008fe3df2a4114b369a0985ea">get_rapidity_extent</a>(<span class="keywordtype">double</span> &amp;rapmin, <span class="keywordtype">double</span> &amp; rapmax)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;    rapmax = _qmax.comparison_value();      </div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;    rapmin = _qmin.comparison_value(); </div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;  }</div>
<div class="line"><a name="l04597"></a><span class="lineno"><a class="code" href="../../d4/d6d/classSW__RapRange.html#a0c544508d61dfe974164b16725b666a7"> 4597</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d4/d6d/classSW__RapRange.html#a0c544508d61dfe974164b16725b666a7" title="the area is analytically known">has_known_area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;} </div>
<div class="line"><a name="l04598"></a><span class="lineno"><a class="code" href="../../d4/d6d/classSW__RapRange.html#aef85c7849c709617efe6fa29cca49c00"> 4598</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d4/d6d/classSW__RapRange.html#aef85c7849c709617efe6fa29cca49c00">known_area</a>()<span class="keyword"> const </span>{ </div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> * (_qmax.comparison_value()-_qmin.comparison_value());</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;  }</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;};</div>
<div class="line"><a name="l04602"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#ae3477b4620ce0ac0d86ba150cf7898e7"> 4602</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#ae3477b4620ce0ac0d86ba150cf7898e7" title="select objects with rap &gt;= rapmin">SelectorRapMin</a>(<span class="keywordtype">double</span> rapmin) {</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d8/de4/classSW__RapMin.html">SW_RapMin</a>(rapmin));</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;}</div>
<div class="line"><a name="l04605"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a01336eaffa774e250c1292ad23ad5246"> 4605</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a01336eaffa774e250c1292ad23ad5246" title="select objects with rap &lt;= rapmax">SelectorRapMax</a>(<span class="keywordtype">double</span> rapmax) {</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../de/d83/classSW__RapMax.html">SW_RapMax</a>(rapmax));</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;}</div>
<div class="line"><a name="l04608"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a4d370a54cbb125e5673e24b80da31924"> 4608</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a4d370a54cbb125e5673e24b80da31924" title="select objects with rapmin &lt;= rap &lt;= rapmax">SelectorRapRange</a>(<span class="keywordtype">double</span> rapmin, <span class="keywordtype">double</span> rapmax) {</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d4/d6d/classSW__RapRange.html">SW_RapRange</a>(rapmin, rapmax));</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;}</div>
<div class="line"><a name="l04611"></a><span class="lineno"><a class="code" href="../../d8/d40/classQuantityAbsRap.html"> 4611</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d8/d40/classQuantityAbsRap.html">QuantityAbsRap</a> : <span class="keyword">public</span> <a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>{</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04613"></a><span class="lineno"><a class="code" href="../../d8/d40/classQuantityAbsRap.html#a00685dbdef85123554eb161b827cb868"> 4613</a></span>&#160;  <a class="code" href="../../d8/d40/classQuantityAbsRap.html#a00685dbdef85123554eb161b827cb868">QuantityAbsRap</a>(<span class="keywordtype">double</span> absrap) : <a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>(absrap){}</div>
<div class="line"><a name="l04614"></a><span class="lineno"><a class="code" href="../../d8/d40/classQuantityAbsRap.html#a84291221c24a2d51f738c6c97a016679"> 4614</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d8/d40/classQuantityAbsRap.html#a84291221c24a2d51f738c6c97a016679">operator()</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> abs(jet.rap());}</div>
<div class="line"><a name="l04615"></a><span class="lineno"><a class="code" href="../../d8/d40/classQuantityAbsRap.html#a70f243d46e9b6152eb7302cf302cebe1"> 4615</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d8/d40/classQuantityAbsRap.html#a70f243d46e9b6152eb7302cf302cebe1">description</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;|rap|&quot;</span>;}</div>
<div class="line"><a name="l04616"></a><span class="lineno"><a class="code" href="../../d8/d40/classQuantityAbsRap.html#a760e92c08c7f0d37a058b61966b1224f"> 4616</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d8/d40/classQuantityAbsRap.html#a760e92c08c7f0d37a058b61966b1224f">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;};  </div>
<div class="line"><a name="l04618"></a><span class="lineno"><a class="code" href="../../d6/dbf/classSW__AbsRapMax.html"> 4618</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d6/dbf/classSW__AbsRapMax.html">SW_AbsRapMax</a> : <span class="keyword">public</span> <a class="code" href="../../d0/ded/classSW__QuantityMax.html">SW_QuantityMax</a>&lt;QuantityAbsRap&gt;{</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04620"></a><span class="lineno"><a class="code" href="../../d6/dbf/classSW__AbsRapMax.html#a8bf679625f6b20f2bd7124f0944907b8"> 4620</a></span>&#160;  <a class="code" href="../../d6/dbf/classSW__AbsRapMax.html#a8bf679625f6b20f2bd7124f0944907b8">SW_AbsRapMax</a>(<span class="keywordtype">double</span> absrapmax) : <a class="code" href="../../d0/ded/classSW__QuantityMax.html">SW_QuantityMax</a>&lt;<a class="code" href="../../d8/d40/classQuantityAbsRap.html">QuantityAbsRap</a>&gt;(absrapmax){}</div>
<div class="line"><a name="l04621"></a><span class="lineno"><a class="code" href="../../d6/dbf/classSW__AbsRapMax.html#a5050b930a67aaa63d7f239733ca89f4f"> 4621</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/dbf/classSW__AbsRapMax.html#a5050b930a67aaa63d7f239733ca89f4f">get_rapidity_extent</a>(<span class="keywordtype">double</span> &amp;rapmin, <span class="keywordtype">double</span> &amp; rapmax)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;    rapmax =  _qmax.comparison_value(); </div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;    rapmin = -_qmax.comparison_value();</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;  }</div>
<div class="line"><a name="l04625"></a><span class="lineno"><a class="code" href="../../d6/dbf/classSW__AbsRapMax.html#ae9a360ce727d013ae7ee241e95db0d90"> 4625</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d6/dbf/classSW__AbsRapMax.html#ae9a360ce727d013ae7ee241e95db0d90" title="the area is analytically known">has_known_area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}   </div>
<div class="line"><a name="l04626"></a><span class="lineno"><a class="code" href="../../d6/dbf/classSW__AbsRapMax.html#af6508c90016a67ec9ae89621705c0ad5"> 4626</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d6/dbf/classSW__AbsRapMax.html#af6508c90016a67ec9ae89621705c0ad5">known_area</a>()<span class="keyword"> const </span>{ </div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> * 2 * _qmax.comparison_value();</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;  }</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;};</div>
<div class="line"><a name="l04630"></a><span class="lineno"><a class="code" href="../../de/d91/classSW__AbsRapRange.html"> 4630</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../de/d91/classSW__AbsRapRange.html">SW_AbsRapRange</a> : <span class="keyword">public</span> <a class="code" href="../../de/d4f/classSW__QuantityRange.html">SW_QuantityRange</a>&lt;QuantityAbsRap&gt;{</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04632"></a><span class="lineno"><a class="code" href="../../de/d91/classSW__AbsRapRange.html#a2983c2d8ca43dd942c7bfe4832a6063b"> 4632</a></span>&#160;  <a class="code" href="../../de/d91/classSW__AbsRapRange.html#a2983c2d8ca43dd942c7bfe4832a6063b">SW_AbsRapRange</a>(<span class="keywordtype">double</span> absrapmin, <span class="keywordtype">double</span> absrapmax) : <a class="code" href="../../de/d4f/classSW__QuantityRange.html">SW_QuantityRange</a>&lt;<a class="code" href="../../d8/d40/classQuantityAbsRap.html">QuantityAbsRap</a>&gt;(absrapmin, absrapmax){}</div>
<div class="line"><a name="l04633"></a><span class="lineno"><a class="code" href="../../de/d91/classSW__AbsRapRange.html#a46017077cccccac35ae77e5e4cf6406f"> 4633</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d91/classSW__AbsRapRange.html#a46017077cccccac35ae77e5e4cf6406f">get_rapidity_extent</a>(<span class="keywordtype">double</span> &amp;rapmin, <span class="keywordtype">double</span> &amp; rapmax)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;    rapmax =  _qmax.comparison_value(); </div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;    rapmin = -_qmax.comparison_value();</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;  }</div>
<div class="line"><a name="l04637"></a><span class="lineno"><a class="code" href="../../de/d91/classSW__AbsRapRange.html#a1546f2c41fb49d16aeb109368c563537"> 4637</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../de/d91/classSW__AbsRapRange.html#a1546f2c41fb49d16aeb109368c563537" title="the area is analytically known">has_known_area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;} </div>
<div class="line"><a name="l04638"></a><span class="lineno"><a class="code" href="../../de/d91/classSW__AbsRapRange.html#a7588a9400104b350a3f437d0eb3e0148"> 4638</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../de/d91/classSW__AbsRapRange.html#a7588a9400104b350a3f437d0eb3e0148">known_area</a>()<span class="keyword"> const </span>{ </div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> * 2 * (_qmax.comparison_value()-max(_qmin.comparison_value(),0.0)); <span class="comment">// this should handle properly absrapmin&lt;0</span></div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;  }</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;};</div>
<div class="line"><a name="l04642"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#ae47591c321935c034de360c8120718c0"> 4642</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#ae47591c321935c034de360c8120718c0" title="select objects with |rap| &gt;= absrapmin">SelectorAbsRapMin</a>(<span class="keywordtype">double</span> absrapmin) {</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d5/ddc/classSW__QuantityMin.html">SW_QuantityMin&lt;QuantityAbsRap&gt;</a>(absrapmin));</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;}</div>
<div class="line"><a name="l04645"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a21d758c1122c84b04e081c184202743c"> 4645</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a21d758c1122c84b04e081c184202743c" title="select objects with |rap| &lt;= absrapmax">SelectorAbsRapMax</a>(<span class="keywordtype">double</span> absrapmax) {</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d6/dbf/classSW__AbsRapMax.html">SW_AbsRapMax</a>(absrapmax));</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;}</div>
<div class="line"><a name="l04648"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a0aaef1f50668040a5c033c6c51f7669a"> 4648</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#aae5488aa188f6874e402407526b0a604" title="select objects with absrapmin &lt;= |rap| &lt;= absrapmax">SelectorAbsRapRange</a>(<span class="keywordtype">double</span> rapmin, <span class="keywordtype">double</span> rapmax) {</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../de/d91/classSW__AbsRapRange.html">SW_AbsRapRange</a>(rapmin, rapmax));</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;}</div>
<div class="line"><a name="l04651"></a><span class="lineno"><a class="code" href="../../d0/d6f/classQuantityEta.html"> 4651</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d0/d6f/classQuantityEta.html">QuantityEta</a> : <span class="keyword">public</span> <a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>{</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04653"></a><span class="lineno"><a class="code" href="../../d0/d6f/classQuantityEta.html#a1cc1816b6015163b76b9c63bbe8d4420"> 4653</a></span>&#160;  <a class="code" href="../../d0/d6f/classQuantityEta.html#a1cc1816b6015163b76b9c63bbe8d4420">QuantityEta</a>(<span class="keywordtype">double</span> eta) : <a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>(eta){}</div>
<div class="line"><a name="l04654"></a><span class="lineno"><a class="code" href="../../d0/d6f/classQuantityEta.html#ac3a3bf319512be22abe27ef2a8643bb5"> 4654</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d0/d6f/classQuantityEta.html#ac3a3bf319512be22abe27ef2a8643bb5">operator()</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> jet.eta();}</div>
<div class="line"><a name="l04655"></a><span class="lineno"><a class="code" href="../../d0/d6f/classQuantityEta.html#aa9222eb2f57d1c5252faf62c4e1e59f5"> 4655</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d0/d6f/classQuantityEta.html#aa9222eb2f57d1c5252faf62c4e1e59f5">description</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;eta&quot;</span>;}</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;};  </div>
<div class="line"><a name="l04657"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#af5e758a6ee90b5ef70df090c28875bc1"> 4657</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#af5e758a6ee90b5ef70df090c28875bc1" title="select objects with eta &gt;= etamin">SelectorEtaMin</a>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d4d/JETSCAPE_2blob_2main_2jail_2vhlle_2src_2main_8cpp.html#aad8d6e22d0aafc481c021cc16fcd7783">etamin</a>) {</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d5/ddc/classSW__QuantityMin.html">SW_QuantityMin&lt;QuantityEta&gt;</a>(etamin));</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;}</div>
<div class="line"><a name="l04660"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#aa4e2ded11c6a8b2a48e7631b8a5e7ff4"> 4660</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#aa4e2ded11c6a8b2a48e7631b8a5e7ff4" title="select objects with eta &lt;= etamax">SelectorEtaMax</a>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d4d/JETSCAPE_2blob_2main_2jail_2vhlle_2src_2main_8cpp.html#a425b410f0855ee1e6177dfeef3febb3c">etamax</a>) {</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d0/ded/classSW__QuantityMax.html">SW_QuantityMax&lt;QuantityEta&gt;</a>(etamax));</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;}</div>
<div class="line"><a name="l04663"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a5ac2888726bb9c73f8ef5104c45c46ef"> 4663</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a5ac2888726bb9c73f8ef5104c45c46ef" title="select objects with etamin &lt;= eta &lt;= etamax">SelectorEtaRange</a>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d4d/JETSCAPE_2blob_2main_2jail_2vhlle_2src_2main_8cpp.html#aad8d6e22d0aafc481c021cc16fcd7783">etamin</a>, <span class="keywordtype">double</span> <a class="code" href="../../d0/d4d/JETSCAPE_2blob_2main_2jail_2vhlle_2src_2main_8cpp.html#a425b410f0855ee1e6177dfeef3febb3c">etamax</a>) {</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../de/d4f/classSW__QuantityRange.html">SW_QuantityRange&lt;QuantityEta&gt;</a>(etamin, etamax));</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;}</div>
<div class="line"><a name="l04666"></a><span class="lineno"><a class="code" href="../../d7/d05/classQuantityAbsEta.html"> 4666</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d7/d05/classQuantityAbsEta.html">QuantityAbsEta</a> : <span class="keyword">public</span> <a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>{</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04668"></a><span class="lineno"><a class="code" href="../../d7/d05/classQuantityAbsEta.html#a12f6704c94539a673f9d11ef75b25104"> 4668</a></span>&#160;  <a class="code" href="../../d7/d05/classQuantityAbsEta.html#a12f6704c94539a673f9d11ef75b25104">QuantityAbsEta</a>(<span class="keywordtype">double</span> abseta) : <a class="code" href="../../d2/d48/classQuantityBase.html">QuantityBase</a>(abseta){}</div>
<div class="line"><a name="l04669"></a><span class="lineno"><a class="code" href="../../d7/d05/classQuantityAbsEta.html#afa85049cb1efe59bfc3cf985785ef897"> 4669</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d7/d05/classQuantityAbsEta.html#afa85049cb1efe59bfc3cf985785ef897">operator()</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> abs(jet.eta());}</div>
<div class="line"><a name="l04670"></a><span class="lineno"><a class="code" href="../../d7/d05/classQuantityAbsEta.html#a23b3484e7dbc1bb68f040837f0b69a3b"> 4670</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d7/d05/classQuantityAbsEta.html#a23b3484e7dbc1bb68f040837f0b69a3b">description</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;|eta|&quot;</span>;}</div>
<div class="line"><a name="l04671"></a><span class="lineno"><a class="code" href="../../d7/d05/classQuantityAbsEta.html#a7e7c376e789619074e640f09302eb6ac"> 4671</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d7/d05/classQuantityAbsEta.html#a7e7c376e789619074e640f09302eb6ac">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;};  </div>
<div class="line"><a name="l04673"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a5c6155d3bf00eb445425cad621ccb917"> 4673</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a5c6155d3bf00eb445425cad621ccb917" title="select objects with |eta| &gt;= absetamin">SelectorAbsEtaMin</a>(<span class="keywordtype">double</span> absetamin) {</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d5/ddc/classSW__QuantityMin.html">SW_QuantityMin&lt;QuantityAbsEta&gt;</a>(absetamin));</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;}</div>
<div class="line"><a name="l04676"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a8688f761704f0fc0f4788d61131dd9d2"> 4676</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a8688f761704f0fc0f4788d61131dd9d2" title="select objects with |eta| &lt;= absetamax">SelectorAbsEtaMax</a>(<span class="keywordtype">double</span> absetamax) {</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d0/ded/classSW__QuantityMax.html">SW_QuantityMax&lt;QuantityAbsEta&gt;</a>(absetamax));</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;}</div>
<div class="line"><a name="l04679"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#ad734210b4f5144bf69b84a5a3a8f3ecc"> 4679</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#ad734210b4f5144bf69b84a5a3a8f3ecc" title="select objects with absetamin &lt;= |eta| &lt;= absetamax">SelectorAbsEtaRange</a>(<span class="keywordtype">double</span> absetamin, <span class="keywordtype">double</span> absetamax) {</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../de/d4f/classSW__QuantityRange.html">SW_QuantityRange&lt;QuantityAbsEta&gt;</a>(absetamin, absetamax));</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;}</div>
<div class="line"><a name="l04682"></a><span class="lineno"><a class="code" href="../../da/d96/classSW__PhiRange.html"> 4682</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../da/d96/classSW__PhiRange.html">SW_PhiRange</a> : <span class="keyword">public</span> <a class="code" href="../../da/de9/classSelectorWorker.html">SelectorWorker</a> {</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04684"></a><span class="lineno"><a class="code" href="../../da/d96/classSW__PhiRange.html#ade72afd23151a62630684e30f6c4626f"> 4684</a></span>&#160;  <a class="code" href="../../da/d96/classSW__PhiRange.html#ade72afd23151a62630684e30f6c4626f">SW_PhiRange</a>(<span class="keywordtype">double</span> <a class="code" href="../../d6/d97/namespaceMATSCAN.html#ad3c7a8489627a27f4e16211c93e6a2c3">phimin</a>, <span class="keywordtype">double</span> phimax) : _phimin(phimin), _phimax(phimax){</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(_phimin&lt;_phimax);</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(_phimin&gt;-<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>);</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;    <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(_phimax&lt;2*<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>);</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;    _phispan = _phimax - _phimin;</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;  }</div>
<div class="line"><a name="l04690"></a><span class="lineno"><a class="code" href="../../da/d96/classSW__PhiRange.html#abed5d7aaf8408eaa8c91175b92507fd9"> 4690</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../da/d96/classSW__PhiRange.html#abed5d7aaf8408eaa8c91175b92507fd9">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>=jet.phi()-_phimin;</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;    <span class="keywordflow">if</span> (dphi &gt;= <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>) dphi -= <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>;</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;    <span class="keywordflow">if</span> (dphi &lt; 0)      dphi += <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>;</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;    <span class="keywordflow">return</span> (dphi &lt;= _phispan);</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;  }</div>
<div class="line"><a name="l04696"></a><span class="lineno"><a class="code" href="../../da/d96/classSW__PhiRange.html#aeaff01d5af6810aa7b90329fbbf218b0"> 4696</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../da/d96/classSW__PhiRange.html#aeaff01d5af6810aa7b90329fbbf218b0">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;    ostr &lt;&lt; _phimin &lt;&lt; <span class="stringliteral">&quot; &lt;= phi &lt;= &quot;</span> &lt;&lt; _phimax;</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;  }</div>
<div class="line"><a name="l04701"></a><span class="lineno"><a class="code" href="../../da/d96/classSW__PhiRange.html#a44b3d55cb8a7972acd7c323ca5e24739"> 4701</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../da/d96/classSW__PhiRange.html#a44b3d55cb8a7972acd7c323ca5e24739">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04703"></a><span class="lineno"><a class="code" href="../../da/d96/classSW__PhiRange.html#adf7afa1f74477f2300e65ecc4d7e7f29"> 4703</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../da/d96/classSW__PhiRange.html#adf7afa1f74477f2300e65ecc4d7e7f29">_phimin</a>;   <span class="comment">// the lower cut </span></div>
<div class="line"><a name="l04704"></a><span class="lineno"><a class="code" href="../../da/d96/classSW__PhiRange.html#a3d19e0786a54288adb5b26d5314c56cc"> 4704</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../da/d96/classSW__PhiRange.html#a3d19e0786a54288adb5b26d5314c56cc">_phimax</a>;   <span class="comment">// the upper cut</span></div>
<div class="line"><a name="l04705"></a><span class="lineno"><a class="code" href="../../da/d96/classSW__PhiRange.html#a3dc09a02b353046aa415d973a0b911ae"> 4705</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../da/d96/classSW__PhiRange.html#a3dc09a02b353046aa415d973a0b911ae">_phispan</a>;  <span class="comment">// the span of the range</span></div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;};</div>
<div class="line"><a name="l04707"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#aa68d50ae26565bb6355b21324b63f871"> 4707</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#aa68d50ae26565bb6355b21324b63f871" title="select objects with phimin &lt;= phi &lt;= phimax">SelectorPhiRange</a>(<span class="keywordtype">double</span> <a class="code" href="../../d6/d97/namespaceMATSCAN.html#ad3c7a8489627a27f4e16211c93e6a2c3">phimin</a>, <span class="keywordtype">double</span> phimax) {</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../da/d96/classSW__PhiRange.html">SW_PhiRange</a>(phimin, phimax));</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;}</div>
<div class="line"><a name="l04710"></a><span class="lineno"><a class="code" href="../../d4/d09/classSW__RapPhiRange.html"> 4710</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d4/d09/classSW__RapPhiRange.html">SW_RapPhiRange</a> : <span class="keyword">public</span> <a class="code" href="../../d8/d21/classSW__And.html">SW_And</a>{</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04712"></a><span class="lineno"><a class="code" href="../../d4/d09/classSW__RapPhiRange.html#ab5abca9493775732c6908a5ec3658c02"> 4712</a></span>&#160;  <a class="code" href="../../d4/d09/classSW__RapPhiRange.html">SW_RapPhiRange</a>(<span class="keywordtype">double</span> rapmin, <span class="keywordtype">double</span> rapmax, <span class="keywordtype">double</span> <a class="code" href="../../d6/d97/namespaceMATSCAN.html#ad3c7a8489627a27f4e16211c93e6a2c3">phimin</a>, <span class="keywordtype">double</span> phimax)</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;    : <a class="code" href="../../d8/d21/classSW__And.html">SW_And</a>(<a class="code" href="../../d8/d99/fjcore_8cc.html#a4d370a54cbb125e5673e24b80da31924" title="select objects with rapmin &lt;= rap &lt;= rapmax">SelectorRapRange</a>(rapmin, rapmax), <a class="code" href="../../d8/d99/fjcore_8cc.html#aa68d50ae26565bb6355b21324b63f871" title="select objects with phimin &lt;= phi &lt;= phimax">SelectorPhiRange</a>(phimin, phimax)){</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;    _known_area = ((phimax-phimin &gt; <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>) ? <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> : phimax-phimin) * (rapmax-rapmin);</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;  }</div>
<div class="line"><a name="l04716"></a><span class="lineno"><a class="code" href="../../d4/d09/classSW__RapPhiRange.html#aa25bfe6026a673cf78384a99a47995ae"> 4716</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d4/d09/classSW__RapPhiRange.html#aa25bfe6026a673cf78384a99a47995ae">known_area</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;    <span class="keywordflow">return</span> _known_area;</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;  }</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04720"></a><span class="lineno"><a class="code" href="../../d4/d09/classSW__RapPhiRange.html#af58240eb7cfa16cfb1c8ea1abe0c502a"> 4720</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d4/d09/classSW__RapPhiRange.html#af58240eb7cfa16cfb1c8ea1abe0c502a">_known_area</a>;</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;};</div>
<div class="line"><a name="l04722"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a33849b0745c9c2e97edc0f26f1bc1c08"> 4722</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a33849b0745c9c2e97edc0f26f1bc1c08">SelectorRapPhiRange</a>(<span class="keywordtype">double</span> rapmin, <span class="keywordtype">double</span> rapmax, <span class="keywordtype">double</span> <a class="code" href="../../d6/d97/namespaceMATSCAN.html#ad3c7a8489627a27f4e16211c93e6a2c3">phimin</a>, <span class="keywordtype">double</span> phimax) {</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d4/d09/classSW__RapPhiRange.html">SW_RapPhiRange</a>(rapmin, rapmax, phimin, phimax));</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;}</div>
<div class="line"><a name="l04725"></a><span class="lineno"><a class="code" href="../../de/d11/classSW__NHardest.html"> 4725</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../de/d11/classSW__NHardest.html">SW_NHardest</a> : <span class="keyword">public</span> <a class="code" href="../../da/de9/classSelectorWorker.html">SelectorWorker</a> {</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04727"></a><span class="lineno"><a class="code" href="../../de/d11/classSW__NHardest.html#a347f2851f74656690a7c8b7c071c7b8d"> 4727</a></span>&#160;  <a class="code" href="../../de/d11/classSW__NHardest.html#a347f2851f74656690a7c8b7c071c7b8d">SW_NHardest</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>) : _n(n) {};</div>
<div class="line"><a name="l04728"></a><span class="lineno"><a class="code" href="../../de/d11/classSW__NHardest.html#ac59da5b9c23b456ccb5d76d924a4aae0"> 4728</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../de/d11/classSW__NHardest.html#ac59da5b9c23b456ccb5d76d924a4aae0">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp;)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;    <span class="keywordflow">if</span> (!applies_jet_by_jet())</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;Cannot apply this selector worker to an individual jet&quot;</span>);</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;  }</div>
<div class="line"><a name="l04733"></a><span class="lineno"><a class="code" href="../../de/d11/classSW__NHardest.html#a17ee567fd9a9208f30437ed72477f931"> 4733</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/classSW__NHardest.html#a17ee567fd9a9208f30437ed72477f931">terminator</a>(vector&lt;const PseudoJet *&gt; &amp; jets)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;    <span class="keywordflow">if</span> (jets.size() &lt; _n) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;    vector&lt;double&gt; minus_pt2(jets.size());</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;    vector&lt;unsigned int&gt; indices(jets.size());</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt;jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++){</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;      indices[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>;</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;      minus_pt2[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] ? -jets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]-&gt;perp2() : 0.0;</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;    }</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;    <a class="code" href="../../d3/db9/classIndexedSortHelper.html">IndexedSortHelper</a> sort_helper(&amp; minus_pt2);</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;    partial_sort(indices.begin(), indices.begin()+_n, indices.end(), sort_helper);</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=_n; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt;jets.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++)</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;      jets[indices[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]] = NULL;</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;  }</div>
<div class="line"><a name="l04746"></a><span class="lineno"><a class="code" href="../../de/d11/classSW__NHardest.html#a824e9fa93796c21d7ed272b04151e566"> 4746</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../de/d11/classSW__NHardest.html#a824e9fa93796c21d7ed272b04151e566">applies_jet_by_jet</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="keyword">false</span>;}</div>
<div class="line"><a name="l04747"></a><span class="lineno"><a class="code" href="../../de/d11/classSW__NHardest.html#a1f32b1141f37e15b1fcf06947b1a0d2f"> 4747</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../de/d11/classSW__NHardest.html#a1f32b1141f37e15b1fcf06947b1a0d2f">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;    ostr &lt;&lt; _n &lt;&lt; <span class="stringliteral">&quot; hardest&quot;</span>;</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;  }</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04753"></a><span class="lineno"><a class="code" href="../../de/d11/classSW__NHardest.html#ae878300ccc7ebc6ba10da5f4654d2115"> 4753</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/classSW__NHardest.html#ae878300ccc7ebc6ba10da5f4654d2115">_n</a>;</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;};</div>
<div class="line"><a name="l04755"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a93302534916fb459ee021663e9ce42d3"> 4755</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a93302534916fb459ee021663e9ce42d3">SelectorNHardest</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>) {</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../de/d11/classSW__NHardest.html">SW_NHardest</a>(n));</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;}</div>
<div class="line"><a name="l04758"></a><span class="lineno"><a class="code" href="../../d6/dd6/classSW__WithReference.html"> 4758</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d6/dd6/classSW__WithReference.html">SW_WithReference</a> : <span class="keyword">public</span> SelectorWorker{</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04760"></a><span class="lineno"><a class="code" href="../../d6/dd6/classSW__WithReference.html#ad3aa4ec1f4a68e3dc455a5a53119b029"> 4760</a></span>&#160;  <a class="code" href="../../d6/dd6/classSW__WithReference.html#ad3aa4ec1f4a68e3dc455a5a53119b029">SW_WithReference</a>() : _is_initialised(<a class="code" href="../../d5/dc0/BoolDefs_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>){};</div>
<div class="line"><a name="l04761"></a><span class="lineno"><a class="code" href="../../d6/dd6/classSW__WithReference.html#af714c1c2c2cf0a027813c1ca77d5095d"> 4761</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d6/dd6/classSW__WithReference.html#af714c1c2c2cf0a027813c1ca77d5095d">takes_reference</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}</div>
<div class="line"><a name="l04762"></a><span class="lineno"><a class="code" href="../../d6/dd6/classSW__WithReference.html#a087fd60173d8a3d9abeab6ccfbc4db68"> 4762</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/dd6/classSW__WithReference.html#a087fd60173d8a3d9abeab6ccfbc4db68">set_reference</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp;centre){</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;    _is_initialised = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;    _reference = centre;</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;  }</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04767"></a><span class="lineno"><a class="code" href="../../d6/dd6/classSW__WithReference.html#a31985a81b909358ce7013f63324a66b2"> 4767</a></span>&#160;  <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> <a class="code" href="../../d6/dd6/classSW__WithReference.html#a31985a81b909358ce7013f63324a66b2">_reference</a>;</div>
<div class="line"><a name="l04768"></a><span class="lineno"><a class="code" href="../../d6/dd6/classSW__WithReference.html#a0fcb7b74ae7f74fc9095b3debe5794a3"> 4768</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d6/dd6/classSW__WithReference.html#a0fcb7b74ae7f74fc9095b3debe5794a3">_is_initialised</a>;</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;};</div>
<div class="line"><a name="l04770"></a><span class="lineno"><a class="code" href="../../d2/dbe/classSW__Circle.html"> 4770</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d2/dbe/classSW__Circle.html">SW_Circle</a> : <span class="keyword">public</span> <a class="code" href="../../d6/dd6/classSW__WithReference.html">SW_WithReference</a> {</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04772"></a><span class="lineno"><a class="code" href="../../d2/dbe/classSW__Circle.html#afdca1e6fa58bbe3bb673b2952f8de24d"> 4772</a></span>&#160;  <a class="code" href="../../d2/dbe/classSW__Circle.html#afdca1e6fa58bbe3bb673b2952f8de24d">SW_Circle</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> radius) : _radius2(radius*radius) {}</div>
<div class="line"><a name="l04773"></a><span class="lineno"><a class="code" href="../../d2/dbe/classSW__Circle.html#a0e7fcd144ba7fc8c274f31d5d0ff5e92"> 4773</a></span>&#160;  <span class="keyword">virtual</span> SelectorWorker* <a class="code" href="../../d2/dbe/classSW__Circle.html#a0e7fcd144ba7fc8c274f31d5d0ff5e92">copy</a>(){ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="../../d2/dbe/classSW__Circle.html">SW_Circle</a>(*<span class="keyword">this</span>);}</div>
<div class="line"><a name="l04774"></a><span class="lineno"><a class="code" href="../../d2/dbe/classSW__Circle.html#a7ab81b2b0eff0640967aa5fa885338ae"> 4774</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d2/dbe/classSW__Circle.html#a7ab81b2b0eff0640967aa5fa885338ae">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;    <span class="keywordflow">if</span> (! _is_initialised)</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;To use a SelectorCircle (or any selector that requires a reference), you first have to call set_reference(...)&quot;</span>);</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;    <span class="keywordflow">return</span> jet.squared_distance(_reference) &lt;= _radius2;</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;  } </div>
<div class="line"><a name="l04779"></a><span class="lineno"><a class="code" href="../../d2/dbe/classSW__Circle.html#ae480ddf48fad90ff2366cee0baca4b20"> 4779</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d2/dbe/classSW__Circle.html#ae480ddf48fad90ff2366cee0baca4b20">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;    ostr &lt;&lt; <span class="stringliteral">&quot;distance from the centre &lt;= &quot;</span> &lt;&lt; sqrt(_radius2);</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;  }</div>
<div class="line"><a name="l04784"></a><span class="lineno"><a class="code" href="../../d2/dbe/classSW__Circle.html#a480e6ad368bd9986fcada663e3460a60"> 4784</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d2/dbe/classSW__Circle.html#a480e6ad368bd9986fcada663e3460a60">get_rapidity_extent</a>(<span class="keywordtype">double</span> &amp; rapmin, <span class="keywordtype">double</span> &amp; rapmax)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;    <span class="keywordflow">if</span> (! _is_initialised)</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;To use a SelectorCircle (or any selector that requires a reference), you first have to call set_reference(...)&quot;</span>);</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;    rapmax = _reference.rap()+sqrt(_radius2);</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;    rapmin = _reference.rap()-sqrt(_radius2);</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;  }</div>
<div class="line"><a name="l04790"></a><span class="lineno"><a class="code" href="../../d2/dbe/classSW__Circle.html#ac9799d93308267d6581841782d7662cb"> 4790</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d2/dbe/classSW__Circle.html#ac9799d93308267d6581841782d7662cb" title="implies a finite area">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}    </div>
<div class="line"><a name="l04791"></a><span class="lineno"><a class="code" href="../../d2/dbe/classSW__Circle.html#a5f4a153bae7c44e7cce170618b42dae5"> 4791</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d2/dbe/classSW__Circle.html#a5f4a153bae7c44e7cce170618b42dae5" title="regardless of the reference">has_finite_area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;} </div>
<div class="line"><a name="l04792"></a><span class="lineno"><a class="code" href="../../d2/dbe/classSW__Circle.html#a53de992704114a24d2a573617e1b2d6a"> 4792</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d2/dbe/classSW__Circle.html#a53de992704114a24d2a573617e1b2d6a" title="the area is analytically known">has_known_area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}  </div>
<div class="line"><a name="l04793"></a><span class="lineno"><a class="code" href="../../d2/dbe/classSW__Circle.html#acba31423f988e51b44f910e9c3280fb3"> 4793</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d2/dbe/classSW__Circle.html#acba31423f988e51b44f910e9c3280fb3">known_area</a>()<span class="keyword"> const </span>{ </div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a> * _radius2;</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;  }</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04797"></a><span class="lineno"><a class="code" href="../../d2/dbe/classSW__Circle.html#a725dd0faf36fa973e9e8aae7464b4f1b"> 4797</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d2/dbe/classSW__Circle.html#a725dd0faf36fa973e9e8aae7464b4f1b">_radius2</a>;</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;};</div>
<div class="line"><a name="l04799"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a674956f6927ada1c013a9966e50ebab7"> 4799</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a674956f6927ada1c013a9966e50ebab7">SelectorCircle</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> radius) {</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d2/dbe/classSW__Circle.html">SW_Circle</a>(radius));</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;}</div>
<div class="line"><a name="l04802"></a><span class="lineno"><a class="code" href="../../d6/df6/classSW__Doughnut.html"> 4802</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d6/df6/classSW__Doughnut.html">SW_Doughnut</a> : <span class="keyword">public</span> <a class="code" href="../../d6/dd6/classSW__WithReference.html">SW_WithReference</a> {</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04804"></a><span class="lineno"><a class="code" href="../../d6/df6/classSW__Doughnut.html#aea0a9410673b819e3af223166b354b4a"> 4804</a></span>&#160;  <a class="code" href="../../d6/df6/classSW__Doughnut.html">SW_Doughnut</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> radius_in, <span class="keyword">const</span> <span class="keywordtype">double</span> radius_out)</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;    : _radius_in2(radius_in*radius_in), _radius_out2(radius_out*radius_out) {}</div>
<div class="line"><a name="l04806"></a><span class="lineno"><a class="code" href="../../d6/df6/classSW__Doughnut.html#a5b989ec8f3f63cbefc7fc2fd027c098d"> 4806</a></span>&#160;  <span class="keyword">virtual</span> SelectorWorker* <a class="code" href="../../d6/df6/classSW__Doughnut.html#a5b989ec8f3f63cbefc7fc2fd027c098d">copy</a>(){ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="../../d6/df6/classSW__Doughnut.html">SW_Doughnut</a>(*<span class="keyword">this</span>);}</div>
<div class="line"><a name="l04807"></a><span class="lineno"><a class="code" href="../../d6/df6/classSW__Doughnut.html#aa6b033339ef47a1731bfbaea5291b0e9"> 4807</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d6/df6/classSW__Doughnut.html#aa6b033339ef47a1731bfbaea5291b0e9">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;    <span class="keywordflow">if</span> (! _is_initialised)</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;To use a SelectorDoughnut (or any selector that requires a reference), you first have to call set_reference(...)&quot;</span>);</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;    <span class="keywordtype">double</span> distance2 = jet.squared_distance(_reference);</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;    <span class="keywordflow">return</span> (distance2 &lt;= _radius_out2) &amp;&amp; (distance2 &gt;= _radius_in2);</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;  } </div>
<div class="line"><a name="l04813"></a><span class="lineno"><a class="code" href="../../d6/df6/classSW__Doughnut.html#a468a4e52cf64cb0c08305d2f36f879a0"> 4813</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d6/df6/classSW__Doughnut.html#a468a4e52cf64cb0c08305d2f36f879a0">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;    ostr &lt;&lt; sqrt(_radius_in2) &lt;&lt; <span class="stringliteral">&quot; &lt;= distance from the centre &lt;= &quot;</span> &lt;&lt; sqrt(_radius_out2);</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;  }</div>
<div class="line"><a name="l04818"></a><span class="lineno"><a class="code" href="../../d6/df6/classSW__Doughnut.html#a2cac4d98bfe8d9a9acc85bf50ef35404"> 4818</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/df6/classSW__Doughnut.html#a2cac4d98bfe8d9a9acc85bf50ef35404">get_rapidity_extent</a>(<span class="keywordtype">double</span> &amp; rapmin, <span class="keywordtype">double</span> &amp; rapmax)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;    <span class="keywordflow">if</span> (! _is_initialised)</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;To use a SelectorDoughnut (or any selector that requires a reference), you first have to call set_reference(...)&quot;</span>);</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;    rapmax = _reference.rap()+sqrt(_radius_out2);</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;    rapmin = _reference.rap()-sqrt(_radius_out2);</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;  }</div>
<div class="line"><a name="l04824"></a><span class="lineno"><a class="code" href="../../d6/df6/classSW__Doughnut.html#a5a73a6f5cf34b63cb7124656da2af392"> 4824</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d6/df6/classSW__Doughnut.html#a5a73a6f5cf34b63cb7124656da2af392" title="implies a finite area">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}    </div>
<div class="line"><a name="l04825"></a><span class="lineno"><a class="code" href="../../d6/df6/classSW__Doughnut.html#a03de2fdf8f4652f84ed0bec77e59d451"> 4825</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d6/df6/classSW__Doughnut.html#a03de2fdf8f4652f84ed0bec77e59d451" title="regardless of the reference">has_finite_area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;} </div>
<div class="line"><a name="l04826"></a><span class="lineno"><a class="code" href="../../d6/df6/classSW__Doughnut.html#af2c29879aee896a3dad38cf8fec2f309"> 4826</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d6/df6/classSW__Doughnut.html#af2c29879aee896a3dad38cf8fec2f309" title="the area is analytically known">has_known_area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}  </div>
<div class="line"><a name="l04827"></a><span class="lineno"><a class="code" href="../../d6/df6/classSW__Doughnut.html#abe8d41f8f5cf8f3ad0fc83c73835ad25"> 4827</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d6/df6/classSW__Doughnut.html#abe8d41f8f5cf8f3ad0fc83c73835ad25">known_area</a>()<span class="keyword"> const </span>{ </div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a> * (_radius_out2-_radius_in2);</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;  }</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04831"></a><span class="lineno"><a class="code" href="../../d6/df6/classSW__Doughnut.html#a965f73df250258a525b43081fb6dd4de"> 4831</a></span>&#160;  <span class="keywordtype">double</span> _radius_in2, <a class="code" href="../../d6/df6/classSW__Doughnut.html#a965f73df250258a525b43081fb6dd4de">_radius_out2</a>;</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;};</div>
<div class="line"><a name="l04833"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#ad075821e33bc6e9759f833110626af11"> 4833</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#ad075821e33bc6e9759f833110626af11">SelectorDoughnut</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> radius_in, <span class="keyword">const</span> <span class="keywordtype">double</span> radius_out) {</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d6/df6/classSW__Doughnut.html">SW_Doughnut</a>(radius_in, radius_out));</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;}</div>
<div class="line"><a name="l04836"></a><span class="lineno"><a class="code" href="../../d0/d67/classSW__Strip.html"> 4836</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d0/d67/classSW__Strip.html">SW_Strip</a> : <span class="keyword">public</span> <a class="code" href="../../d6/dd6/classSW__WithReference.html">SW_WithReference</a> {</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04838"></a><span class="lineno"><a class="code" href="../../d0/d67/classSW__Strip.html#af1bfb124e6fc5365c2471d416f73baae"> 4838</a></span>&#160;  <a class="code" href="../../d0/d67/classSW__Strip.html#af1bfb124e6fc5365c2471d416f73baae">SW_Strip</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../de/dcc/namespacephysmon__vertexing.html#a06474410959c4c89c2797f21085fb2c5">delta</a>) : _delta(delta) {}</div>
<div class="line"><a name="l04839"></a><span class="lineno"><a class="code" href="../../d0/d67/classSW__Strip.html#a5263301b83b0f1fb2862cdfc5867d8c1"> 4839</a></span>&#160;  <span class="keyword">virtual</span> SelectorWorker* <a class="code" href="../../d0/d67/classSW__Strip.html#a5263301b83b0f1fb2862cdfc5867d8c1">copy</a>(){ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="../../d0/d67/classSW__Strip.html">SW_Strip</a>(*<span class="keyword">this</span>);}</div>
<div class="line"><a name="l04840"></a><span class="lineno"><a class="code" href="../../d0/d67/classSW__Strip.html#a84d2a8001995fd677797ceb90e5680af"> 4840</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d0/d67/classSW__Strip.html#a84d2a8001995fd677797ceb90e5680af">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;    <span class="keywordflow">if</span> (! _is_initialised)</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;To use a SelectorStrip (or any selector that requires a reference), you first have to call set_reference(...)&quot;</span>);</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;    <span class="keywordflow">return</span> abs(jet.rap()-_reference.rap()) &lt;= _delta;</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;  } </div>
<div class="line"><a name="l04845"></a><span class="lineno"><a class="code" href="../../d0/d67/classSW__Strip.html#a427b4cac36b6f22eb4f1ccf9447c3e27"> 4845</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d0/d67/classSW__Strip.html#a427b4cac36b6f22eb4f1ccf9447c3e27">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;    ostr &lt;&lt; <span class="stringliteral">&quot;|rap - rap_reference| &lt;= &quot;</span> &lt;&lt; _delta;</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;  }</div>
<div class="line"><a name="l04850"></a><span class="lineno"><a class="code" href="../../d0/d67/classSW__Strip.html#a36ae309ade07f9816e9f0bcc9e5d4b55"> 4850</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d67/classSW__Strip.html#a36ae309ade07f9816e9f0bcc9e5d4b55">get_rapidity_extent</a>(<span class="keywordtype">double</span> &amp; rapmin, <span class="keywordtype">double</span> &amp; rapmax)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;    <span class="keywordflow">if</span> (! _is_initialised)</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;To use a SelectorStrip (or any selector that requires a reference), you first have to call set_reference(...)&quot;</span>);</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;    rapmax = _reference.rap()+_delta;</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;    rapmin = _reference.rap()-_delta;</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;  }</div>
<div class="line"><a name="l04856"></a><span class="lineno"><a class="code" href="../../d0/d67/classSW__Strip.html#acc48160c2401043f79695fbd3914fdda"> 4856</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d0/d67/classSW__Strip.html#acc48160c2401043f79695fbd3914fdda" title="implies a finite area">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}    </div>
<div class="line"><a name="l04857"></a><span class="lineno"><a class="code" href="../../d0/d67/classSW__Strip.html#abf8de82d55eb15a0460c5296ccd2e74f"> 4857</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d0/d67/classSW__Strip.html#abf8de82d55eb15a0460c5296ccd2e74f" title="regardless of the reference">has_finite_area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;} </div>
<div class="line"><a name="l04858"></a><span class="lineno"><a class="code" href="../../d0/d67/classSW__Strip.html#a84b70f39f5978e99fdebc46dae935b96"> 4858</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d0/d67/classSW__Strip.html#a84b70f39f5978e99fdebc46dae935b96" title="the area is analytically known">has_known_area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}  </div>
<div class="line"><a name="l04859"></a><span class="lineno"><a class="code" href="../../d0/d67/classSW__Strip.html#a663786f9a29d1cf1d1bbbf042515a4ff"> 4859</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d0/d67/classSW__Strip.html#a663786f9a29d1cf1d1bbbf042515a4ff">known_area</a>()<span class="keyword"> const </span>{ </div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> * 2 * _delta;</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;  }</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04863"></a><span class="lineno"><a class="code" href="../../d0/d67/classSW__Strip.html#a3cc95230e4489c0e9bd4750fa915c0fe"> 4863</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d0/d67/classSW__Strip.html#a3cc95230e4489c0e9bd4750fa915c0fe">_delta</a>;</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;};</div>
<div class="line"><a name="l04865"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a0034ac0a3872934f5365329acb8b7ba4"> 4865</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a0034ac0a3872934f5365329acb8b7ba4">SelectorStrip</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> half_width) {</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d0/d67/classSW__Strip.html">SW_Strip</a>(half_width));</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;}</div>
<div class="line"><a name="l04868"></a><span class="lineno"><a class="code" href="../../d3/d87/classSW__Rectangle.html"> 4868</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d3/d87/classSW__Rectangle.html">SW_Rectangle</a> : <span class="keyword">public</span> <a class="code" href="../../d6/dd6/classSW__WithReference.html">SW_WithReference</a> {</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04870"></a><span class="lineno"><a class="code" href="../../d3/d87/classSW__Rectangle.html#a4ca0bf03d8ee0a8588d0b42bf6eb7716"> 4870</a></span>&#160;  <a class="code" href="../../d3/d87/classSW__Rectangle.html">SW_Rectangle</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> delta_rap, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#af302a003baa57717a4371eeee3999460">delta_phi</a>)</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;    : _delta_rap(delta_rap),  _delta_phi(delta_phi) {}</div>
<div class="line"><a name="l04872"></a><span class="lineno"><a class="code" href="../../d3/d87/classSW__Rectangle.html#a91473f87bc9bcdd43bfbc20cb9ff9e45"> 4872</a></span>&#160;  <span class="keyword">virtual</span> SelectorWorker* <a class="code" href="../../d3/d87/classSW__Rectangle.html#a91473f87bc9bcdd43bfbc20cb9ff9e45">copy</a>(){ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="../../d3/d87/classSW__Rectangle.html">SW_Rectangle</a>(*<span class="keyword">this</span>);}</div>
<div class="line"><a name="l04873"></a><span class="lineno"><a class="code" href="../../d3/d87/classSW__Rectangle.html#a89ca6c14baf88135ffd16ceab51e8152"> 4873</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d3/d87/classSW__Rectangle.html#a89ca6c14baf88135ffd16ceab51e8152">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;    <span class="keywordflow">if</span> (! _is_initialised)</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;To use a SelectorRectangle (or any selector that requires a reference), you first have to call set_reference(...)&quot;</span>);</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;    <span class="keywordflow">return</span> (abs(jet.rap()-_reference.rap()) &lt;= _delta_rap) &amp;&amp; (abs(jet.delta_phi_to(_reference)) &lt;= _delta_phi);</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;  } </div>
<div class="line"><a name="l04878"></a><span class="lineno"><a class="code" href="../../d3/d87/classSW__Rectangle.html#a7ed2b01da29dfc45345d40354cb6474d"> 4878</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../d3/d87/classSW__Rectangle.html#a7ed2b01da29dfc45345d40354cb6474d">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;    ostr &lt;&lt; <span class="stringliteral">&quot;|rap - rap_reference| &lt;= &quot;</span> &lt;&lt; _delta_rap &lt;&lt; <span class="stringliteral">&quot; &amp;&amp; |phi - phi_reference| &lt;= &quot;</span> &lt;&lt; _delta_phi ;</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;  }</div>
<div class="line"><a name="l04883"></a><span class="lineno"><a class="code" href="../../d3/d87/classSW__Rectangle.html#a71377de2356eaf36a78052e29e21cb70"> 4883</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d3/d87/classSW__Rectangle.html#a71377de2356eaf36a78052e29e21cb70">get_rapidity_extent</a>(<span class="keywordtype">double</span> &amp; rapmin, <span class="keywordtype">double</span> &amp; rapmax)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;    <span class="keywordflow">if</span> (! _is_initialised)</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;To use a SelectorRectangle (or any selector that requires a reference), you first have to call set_reference(...)&quot;</span>);</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;    rapmax = _reference.rap()+_delta_rap;</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;    rapmin = _reference.rap()-_delta_rap;</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;  }</div>
<div class="line"><a name="l04889"></a><span class="lineno"><a class="code" href="../../d3/d87/classSW__Rectangle.html#ab73f6de92de3266ea438e42eab8edf0a"> 4889</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d3/d87/classSW__Rectangle.html#ab73f6de92de3266ea438e42eab8edf0a" title="implies a finite area">is_geometric</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}    </div>
<div class="line"><a name="l04890"></a><span class="lineno"><a class="code" href="../../d3/d87/classSW__Rectangle.html#a68ab4cc86fc89720ca7e16328133a836"> 4890</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d3/d87/classSW__Rectangle.html#a68ab4cc86fc89720ca7e16328133a836" title="regardless of the reference">has_finite_area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;} </div>
<div class="line"><a name="l04891"></a><span class="lineno"><a class="code" href="../../d3/d87/classSW__Rectangle.html#a4d8fd135b847856ab94daba43fabc7de"> 4891</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d3/d87/classSW__Rectangle.html#a4d8fd135b847856ab94daba43fabc7de" title="the area is analytically known">has_known_area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>;}  </div>
<div class="line"><a name="l04892"></a><span class="lineno"><a class="code" href="../../d3/d87/classSW__Rectangle.html#a4d28ea53ea8894c96f6138b187a55938"> 4892</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="../../d3/d87/classSW__Rectangle.html#a4d28ea53ea8894c96f6138b187a55938">known_area</a>()<span class="keyword"> const </span>{ </div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;    <span class="keywordflow">return</span> 4 * _delta_rap * _delta_phi;</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;  }</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04896"></a><span class="lineno"><a class="code" href="../../d3/d87/classSW__Rectangle.html#a6b4a1eb836449874116307b9b21b3c7e"> 4896</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/d87/classSW__Rectangle.html#a6b4a1eb836449874116307b9b21b3c7e">_delta_rap</a>, _delta_phi;</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;};</div>
<div class="line"><a name="l04898"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a7256483396508746bbb079dc8b06b6e5"> 4898</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a7256483396508746bbb079dc8b06b6e5">SelectorRectangle</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> half_rap_width, <span class="keyword">const</span> <span class="keywordtype">double</span> half_phi_width) {</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../d3/d87/classSW__Rectangle.html">SW_Rectangle</a>(half_rap_width, half_phi_width));</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;}</div>
<div class="line"><a name="l04901"></a><span class="lineno"><a class="code" href="../../dc/ddc/classSW__PtFractionMin.html"> 4901</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../dc/ddc/classSW__PtFractionMin.html">SW_PtFractionMin</a> : <span class="keyword">public</span> <a class="code" href="../../d6/dd6/classSW__WithReference.html">SW_WithReference</a> {</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04903"></a><span class="lineno"><a class="code" href="../../dc/ddc/classSW__PtFractionMin.html#ad4e0b69443fad652ac96770cec9eb125"> 4903</a></span>&#160;  <a class="code" href="../../dc/ddc/classSW__PtFractionMin.html#ad4e0b69443fad652ac96770cec9eb125">SW_PtFractionMin</a>(<span class="keywordtype">double</span> fraction) : _fraction2(fraction*fraction){}</div>
<div class="line"><a name="l04904"></a><span class="lineno"><a class="code" href="../../dc/ddc/classSW__PtFractionMin.html#a18c8faa850ba7b83f59361542ec12a74"> 4904</a></span>&#160;  <span class="keyword">virtual</span> SelectorWorker* <a class="code" href="../../dc/ddc/classSW__PtFractionMin.html#a18c8faa850ba7b83f59361542ec12a74">copy</a>(){ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="../../dc/ddc/classSW__PtFractionMin.html">SW_PtFractionMin</a>(*<span class="keyword">this</span>);}</div>
<div class="line"><a name="l04905"></a><span class="lineno"><a class="code" href="../../dc/ddc/classSW__PtFractionMin.html#a142b3c376cb4f27cb044d9488f83648b"> 4905</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../dc/ddc/classSW__PtFractionMin.html#a142b3c376cb4f27cb044d9488f83648b">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;    <span class="keywordflow">if</span> (! _is_initialised)</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d9/dd6/classError.html">Error</a>(<span class="stringliteral">&quot;To use a SelectorPtFractionMin (or any selector that requires a reference), you first have to call set_reference(...)&quot;</span>);</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;    <span class="keywordflow">return</span> (jet.perp2() &gt;= _fraction2*_reference.perp2());</div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;  }</div>
<div class="line"><a name="l04910"></a><span class="lineno"><a class="code" href="../../dc/ddc/classSW__PtFractionMin.html#a2d1353493f2e9a7f2d3f24e713670afd"> 4910</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../dc/ddc/classSW__PtFractionMin.html#a2d1353493f2e9a7f2d3f24e713670afd">description</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;    ostringstream ostr;</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;    ostr &lt;&lt; <span class="stringliteral">&quot;pt &gt;= &quot;</span> &lt;&lt; sqrt(_fraction2) &lt;&lt; <span class="stringliteral">&quot;* pt_ref&quot;</span>;</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;    <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;  }</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l04916"></a><span class="lineno"><a class="code" href="../../dc/ddc/classSW__PtFractionMin.html#a79bfb6a8413e83f4bdeffecfdc014269"> 4916</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/ddc/classSW__PtFractionMin.html#a79bfb6a8413e83f4bdeffecfdc014269">_fraction2</a>;</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;};</div>
<div class="line"><a name="l04918"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#acdc7b1a22b35591f488fb1f37ce67dc2"> 4918</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#acdc7b1a22b35591f488fb1f37ce67dc2">SelectorPtFractionMin</a>(<span class="keywordtype">double</span> fraction){</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../dc/ddc/classSW__PtFractionMin.html">SW_PtFractionMin</a>(fraction));</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;}</div>
<div class="line"><a name="l04921"></a><span class="lineno"><a class="code" href="../../db/dff/classSW__IsZero.html"> 4921</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../db/dff/classSW__IsZero.html">SW_IsZero</a> : <span class="keyword">public</span> <a class="code" href="../../da/de9/classSelectorWorker.html">SelectorWorker</a> {</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04923"></a><span class="lineno"><a class="code" href="../../db/dff/classSW__IsZero.html#adb5af55a5f62f99cd2aa703dd00aebc1"> 4923</a></span>&#160;  <a class="code" href="../../db/dff/classSW__IsZero.html#adb5af55a5f62f99cd2aa703dd00aebc1">SW_IsZero</a>(){}</div>
<div class="line"><a name="l04924"></a><span class="lineno"><a class="code" href="../../db/dff/classSW__IsZero.html#a63d519d63502929ddec87ec8f8e5d949"> 4924</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../db/dff/classSW__IsZero.html#a63d519d63502929ddec87ec8f8e5d949">pass</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d30/classPseudoJet.html#ab6eed0f9eec865ee5e501f8549328a15">PseudoJet</a> &amp; jet)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;    <span class="keywordflow">return</span> jet==0;</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;  }</div>
<div class="line"><a name="l04927"></a><span class="lineno"><a class="code" href="../../db/dff/classSW__IsZero.html#ae7c4b39b648059f9c870d8a1a809aa41"> 4927</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="../../db/dff/classSW__IsZero.html#ae7c4b39b648059f9c870d8a1a809aa41">description</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;zero&quot;</span>;}</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;};</div>
<div class="line"><a name="l04929"></a><span class="lineno"><a class="code" href="../../d6/db0/fjcore_8hh.html#a6d6522b61cbc32fcd132c7d86c5c6dc5"> 4929</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> <a class="code" href="../../d8/d99/fjcore_8cc.html#a6d6522b61cbc32fcd132c7d86c5c6dc5">SelectorIsZero</a>(){</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a>(<span class="keyword">new</span> <a class="code" href="../../db/dff/classSW__IsZero.html">SW_IsZero</a>());</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;}</div>
<div class="line"><a name="l04932"></a><span class="lineno"><a class="code" href="../../d1/d54/classSelector.html#a5a9861721292f63e2cf29209c0f7132f"> 4932</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; <a class="code" href="../../d1/d54/classSelector.html#a5a9861721292f63e2cf29209c0f7132f">Selector::operator &amp;=</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; <a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>){</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;  _worker.reset(<span class="keyword">new</span> <a class="code" href="../../d8/d21/classSW__And.html">SW_And</a>(*<span class="keyword">this</span>, b));</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;}</div>
<div class="line"><a name="l04936"></a><span class="lineno"><a class="code" href="../../d1/d54/classSelector.html#ace7da132f85c252b945771424bb163bd"> 4936</a></span>&#160;<a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; <a class="code" href="../../d1/d54/classSelector.html#ace7da132f85c252b945771424bb163bd">Selector::operator |=</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d54/classSelector.html">Selector</a> &amp; <a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>){</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;  _worker.reset(<span class="keyword">new</span> <a class="code" href="../../de/da7/classSW__Or.html">SW_Or</a>(*<span class="keyword">this</span>, b));</div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;}</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l04944"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a78d4f72da11344fc1f002a45dc081e1a"> 4944</a></span>&#160;<a class="code" href="../../d8/dbe/classLazyTiling25.html#a78d4f72da11344fc1f002a45dc081e1a">LazyTiling25::LazyTiling25</a>(ClusterSequence &amp; cs) :</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;  _cs(cs), _jets(cs.jets())</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;{</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;<span class="preprocessor"></span>  _ncall = 0; <span class="comment">// gps tmp</span></div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;  _ncall_dtt = 0; <span class="comment">// gps tmp</span></div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;<span class="preprocessor">#endif // INSTRUMENT2</span></div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../d8/dbe/classLazyTiling25.html#a603c707072007bc635053031ecd05c53">_Rparam</a> = cs.jet_def().R();</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;  <a class="code" href="../../d8/dbe/classLazyTiling25.html#a55f87aa88a07215b86961042276d8cb7">_R2</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a603c707072007bc635053031ecd05c53">_Rparam</a> * <a class="code" href="../../d8/dbe/classLazyTiling25.html#a603c707072007bc635053031ecd05c53">_Rparam</a>;</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;  <a class="code" href="../../d8/dbe/classLazyTiling25.html#ac84f226ec67629cfa423dd82653fbc02">_invR2</a> = 1.0 / <a class="code" href="../../d8/dbe/classLazyTiling25.html#a55f87aa88a07215b86961042276d8cb7">_R2</a>;</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;  <a class="code" href="../../d8/dbe/classLazyTiling25.html#a3177ddbdd51ae44c26edeafa52235dbb">_initialise_tiles</a>();</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;}</div>
<div class="line"><a name="l04956"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a3177ddbdd51ae44c26edeafa52235dbb"> 4956</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#a3177ddbdd51ae44c26edeafa52235dbb">LazyTiling25::_initialise_tiles</a>() {</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;  <span class="keywordtype">double</span> default_size = max(0.1,<a class="code" href="../../d8/dbe/classLazyTiling25.html#a603c707072007bc635053031ecd05c53">_Rparam</a>)/2;</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;  <a class="code" href="../../d8/dbe/classLazyTiling25.html#adef3e9944f9b5349bd92d26e116b81aa">_tile_size_eta</a> = default_size;</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;  <a class="code" href="../../d8/dbe/classLazyTiling25.html#a549a3230a3c3efe5b05a26fa4efe2607">_n_tiles_phi</a>   = max(5,<span class="keywordtype">int</span>(floor(<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>/default_size)));</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;  <a class="code" href="../../d8/dbe/classLazyTiling25.html#aa5358fd1f9c21e918781c6673f84bd80">_tile_size_phi</a> = <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> / <a class="code" href="../../d8/dbe/classLazyTiling25.html#a549a3230a3c3efe5b05a26fa4efe2607">_n_tiles_phi</a>; <span class="comment">// &gt;= _Rparam and fits in 2pi</span></div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;<span class="preprocessor">#define _FJCORE_TILING25_USE_TILING_ANALYSIS_</span></div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef  _FASTJET_TILING25_USE_TILING_ANALYSIS_</span></div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../da/dd5/classTilingExtent.html">TilingExtent</a> tiling_analysis(<a class="code" href="../../d8/dbe/classLazyTiling25.html#a69f84d613408c8f4d1917d93d38520cc">_cs</a>);</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;  <a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d">_tiles_eta_min</a> = tiling_analysis.<a class="code" href="../../da/dd5/classTilingExtent.html#a69f512777159849c7455dd6c68366c9a">minrap</a>();</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;  <a class="code" href="../../d8/dbe/classLazyTiling25.html#a469af04a7362bcd08775822b767ca081">_tiles_eta_max</a> = tiling_analysis.<a class="code" href="../../da/dd5/classTilingExtent.html#a0800e910cd13b69b161525c8864af207">maxrap</a>();</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;<span class="preprocessor">#else // not _FASTJET_TILING25_USE_TILING_ANALYSIS_</span></div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d">_tiles_eta_min</a> = 0.0;</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;  <a class="code" href="../../d8/dbe/classLazyTiling25.html#a469af04a7362bcd08775822b767ca081">_tiles_eta_max</a> = 0.0;</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> maxrap = 7.0;</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#aa3dd12e7ad4a1988b0115d69dad372ae">_jets</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;    <span class="keywordtype">double</span> eta = <a class="code" href="../../d8/dbe/classLazyTiling25.html#aa3dd12e7ad4a1988b0115d69dad372ae">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].rap();</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;    <span class="keywordflow">if</span> (abs(eta) &lt; maxrap) {</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;      <span class="keywordflow">if</span> (eta &lt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d">_tiles_eta_min</a>) {<a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d">_tiles_eta_min</a> = <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#aa66df887c67e0d1025831e9998ea2415">eta</a>;}</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;      <span class="keywordflow">if</span> (eta &gt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a469af04a7362bcd08775822b767ca081">_tiles_eta_max</a>) {<a class="code" href="../../d8/dbe/classLazyTiling25.html#a469af04a7362bcd08775822b767ca081">_tiles_eta_max</a> = <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#aa66df887c67e0d1025831e9998ea2415">eta</a>;}</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;    }</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;  }</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;<span class="preprocessor">#endif // _FASTJET_TILING25_USE_TILING_ANALYSIS_</span></div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># define FJCORE_LAZY25_MIN3TILESY</span></div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef FJCORE_LAZY25_MIN3TILESY</span></div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;<span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dbe/classLazyTiling25.html#a469af04a7362bcd08775822b767ca081">_tiles_eta_max</a> - <a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d">_tiles_eta_min</a> &lt; 3*<a class="code" href="../../d8/dbe/classLazyTiling25.html#adef3e9944f9b5349bd92d26e116b81aa">_tile_size_eta</a>) {</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;     <a class="code" href="../../d8/dbe/classLazyTiling25.html#adef3e9944f9b5349bd92d26e116b81aa">_tile_size_eta</a> = (<a class="code" href="../../d8/dbe/classLazyTiling25.html#a469af04a7362bcd08775822b767ca081">_tiles_eta_max</a> - <a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d">_tiles_eta_min</a>)/3;</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;     <a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38">_tiles_ieta_min</a> = 0;</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;     <a class="code" href="../../d8/dbe/classLazyTiling25.html#a45de6698d741a5112ebf15883be58420">_tiles_ieta_max</a> = 2;</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;     <a class="code" href="../../d8/dbe/classLazyTiling25.html#a469af04a7362bcd08775822b767ca081">_tiles_eta_max</a> -= <a class="code" href="../../d8/dbe/classLazyTiling25.html#adef3e9944f9b5349bd92d26e116b81aa">_tile_size_eta</a>;</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;   } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;<span class="preprocessor">#endif //FASTJET_LAZY25_MIN3TILESY</span></div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;<span class="preprocessor"></span>    <a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38">_tiles_ieta_min</a> = int(floor(<a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d">_tiles_eta_min</a>/<a class="code" href="../../d8/dbe/classLazyTiling25.html#adef3e9944f9b5349bd92d26e116b81aa">_tile_size_eta</a>));</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;    <a class="code" href="../../d8/dbe/classLazyTiling25.html#a45de6698d741a5112ebf15883be58420">_tiles_ieta_max</a> = int(floor( <a class="code" href="../../d8/dbe/classLazyTiling25.html#a469af04a7362bcd08775822b767ca081">_tiles_eta_max</a>/<a class="code" href="../../d8/dbe/classLazyTiling25.html#adef3e9944f9b5349bd92d26e116b81aa">_tile_size_eta</a>));</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;    <a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d">_tiles_eta_min</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38">_tiles_ieta_min</a> * <a class="code" href="../../d8/dbe/classLazyTiling25.html#adef3e9944f9b5349bd92d26e116b81aa">_tile_size_eta</a>;</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;    <a class="code" href="../../d8/dbe/classLazyTiling25.html#a469af04a7362bcd08775822b767ca081">_tiles_eta_max</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a45de6698d741a5112ebf15883be58420">_tiles_ieta_max</a> * <a class="code" href="../../d8/dbe/classLazyTiling25.html#adef3e9944f9b5349bd92d26e116b81aa">_tile_size_eta</a>;</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;<span class="preprocessor">#ifdef FJCORE_LAZY25_MIN3TILESY</span></div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;<span class="preprocessor"></span>   }</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../d8/dbe/classLazyTiling25.html#a6972e248033021b322775fbca1c4c240">_tile_half_size_eta</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#adef3e9944f9b5349bd92d26e116b81aa">_tile_size_eta</a> * 0.5;</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;  <a class="code" href="../../d8/dbe/classLazyTiling25.html#a9c3d392b1bc47fa3dbdead589d07bce0">_tile_half_size_phi</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#aa5358fd1f9c21e918781c6673f84bd80">_tile_size_phi</a> * 0.5;</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;  vector&lt;bool&gt; use_periodic_delta_phi(<a class="code" href="../../d8/dbe/classLazyTiling25.html#a549a3230a3c3efe5b05a26fa4efe2607">_n_tiles_phi</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d8/dbe/classLazyTiling25.html#a549a3230a3c3efe5b05a26fa4efe2607">_n_tiles_phi</a> &lt;= 5) {</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;    fill(use_periodic_delta_phi.begin(), use_periodic_delta_phi.end(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;    use_periodic_delta_phi[0] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;    use_periodic_delta_phi[1] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;    use_periodic_delta_phi[<a class="code" href="../../d8/dbe/classLazyTiling25.html#a549a3230a3c3efe5b05a26fa4efe2607">_n_tiles_phi</a>-2] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;    use_periodic_delta_phi[<a class="code" href="../../d8/dbe/classLazyTiling25.html#a549a3230a3c3efe5b05a26fa4efe2607">_n_tiles_phi</a>-1] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;  }</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;  <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>.resize((<a class="code" href="../../d8/dbe/classLazyTiling25.html#a45de6698d741a5112ebf15883be58420">_tiles_ieta_max</a>-<a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38">_tiles_ieta_min</a>+1)*<a class="code" href="../../d8/dbe/classLazyTiling25.html#a549a3230a3c3efe5b05a26fa4efe2607">_n_tiles_phi</a>);</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ieta = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38">_tiles_ieta_min</a>; ieta &lt;= <a class="code" href="../../d8/dbe/classLazyTiling25.html#a45de6698d741a5112ebf15883be58420">_tiles_ieta_max</a>; ieta++) {</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iphi = 0; iphi &lt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a549a3230a3c3efe5b05a26fa4efe2607">_n_tiles_phi</a>; iphi++) {</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;      Tile25 * <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> = &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[<a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea">_tile_index</a>(ieta,iphi)];</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;      tile-&gt;head = NULL; <span class="comment">// first element of tiles points to itself</span></div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;      tile-&gt;begin_tiles[0] =  <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>;</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;      Tile25 ** pptile = &amp; (tile-&gt;begin_tiles[0]);</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;      pptile++;</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;      tile-&gt;surrounding_tiles = pptile;</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;      <span class="keywordflow">if</span> (ieta &gt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38">_tiles_ieta_min</a>) {</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;        <span class="comment">// with the itile subroutine, we can safely run tiles from</span></div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;        <span class="comment">// idphi=-1 to idphi=+1, because it takes care of</span></div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;        <span class="comment">// negative and positive boundaries</span></div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idphi = -2; idphi &lt;=+2; idphi++) {</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;          *pptile = &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[<a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea">_tile_index</a>(ieta-1,iphi+idphi)];</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;          pptile++;</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;        }       </div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;      }</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;      <span class="keywordflow">if</span> (ieta &gt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38">_tiles_ieta_min</a> + 1) {</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;        <span class="comment">// with the itile subroutine, we can safely run tiles from</span></div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;        <span class="comment">// idphi=-1 to idphi=+1, because it takes care of</span></div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;        <span class="comment">// negative and positive boundaries</span></div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idphi = -2; idphi &lt;= +2; idphi++) {</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;          *pptile = &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[<a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea">_tile_index</a>(ieta-2,iphi+idphi)];</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;          pptile++;</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;        }       </div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;      }</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;      *pptile = &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[<a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea">_tile_index</a>(ieta,iphi-1)];</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;      pptile++;</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;      *pptile = &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[<a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea">_tile_index</a>(ieta,iphi-2)];</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;      pptile++;</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;      tile-&gt;RH_tiles = pptile;</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;      *pptile = &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[<a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea">_tile_index</a>(ieta,iphi+1)];</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;      pptile++;</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;      *pptile = &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[<a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea">_tile_index</a>(ieta,iphi+2)];</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;      pptile++;</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;      <span class="keywordflow">if</span> (ieta &lt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a45de6698d741a5112ebf15883be58420">_tiles_ieta_max</a>) {</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idphi = -2; idphi &lt;= +2; idphi++) {</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;          *pptile = &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[<a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea">_tile_index</a>(ieta+1,iphi+idphi)];</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;          pptile++;</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;        }       </div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;      }</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;      <span class="keywordflow">if</span> (ieta &lt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a45de6698d741a5112ebf15883be58420">_tiles_ieta_max</a> - 1) {</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idphi = -2; idphi &lt;= +2; idphi++) {</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;          *pptile = &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[<a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea">_tile_index</a>(ieta+2,iphi+idphi)];</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;          pptile++;</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;        }       </div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;      }</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;      tile-&gt;end_tiles = pptile;</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;      tile-&gt;tagged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;      tile-&gt;use_periodic_delta_phi = use_periodic_delta_phi[iphi];</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;      tile-&gt;max_NN_dist = 0;</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;      tile-&gt;eta_centre = (ieta-<a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38">_tiles_ieta_min</a>+0.5)*<a class="code" href="../../d8/dbe/classLazyTiling25.html#adef3e9944f9b5349bd92d26e116b81aa">_tile_size_eta</a> + <a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d">_tiles_eta_min</a>;</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;      tile-&gt;phi_centre = (iphi+0.5)*<a class="code" href="../../d8/dbe/classLazyTiling25.html#aa5358fd1f9c21e918781c6673f84bd80">_tile_size_phi</a>;</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;    }</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;  }</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;}</div>
<div class="line"><a name="l05062"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#ada22c310fc9853579505b81f39da2004"> 5062</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea">LazyTiling25::_tile_index</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> eta, <span class="keyword">const</span> <span class="keywordtype">double</span> phi)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;  <span class="keywordtype">int</span> ieta, iphi;</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;  <span class="keywordflow">if</span>      (eta &lt;= <a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d">_tiles_eta_min</a>) {ieta = 0;}</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eta &gt;= <a class="code" href="../../d8/dbe/classLazyTiling25.html#a469af04a7362bcd08775822b767ca081">_tiles_eta_max</a>) {ieta = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a45de6698d741a5112ebf15883be58420">_tiles_ieta_max</a>-<a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38">_tiles_ieta_min</a>;}</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;    ieta = int(((eta - <a class="code" href="../../d8/dbe/classLazyTiling25.html#a8cdb129d8fca98c28a7e6abf1fa3e64d">_tiles_eta_min</a>) / <a class="code" href="../../d8/dbe/classLazyTiling25.html#adef3e9944f9b5349bd92d26e116b81aa">_tile_size_eta</a>));</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;    <span class="keywordflow">if</span> (ieta &gt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a45de6698d741a5112ebf15883be58420">_tiles_ieta_max</a>-<a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38">_tiles_ieta_min</a>) {</div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;      ieta = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a45de6698d741a5112ebf15883be58420">_tiles_ieta_max</a>-<a class="code" href="../../d8/dbe/classLazyTiling25.html#a1984aec9634830d88be538d272d6bf38">_tiles_ieta_min</a>;} </div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;  }</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;  iphi = int((phi+<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>)/<a class="code" href="../../d8/dbe/classLazyTiling25.html#aa5358fd1f9c21e918781c6673f84bd80">_tile_size_phi</a>) % <a class="code" href="../../d8/dbe/classLazyTiling25.html#a549a3230a3c3efe5b05a26fa4efe2607">_n_tiles_phi</a>;</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;  <span class="keywordflow">return</span> (iphi + ieta * <a class="code" href="../../d8/dbe/classLazyTiling25.html#a549a3230a3c3efe5b05a26fa4efe2607">_n_tiles_phi</a>);</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;}</div>
<div class="line"><a name="l05074"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a572321e5bc4d10c1e6878fa9945e7fe6"> 5074</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#a572321e5bc4d10c1e6878fa9945e7fe6">LazyTiling25::_tj_set_jetinfo</a>( <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet,</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">int</span> _jets_index) {</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;  _bj_set_jetinfo&lt;&gt;(jet, _jets_index);</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;  jet-&gt;tile_index = <a class="code" href="../../d8/dbe/classLazyTiling25.html#af592fdbf081b1d072bf5b1cc3b3e6cea">_tile_index</a>(jet-&gt;eta, jet-&gt;phi);</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;  Tile25 * <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> = &amp;<a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[jet-&gt;tile_index];</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;  jet-&gt;previous   = NULL;</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;  jet-&gt;next       = tile-&gt;head;</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;  <span class="keywordflow">if</span> (jet-&gt;next != NULL) {jet-&gt;next-&gt;previous = jet;}</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;  tile-&gt;head      = jet;</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;}</div>
<div class="line"><a name="l05084"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a6d7fcc1aceaa7f412dca1c00cad34ef0"> 5084</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#a6d7fcc1aceaa7f412dca1c00cad34ef0">LazyTiling25::_bj_remove_from_tiles</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet) {</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;  Tile25 * <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> = &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>];</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;  <span class="keywordflow">if</span> (jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a> == NULL) {</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;    tile-&gt;head = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>;</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;    jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a>-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>;</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;  }</div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;  <span class="keywordflow">if</span> (jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a> != NULL) {</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;    jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a>;</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;  }</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;}</div>
<div class="line"><a name="l05095"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a485be1034d6f274cac52bdf48e18f668"> 5095</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#a485be1034d6f274cac52bdf48e18f668">LazyTiling25::_print_tiles</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * briefjets )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;  <span class="keywordflow">for</span> (vector&lt;Tile25&gt;::const_iterator <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>.begin(); </div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;       <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> &lt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>.end(); <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>++) {</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Tile &quot;</span> &lt;&lt; <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> - <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>.begin()</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; at &quot;</span> &lt;&lt; setw(10) &lt;&lt; <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>-&gt;eta_centre &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; setw(10) &lt;&lt; <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>-&gt;phi_centre</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; = &quot;</span>;</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;    vector&lt;int&gt; list;</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>-&gt;head; jetI != NULL; jetI = jetI-&gt;next) {</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;      list.push_back(jetI-briefjets);</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;    }</div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;    <a class="code" href="../../d2/da5/namespaceActs_1_1Experimental_1_1detail_1_1BlueprintHelper.html#a308a6456db2655fc6a1a916696da20c8" title="Sort the nodes in the blueprint container node.">sort</a>(list.begin(),list.end());</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; list.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {cout &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;list[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];}</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;    cout &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;  }</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;}</div>
<div class="line"><a name="l05110"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a61145cd9cd75d360afc09d73c3187963"> 5110</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#a61145cd9cd75d360afc09d73c3187963">LazyTiling25::_add_neighbours_to_tile_union</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;               vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;  <span class="keywordflow">for</span> (Tile25 * <span class="keyword">const</span> * near_tile = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[tile_index].begin_tiles; </div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;       near_tile != <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[tile_index].end_tiles; near_tile++){</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;    tile_union[n_near_tiles] = *near_tile - &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[0];</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;    n_near_tiles++;</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;  }</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;}</div>
<div class="line"><a name="l05118"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a39dfade7260eee9f92a37219aefa5e2f"> 5118</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#a39dfade7260eee9f92a37219aefa5e2f">LazyTiling25::_add_untagged_neighbours_to_tile_union</a>(</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;               vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles)  {</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;  <span class="keywordflow">for</span> (Tile25 ** near_tile = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[tile_index].begin_tiles; </div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;       near_tile != <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[tile_index].end_tiles; near_tile++){</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;    <span class="keywordflow">if</span> (! (*near_tile)-&gt;tagged) {</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;      (*near_tile)-&gt;tagged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;      tile_union[n_near_tiles] = *near_tile - &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[0];</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;      n_near_tiles++;</div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;    }</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;  }</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;}</div>
<div class="line"><a name="l05130"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a20736b2fbcaec9bac875c743d46a089c"> 5130</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#a20736b2fbcaec9bac875c743d46a089c">LazyTiling25::_add_untagged_neighbours_to_tile_union_using_max_info</a>(</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;               <span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jet, </div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;               vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles)  {</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;  Tile25 &amp; <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>];</div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;  <span class="keywordflow">for</span> (Tile25 ** near_tile = tile.begin_tiles; near_tile != tile.end_tiles; near_tile++){</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;    <span class="keywordflow">if</span> ((*near_tile)-&gt;tagged) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a4d73570906df890283899315bc02c72d">_distance_to_tile</a>(jet, *near_tile) - <a class="code" href="../../d8/d99/fjcore_8cc.html#a4f014d5727219a7118bf37a8c22be6ec">tile_edge_security_margin</a>;</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;    <span class="keywordflow">if</span> (dist &gt; (*near_tile)-&gt;max_NN_dist) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;    (*near_tile)-&gt;tagged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;    tile_union[n_near_tiles] = *near_tile - &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[0];</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;    n_near_tiles++;</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;  }</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;}</div>
<div class="line"><a name="l05143"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a4d73570906df890283899315bc02c72d"> 5143</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#a4d73570906df890283899315bc02c72d">LazyTiling25::_distance_to_tile</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * bj, <span class="keyword">const</span> Tile25 * <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>) </div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;<span class="preprocessor"></span>   {</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;  _ncall_dtt++; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;<span class="preprocessor"></span>  <span class="keyword">const</span> {</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;<span class="preprocessor">#endif // INSTRUMENT2</span></div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">double</span> deta;</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;  <span class="keywordflow">if</span> (_tiles[bj-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>].eta_centre == tile-&gt;eta_centre) deta = 0;</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;  <span class="keywordflow">else</span>   deta = std::abs(bj-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a4d55d138e2a9c00de4c8a7bebbf22527">eta</a> - tile-&gt;eta_centre) - _tile_half_size_eta;</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = std::abs(bj-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8835c304c97003b0159e3b2686b99151">phi</a> - tile-&gt;phi_centre);</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;  <span class="keywordflow">if</span> (dphi &gt; <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>) dphi = <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>-<a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;  dphi -= _tile_half_size_phi;</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;  <span class="keywordflow">if</span> (dphi &lt; 0) dphi = 0;</div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;  <span class="keywordflow">return</span> dphi*dphi + deta*deta;</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;}</div>
<div class="line"><a name="l05159"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#ad40bd4f30597baabe7b2c59b8c1fc0e4"> 5159</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#ad40bd4f30597baabe7b2c59b8c1fc0e4">LazyTiling25::_update_jetX_jetI_NN</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetX, <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI, vector&lt;TiledJet *&gt; &amp; jets_for_minheap) {</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#abe893ef1fe04af04c316bee984bcc68b">_bj_dist</a>(jetI,jetX);</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;  <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist) {</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;    <span class="keywordflow">if</span> (jetI != jetX) {</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;      jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;      jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetX;</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;      <span class="keywordflow">if</span> (!jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a6a9b6e9d8d9e84ceb95c722b7c892aa0">minheap_update_needed</a>()) {</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;        jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a3f73f5b46367e34719b3024d36573b54">label_minheap_update_needed</a>();</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;        jets_for_minheap.push_back(jetI);</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;      }</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;    }</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;  }</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;  <span class="keywordflow">if</span> (dist &lt; jetX-&gt;NN_dist) {</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;    <span class="keywordflow">if</span> (jetI != jetX) {</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;      jetX-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;      jetX-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a>      = jetI;}</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;  }</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;}</div>
<div class="line"><a name="l05177"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#a0f51d2fae5e1b8737a70a05699a2447c"> 5177</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#a0f51d2fae5e1b8737a70a05699a2447c">LazyTiling25::_set_NN</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI, </div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;                              vector&lt;TiledJet *&gt; &amp; jets_for_minheap) {</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;  jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a55f87aa88a07215b86961042276d8cb7">_R2</a>;</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;  jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a>      = NULL;</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;  <span class="keywordflow">if</span> (!jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a6a9b6e9d8d9e84ceb95c722b7c892aa0">minheap_update_needed</a>()) {</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;    jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a3f73f5b46367e34719b3024d36573b54">label_minheap_update_needed</a>();</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;    jets_for_minheap.push_back(jetI);}</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;  Tile25 * tile_ptr = &amp;<a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>];</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;    <span class="keywordflow">for</span> (Tile25 ** near_tile  = tile_ptr-&gt;begin_tiles; </div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;         near_tile != tile_ptr-&gt;end_tiles; near_tile++) {</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;      <span class="keywordflow">if</span> (jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> &lt; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a4d73570906df890283899315bc02c72d">_distance_to_tile</a>(jetI, *near_tile)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetJ  = (*near_tile)-&gt;head; </div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;           jetJ != NULL; jetJ = jetJ-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#abe893ef1fe04af04c316bee984bcc68b">_bj_dist</a>(jetI,jetJ);</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist &amp;&amp; jetJ != jetI) {</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;          jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetJ;</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;        }</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;      }</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;    }</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;}</div>
<div class="line"><a name="l05197"></a><span class="lineno"><a class="code" href="../../d8/dbe/classLazyTiling25.html#af45e2f504bb02eae6f5dffb162aa4bb9"> 5197</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dbe/classLazyTiling25.html#af45e2f504bb02eae6f5dffb162aa4bb9">LazyTiling25::run</a>() {</div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#aa3dd12e7ad4a1988b0115d69dad372ae">_jets</a>.size();</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;  <span class="keywordflow">if</span> (n == 0) <span class="keywordflow">return</span>; </div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * briefjets = <span class="keyword">new</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a>[<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>];</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetA = briefjets, * jetB;</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> oldB = briefjets[0]; </div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;  vector&lt;int&gt; tile_union(3*25);</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;    <a class="code" href="../../d8/dbe/classLazyTiling25.html#a572321e5bc4d10c1e6878fa9945e7fe6">_tj_set_jetinfo</a>(jetA, <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>);</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;    jetA++; <span class="comment">// move on to next entry of briefjets</span></div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;  }</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * head = briefjets; <span class="comment">// a nicer way of naming start</span></div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;  vector&lt;Tile25&gt;::iterator <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>;</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;  <span class="keywordflow">for</span> (tile = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>.begin(); tile != <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;    <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;      <span class="keywordflow">for</span> (jetB = tile-&gt;head; jetB != jetA; jetB = jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#adc8bdafcb773f6257fa47552e6646045">_bj_dist_not_periodic</a>(jetA,jetB);</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetB;}</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;      }</div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;    }</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;    <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;      <span class="keywordflow">if</span> (jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> &gt; tile-&gt;max_NN_dist) tile-&gt;max_NN_dist = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;    }</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;  }</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;  <span class="keywordflow">for</span> (tile = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>.begin(); tile != <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;    <span class="keywordflow">if</span> (tile-&gt;use_periodic_delta_phi) {</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;      <span class="keywordflow">for</span> (Tile25 ** RTile = tile-&gt;RH_tiles; RTile != tile-&gt;end_tiles; RTile++) {</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;        <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;          <span class="keywordtype">double</span> dist_to_tile = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a4d73570906df890283899315bc02c72d">_distance_to_tile</a>(jetA, *RTile);</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;          <span class="keywordtype">bool</span> relevant_for_jetA  = dist_to_tile &lt;= jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;          <span class="keywordtype">bool</span> relevant_for_RTile = dist_to_tile &lt;= (*RTile)-&gt;max_NN_dist;</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;          <span class="keywordflow">if</span> (relevant_for_jetA || relevant_for_RTile) {</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;            <span class="keywordflow">for</span> (jetB = (*RTile)-&gt;head; jetB != NULL; jetB = jetB-&gt;next) {</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#abe893ef1fe04af04c316bee984bcc68b">_bj_dist</a>(jetA,jetB);</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetB;}</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;            }</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;          } </div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;        }</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;      }</div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;      <span class="keywordflow">for</span> (Tile25 ** RTile = tile-&gt;RH_tiles; RTile != tile-&gt;end_tiles; RTile++) {</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;        <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;          <span class="keywordtype">double</span> dist_to_tile = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a4d73570906df890283899315bc02c72d">_distance_to_tile</a>(jetA, *RTile);</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;          <span class="keywordtype">bool</span> relevant_for_jetA  = dist_to_tile &lt;= jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;          <span class="keywordtype">bool</span> relevant_for_RTile = dist_to_tile &lt;= (*RTile)-&gt;max_NN_dist;</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;          <span class="keywordflow">if</span> (relevant_for_jetA || relevant_for_RTile) {</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;            <span class="keywordflow">for</span> (jetB = (*RTile)-&gt;head; jetB != NULL; jetB = jetB-&gt;next) {</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d8/dbe/classLazyTiling25.html#adc8bdafcb773f6257fa47552e6646045">_bj_dist_not_periodic</a>(jetA,jetB);</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetB;}</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;            }</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;          } </div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;        }</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;      }</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;    }</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;  }</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;  <span class="keywordflow">for</span> (tile = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>.begin(); tile != <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;    tile-&gt;max_NN_dist = 0;</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;    <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;      <span class="keywordflow">if</span> (jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> &gt; tile-&gt;max_NN_dist) tile-&gt;max_NN_dist = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;    }</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;  }</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;<span class="preprocessor"></span>  cout &lt;&lt; <span class="stringliteral">&quot;intermediate ncall, dtt = &quot;</span> &lt;&lt; _ncall &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; _ncall_dtt &lt;&lt; endl; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;<span class="preprocessor">#endif // INSTRUMENT2</span></div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;<span class="preprocessor"></span>  vector&lt;double&gt; diJs(n);</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;    diJs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = <a class="code" href="../../d8/dbe/classLazyTiling25.html#ae27818af520ed2d440600b9dee6e8961">_bj_diJ</a>(&amp;briefjets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;    briefjets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].<a class="code" href="../../df/da7/classTiledJet.html#aa91ab795c368e78cd37c188ddf2b0eba">label_minheap_update_done</a>();</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;  }</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;  <a class="code" href="../../dc/d1f/classMinHeap.html">MinHeap</a> minheap(diJs);</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;  vector&lt;TiledJet *&gt; jets_for_minheap;</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;  jets_for_minheap.reserve(n); </div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;  <span class="keywordtype">int</span> history_location = n-1;</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;  <span class="keywordflow">while</span> (n &gt; 0) {</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;    <span class="keywordtype">double</span> diJ_min = minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#ae17ef2b28154bf277ffef1c4f0e71f12">minval</a>() *<a class="code" href="../../d8/dbe/classLazyTiling25.html#ac84f226ec67629cfa423dd82653fbc02">_invR2</a>;</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;    jetA = head + minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#a0ca99aace4dc34bf64a6bca0408c9b08">minloc</a>();</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;    history_location++;</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;    jetB = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a>;</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;      <span class="keywordflow">if</span> (jetA &lt; jetB) {<a class="code" href="../../d6/db0/fjcore_8hh.html#ac71f249d840a70f8b3aaffb721843eaa">std::swap</a>(jetA,jetB);}</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;      <span class="keywordtype">int</span> nn; <span class="comment">// new jet index</span></div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;      <a class="code" href="../../d8/dbe/classLazyTiling25.html#a69f84d613408c8f4d1917d93d38520cc">_cs</a>.plugin_record_ij_recombination(jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#adcad53d4a6409c3f08fea864bd84df48">_jets_index</a>, jetB-&gt;_jets_index, diJ_min, nn);</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;      <a class="code" href="../../d8/dbe/classLazyTiling25.html#a6d7fcc1aceaa7f412dca1c00cad34ef0">_bj_remove_from_tiles</a>(jetA);</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;      oldB = * jetB;  <span class="comment">// take a copy because we will need it...</span></div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;      <a class="code" href="../../d8/dbe/classLazyTiling25.html#a6d7fcc1aceaa7f412dca1c00cad34ef0">_bj_remove_from_tiles</a>(jetB);</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;      <a class="code" href="../../d8/dbe/classLazyTiling25.html#a572321e5bc4d10c1e6878fa9945e7fe6">_tj_set_jetinfo</a>(jetB, nn); <span class="comment">// cause jetB to become _jets[nn]</span></div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;      <a class="code" href="../../d8/dbe/classLazyTiling25.html#a69f84d613408c8f4d1917d93d38520cc">_cs</a>.plugin_record_iB_recombination(jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#adcad53d4a6409c3f08fea864bd84df48">_jets_index</a>, diJ_min);</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;      <a class="code" href="../../d8/dbe/classLazyTiling25.html#a6d7fcc1aceaa7f412dca1c00cad34ef0">_bj_remove_from_tiles</a>(jetA);</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;    }</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;    minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#a43c188a1357883198388a9713b3d889b">remove</a>(jetA-head);</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;    <span class="keywordtype">int</span> n_near_tiles = 0;</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;      Tile25 &amp; jetB_tile = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[jetB-&gt;tile_index];</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;      <span class="keywordflow">for</span> (Tile25 ** near_tile  = jetB_tile.begin_tiles; </div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;                   near_tile != jetB_tile.end_tiles; near_tile++) {</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;        <span class="keywordtype">double</span> dist_to_tile = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a4d73570906df890283899315bc02c72d">_distance_to_tile</a>(jetB, *near_tile);</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;        <span class="keywordtype">bool</span> relevant_for_jetB  = dist_to_tile &lt;= jetB-&gt;NN_dist;</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;        <span class="keywordtype">bool</span> relevant_for_near_tile = dist_to_tile &lt;= (*near_tile)-&gt;max_NN_dist;</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;        <span class="keywordtype">bool</span> relevant = relevant_for_jetB || relevant_for_near_tile;</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;        <span class="keywordflow">if</span> (! relevant) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;        tile_union[n_near_tiles] = *near_tile - &amp; <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[0];</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;        (*near_tile)-&gt;tagged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;        n_near_tiles++;</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = (*near_tile)-&gt;head; jetI != NULL; jetI = jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;          <span class="keywordflow">if</span> (jetI-&gt;NN == jetA || jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> == jetB) <a class="code" href="../../d8/dbe/classLazyTiling25.html#a0f51d2fae5e1b8737a70a05699a2447c">_set_NN</a>(jetI, jets_for_minheap);</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;          <a class="code" href="../../d8/dbe/classLazyTiling25.html#ad40bd4f30597baabe7b2c59b8c1fc0e4">_update_jetX_jetI_NN</a>(jetB, jetI, jets_for_minheap);</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;        }</div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;      }</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;    }</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;    <span class="keywordtype">int</span> n_done_tiles = n_near_tiles;</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;    <a class="code" href="../../d8/dbe/classLazyTiling25.html#a20736b2fbcaec9bac875c743d46a089c">_add_untagged_neighbours_to_tile_union_using_max_info</a>(jetA, </div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;                                           tile_union, n_near_tiles);</div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;        <a class="code" href="../../d8/dbe/classLazyTiling25.html#a20736b2fbcaec9bac875c743d46a089c">_add_untagged_neighbours_to_tile_union_using_max_info</a>(&amp;oldB,</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;                                                              tile_union,n_near_tiles);</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;      jetB-&gt;label_minheap_update_needed();</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;      jets_for_minheap.push_back(jetB);</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;    }</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itile = 0; itile &lt; n_done_tiles; itile++) {</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;      <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[tile_union[itile]].tagged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;    }</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itile = n_done_tiles; itile &lt; n_near_tiles; itile++) {</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;      Tile25 * tile_ptr = &amp;<a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[tile_union[itile]];</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;      tile_ptr-&gt;tagged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = tile_ptr-&gt;head; jetI != NULL; jetI = jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;        <span class="keywordflow">if</span> (jetI-&gt;NN == jetA || (jetI-&gt;NN == jetB &amp;&amp; jetB != NULL)) {</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;          <a class="code" href="../../d8/dbe/classLazyTiling25.html#a0f51d2fae5e1b8737a70a05699a2447c">_set_NN</a>(jetI, jets_for_minheap);</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;        }</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;      }</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;    }</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;    <span class="keywordflow">while</span> (jets_for_minheap.size() &gt; 0) {</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;      <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = jets_for_minheap.back(); </div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;      jets_for_minheap.pop_back();</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;      minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#a389062f6aba4c38b4995271bf0ece469">update</a>(jetI-head, <a class="code" href="../../d8/dbe/classLazyTiling25.html#ae27818af520ed2d440600b9dee6e8961">_bj_diJ</a>(jetI));</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;      jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#aa91ab795c368e78cd37c188ddf2b0eba">label_minheap_update_done</a>();</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;      Tile25 &amp; tile_I = <a class="code" href="../../d8/dbe/classLazyTiling25.html#a070ebbfdbeb384f1ef60e49d2cddb51f">_tiles</a>[jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>];</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;      <span class="keywordflow">if</span> (tile_I.max_NN_dist &lt; jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>) tile_I.max_NN_dist = jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;    }</div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;    n--;</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;  }</div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;  <span class="keyword">delete</span>[] briefjets;</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;<span class="preprocessor"></span>  cout &lt;&lt; <span class="stringliteral">&quot;ncall, dtt = &quot;</span> &lt;&lt; _ncall &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; _ncall_dtt &lt;&lt; endl; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;<span class="preprocessor">#endif // INSTRUMENT2</span></div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l05351"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#a2597286bf6fb41de3b9786dca4d3b14a"> 5351</a></span>&#160;<span class="preprocessor">#define _FJCORE_TILING2_USE_TILING_ANALYSIS_</span></div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;<span class="preprocessor"></span><a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l05353"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#aa662d71ae8f168ca28ed15288a85bcee"> 5353</a></span>&#160;<a class="code" href="../../d6/d0c/classLazyTiling9.html#aa662d71ae8f168ca28ed15288a85bcee">LazyTiling9::LazyTiling9</a>(ClusterSequence &amp; cs) :</div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;  _cs(cs), _jets(cs.jets())</div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;{</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;<span class="preprocessor"></span>  _ncall = 0; <span class="comment">// gps tmp</span></div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;  _ncall_dtt = 0; <span class="comment">// gps tmp</span></div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;<span class="preprocessor">#endif // INSTRUMENT2</span></div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a> = cs.jet_def().R();</div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a> * <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>;</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a> = 1.0 / <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>;</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0e8c176445183a4f9e03ba8ac6b40131">_initialise_tiles</a>();</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;}</div>
<div class="line"><a name="l05365"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a0e8c176445183a4f9e03ba8ac6b40131"> 5365</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0e8c176445183a4f9e03ba8ac6b40131">LazyTiling9::_initialise_tiles</a>() {</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;  <span class="keywordtype">double</span> default_size = max(0.1,<a class="code" href="../../d6/d0c/classLazyTiling9.html#a0c836cf454c93f96f96be389acca9ba8">_Rparam</a>);</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a> = default_size;</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>   = max(3,<span class="keywordtype">int</span>(floor(<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>/default_size)));</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#aff3c1a2733231c09a9e259c5730928d2">_tile_size_phi</a> = <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> / <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>; <span class="comment">// &gt;= _Rparam and fits in 2pi</span></div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;<span class="preprocessor">#ifdef _FJCORE_TILING2_USE_TILING_ANALYSIS_</span></div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../da/dd5/classTilingExtent.html">TilingExtent</a> tiling_analysis(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a63f258516215178970e17bbe2987f8ad">_cs</a>);</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a> = tiling_analysis.<a class="code" href="../../da/dd5/classTilingExtent.html#a69f512777159849c7455dd6c68366c9a">minrap</a>();</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a> = tiling_analysis.<a class="code" href="../../da/dd5/classTilingExtent.html#a0800e910cd13b69b161525c8864af207">maxrap</a>();</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a> = 0.0;</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a> = 0.0;</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> maxrap = 7.0;</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;    <span class="keywordtype">double</span> eta = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].rap();</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;    <span class="keywordflow">if</span> (abs(eta) &lt; maxrap) {</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;      <span class="keywordflow">if</span> (eta &lt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a>) {<a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a> = <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#aa66df887c67e0d1025831e9998ea2415">eta</a>;}</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;      <span class="keywordflow">if</span> (eta &gt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a>) {<a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a> = <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#aa66df887c67e0d1025831e9998ea2415">eta</a>;}</div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;    }</div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;  }</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># define FJCORE_LAZY9_MIN2TILESY</span></div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef FJCORE_LAZY9_MIN2TILESY</span></div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;<span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a> - <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a> &lt; 2*<a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>) {</div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;     <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a> = (<a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a> - <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a>)/2;</div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;     <a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a> = 0;</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;     <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a> = 1;</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;     <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a> -= <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>;</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;   } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;<span class="preprocessor">#endif //FASTJET_LAZY9_MIN2TILESY</span></div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a> = int(floor(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a>/<a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>));</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a> = int(floor( <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a>/<a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>));</div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a> * <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>;</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a> * <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>;</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;<span class="preprocessor">#ifdef FJCORE_LAZY9_MIN2TILESY</span></div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;<span class="preprocessor"></span>   }</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a36915a57bffdd5ac16a1390775cdd2b1">_tile_half_size_eta</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a> * 0.5;</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#a353ef38de1408b7d50f10f85f9d9dd0e">_tile_half_size_phi</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aff3c1a2733231c09a9e259c5730928d2">_tile_size_phi</a> * 0.5;</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;  vector&lt;bool&gt; use_periodic_delta_phi(<a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a> &lt;= 3) {</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;    fill(use_periodic_delta_phi.begin(), use_periodic_delta_phi.end(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;    use_periodic_delta_phi[0] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;    use_periodic_delta_phi[<a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>-1] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;  }</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;  <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.resize((<a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>-<a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>+1)*<a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>);</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ieta = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>; ieta &lt;= <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>; ieta++) {</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iphi = 0; iphi &lt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>; iphi++) {</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;      Tile2 * tile = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[<a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(ieta,iphi)];</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;      tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a967234fb4a55f306015eec8ed87f9bfc">head</a> = NULL; <span class="comment">// first element of tiles points to itself</span></div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;      tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#ae1e3c44950c032480fb16783c993ed13">begin_tiles</a>[0] =  <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>;</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;      Tile2 ** pptile = &amp; (tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#ae1e3c44950c032480fb16783c993ed13">begin_tiles</a>[0]);</div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;      pptile++;</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;      tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a68d6a05f16e2d5c423dc97c95b77a4e3">surrounding_tiles</a> = pptile;</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;      <span class="keywordflow">if</span> (ieta &gt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>) {</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;        <span class="comment">// with the itile subroutine, we can safely run tiles from</span></div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;        <span class="comment">// idphi=-1 to idphi=+1, because it takes care of</span></div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;        <span class="comment">// negative and positive boundaries</span></div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idphi = -1; idphi &lt;=+1; idphi++) {</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;          *pptile = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[<a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(ieta-1,iphi+idphi)];</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;          pptile++;</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;        }       </div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;      }</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;      *pptile = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[<a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(ieta,iphi-1)];</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;      pptile++;</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;      tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#ae8c883f4c7a7b721b816068db55c66d8">RH_tiles</a> = pptile;</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;      *pptile = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[<a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(ieta,iphi+1)];</div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;      pptile++;</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;      <span class="keywordflow">if</span> (ieta &lt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>) {</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idphi = -1; idphi &lt;= +1; idphi++) {</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;          *pptile = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[<a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(ieta+1,iphi+idphi)];</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;          pptile++;</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;        }       </div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;      }</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;      tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#af98fbf093794eb40b3dbbc134fd80f56">end_tiles</a> = pptile;</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;      tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#adeb2eb8f227cf231ef5694bc183ec9a1">tagged</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;      tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a0fa522d0d86c555e2645f1be170cb83a">use_periodic_delta_phi</a> = use_periodic_delta_phi[iphi];</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;      tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a4f1ab1f745a57b517c847c06011e8281">max_NN_dist</a> = 0;</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;      tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a50417c886eb3761eb0d958b4a0ab1036">eta_centre</a> = (ieta-<a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>+0.5)*<a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a> + <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a>;</div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;      tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a6cf288492a7f3b7c2d26c19f9ffb96d9">phi_centre</a> = (iphi+0.5)*<a class="code" href="../../d6/d0c/classLazyTiling9.html#aff3c1a2733231c09a9e259c5730928d2">_tile_size_phi</a>;</div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;    }</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;  }</div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;}</div>
<div class="line"><a name="l05449"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a7de94ff0cf8e9a2e80b71cbee920ce32"> 5449</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">LazyTiling9::_tile_index</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> eta, <span class="keyword">const</span> <span class="keywordtype">double</span> phi)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;  <span class="keywordtype">int</span> ieta, iphi;</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;  <span class="keywordflow">if</span>      (eta &lt;= <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a>) {ieta = 0;}</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eta &gt;= <a class="code" href="../../d6/d0c/classLazyTiling9.html#a574af1f587b05a4ffe242a923f7f4c0b">_tiles_eta_max</a>) {ieta = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>-<a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>;}</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;    ieta = int(((eta - <a class="code" href="../../d6/d0c/classLazyTiling9.html#a790fd8639ad4a850b2fae5027402fb82">_tiles_eta_min</a>) / <a class="code" href="../../d6/d0c/classLazyTiling9.html#a1a6e004d31c79db617a723e5aad5168b">_tile_size_eta</a>));</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;    <span class="keywordflow">if</span> (ieta &gt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>-<a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>) {</div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;      ieta = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a64c1adf2dc81e72892e7c4769f714967">_tiles_ieta_max</a>-<a class="code" href="../../d6/d0c/classLazyTiling9.html#a00e1dd719434e25a2c80a30866553d7c">_tiles_ieta_min</a>;} </div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;  }</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;  iphi = int((phi+<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>)/<a class="code" href="../../d6/d0c/classLazyTiling9.html#aff3c1a2733231c09a9e259c5730928d2">_tile_size_phi</a>) % <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>;</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;  <span class="keywordflow">return</span> (iphi + ieta * <a class="code" href="../../d6/d0c/classLazyTiling9.html#a760170c14e1ab3b925e464712d9f44e0">_n_tiles_phi</a>);</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;}</div>
<div class="line"><a name="l05461"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a5da6d84f64a7cff12c08700d37f56782"> 5461</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5da6d84f64a7cff12c08700d37f56782">LazyTiling9::_tj_set_jetinfo</a>( <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet,</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">int</span> _jets_index) {</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;  _bj_set_jetinfo&lt;&gt;(jet, _jets_index);</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;  jet-&gt;tile_index = <a class="code" href="../../d6/d0c/classLazyTiling9.html#abc3b80a9de7dd24b76c3a1a95876256d">_tile_index</a>(jet-&gt;eta, jet-&gt;phi);</div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;  Tile2 * tile = &amp;<a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[jet-&gt;tile_index];</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;  jet-&gt;previous   = NULL;</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;  jet-&gt;next       = tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a967234fb4a55f306015eec8ed87f9bfc">head</a>;</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;  <span class="keywordflow">if</span> (jet-&gt;next != NULL) {jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a> = jet;}</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;  tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a967234fb4a55f306015eec8ed87f9bfc">head</a>      = jet;</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;}</div>
<div class="line"><a name="l05471"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5"> 5471</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">LazyTiling9::_bj_remove_from_tiles</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet) {</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;  Tile2 * tile = &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>];</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;  <span class="keywordflow">if</span> (jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a> == NULL) {</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;    tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a967234fb4a55f306015eec8ed87f9bfc">head</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>;</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;    jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a>-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>;</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;  }</div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;  <span class="keywordflow">if</span> (jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a> != NULL) {</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;    jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a>;</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;  }</div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;}</div>
<div class="line"><a name="l05482"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a49c31c2140e3b60cf4d6b90672eb3cf2"> 5482</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a49c31c2140e3b60cf4d6b90672eb3cf2">LazyTiling9::_print_tiles</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * briefjets )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;  <span class="keywordflow">for</span> (vector&lt;Tile2&gt;::const_iterator tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.begin(); </div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;       tile &lt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Tile &quot;</span> &lt;&lt; tile - <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.begin()&lt;&lt;<span class="stringliteral">&quot; = &quot;</span>;</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;    vector&lt;int&gt; list;</div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = tile-&gt;head; jetI != NULL; jetI = jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;      list.push_back(jetI-briefjets);</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;    }</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;    <a class="code" href="../../d2/da5/namespaceActs_1_1Experimental_1_1detail_1_1BlueprintHelper.html#a308a6456db2655fc6a1a916696da20c8" title="Sort the nodes in the blueprint container node.">sort</a>(list.begin(),list.end());</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; list.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {cout &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;list[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];}</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;    cout &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;  }</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;}</div>
<div class="line"><a name="l05495"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#ac279873de61def4b2de5bc273d6ed6a1"> 5495</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#ac279873de61def4b2de5bc273d6ed6a1">LazyTiling9::_add_neighbours_to_tile_union</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;               vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;  <span class="keywordflow">for</span> (Tile2 * <span class="keyword">const</span> * near_tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_index].begin_tiles; </div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;       near_tile != <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_index].end_tiles; near_tile++){</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;    tile_union[n_near_tiles] = *near_tile - &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[0];</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;    n_near_tiles++;</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;  }</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;}</div>
<div class="line"><a name="l05503"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a3f62c993b981ade840a9d22a4209fc27"> 5503</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3f62c993b981ade840a9d22a4209fc27">LazyTiling9::_add_untagged_neighbours_to_tile_union</a>(</div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;               vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles)  {</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;  <span class="keywordflow">for</span> (Tile2 ** near_tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_index].begin_tiles; </div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;       near_tile != <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_index].end_tiles; near_tile++){</div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;    <span class="keywordflow">if</span> (! (*near_tile)-&gt;tagged) {</div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;      (*near_tile)-&gt;tagged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;      tile_union[n_near_tiles] = *near_tile - &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[0];</div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;      n_near_tiles++;</div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;    }</div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;  }</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;}</div>
<div class="line"><a name="l05515"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#adb795b6cfe7ca3348e4faf5b28c87734"> 5515</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#adb795b6cfe7ca3348e4faf5b28c87734">LazyTiling9::_add_untagged_neighbours_to_tile_union_using_max_info</a>(</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;               <span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jet, </div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;               vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles)  {</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;  Tile2 &amp; tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>];</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;  <span class="keywordflow">for</span> (Tile2 ** near_tile = tile.<a class="code" href="../../d9/db1/classTile2Base.html#ae1e3c44950c032480fb16783c993ed13">begin_tiles</a>; near_tile != tile.<a class="code" href="../../d9/db1/classTile2Base.html#af98fbf093794eb40b3dbbc134fd80f56">end_tiles</a>; near_tile++){</div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;    <span class="keywordflow">if</span> ((*near_tile)-&gt;tagged) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3d193f3e3b51ad0f4b5262b57b71ed43">_distance_to_tile</a>(jet, *near_tile) - <a class="code" href="../../d8/d99/fjcore_8cc.html#a4f014d5727219a7118bf37a8c22be6ec">tile_edge_security_margin</a>;</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;    <span class="keywordflow">if</span> (dist &gt; (*near_tile)-&gt;max_NN_dist) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;    (*near_tile)-&gt;tagged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;    tile_union[n_near_tiles] = *near_tile - &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[0];</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;    n_near_tiles++;</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;  }</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;}</div>
<div class="line"><a name="l05528"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a3d193f3e3b51ad0f4b5262b57b71ed43"> 5528</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3d193f3e3b51ad0f4b5262b57b71ed43">LazyTiling9::_distance_to_tile</a>(<span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * bj, <span class="keyword">const</span> Tile2 * tile) </div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;<span class="preprocessor"></span>   {</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;  _ncall_dtt++; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;<span class="preprocessor"></span>  <span class="keyword">const</span> {</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;<span class="preprocessor">#endif // INSTRUMENT2</span></div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">double</span> deta;</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;  <span class="keywordflow">if</span> (_tiles[bj-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>].eta_centre == tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a50417c886eb3761eb0d958b4a0ab1036">eta_centre</a>) deta = 0;</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;  <span class="keywordflow">else</span>   deta = std::abs(bj-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a4d55d138e2a9c00de4c8a7bebbf22527">eta</a> - tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a50417c886eb3761eb0d958b4a0ab1036">eta_centre</a>) - _tile_half_size_eta;</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a> = std::abs(bj-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8835c304c97003b0159e3b2686b99151">phi</a> - tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a6cf288492a7f3b7c2d26c19f9ffb96d9">phi_centre</a>);</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;  <span class="keywordflow">if</span> (dphi &gt; <a class="code" href="../../d6/db0/fjcore_8hh.html#a83ed6d79695912896ba03659228dc2b8">pi</a>) dphi = <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>-<a class="code" href="../../d3/d58/namespaceINTTVtxZ.html#a7ee39891286fe7af16a879bb139bead2">dphi</a>;</div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;  dphi -= _tile_half_size_phi;</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;  <span class="keywordflow">if</span> (dphi &lt; 0) dphi = 0;</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;  <span class="keywordflow">return</span> dphi*dphi + deta*deta;</div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;}</div>
<div class="line"><a name="l05544"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#ab4a0376d864c66c877a3b4559ab5b62b"> 5544</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#ab4a0376d864c66c877a3b4559ab5b62b">LazyTiling9::_update_jetX_jetI_NN</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetX, <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI, vector&lt;TiledJet *&gt; &amp; jets_for_minheap) {</div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetI,jetX);</div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;  <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist) {</div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;    <span class="keywordflow">if</span> (jetI != jetX) {</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;      jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;      jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetX;</div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;      <span class="keywordflow">if</span> (!jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a6a9b6e9d8d9e84ceb95c722b7c892aa0">minheap_update_needed</a>()) {</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;        jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a3f73f5b46367e34719b3024d36573b54">label_minheap_update_needed</a>();</div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;        jets_for_minheap.push_back(jetI);</div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;      }</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;    }</div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;  }</div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;  <span class="keywordflow">if</span> (dist &lt; jetX-&gt;NN_dist) {</div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;    <span class="keywordflow">if</span> (jetI != jetX) {</div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;      jetX-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;      jetX-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a>      = jetI;}</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;  }</div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;}</div>
<div class="line"><a name="l05562"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#ab5cbd2f263244bb145a45e180de3bc99"> 5562</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#ab5cbd2f263244bb145a45e180de3bc99">LazyTiling9::_set_NN</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI, </div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;                              vector&lt;TiledJet *&gt; &amp; jets_for_minheap) {</div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;  jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5fb82ad2fe64d29e92e6b6477b1b8e2c">_R2</a>;</div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;  jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a>      = NULL;</div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;  <span class="keywordflow">if</span> (!jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a6a9b6e9d8d9e84ceb95c722b7c892aa0">minheap_update_needed</a>()) {</div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;    jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a3f73f5b46367e34719b3024d36573b54">label_minheap_update_needed</a>();</div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;    jets_for_minheap.push_back(jetI);}</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;  Tile2 * tile_ptr = &amp;<a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>];</div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;    <span class="keywordflow">for</span> (Tile2 ** near_tile  = tile_ptr-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#ae1e3c44950c032480fb16783c993ed13">begin_tiles</a>; </div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;         near_tile != tile_ptr-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#af98fbf093794eb40b3dbbc134fd80f56">end_tiles</a>; near_tile++) {</div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;      <span class="keywordflow">if</span> (jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> &lt; <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3d193f3e3b51ad0f4b5262b57b71ed43">_distance_to_tile</a>(jetI, *near_tile)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetJ  = (*near_tile)-&gt;head; </div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;           jetJ != NULL; jetJ = jetJ-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetI,jetJ);</div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist &amp;&amp; jetJ != jetI) {</div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;          jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetJ;</div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;        }</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;      }</div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;    }</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;}</div>
<div class="line"><a name="l05582"></a><span class="lineno"><a class="code" href="../../d6/d0c/classLazyTiling9.html#a59d38f77750b9265c6f182157130b1cf"> 5582</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/d0c/classLazyTiling9.html#a59d38f77750b9265c6f182157130b1cf">LazyTiling9::run</a>() {</div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a0b49bb413097fff3ea14648e29fbd6d5">_jets</a>.size();</div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;  <span class="keywordflow">if</span> (n == 0) <span class="keywordflow">return</span>; </div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * briefjets = <span class="keyword">new</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a>[<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>];</div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetA = briefjets, * jetB;</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> oldB = briefjets[0]; </div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;  vector&lt;int&gt; tile_union(3*n_tile_neighbours);</div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5da6d84f64a7cff12c08700d37f56782">_tj_set_jetinfo</a>(jetA, <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>);</div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;    jetA++; <span class="comment">// move on to next entry of briefjets</span></div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;  }</div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * head = briefjets; <span class="comment">// a nicer way of naming start</span></div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;  vector&lt;Tile2&gt;::iterator <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>;</div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;  <span class="keywordflow">for</span> (tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.begin(); tile != <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;    <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;      <span class="keywordflow">for</span> (jetB = tile-&gt;head; jetB != jetA; jetB = jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5acc49ca0da50d3a4fa1b4cab400c990">_bj_dist_not_periodic</a>(jetA,jetB);</div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetB;}</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;      }</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;    }</div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;    <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;      <span class="keywordflow">if</span> (jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> &gt; tile-&gt;max_NN_dist) tile-&gt;max_NN_dist = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;    }</div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;  }</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;  <span class="keywordflow">for</span> (tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.begin(); tile != <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;    <span class="keywordflow">if</span> (tile-&gt;use_periodic_delta_phi) {</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;      <span class="keywordflow">for</span> (Tile2 ** RTile = tile-&gt;RH_tiles; RTile != tile-&gt;end_tiles; RTile++) {</div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;        <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;          <span class="keywordtype">double</span> dist_to_tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3d193f3e3b51ad0f4b5262b57b71ed43">_distance_to_tile</a>(jetA, *RTile);</div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;          <span class="keywordtype">bool</span> relevant_for_jetA  = dist_to_tile &lt;= jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;          <span class="keywordtype">bool</span> relevant_for_RTile = dist_to_tile &lt;= (*RTile)-&gt;max_NN_dist;</div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;          <span class="keywordflow">if</span> (relevant_for_jetA || relevant_for_RTile) {</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;            <span class="keywordflow">for</span> (jetB = (*RTile)-&gt;head; jetB != NULL; jetB = jetB-&gt;next) {</div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad64e0fafab814d5fda4b3e9d5e6f9aa8">_bj_dist</a>(jetA,jetB);</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetB;}</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;            }</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;          } </div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;        }</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;      }</div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;      <span class="keywordflow">for</span> (Tile2 ** RTile = tile-&gt;RH_tiles; RTile != tile-&gt;end_tiles; RTile++) {</div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;        <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;          <span class="keywordtype">double</span> dist_to_tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3d193f3e3b51ad0f4b5262b57b71ed43">_distance_to_tile</a>(jetA, *RTile);</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;          <span class="keywordtype">bool</span> relevant_for_jetA  = dist_to_tile &lt;= jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;          <span class="keywordtype">bool</span> relevant_for_RTile = dist_to_tile &lt;= (*RTile)-&gt;max_NN_dist;</div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;          <span class="keywordflow">if</span> (relevant_for_jetA || relevant_for_RTile) {</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;            <span class="keywordflow">for</span> (jetB = (*RTile)-&gt;head; jetB != NULL; jetB = jetB-&gt;next) {</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5acc49ca0da50d3a4fa1b4cab400c990">_bj_dist_not_periodic</a>(jetA,jetB);</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetB;}</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;            }</div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;          } </div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;        }</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;      }</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;    }</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;  }</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;  <span class="keywordflow">for</span> (tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.begin(); tile != <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;    tile-&gt;max_NN_dist = 0;</div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;    <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;      <span class="keywordflow">if</span> (jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> &gt; tile-&gt;max_NN_dist) tile-&gt;max_NN_dist = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;    }</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;  }</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;<span class="preprocessor"></span>  cout &lt;&lt; <span class="stringliteral">&quot;intermediate ncall, dtt = &quot;</span> &lt;&lt; _ncall &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; _ncall_dtt &lt;&lt; endl; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;<span class="preprocessor">#endif // INSTRUMENT2</span></div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;<span class="preprocessor"></span>  vector&lt;double&gt; diJs(n);</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;    diJs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(&amp;briefjets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;    briefjets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].<a class="code" href="../../df/da7/classTiledJet.html#aa91ab795c368e78cd37c188ddf2b0eba">label_minheap_update_done</a>();</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;  }</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;  <a class="code" href="../../dc/d1f/classMinHeap.html">MinHeap</a> minheap(diJs);</div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;  vector&lt;TiledJet *&gt; jets_for_minheap;</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;  jets_for_minheap.reserve(n); </div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;  <span class="keywordtype">int</span> history_location = n-1;</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;  <span class="keywordflow">while</span> (n &gt; 0) {</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;    <span class="keywordtype">double</span> diJ_min = minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#ae17ef2b28154bf277ffef1c4f0e71f12">minval</a>() *<a class="code" href="../../d6/d0c/classLazyTiling9.html#a7869e058b32fc97ebcf40e96aef5241e">_invR2</a>;</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;    jetA = head + minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#a0ca99aace4dc34bf64a6bca0408c9b08">minloc</a>();</div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;    history_location++;</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;    jetB = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a>;</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;      <span class="keywordflow">if</span> (jetA &lt; jetB) {<a class="code" href="../../d6/db0/fjcore_8hh.html#ac71f249d840a70f8b3aaffb721843eaa">std::swap</a>(jetA,jetB);}</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;      <span class="keywordtype">int</span> nn; <span class="comment">// new jet index</span></div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a63f258516215178970e17bbe2987f8ad">_cs</a>.plugin_record_ij_recombination(jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#adcad53d4a6409c3f08fea864bd84df48">_jets_index</a>, jetB-&gt;_jets_index, diJ_min, nn);</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(jetA);</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;      oldB = * jetB;  <span class="comment">// take a copy because we will need it...</span></div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(jetB);</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a5da6d84f64a7cff12c08700d37f56782">_tj_set_jetinfo</a>(jetB, nn); <span class="comment">// cause jetB to become _jets[nn]</span></div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a63f258516215178970e17bbe2987f8ad">_cs</a>.plugin_record_iB_recombination(jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#adcad53d4a6409c3f08fea864bd84df48">_jets_index</a>, diJ_min);</div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#a03883ee151528f6652e35a2ccd2809a5">_bj_remove_from_tiles</a>(jetA);</div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;    }</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;    minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#a43c188a1357883198388a9713b3d889b">remove</a>(jetA-head);</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;    <span class="keywordtype">int</span> n_near_tiles = 0;</div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;      Tile2 &amp; jetB_tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[jetB-&gt;tile_index];</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;      <span class="keywordflow">for</span> (Tile2 ** near_tile  = jetB_tile.<a class="code" href="../../d9/db1/classTile2Base.html#ae1e3c44950c032480fb16783c993ed13">begin_tiles</a>; </div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;                   near_tile != jetB_tile.<a class="code" href="../../d9/db1/classTile2Base.html#af98fbf093794eb40b3dbbc134fd80f56">end_tiles</a>; near_tile++) {</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;        <span class="keywordtype">double</span> dist_to_tile = <a class="code" href="../../d6/d0c/classLazyTiling9.html#a3d193f3e3b51ad0f4b5262b57b71ed43">_distance_to_tile</a>(jetB, *near_tile);</div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;        <span class="keywordtype">bool</span> relevant_for_jetB  = dist_to_tile &lt;= jetB-&gt;NN_dist;</div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;        <span class="keywordtype">bool</span> relevant_for_near_tile = dist_to_tile &lt;= (*near_tile)-&gt;max_NN_dist;</div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;        <span class="keywordtype">bool</span> relevant = relevant_for_jetB || relevant_for_near_tile;</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;        <span class="keywordflow">if</span> (! relevant) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;        tile_union[n_near_tiles] = *near_tile - &amp; <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[0];</div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;        (*near_tile)-&gt;tagged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;        n_near_tiles++;</div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = (*near_tile)-&gt;head; jetI != NULL; jetI = jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;          <span class="keywordflow">if</span> (jetI-&gt;NN == jetA || jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> == jetB) <a class="code" href="../../d6/d0c/classLazyTiling9.html#ab5cbd2f263244bb145a45e180de3bc99">_set_NN</a>(jetI, jets_for_minheap);</div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;          <a class="code" href="../../d6/d0c/classLazyTiling9.html#ab4a0376d864c66c877a3b4559ab5b62b">_update_jetX_jetI_NN</a>(jetB, jetI, jets_for_minheap);</div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;        }</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;      }</div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;    }</div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;    <span class="keywordtype">int</span> n_done_tiles = n_near_tiles;</div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;    <a class="code" href="../../d6/d0c/classLazyTiling9.html#adb795b6cfe7ca3348e4faf5b28c87734">_add_untagged_neighbours_to_tile_union_using_max_info</a>(jetA, </div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;                                           tile_union, n_near_tiles);</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;        <a class="code" href="../../d6/d0c/classLazyTiling9.html#adb795b6cfe7ca3348e4faf5b28c87734">_add_untagged_neighbours_to_tile_union_using_max_info</a>(&amp;oldB,</div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;                                                              tile_union,n_near_tiles);</div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;      jetB-&gt;label_minheap_update_needed();</div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;      jets_for_minheap.push_back(jetB);</div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;    }</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itile = 0; itile &lt; n_done_tiles; itile++) {</div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;      <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_union[itile]].tagged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;    }</div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itile = n_done_tiles; itile &lt; n_near_tiles; itile++) {</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;      Tile2 * tile_ptr = &amp;<a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[tile_union[itile]];</div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;      tile_ptr-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#adeb2eb8f227cf231ef5694bc183ec9a1">tagged</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = tile_ptr-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a967234fb4a55f306015eec8ed87f9bfc">head</a>; jetI != NULL; jetI = jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;        <span class="keywordflow">if</span> (jetI-&gt;NN == jetA || (jetI-&gt;NN == jetB &amp;&amp; jetB != NULL)) {</div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;          <a class="code" href="../../d6/d0c/classLazyTiling9.html#ab5cbd2f263244bb145a45e180de3bc99">_set_NN</a>(jetI, jets_for_minheap);</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;        }</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;      }</div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;    }</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;    <span class="keywordflow">while</span> (jets_for_minheap.size() &gt; 0) {</div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;      <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = jets_for_minheap.back(); </div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;      jets_for_minheap.pop_back();</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;      minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#a389062f6aba4c38b4995271bf0ece469">update</a>(jetI-head, <a class="code" href="../../d6/d0c/classLazyTiling9.html#ad45eda421baa215aae92c6f187fd02bc">_bj_diJ</a>(jetI));</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;      jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#aa91ab795c368e78cd37c188ddf2b0eba">label_minheap_update_done</a>();</div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;      Tile2 &amp; tile_I = <a class="code" href="../../d6/d0c/classLazyTiling9.html#aae692ff25c6103f0571a3974653a4a18">_tiles</a>[jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>];</div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;      <span class="keywordflow">if</span> (tile_I.<a class="code" href="../../d9/db1/classTile2Base.html#a4f1ab1f745a57b517c847c06011e8281">max_NN_dist</a> &lt; jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>) tile_I.<a class="code" href="../../d9/db1/classTile2Base.html#a4f1ab1f745a57b517c847c06011e8281">max_NN_dist</a> = jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;    }</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;    n--;</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;  }</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;  <span class="keyword">delete</span>[] briefjets;</div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;<span class="preprocessor">#ifdef INSTRUMENT2</span></div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;<span class="preprocessor"></span>  cout &lt;&lt; <span class="stringliteral">&quot;ncall, dtt = &quot;</span> &lt;&lt; _ncall &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; _ncall_dtt &lt;&lt; endl; <span class="comment">// GPS tmp</span></div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;<span class="preprocessor">#endif // INSTRUMENT2</span></div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l05735"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ab913591cbf2ebdf06ca97a54ec474dd8"> 5735</a></span>&#160;<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ab913591cbf2ebdf06ca97a54ec474dd8">LazyTiling9Alt::LazyTiling9Alt</a>(ClusterSequence &amp; cs) :</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;  _cs(cs), _jets(cs.jets())</div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;{</div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a9fc9bfd272cca34b93ded55e9269fa85">_Rparam</a> = cs.jet_def().R();</div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a5f9fae9719f3b1bbdf0d3c12fcd5f2b4">_R2</a> = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a9fc9bfd272cca34b93ded55e9269fa85">_Rparam</a> * <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a9fc9bfd272cca34b93ded55e9269fa85">_Rparam</a>;</div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a72e777ed159e2d08314079248787ee07">_invR2</a> = 1.0 / <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a5f9fae9719f3b1bbdf0d3c12fcd5f2b4">_R2</a>;</div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a49b58fbc44131003e18059ae573ffc52">_initialise_tiles</a>();</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;}</div>
<div class="line"><a name="l05743"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a49b58fbc44131003e18059ae573ffc52"> 5743</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a49b58fbc44131003e18059ae573ffc52">LazyTiling9Alt::_initialise_tiles</a>() {</div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;  <span class="keywordtype">double</span> default_size = max(0.1,<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a9fc9bfd272cca34b93ded55e9269fa85">_Rparam</a>);</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a311e075e7c55de8df64ec224ab173f48">_tile_size_eta</a> = default_size;</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a>   = max(3,<span class="keywordtype">int</span>(floor(<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>/default_size)));</div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a8cd3408521104c153b58709bd47b578f">_tile_size_phi</a> = <a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a> / <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a>; <span class="comment">// &gt;= _Rparam and fits in 2pi</span></div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac32fb405bf33639ccff8298608f61e93">_tiles_eta_min</a> = 0.0;</div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af12c3d5af7b660271ecb42d9ed7ce8f2">_tiles_eta_max</a> = 0.0;</div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> maxrap = 7.0;</div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a3d3a32b461c65d2de87fc0bf3f46757b">_jets</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;    <span class="keywordtype">double</span> eta = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a3d3a32b461c65d2de87fc0bf3f46757b">_jets</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].rap();</div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;    <span class="keywordflow">if</span> (abs(eta) &lt; maxrap) {</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;      <span class="keywordflow">if</span> (eta &lt; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac32fb405bf33639ccff8298608f61e93">_tiles_eta_min</a>) {<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac32fb405bf33639ccff8298608f61e93">_tiles_eta_min</a> = <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#aa66df887c67e0d1025831e9998ea2415">eta</a>;}</div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;      <span class="keywordflow">if</span> (eta &gt; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af12c3d5af7b660271ecb42d9ed7ce8f2">_tiles_eta_max</a>) {<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af12c3d5af7b660271ecb42d9ed7ce8f2">_tiles_eta_max</a> = <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#aa66df887c67e0d1025831e9998ea2415">eta</a>;}</div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;    }</div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;  }</div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#acbe0b1edd05c6897941261f4441048dc">_tiles_ieta_min</a> = int(floor(<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac32fb405bf33639ccff8298608f61e93">_tiles_eta_min</a>/<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a311e075e7c55de8df64ec224ab173f48">_tile_size_eta</a>));</div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af353acf9bd821a65c0c3aa7f1f88b81d">_tiles_ieta_max</a> = int(floor( <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af12c3d5af7b660271ecb42d9ed7ce8f2">_tiles_eta_max</a>/<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a311e075e7c55de8df64ec224ab173f48">_tile_size_eta</a>));</div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac32fb405bf33639ccff8298608f61e93">_tiles_eta_min</a> = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#acbe0b1edd05c6897941261f4441048dc">_tiles_ieta_min</a> * <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a311e075e7c55de8df64ec224ab173f48">_tile_size_eta</a>;</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af12c3d5af7b660271ecb42d9ed7ce8f2">_tiles_eta_max</a> = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af353acf9bd821a65c0c3aa7f1f88b81d">_tiles_ieta_max</a> * <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a311e075e7c55de8df64ec224ab173f48">_tile_size_eta</a>;</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a07d6b04e9ba468108741f255374824d9">_tile_half_size_eta</a> = _tile_size_eta * 0.5;</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ab44b92c53982b5265ff23b819e723c22">_tile_half_size_phi</a> = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a8cd3408521104c153b58709bd47b578f">_tile_size_phi</a> * 0.5;</div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;  vector&lt;bool&gt; use_periodic_delta_phi(<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a> &lt;= 3) {</div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;    fill(use_periodic_delta_phi.begin(), use_periodic_delta_phi.end(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;    use_periodic_delta_phi[0] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;    use_periodic_delta_phi[<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a>-1] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;  }</div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;  <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>.resize((<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af353acf9bd821a65c0c3aa7f1f88b81d">_tiles_ieta_max</a>-<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#acbe0b1edd05c6897941261f4441048dc">_tiles_ieta_min</a>+1)*<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a>);</div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ieta = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#acbe0b1edd05c6897941261f4441048dc">_tiles_ieta_min</a>; ieta &lt;= <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af353acf9bd821a65c0c3aa7f1f88b81d">_tiles_ieta_max</a>; ieta++) {</div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iphi = 0; iphi &lt; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a>; iphi++) {</div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;      <a class="code" href="../../d6/dba/classTile.html">Tile</a> * tile = &amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">_tile_index</a>(ieta,iphi)];</div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;      tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a7580f851a180f1149b0ea356d01f4ef6">head</a> = NULL; <span class="comment">// first element of tiles points to itself</span></div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;      tile-&gt;<a class="code" href="../../d6/dba/classTile.html#ae84cc387ca2878997788f69203080653">begin_tiles</a>[0] =  <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a>(tile,&amp;<a class="code" href="../../d6/dba/classTile.html#a1698b7e24fa015346465b2e6cd2f4586">Tile::distance_to_centre</a>);</div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;      <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a> * pptile = &amp; (tile-&gt;<a class="code" href="../../d6/dba/classTile.html#ae84cc387ca2878997788f69203080653">begin_tiles</a>[0]);</div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;      pptile++;</div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;      tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a00380e1cbb97c3050cba2cd536f8e8ff">surrounding_tiles</a> = pptile;</div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;      <span class="keywordflow">if</span> (ieta &gt; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#acbe0b1edd05c6897941261f4441048dc">_tiles_ieta_min</a>) {</div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;        <span class="comment">// with the itile subroutine, we can safely run tiles from</span></div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;        <span class="comment">// idphi=-1 to idphi=+1, because it takes care of</span></div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;        <span class="comment">// negative and positive boundaries</span></div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;        <span class="comment">//for (int idphi = -1; idphi &lt;=+1; idphi++) {</span></div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;        *pptile = <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a>(&amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">_tile_index</a>(ieta-1,iphi-1)],</div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;                                   &amp;<a class="code" href="../../d6/dba/classTile.html#a97aa7052cf679ded850bf4339190d7f6">Tile::distance_to_left_bottom</a>);</div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;        pptile++;</div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;        *pptile = <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a>(&amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">_tile_index</a>(ieta-1,iphi)],</div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;                                   &amp;<a class="code" href="../../d6/dba/classTile.html#a891abfc26f5d46c6c1da3135cbc08c63">Tile::distance_to_left</a>);</div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;        pptile++;</div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;        *pptile = <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a>(&amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">_tile_index</a>(ieta-1,iphi+1)],</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;                                   &amp;<a class="code" href="../../d6/dba/classTile.html#a01d3c18d7fd76ac9b2198f4b421ecc3b">Tile::distance_to_left_top</a>);</div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;        pptile++;</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;      }</div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;      *pptile = <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a>(&amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">_tile_index</a>(ieta,iphi-1)], </div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;                                 &amp;<a class="code" href="../../d6/dba/classTile.html#a1a0a8cd91c79d58e06297a8124888700">Tile::distance_to_bottom</a>);</div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;      pptile++;</div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;      tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a8bb3c90e69ebdcf4006a4604a0686e8a">RH_tiles</a> = pptile;</div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;      *pptile = <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a>(&amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">_tile_index</a>(ieta,iphi+1)], </div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;                                 &amp;<a class="code" href="../../d6/dba/classTile.html#a777f229c42135ac9ebf685033a3af918">Tile::distance_to_top</a>);</div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;      pptile++;</div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;      <span class="keywordflow">if</span> (ieta &lt; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af353acf9bd821a65c0c3aa7f1f88b81d">_tiles_ieta_max</a>) {</div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;        <span class="comment">//for (int idphi = -1; idphi &lt;= +1; idphi++) {</span></div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;        <span class="comment">//  *pptile = &amp; _tiles[_tile_index(ieta+1,iphi+idphi)];</span></div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;        <span class="comment">//  pptile++;</span></div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;        <span class="comment">//}     </span></div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;        *pptile = <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a>(&amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">_tile_index</a>(ieta+1,iphi-1)],</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;                                   &amp;<a class="code" href="../../d6/dba/classTile.html#aa2cd60d5bd91d4adbc54accac9ca97d7">Tile::distance_to_right_bottom</a>);</div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;        pptile++;</div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;        *pptile = <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a>(&amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">_tile_index</a>(ieta+1,iphi)],</div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;                                   &amp;<a class="code" href="../../d6/dba/classTile.html#a7301bc20be1599cb3fe210feb0f15cc5">Tile::distance_to_right</a>);</div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;        pptile++;</div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;        *pptile = <a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a>(&amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">_tile_index</a>(ieta+1,iphi+1)],</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;                                   &amp;<a class="code" href="../../d6/dba/classTile.html#aabc56b48d79be7881fa5071c2aa19adb">Tile::distance_to_right_top</a>);</div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;        pptile++;</div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;      }</div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;      tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a329d17e1969ebc71b1b4b5f526c7fbca">end_tiles</a> = pptile;</div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;      tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a813d13f819ffe7a56b6d9b1c3969fd0f">tagged</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;      tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a8a2e35acd08e0cd6f4ec833476a06046">use_periodic_delta_phi</a> = use_periodic_delta_phi[iphi];</div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;      tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a24050e641756be95bc3056567c369740">max_NN_dist</a> = 0;</div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;      tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a213dd764e077f3d80099880eb67dae0d">eta_min</a> = ieta*<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a311e075e7c55de8df64ec224ab173f48">_tile_size_eta</a>;</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;      tile-&gt;<a class="code" href="../../d6/dba/classTile.html#ab7a9c841145708a7c56a4ee2bc3f6c29">eta_max</a> = (ieta+1)*_tile_size_eta;</div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;      tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a5ed67a95bf42d52d52f220069ff67e86">phi_min</a> = iphi*<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a8cd3408521104c153b58709bd47b578f">_tile_size_phi</a>;</div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;      tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a63432d21621459990959f4b5acb52f86">phi_max</a> = (iphi+1)*_tile_size_phi;</div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;    }</div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;  }</div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;}</div>
<div class="line"><a name="l05828"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ad945336d7229d38e94756a80869fd502"> 5828</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">LazyTiling9Alt::_tile_index</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> eta, <span class="keyword">const</span> <span class="keywordtype">double</span> phi)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;  <span class="keywordtype">int</span> ieta, iphi;</div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;  <span class="keywordflow">if</span>      (eta &lt;= <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac32fb405bf33639ccff8298608f61e93">_tiles_eta_min</a>) {ieta = 0;}</div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eta &gt;= <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af12c3d5af7b660271ecb42d9ed7ce8f2">_tiles_eta_max</a>) {ieta = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af353acf9bd821a65c0c3aa7f1f88b81d">_tiles_ieta_max</a>-<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#acbe0b1edd05c6897941261f4441048dc">_tiles_ieta_min</a>;}</div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;    ieta = int(((eta - <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac32fb405bf33639ccff8298608f61e93">_tiles_eta_min</a>) / <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a311e075e7c55de8df64ec224ab173f48">_tile_size_eta</a>));</div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;    <span class="keywordflow">if</span> (ieta &gt; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af353acf9bd821a65c0c3aa7f1f88b81d">_tiles_ieta_max</a>-<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#acbe0b1edd05c6897941261f4441048dc">_tiles_ieta_min</a>) {</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;      ieta = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#af353acf9bd821a65c0c3aa7f1f88b81d">_tiles_ieta_max</a>-<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#acbe0b1edd05c6897941261f4441048dc">_tiles_ieta_min</a>;} </div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;  }</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;  iphi = int((phi+<a class="code" href="../../d6/db0/fjcore_8hh.html#ad996edbbc287b4e5f3dd072a10bd6122">twopi</a>)/<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a8cd3408521104c153b58709bd47b578f">_tile_size_phi</a>) % <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a>;</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;  <span class="keywordflow">return</span> (iphi + ieta * <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a094538bf3c56ecfc1cb1193b44f86a1b">_n_tiles_phi</a>);</div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;}</div>
<div class="line"><a name="l05840"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ab06aa2645325f0dc3cf75704834898ec"> 5840</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ab06aa2645325f0dc3cf75704834898ec">LazyTiling9Alt::_tj_set_jetinfo</a>( <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet,</div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">int</span> _jets_index) {</div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;  _bj_set_jetinfo&lt;&gt;(jet, _jets_index);</div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;  jet-&gt;tile_index = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a4003fb6775f8a0750712555977773462">_tile_index</a>(jet-&gt;eta, jet-&gt;phi);</div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;  <a class="code" href="../../d6/dba/classTile.html">Tile</a> * tile = &amp;<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[jet-&gt;tile_index];</div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;  jet-&gt;previous   = NULL;</div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;  jet-&gt;next       = tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a7580f851a180f1149b0ea356d01f4ef6">head</a>;</div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;  <span class="keywordflow">if</span> (jet-&gt;next != NULL) {jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a> = jet;}</div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;  tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a7580f851a180f1149b0ea356d01f4ef6">head</a>      = jet;</div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;}</div>
<div class="line"><a name="l05850"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a34935a01ded9d31425d43fcbf3047c9e"> 5850</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a34935a01ded9d31425d43fcbf3047c9e">LazyTiling9Alt::_bj_remove_from_tiles</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * <span class="keyword">const</span> jet) {</div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;  <a class="code" href="../../d6/dba/classTile.html">Tile</a> * tile = &amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>];</div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;  <span class="keywordflow">if</span> (jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a> == NULL) {</div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;    tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a7580f851a180f1149b0ea356d01f4ef6">head</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>;</div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;    jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a>-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>;</div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;  }</div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;  <span class="keywordflow">if</span> (jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a> != NULL) {</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;    jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a> = jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a8a49fd720b0bdb62b577c2d90daadfef">previous</a>;</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;  }</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;}</div>
<div class="line"><a name="l05861"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ae4d08a569f9d9d675d1d37e5492a1e13"> 5861</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ae4d08a569f9d9d675d1d37e5492a1e13">LazyTiling9Alt::_print_tiles</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * briefjets )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;  <span class="keywordflow">for</span> (vector&lt;Tile&gt;::const_iterator tile = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>.begin(); </div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;       tile &lt; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Tile &quot;</span> &lt;&lt; tile - <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>.begin()&lt;&lt;<span class="stringliteral">&quot; = &quot;</span>;</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;    vector&lt;int&gt; list;</div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = tile-&gt;<a class="code" href="../../d9/db1/classTile2Base.html#a967234fb4a55f306015eec8ed87f9bfc">head</a>; jetI != NULL; jetI = jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;      list.push_back(jetI-briefjets);</div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;    }</div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;    <a class="code" href="../../d2/da5/namespaceActs_1_1Experimental_1_1detail_1_1BlueprintHelper.html#a308a6456db2655fc6a1a916696da20c8" title="Sort the nodes in the blueprint container node.">sort</a>(list.begin(),list.end());</div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; list.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {cout &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;list[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>];}</div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;    cout &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;  }</div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;}</div>
<div class="line"><a name="l05874"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a10445c472f9312b1d5c8bf5e02a91eba"> 5874</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a10445c472f9312b1d5c8bf5e02a91eba">LazyTiling9Alt::_add_neighbours_to_tile_union</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;               vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a> <span class="keyword">const</span> * near_tile = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[tile_index].begin_tiles; </div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;       near_tile != <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[tile_index].end_tiles; near_tile++){</div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;    tile_union[n_near_tiles] = near_tile-&gt;first - &amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[0];</div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;    n_near_tiles++;</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;  }</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;}</div>
<div class="line"><a name="l05882"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a0b6dca001f406eae6eb03a4b41f6d5c7"> 5882</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a0b6dca001f406eae6eb03a4b41f6d5c7">LazyTiling9Alt::_add_untagged_neighbours_to_tile_union</a>(</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> tile_index, </div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;               vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles)  {</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a> * near_tile = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[tile_index].begin_tiles; </div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;       near_tile != <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[tile_index].end_tiles; near_tile++){</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;    <span class="keywordflow">if</span> (! (near_tile-&gt;first)-&gt;tagged) {</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;      (near_tile-&gt;first)-&gt;tagged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;      tile_union[n_near_tiles] = near_tile-&gt;first - &amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[0];</div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;      n_near_tiles++;</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;    }</div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;  }</div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;}</div>
<div class="line"><a name="l05894"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a494f7447beed4925b4e0cefbda761ee8"> 5894</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a494f7447beed4925b4e0cefbda761ee8">LazyTiling9Alt::_add_untagged_neighbours_to_tile_union_using_max_info</a>(</div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;               <span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jet, </div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;               vector&lt;int&gt; &amp; tile_union, <span class="keywordtype">int</span> &amp; n_near_tiles)  {</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;  <a class="code" href="../../d6/dba/classTile.html">Tile</a> &amp; tile = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[jet-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>];</div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a> * near_tile = tile.<a class="code" href="../../d6/dba/classTile.html#ae84cc387ca2878997788f69203080653">begin_tiles</a>; near_tile != tile.<a class="code" href="../../d6/dba/classTile.html#a329d17e1969ebc71b1b4b5f526c7fbca">end_tiles</a>; near_tile++){</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;    <span class="keywordflow">if</span> ((near_tile-&gt;first)-&gt;tagged) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = (tile.*(near_tile-&gt;second))(jet) - tile_edge_security_margin;</div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;    <span class="keywordflow">if</span> (dist &gt; (near_tile-&gt;first)-&gt;max_NN_dist) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;    (near_tile-&gt;first)-&gt;tagged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;    tile_union[n_near_tiles] = near_tile-&gt;first - &amp; <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[0];</div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;    n_near_tiles++;</div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;  }</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;}</div>
<div class="line"><a name="l05907"></a><span class="lineno"><a class="code" href="../../d8/d99/fjcore_8cc.html#ac93d71f7649c9fc9b5cb0788ae5c4bcb"> 5907</a></span>&#160;ostream &amp; <a class="code" href="../../da/d7b/namespaceActs.html#aaf945d5e789508b76330e694c2a986e2">operator&lt;&lt;</a>(ostream &amp; ostr, <span class="keyword">const</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> &amp; jet) {</div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;  ostr &lt;&lt; <span class="stringliteral">&quot;j&quot;</span> &lt;&lt; setw(3) &lt;&lt; jet.<a class="code" href="../../df/da7/classTiledJet.html#adcad53d4a6409c3f08fea864bd84df48">_jets_index</a> &lt;&lt; <span class="stringliteral">&quot;:pt2,rap,phi=&quot;</span> ; ostr.flush();</div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;  ostr     &lt;&lt; jet.<a class="code" href="../../df/da7/classTiledJet.html#a370a59a9def2f68b1cdded48eb319471">kt2</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>; ostr.flush();</div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;  ostr     &lt;&lt; jet.<a class="code" href="../../df/da7/classTiledJet.html#a4d55d138e2a9c00de4c8a7bebbf22527">eta</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>; ostr.flush();</div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;  ostr     &lt;&lt; jet.<a class="code" href="../../df/da7/classTiledJet.html#a8835c304c97003b0159e3b2686b99151">phi</a>; ostr.flush();</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;  ostr     &lt;&lt; <span class="stringliteral">&quot;, tile=&quot;</span> &lt;&lt; jet.<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>; ostr.flush();</div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;  <span class="keywordflow">return</span> ostr;</div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;}</div>
<div class="line"><a name="l05915"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#abe7dd3e938c46d2625e2e9a6a8657aa2"> 5915</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#abe7dd3e938c46d2625e2e9a6a8657aa2">LazyTiling9Alt::_update_jetX_jetI_NN</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetX, <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI, vector&lt;TiledJet *&gt; &amp; jets_for_minheap) {</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a12d687852b9b72130480b27594a10d84">_bj_dist</a>(jetI,jetX);</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;  <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist) {</div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;    <span class="keywordflow">if</span> (jetI != jetX) {</div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;      jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;      jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetX;</div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;      <span class="keywordflow">if</span> (!jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a6a9b6e9d8d9e84ceb95c722b7c892aa0">minheap_update_needed</a>()) {</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;        jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a3f73f5b46367e34719b3024d36573b54">label_minheap_update_needed</a>();</div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;        jets_for_minheap.push_back(jetI);</div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;      }</div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;    }</div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;  }</div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;  <span class="keywordflow">if</span> (dist &lt; jetX-&gt;NN_dist) {</div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;    <span class="keywordflow">if</span> (jetI != jetX) {</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;      jetX-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>;</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;      jetX-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a>      = jetI;}</div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;  }</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;}</div>
<div class="line"><a name="l05933"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a610f988049ee51f745cdd79a0b97df01"> 5933</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a610f988049ee51f745cdd79a0b97df01">LazyTiling9Alt::_set_NN</a>(<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI, </div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;                            vector&lt;TiledJet *&gt; &amp; jets_for_minheap) {</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;  jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a5f9fae9719f3b1bbdf0d3c12fcd5f2b4">_R2</a>;</div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;  jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a>      = NULL;</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;  <span class="keywordflow">if</span> (!jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a6a9b6e9d8d9e84ceb95c722b7c892aa0">minheap_update_needed</a>()) {</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;    jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a3f73f5b46367e34719b3024d36573b54">label_minheap_update_needed</a>();</div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;    jets_for_minheap.push_back(jetI);}</div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;  <a class="code" href="../../d6/dba/classTile.html">Tile</a> * tile_ptr = &amp;<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>];</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a> * near_tile  = tile_ptr-&gt;<a class="code" href="../../d6/dba/classTile.html#ae84cc387ca2878997788f69203080653">begin_tiles</a>; </div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;         near_tile != tile_ptr-&gt;<a class="code" href="../../d6/dba/classTile.html#a329d17e1969ebc71b1b4b5f526c7fbca">end_tiles</a>; near_tile++) {</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;      <span class="keywordflow">if</span> (jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> &lt; (tile_ptr-&gt;*(near_tile-&gt;second))(jetI)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetJ  = (near_tile-&gt;first)-&gt;head; </div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;           jetJ != NULL; jetJ = jetJ-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a12d687852b9b72130480b27594a10d84">_bj_dist</a>(jetI,jetJ);</div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetI-&gt;NN_dist &amp;&amp; jetJ != jetI) {</div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;          jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetJ;</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;        }</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;      }</div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;    }</div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;}</div>
<div class="line"><a name="l05953"></a><span class="lineno"><a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac84f56586f04bf876590c60b0b015806"> 5953</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ac84f56586f04bf876590c60b0b015806">LazyTiling9Alt::run</a>() {</div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a> = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a3d3a32b461c65d2de87fc0bf3f46757b">_jets</a>.size();</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * briefjets = <span class="keyword">new</span> <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a>[<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>];</div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetA = briefjets, * jetB;</div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> oldB;</div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;  vector&lt;int&gt; tile_union(3*n_tile_neighbours);</div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;    <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ab06aa2645325f0dc3cf75704834898ec">_tj_set_jetinfo</a>(jetA, <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>);</div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;    jetA++; <span class="comment">// move on to next entry of briefjets</span></div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;  }</div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;  <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * head = briefjets; <span class="comment">// a nicer way of naming start</span></div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;  vector&lt;Tile&gt;::iterator <a class="code" href="../../d2/d51/usm_8C.html#a4fc3d7a8ab8dddafe2295d65165d9cf7">tile</a>;</div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;  <span class="keywordflow">for</span> (tile = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>.begin(); tile != <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;    <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;      <span class="keywordflow">for</span> (jetB = tile-&gt;head; jetB != jetA; jetB = jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a02c2cfced1c947f61aa68860c6a0b46c">_bj_dist_not_periodic</a>(jetA,jetB);</div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetB;}</div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;        <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;      }</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;    }</div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;    <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;      <span class="keywordflow">if</span> (jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> &gt; tile-&gt;max_NN_dist) tile-&gt;max_NN_dist = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;    }</div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;  }</div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;  <span class="keywordflow">for</span> (tile = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>.begin(); tile != <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;    <span class="keywordflow">if</span> (tile-&gt;use_periodic_delta_phi) {</div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a> * RTileFnPair = tile-&gt;RH_tiles; </div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;           RTileFnPair != tile-&gt;end_tiles; RTileFnPair++) {</div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;        <a class="code" href="../../d6/dba/classTile.html">Tile</a> *RTile = RTileFnPair-&gt;first;</div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;        <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;          <span class="keywordtype">double</span> dist_to_tile = ((*tile).*(RTileFnPair-&gt;second))(jetA);</div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;          <span class="keywordtype">bool</span> relevant_for_jetA  = dist_to_tile &lt;= jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;          <span class="keywordtype">bool</span> relevant_for_RTile = dist_to_tile &lt;= RTile-&gt;<a class="code" href="../../d6/dba/classTile.html#a24050e641756be95bc3056567c369740">max_NN_dist</a>;</div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;          <span class="keywordflow">if</span> (relevant_for_jetA || relevant_for_RTile) {</div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;            <span class="keywordflow">for</span> (jetB = RTile-&gt;<a class="code" href="../../d6/dba/classTile.html#a7580f851a180f1149b0ea356d01f4ef6">head</a>; jetB != NULL; jetB = jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a12d687852b9b72130480b27594a10d84">_bj_dist</a>(jetA,jetB);</div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetB;}</div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;            }</div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;          } </div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;        }</div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;      }</div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a>* RTileFnPair = tile-&gt;RH_tiles;</div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;           RTileFnPair != tile-&gt;end_tiles; RTileFnPair++) {</div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;        <a class="code" href="../../d6/dba/classTile.html">Tile</a> *RTile = RTileFnPair-&gt;first;</div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;        <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;          <span class="keywordtype">double</span> dist_to_tile = ((*tile).*(RTileFnPair-&gt;second))(jetA);</div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;          <span class="keywordtype">bool</span> relevant_for_jetA  = dist_to_tile &lt;= jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;          <span class="keywordtype">bool</span> relevant_for_RTile = dist_to_tile &lt;= RTile-&gt;<a class="code" href="../../d6/dba/classTile.html#a24050e641756be95bc3056567c369740">max_NN_dist</a>;</div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;          <span class="keywordflow">if</span> (relevant_for_jetA || relevant_for_RTile) {</div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;            <span class="keywordflow">for</span> (jetB = RTile-&gt;<a class="code" href="../../d6/dba/classTile.html#a7580f851a180f1149b0ea356d01f4ef6">head</a>; jetB != NULL; jetB = jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a> = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a02c2cfced1c947f61aa68860c6a0b46c">_bj_dist_not_periodic</a>(jetA,jetB);</div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetA-&gt;NN_dist) {jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> = jetB;}</div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;              <span class="keywordflow">if</span> (dist &lt; jetB-&gt;NN_dist) {jetB-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> = <a class="code" href="../../d9/dbb/buildEdges_8cpp.html#a1c7c5a664ae255650d4dd47dffef1835">dist</a>; jetB-&gt;NN = jetA;}</div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;            }</div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;          } </div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;        }</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;      }</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;    }</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;  }</div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;  <span class="keywordflow">for</span> (tile = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>.begin(); tile != <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>.end(); tile++) {</div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;    tile-&gt;max_NN_dist = 0;</div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;    <span class="keywordflow">for</span> (jetA = tile-&gt;head; jetA != NULL; jetA = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;      <span class="keywordflow">if</span> (jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a> &gt; tile-&gt;max_NN_dist) tile-&gt;max_NN_dist = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;    }</div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;  }</div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;  vector&lt;double&gt; diJs(n);</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; <a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;    diJs[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>] = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a79afb75701cc931952234d74e549ddeb">_bj_diJ</a>(&amp;briefjets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;    briefjets[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].<a class="code" href="../../df/da7/classTiledJet.html#aa91ab795c368e78cd37c188ddf2b0eba">label_minheap_update_done</a>();</div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;  }</div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;  <a class="code" href="../../dc/d1f/classMinHeap.html">MinHeap</a> minheap(diJs);</div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;  vector&lt;TiledJet *&gt; jets_for_minheap;</div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;  jets_for_minheap.reserve(n); </div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;  <span class="keywordtype">int</span> history_location = n-1;</div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;  <span class="keywordflow">while</span> (n &gt; 0) {</div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;    <span class="keywordtype">double</span> diJ_min = minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#ae17ef2b28154bf277ffef1c4f0e71f12">minval</a>() *<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a72e777ed159e2d08314079248787ee07">_invR2</a>;</div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;    jetA = head + minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#a0ca99aace4dc34bf64a6bca0408c9b08">minloc</a>();</div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;    history_location++;</div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;    jetB = jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a>;</div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;      <span class="keywordflow">if</span> (jetA &lt; jetB) {<a class="code" href="../../d6/db0/fjcore_8hh.html#ac71f249d840a70f8b3aaffb721843eaa">std::swap</a>(jetA,jetB);}</div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;      <span class="keywordtype">int</span> nn; <span class="comment">// new jet index</span></div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;      <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#aa178ac68f7b0cde61f9102276957cdb5">_cs</a>.plugin_record_ij_recombination(jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#adcad53d4a6409c3f08fea864bd84df48">_jets_index</a>, jetB-&gt;_jets_index, diJ_min, nn);</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;      <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a34935a01ded9d31425d43fcbf3047c9e">_bj_remove_from_tiles</a>(jetA);</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;      oldB = * jetB;  <span class="comment">// take a copy because we will need it...</span></div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;      <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a34935a01ded9d31425d43fcbf3047c9e">_bj_remove_from_tiles</a>(jetB);</div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;      <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#ab06aa2645325f0dc3cf75704834898ec">_tj_set_jetinfo</a>(jetB, nn); <span class="comment">// cause jetB to become _jets[nn]</span></div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;      <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#aa178ac68f7b0cde61f9102276957cdb5">_cs</a>.plugin_record_iB_recombination(jetA-&gt;<a class="code" href="../../df/da7/classTiledJet.html#adcad53d4a6409c3f08fea864bd84df48">_jets_index</a>, diJ_min);</div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;      <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a34935a01ded9d31425d43fcbf3047c9e">_bj_remove_from_tiles</a>(jetA);</div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;    }</div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;    minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#a43c188a1357883198388a9713b3d889b">remove</a>(jetA-head);</div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;    <span class="keywordtype">int</span> n_near_tiles = 0;</div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;    <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a494f7447beed4925b4e0cefbda761ee8">_add_untagged_neighbours_to_tile_union_using_max_info</a>(jetA, </div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;                                           tile_union, n_near_tiles);</div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;        <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a494f7447beed4925b4e0cefbda761ee8">_add_untagged_neighbours_to_tile_union_using_max_info</a>(&amp;oldB,</div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;                                                              tile_union,n_near_tiles);</div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;      jetB-&gt;label_minheap_update_needed();</div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;      jets_for_minheap.push_back(jetB);</div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;    }</div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;    <span class="keywordflow">if</span> (jetB != NULL) {</div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;      <a class="code" href="../../d6/dba/classTile.html">Tile</a> &amp; jetB_tile = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[jetB-&gt;tile_index];</div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../d6/dba/classTile.html#a2fa06782077ffee9c3c95a15ebf45324">Tile::TileFnPair</a> * near_tile_fn_pair  = jetB_tile.<a class="code" href="../../d6/dba/classTile.html#ae84cc387ca2878997788f69203080653">begin_tiles</a>; </div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;                   near_tile_fn_pair != jetB_tile.<a class="code" href="../../d6/dba/classTile.html#a329d17e1969ebc71b1b4b5f526c7fbca">end_tiles</a>; near_tile_fn_pair++) {</div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;        <a class="code" href="../../d6/dba/classTile.html">Tile</a> * near_tile = near_tile_fn_pair-&gt;first;</div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;        <span class="keywordtype">double</span> dist_to_tile = (jetB_tile.*(near_tile_fn_pair-&gt;second))(jetB);</div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;        <span class="keywordtype">bool</span> relevant_for_jetB  = dist_to_tile &lt;= jetB-&gt;NN_dist;</div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;        <span class="keywordtype">bool</span> relevant_for_near_tile = dist_to_tile &lt;= near_tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a24050e641756be95bc3056567c369740">max_NN_dist</a>;</div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;        <span class="keywordtype">bool</span> relevant = relevant_for_jetB || relevant_for_near_tile;</div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;        <span class="keywordflow">if</span> (relevant) {</div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;          <span class="keywordflow">if</span> (near_tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a813d13f819ffe7a56b6d9b1c3969fd0f">tagged</a>) {</div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = near_tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a7580f851a180f1149b0ea356d01f4ef6">head</a>; jetI != NULL; jetI = jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;              <span class="keywordflow">if</span> (jetI-&gt;NN == jetA || jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#ab342cfc32990ae47d5fb0bd9f553456a">NN</a> == jetB) <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a610f988049ee51f745cdd79a0b97df01">_set_NN</a>(jetI, jets_for_minheap);</div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;              <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#abe7dd3e938c46d2625e2e9a6a8657aa2">_update_jetX_jetI_NN</a>(jetB, jetI, jets_for_minheap);</div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;            }</div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;          near_tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a813d13f819ffe7a56b6d9b1c3969fd0f">tagged</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = near_tile-&gt;<a class="code" href="../../d6/dba/classTile.html#a7580f851a180f1149b0ea356d01f4ef6">head</a>; jetI != NULL; jetI = jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;              <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#abe7dd3e938c46d2625e2e9a6a8657aa2">_update_jetX_jetI_NN</a>(jetB, jetI, jets_for_minheap);</div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;            }</div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;          }</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;        }</div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;        <span class="comment">//     // -- Keep this old inline code for later speed tests</span></div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;      }</div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;    }</div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itile = 0; itile &lt; n_near_tiles; itile++) {</div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;      <a class="code" href="../../d6/dba/classTile.html">Tile</a> * tile_ptr = &amp;<a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[tile_union[itile]];</div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;      <span class="keywordflow">if</span> (!tile_ptr-&gt;<a class="code" href="../../d6/dba/classTile.html#a813d13f819ffe7a56b6d9b1c3969fd0f">tagged</a>) <span class="keywordflow">continue</span>; <span class="comment">// because earlier loop may have undone the tag</span></div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;      tile_ptr-&gt;<a class="code" href="../../d6/dba/classTile.html#a813d13f819ffe7a56b6d9b1c3969fd0f">tagged</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = tile_ptr-&gt;<a class="code" href="../../d6/dba/classTile.html#a7580f851a180f1149b0ea356d01f4ef6">head</a>; jetI != NULL; jetI = jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a5afb5c80781680fb61e6fdbd0c5664ed">next</a>) {</div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;        <span class="keywordflow">if</span> (jetI-&gt;NN == jetA || (jetI-&gt;NN == jetB &amp;&amp; jetB != NULL)) {</div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;          <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a610f988049ee51f745cdd79a0b97df01">_set_NN</a>(jetI, jets_for_minheap);</div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;        }</div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;      }</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;    }</div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;    <span class="keywordflow">while</span> (jets_for_minheap.size() &gt; 0) {</div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;      <a class="code" href="../../df/da7/classTiledJet.html">TiledJet</a> * jetI = jets_for_minheap.back(); </div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;      jets_for_minheap.pop_back();</div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;      minheap.<a class="code" href="../../dc/d1f/classMinHeap.html#a389062f6aba4c38b4995271bf0ece469">update</a>(jetI-head, <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#a79afb75701cc931952234d74e549ddeb">_bj_diJ</a>(jetI));</div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;      jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#aa91ab795c368e78cd37c188ddf2b0eba">label_minheap_update_done</a>();</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;      <a class="code" href="../../d6/dba/classTile.html">Tile</a> &amp; tile_I = <a class="code" href="../../d9/dae/classLazyTiling9Alt.html#adef8064e807ea59bcad029deaa66883a">_tiles</a>[jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#a69fffb87a2d67b20afc7706c8631a282">tile_index</a>];</div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;      <span class="keywordflow">if</span> (tile_I.<a class="code" href="../../d6/dba/classTile.html#a24050e641756be95bc3056567c369740">max_NN_dist</a> &lt; jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>) tile_I.<a class="code" href="../../d6/dba/classTile.html#a24050e641756be95bc3056567c369740">max_NN_dist</a> = jetI-&gt;<a class="code" href="../../df/da7/classTiledJet.html#af1ef44f0882af80917153b14dd664301">NN_dist</a>;</div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;    }</div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;    n--;</div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;  }</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;  <span class="keyword">delete</span>[] briefjets;</div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;}</div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ae90328c3b710ee0f2de3ac44beb83def">FJCORE_BEGIN_NAMESPACE</a>      <span class="comment">// defined in fastjet/internal/base.hh</span></div>
<div class="line"><a name="l06109"></a><span class="lineno"><a class="code" href="../../da/dd5/classTilingExtent.html#a46f5ec6374d8a7b379c2a32244dcdd63"> 6109</a></span>&#160;<a class="code" href="../../da/dd5/classTilingExtent.html#a46f5ec6374d8a7b379c2a32244dcdd63">TilingExtent::TilingExtent</a>(ClusterSequence &amp; cs) {</div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;  _determine_rapidity_extent(cs.jets());</div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;}</div>
<div class="line"><a name="l06112"></a><span class="lineno"><a class="code" href="../../da/dd5/classTilingExtent.html#ab545b88676e638cd950a0b4144853fd3"> 6112</a></span>&#160;<a class="code" href="../../da/dd5/classTilingExtent.html#a46f5ec6374d8a7b379c2a32244dcdd63">TilingExtent::TilingExtent</a>(<span class="keyword">const</span> vector&lt;PseudoJet&gt; &amp;<a class="code" href="../../d8/d44/Plot-Measured__Energy-EMC_8C.html#a5f26f26553bf8cd4bdde213793d63113">particles</a>) {</div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;  _determine_rapidity_extent(particles);</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;}</div>
<div class="line"><a name="l06115"></a><span class="lineno"><a class="code" href="../../da/dd5/classTilingExtent.html#ad25fb4ef05c155af0a885e9a000baa88"> 6115</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../da/dd5/classTilingExtent.html#ad25fb4ef05c155af0a885e9a000baa88">TilingExtent::_determine_rapidity_extent</a>(<span class="keyword">const</span> vector&lt;PseudoJet&gt; &amp; <a class="code" href="../../d8/d44/Plot-Measured__Energy-EMC_8C.html#a5f26f26553bf8cd4bdde213793d63113">particles</a>) {</div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;  <span class="keywordtype">int</span> nrap = 20; </div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../df/d51/dvcs__plot_8C.html#a468a1928a2d2dd88800a5d42a74b5624">nbins</a> = 2*nrap;</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;  vector&lt;double&gt; counts(nbins, 0);</div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;  _minrap =  numeric_limits&lt;double&gt;::max();</div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;  _maxrap = -numeric_limits&lt;double&gt;::max();</div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d5/d92/namespaceconfigureMap.html#af4436842063f51f2a5388cca02549d81">ibin</a>;</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; particles.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;    <span class="keywordflow">if</span> (particles[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].<a class="code" href="../../dc/d43/Proto2ShowerCalibFit_8m.html#a93b7cb110b782e59ebd44f83181b9e0e" title="Modifier of energy of the particle, fP[6].">E</a>() == abs(particles[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].pz())) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;    <span class="keywordtype">double</span> rap = particles[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].rap();</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;    <span class="keywordflow">if</span> (rap &lt; _minrap) _minrap = rap;</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;    <span class="keywordflow">if</span> (rap &gt; _maxrap) _maxrap = rap;</div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;    ibin = int(rap+nrap); </div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;    <span class="keywordflow">if</span> (ibin &lt; 0) ibin = 0;</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;    <span class="keywordflow">if</span> (ibin &gt;= nbins) ibin = nbins - 1;</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;    counts[<a class="code" href="../../d5/d92/namespaceconfigureMap.html#af4436842063f51f2a5388cca02549d81">ibin</a>]++;</div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;  }</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;  <span class="keywordtype">double</span> max_in_bin = 0;</div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;  <span class="keywordflow">for</span> (ibin = 0; ibin &lt; <a class="code" href="../../df/d51/dvcs__plot_8C.html#a468a1928a2d2dd88800a5d42a74b5624">nbins</a>; ibin++) {</div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;    <span class="keywordflow">if</span> (max_in_bin &lt; counts[ibin]) max_in_bin = counts[<a class="code" href="../../d5/d92/namespaceconfigureMap.html#af4436842063f51f2a5388cca02549d81">ibin</a>];</div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;  }</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> allowed_max_fraction = 0.25;</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> min_multiplicity = 4;</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;  <span class="keywordtype">double</span> allowed_max_cumul = floor(max(max_in_bin * allowed_max_fraction, min_multiplicity));</div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;  <span class="keywordflow">if</span> (allowed_max_cumul &gt; max_in_bin) allowed_max_cumul = max_in_bin;</div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;  <span class="keywordtype">double</span> cumul_lo = 0;</div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;  _cumul2 = 0;</div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;  <span class="keywordflow">for</span> (ibin = 0; ibin &lt; <a class="code" href="../../df/d51/dvcs__plot_8C.html#a468a1928a2d2dd88800a5d42a74b5624">nbins</a>; ibin++) {</div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;    cumul_lo += counts[<a class="code" href="../../d5/d92/namespaceconfigureMap.html#af4436842063f51f2a5388cca02549d81">ibin</a>];</div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;    <span class="keywordflow">if</span> (cumul_lo &gt;= allowed_max_cumul) {</div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#ab927965981178aa1fba979a37168db2a">y</a> = ibin-nrap;</div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;      <span class="keywordflow">if</span> (y &gt; _minrap) _minrap = <a class="code" href="../../d7/d87/fasthadv4_8C.html#ab927965981178aa1fba979a37168db2a">y</a>;</div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;    }</div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;  }</div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(ibin != nbins); <span class="comment">// internal consistency check that you found a bin</span></div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;  _cumul2 += cumul_lo*cumul_lo;</div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;  <span class="keywordtype">int</span> ibin_lo = <a class="code" href="../../d5/d92/namespaceconfigureMap.html#af4436842063f51f2a5388cca02549d81">ibin</a>;</div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;  <span class="keywordtype">double</span> cumul_hi = 0;</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;  <span class="keywordflow">for</span> (ibin = nbins-1; ibin &gt;= 0; ibin--) {</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;    cumul_hi += counts[<a class="code" href="../../d5/d92/namespaceconfigureMap.html#af4436842063f51f2a5388cca02549d81">ibin</a>];</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;    <span class="keywordflow">if</span> (cumul_hi &gt;= allowed_max_cumul) {</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#ab927965981178aa1fba979a37168db2a">y</a> = ibin-nrap+1; <span class="comment">// +1 here is the rapidity bin width</span></div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;      <span class="keywordflow">if</span> (y &lt; _maxrap) _maxrap = <a class="code" href="../../d7/d87/fasthadv4_8C.html#ab927965981178aa1fba979a37168db2a">y</a>;</div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;    }</div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;  }</div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(ibin &gt;= 0); <span class="comment">// internal consistency check that you found a bin</span></div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;  <span class="keywordtype">int</span> ibin_hi = <a class="code" href="../../d5/d92/namespaceconfigureMap.html#af4436842063f51f2a5388cca02549d81">ibin</a>;</div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;  <a class="code" href="../../df/df7/DrawTrackingEval_8C.html#a6f56363b38edbe2c8f3f447f891ee2c0">assert</a>(ibin_hi &gt;= ibin_lo); </div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;  <span class="keywordflow">if</span> (ibin_hi == ibin_lo) {</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;    _cumul2 = pow(<span class="keywordtype">double</span>(cumul_lo + cumul_hi - counts[ibin_hi]), 2);</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;    _cumul2 += cumul_hi*cumul_hi;</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;    <span class="keywordflow">for</span> (ibin = ibin_lo+1; ibin &lt; ibin_hi; ibin++) {</div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;      _cumul2 += counts[<a class="code" href="../../d5/d92/namespaceconfigureMap.html#af4436842063f51f2a5388cca02549d81">ibin</a>]*counts[<a class="code" href="../../d5/d92/namespaceconfigureMap.html#af4436842063f51f2a5388cca02549d81">ibin</a>];</div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;    }</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;  }</div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;}</div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;<a class="code" href="../../d6/db0/fjcore_8hh.html#ab44ab8f537ec6309eeaf4f963e190f87">FJCORE_END_NAMESPACE</a></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath">
	<!-- id is needed for treeview function! -->
	<ul>
		<li class="navelem"><a class="el" href="../../dir_539fda8f8e03602443ef69ba44bf4faf.html">JETSCAPE</a></li><li class="navelem"><a class="el" href="../../dir_babc5b6d3cbfd698a522392de45ce8d8.html">blob</a></li><li class="navelem"><a class="el" href="../../dir_073b32dd6276373528253fea850746b1.html">main</a></li><li class="navelem"><a class="el" href="../../dir_7f635ad90c01ed59da5e8bce4df21b12.html">external_packages</a></li><li class="navelem"><a class="el" href="../../d8/d99/fjcore_8cc.html">fjcore.cc</a></li>
		<li class="footer">
		Built by <a href="mailto:jhuang@bnl.gov">Jin Huang</a></em>.
			updated: <em>Sat Feb 17 2024 22:18:18</em> using <a
			href="http://www.doxygen.org/index.html"> <img class="footer"
				src="../../doxygen.png" alt="doxygen" /></a> 1.8.2 
				with <a href="https://github.com/sPHENIX-Collaboration">sPHENIX GitHub integration</a>
		</li>
	</ul>
</div>
</body>
</html>
