<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<title>Analysis Software: pythia6/blob/master/pythiaeRHIC/pythia/pymirm.f Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script> <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script> 
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-155388685-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-155388685-2');
</script>
</head>
<body>
	<div id="top">
		<!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><a href="https://wiki.bnl.gov/sPHENIX/index.php/Main_Page"><img
								alt="Logo" src="../../sphenix.png" /></a></td>
						<td style="padding-left: 0.5em;">
							<div id="projectname">
								Analysis Software
							</div> 
							<div id="projectbrief">
								Documentation for <a href="https://wiki.bnl.gov/sPHENIX/index.php/Main_Page">sPHENIX</a> simulation software
							</div> 
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Home&#160;page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li><a href="../../usergroup0.html"><span>External&#160;Links</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d2/daa/pymirm_8f_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pymirm.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d2/daa/pymirm_8f.html">Go to the documentation of this file.</a> Or view <a target="top" href="https://github.com/sPHENIX-Collaboration/pythia6/blob/master/pythiaeRHIC/pythia/pymirm.f">the newest version in sPHENIX GitHub for file pymirm.f</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">C*********************************************************************</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">C...PYMIRM</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">C...Picks primordial kT and shares longitudinal momentum among</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">C...beam remnants.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="code" href="../../d2/daa/pymirm_8f.html#af6270eeef12969a7be55ee5423d8f478">    8</a></span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="../../d6/dcf/pythia6425mod_8f.html#af6270eeef12969a7be55ee5423d8f478">pymirm</a></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">C...Double precision and integer declarations.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;      <span class="keywordtype">IMPLICIT</span> <span class="keywordtype">DOUBLE PRECISION</span>(a-<a class="code" href="../../d7/dde/ctrl_8cpp.html#a41c788a90c812f238c2ba72996bb9594">h</a>, o-<a class="code" href="../../d7/d87/fasthadv4_8C.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a>)</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;      <span class="keywordtype">IMPLICIT</span> <span class="keywordtype">INTEGER</span>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>-<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>)</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      <span class="keywordtype">INTEGER</span> <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac6c322b0c629a97954c1221c422609e7">pyk</a>,<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a27f75936fde97780175fa2c990bc61cd">pychge</a>,<a class="code" href="../../d8/de1/Pythia6_8cc.html#a54e4846d2789b66d1dc7aca291a54a5b">pycomp</a></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">C...The event record</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;      common/<a class="code" href="../../d3/d8d/coresoftware_2blob_2master_2simulation_2g4simulation_2g4decayer_2pythia6__common__address_8c.html#a42bad680548e15c3c12a4874fa4d1ccc">pyjets</a>/<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a>,<a class="code" href="../../db/d14/pythia__commons_8h.html#aad92761fbbdc26c9f4a19000b8a472c6">npad</a>,<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(4000,5),<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(4000,5),<a class="code" href="../../de/de0/matchedfilter_8C.html#a49fd164be887fa48b36a4b165f1a8e7f">v</a>(4000,5)</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">C...Parameters</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      common/<a class="code" href="../../d3/d8d/coresoftware_2blob_2master_2simulation_2g4simulation_2g4decayer_2pythia6__common__address_8c.html#a3ac349aace72ee0475915601b813a720">pydat1</a>/mstu(200),paru(200),mstj(200),parj(200)</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      common/<a class="code" href="../../d1/d73/pythia6_2blob_2master_2pythia6_2pythia6__common__address_8c.html#a8da7c9220b540db4b5ab2b9dce72eb8c">pypars</a>/<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(200),<a class="code" href="../../db/d14/pythia__commons_8h.html#a58a4d650f8bc0e19901fff18146f039b">parp</a>(200),<a class="code" href="../../db/d14/pythia__commons_8h.html#ae9eb72ec4bb6e88122395b4f2aa3950c">msti</a>(200),<a class="code" href="../../db/d14/pythia__commons_8h.html#abf6f48d977c7b10946e7c7e29702ce4e">pari</a>(200)</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      common/<a class="code" href="../../d1/d73/pythia6_2blob_2master_2pythia6_2pythia6__common__address_8c.html#ad83b4003fc0564d8224db1fc12a71a8d">pyint1</a>/<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(400),<a class="code" href="../../db/d14/pythia__commons_8h.html#ab2af52c6eb9d154e3175fdac9c86682e">vint</a>(400)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">C...The common block of colour tags.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      common/pyctag/nct,mct(4000,2)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">C...The common block of dangling ends</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      common/pyintm/kfival(2,3),nmi(2),imi(2,800,2),nvc(2,-6:6),</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;     &amp;     xassoc(2,-6:6,240),xpsvc(-6:6,-1:240),pvctot(2,-1:1),</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;     &amp;     xmi(2,240),pt2mi(240),imisep(0:240)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      <span class="keywordtype">SAVE</span> /<a class="code" href="../../d3/d8d/coresoftware_2blob_2master_2simulation_2g4simulation_2g4decayer_2pythia6__common__address_8c.html#a42bad680548e15c3c12a4874fa4d1ccc">pyjets</a>/,/<a class="code" href="../../d3/d8d/coresoftware_2blob_2master_2simulation_2g4simulation_2g4decayer_2pythia6__common__address_8c.html#a3ac349aace72ee0475915601b813a720">pydat1</a>/,/<a class="code" href="../../d1/d73/pythia6_2blob_2master_2pythia6_2pythia6__common__address_8c.html#a8da7c9220b540db4b5ab2b9dce72eb8c">pypars</a>/,/<a class="code" href="../../d1/d73/pythia6_2blob_2master_2pythia6_2pythia6__common__address_8c.html#ad83b4003fc0564d8224db1fc12a71a8d">pyint1</a>/,/pyintm/,/pyctag/</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">C...Local variables</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      dimension <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0:2,0:2),vb(3),nnxt(2),ivalq(2),icomq(2)</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">C...W(I,J)|  J=0    |   1   |   2   |</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">C...  I=0 | Wrem**2 |  W+   |  W-   |</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">C...    1 | W1**2   |  W1+  |  W1-  |</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">C...    2 | W2**2   |  W2+  |  W2-  |</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">C...4-product</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      four(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,4)*<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>,4)-<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,1)*<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>,1)-<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,2)*<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>,2)-<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,3)*<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>,3)</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">C...Tentative parametrization of &lt;kT&gt; as a function of Q.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      sigpt(<a class="code" href="../../de/d56/classFatras_1_1Test_1_1Particle.html#ab55affcd8914916d2fecd7d8cf45cf41">q</a>)=<a class="code" href="../../da/d72/structActs_1_1detail_1_1PhiBoundParameterLimits.html#a04ea1c8ef7fa6ef9596ffec9da84eae1">max</a>(parj(21),2.1d0*<a class="code" href="../../de/d56/classFatras_1_1Test_1_1Particle.html#ab55affcd8914916d2fecd7d8cf45cf41">q</a>/(7d0+<a class="code" href="../../de/d56/classFatras_1_1Test_1_1Particle.html#ab55affcd8914916d2fecd7d8cf45cf41">q</a>))</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">C      SIGPT(Q)=MAX(0.36D0,4D0*SQRT(Q)/(10D0+SQRT(Q))</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">C      SIGPT(Q)=MAX(PARJ(21),3D0*SQRT(Q)/(5D0+SQRT(Q))</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      getpt(<a class="code" href="../../de/d56/classFatras_1_1Test_1_1Particle.html#ab55affcd8914916d2fecd7d8cf45cf41">q</a>,<a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>)=min(<a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>*sqrt(-<a class="code" href="../../d4/d3e/classActs_1_1Logger.html#a2e009357e8b3be1d10f072a71074ba58">log</a>(<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0))),<a class="code" href="../../db/d14/pythia__commons_8h.html#a58a4d650f8bc0e19901fff18146f039b">parp</a>(93))</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">C...Lambda kinematic function.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      flam(a,b,<a class="code" href="../../d4/dc5/CalcDecile__RhoFluct_8cc.html#a63b96401309cc0c66ce6c88f1783d7c2">c</a>)=a**2+b**2+<a class="code" href="../../d4/dc5/CalcDecile__RhoFluct_8cc.html#a63b96401309cc0c66ce6c88f1783d7c2">c</a>**2-2d0*(a*b+b*<a class="code" href="../../d4/dc5/CalcDecile__RhoFluct_8cc.html#a63b96401309cc0c66ce6c88f1783d7c2">c</a>+<a class="code" href="../../d4/dc5/CalcDecile__RhoFluct_8cc.html#a63b96401309cc0c66ce6c88f1783d7c2">c</a>*a)</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">C...Beginning and end of beam remnant partons</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      nout=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(53)</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      isub=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(1)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">C...Loopback point if kinematic choices gives impossible configuration.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <a class="code" href="../../d6/d21/fasthadv4_8h.html#abba6f2966242cfd40c1777674fb1df30">ntry</a>=0</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  100 <a class="code" href="../../d6/d21/fasthadv4_8h.html#abba6f2966242cfd40c1777674fb1df30">ntry</a>=<a class="code" href="../../d6/d21/fasthadv4_8h.html#abba6f2966242cfd40c1777674fb1df30">ntry</a>+1</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">C...Assign kT values on each side separately.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">DO</span> 180 js=1,2</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">C...First zero all kT on this side. Skip if no kT to generate.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">DO</span> 110 im=1,nmi(js)</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;          <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(js,im,1),1)=0d0</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;          <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(js,im,1),2)=0d0</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  110   <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">IF</span>(<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(91).LE.0) goto 180</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">C...Now assign kT to each (non-collapsed) parton in IMI.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">DO</span> 170 im=1,nmi(js)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=imi(js,im,1)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">C...Select kT according to truncated gaussian or 1/kt6 tails.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">C...For first interaction, either use rms width = PARP(91) or fitted.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          <span class="keywordflow">IF</span> (im.EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>=<a class="code" href="../../db/d14/pythia__commons_8h.html#a58a4d650f8bc0e19901fff18146f039b">parp</a>(91)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(91).GE.11.AND.<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(91).LE.20) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;              <a class="code" href="../../de/d56/classFatras_1_1Test_1_1Particle.html#ab55affcd8914916d2fecd7d8cf45cf41">q</a>=sqrt(pt2mi(im))</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;              <a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>=sigpt(<a class="code" href="../../de/d56/classFatras_1_1Test_1_1Particle.html#ab55affcd8914916d2fecd7d8cf45cf41">q</a>)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">C...For subsequent interactions and BR partons use fragmentation width.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>=parj(21)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a6c0a3a339b7402e811475a7660b798c0">phi</a>=paru(2)*<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;          <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>=0d0</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          <span class="keywordflow">IF</span>(<a class="code" href="../../d6/d21/fasthadv4_8h.html#abba6f2966242cfd40c1777674fb1df30">ntry</a>.LE.100) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; 111        <span class="keywordflow">IF</span> (<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(91).EQ.1.OR.<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(91).EQ.11) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;              <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>=getpt(<a class="code" href="../../de/d56/classFatras_1_1Test_1_1Particle.html#ab55affcd8914916d2fecd7d8cf45cf41">q</a>,<a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;              ptx=<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>*cos(<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a6c0a3a339b7402e811475a7660b798c0">phi</a>)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;              pty=<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>*sin(<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a6c0a3a339b7402e811475a7660b798c0">phi</a>)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(91).EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;              CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a8a7efe2037220dc632000fb06895ebca">pyerrm</a>(11,<span class="stringliteral">&#39;(PYMIRM:) Sorry, MSTP(91)=2 not &#39;</span>//</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;     &amp;          <span class="stringliteral">&#39;available, using MSTP(91)=1.&#39;</span>)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;              CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a23504218b9f527cdb0d3421ecde9852e">pygive</a>(<span class="stringliteral">&#39;MSTP(91)=1&#39;</span>)</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;              goto 111</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keywordflow">ELSEIF</span>(<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(91).EQ.3.OR.<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(91).EQ.13) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">C...Use distribution with kt**6 tails, rms width = PARP(91).</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;              <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>=sqrt(3d0/2d0)*<a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">C...Generate PTX and PTY separately, each propto 1/KT**6</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;              <span class="keywordflow">DO</span> 119 ixy=1,2</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">C...Decide which interval to try</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; 112            p12=1d0/(1d0+27d0/40d0*<a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>**6/<a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>**6)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0).LT.p12) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">C...Use flat approx with accept/reject up to EPS.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                  <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>=<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)*<a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                  wt=(3d0/2d0*<a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>**2/(<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>**2+3d0/2d0*<a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>**2))**3</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                  <span class="keywordflow">IF</span> (<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0).GT.wt) goto 112</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">C...Above EPS, use 1/kt**6 approx with accept/reject.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                  <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>=<a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>/(<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)**(1d0/5d0))</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                  wt=<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>**6/(<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>**2+3d0/2d0*<a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>**2)**3</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                  <span class="keywordflow">IF</span> (<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0).GT.wt) goto 112</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                msign=1</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0).GT.0.5d0) msign=-1</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="keywordflow">IF</span> (ixy.EQ.1) ptx=msign*<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="keywordflow">IF</span> (ixy.EQ.2) pty=msign*<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; 119          <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(91).EQ.4.OR.<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(91).EQ.14) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;              ptx=<a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>*(sqrt(6d0)*<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)-sqrt(3d0/2d0))</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;              pty=<a class="code" href="../../dc/dbf/icGlauber_8cpp.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>*(sqrt(6d0)*<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)-sqrt(3d0/2d0))</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">C...Adjust final PT. Impose upper cutoff, or zero for soft evts.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>=sqrt(ptx**2+pty**2)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            wt=1d0</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>.GT.<a class="code" href="../../db/d14/pythia__commons_8h.html#a58a4d650f8bc0e19901fff18146f039b">parp</a>(93)) wt=sqrt(<a class="code" href="../../db/d14/pythia__commons_8h.html#a58a4d650f8bc0e19901fff18146f039b">parp</a>(93)/<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">IF</span>(isub.EQ.95.AND.im.EQ.1) wt=0d0</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            ptx=ptx*wt</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            pty=pty*wt</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a9429f31b93b4f2739978858bf62cc3d1">pt</a>=sqrt(ptx**2+pty**2)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,1)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,1)+ptx</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,2)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,2)+pty</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">C...Compensation kicks, with varying degree of local anticorrelations.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          mcorr=<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(90)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          <span class="keywordflow">IF</span> (mcorr.EQ.0.OR.isub.EQ.95) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            ptcx=-ptx/(nmi(js)-1)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            ptcy=-pty/(nmi(js)-1)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">IF</span>(isub.EQ.95) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;              ptcx=-ptx/(nmi(js)-2)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;              ptcy=-pty/(nmi(js)-2)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">DO</span> 120 imc=1,nmi(js)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;              <span class="keywordflow">IF</span> (imc.EQ.im) goto 120</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;              <span class="keywordflow">IF</span>(isub.EQ.95.AND.imc.EQ.1) goto 120</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;              <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(js,imc,1),1)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(js,imc,1),1)+ptcx</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;              <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(js,imc,1),2)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(js,imc,1),2)+ptcy</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  120       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          <span class="keywordflow">ELSEIF</span> (mcorr.GE.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordflow">DO</span> 140 msid=4,5</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;              nnxt(msid-3)=0</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">C...Count up # of neighbours on either side</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;              imo=<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  130         imo=<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(imo,msid)/mstu(5)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;              <span class="keywordflow">IF</span> (imo.EQ.0) goto 140</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;              nnxt(msid-3)=nnxt(msid-3)+1</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">C...Stop at quarks and junctions</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;              <span class="keywordflow">IF</span> (mcorr.EQ.1.AND.<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(imo,2).EQ.21) goto 130</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  140       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">C...How should compensation be shared when unequal numbers on the</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">C...two sides? 50/50 regardless? N1:N2? Assume latter for now.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            nsum=nnxt(1)+nnxt(2)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <a class="code" href="../../d7/dc9/make__EmcCorr_8C.html#a2c015b13a9679931075b6cebca8de464">t1</a>=0</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="keywordflow">DO</span> 160 msid=4,5</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">C...Total momentum to be compensated on this side</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;              <span class="keywordflow">IF</span> (nnxt(msid-3).EQ.0) goto 160</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;              ptcx=-(nnxt(msid-3)*ptx)/nsum</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;              ptcy=-(nnxt(msid-3)*pty)/nsum</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">C...RS: compensation supression factor as we go out from parton I.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">C...Hardcoded behaviour RS=0.5, i.e. 1/2**n falloff,</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">C...since (for now) MSTP(90) provides enough variability.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;              rs=0.5d0</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;              fac=(1d0-rs)/(rs*(1-rs**nnxt(msid-3)))</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;              imo=<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  150         ida=imo</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;              imo=<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(imo,msid)/mstu(5)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;              <span class="keywordflow">IF</span> (imo.EQ.0) goto 160</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;              fac=fac*rs</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;              <span class="keywordflow">IF</span> (<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(imo,2).NE.88) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imo,1)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imo,1)+fac*ptcx</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imo,2)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imo,2)+fac*ptcy</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <span class="keywordflow">IF</span> (mcorr.EQ.1.AND.<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(imo,2).EQ.21) goto 150</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">C...If we reach junction, divide out the kT that would have been</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">C...assigned to the junction on each of its other legs.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                l1=mod(<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(imo,4),mstu(5))</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                l2=<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(imo,5)/mstu(5)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                l3=mod(<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(imo,5),mstu(5))</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(l1,1)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(l1,1)+0.5d0*fac*ptcx</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(l1,2)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(l1,2)+0.5d0*fac*ptcy</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(l2,1)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(l2,1)+0.5d0*fac*ptcx</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(l2,2)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(l2,2)+0.5d0*fac*ptcy</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(l3,1)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(l3,1)+0.5d0*fac*ptcx</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(l3,2)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(l3,2)+0.5d0*fac*ptcy</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(ida,1)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(ida,1)-0.5d0*fac*ptcx</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(ida,2)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(ida,2)-0.5d0*fac*ptcy</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;              <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  160       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  170   <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">C...End assignment of kT values to initiators and remnants.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  180 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">C...Check kinematics constraints for non-BR partons.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">DO</span> 190 im=1,<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(31)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        shat=xmi(1,im)*xmi(2,im)*<a class="code" href="../../db/d14/pythia__commons_8h.html#ab2af52c6eb9d154e3175fdac9c86682e">vint</a>(2)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        pt1=sqrt(<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(1,im,1),1)**2+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(1,im,1),2)**2)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="../../dd/d30/classPseudoJet.html#a478b06e1f4a904a32c4fce8e77600a3d">pt2</a>=sqrt(<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(2,im,1),1)**2+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(2,im,1),2)**2)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        pt1pt2=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(1,im,1),1)*<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(2,im,1),1)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;     &amp;        +<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(1,im,1),2)*<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(2,im,1),2)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">IF</span> (shat.LT.2d0*(pt1*<a class="code" href="../../dd/d30/classPseudoJet.html#a478b06e1f4a904a32c4fce8e77600a3d">pt2</a>-pt1pt2).AND.<a class="code" href="../../d6/d21/fasthadv4_8h.html#abba6f2966242cfd40c1777674fb1df30">ntry</a>.LE.100) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          <span class="keywordflow">IF</span>(<a class="code" href="../../d6/d21/fasthadv4_8h.html#abba6f2966242cfd40c1777674fb1df30">ntry</a>.GE.100) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">C...Kill this event and start another.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a8a7efe2037220dc632000fb06895ebca">pyerrm</a>(11,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;     &amp;           <span class="stringliteral">&#39;(PYMIRM:) No consistent (x,kT) sets found&#39;</span>)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(51)=1</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          goto 100</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  190 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">C...Calculate W+ and W- available for combined remnant system.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,1)=<a class="code" href="../../db/d14/pythia__commons_8h.html#ab2af52c6eb9d154e3175fdac9c86682e">vint</a>(1)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,2)=<a class="code" href="../../db/d14/pythia__commons_8h.html#ab2af52c6eb9d154e3175fdac9c86682e">vint</a>(1)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordflow">DO</span> 200 im=1,<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(31)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="../../dd/d30/classPseudoJet.html#a478b06e1f4a904a32c4fce8e77600a3d">pt2</a> = (<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(1,im,1),1)+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(2,im,1),1))**2</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;     &amp;       +(<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(1,im,1),2)+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(imi(2,im,1),2))**2</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        st=xmi(1,im)*xmi(2,im)*<a class="code" href="../../db/d14/pythia__commons_8h.html#ab2af52c6eb9d154e3175fdac9c86682e">vint</a>(2)+<a class="code" href="../../dd/d30/classPseudoJet.html#a478b06e1f4a904a32c4fce8e77600a3d">pt2</a></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,1)=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,1)-sqrt(xmi(1,im)/xmi(2,im)*st)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,2)=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,2)-sqrt(xmi(2,im)/xmi(1,im)*st)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  200 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">C...Also store Wrem**2 = W+ * W-</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,0)=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,1)*<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,2)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,0).LT.0d0.AND.<a class="code" href="../../d6/d21/fasthadv4_8h.html#abba6f2966242cfd40c1777674fb1df30">ntry</a>.LE.100) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          <span class="keywordflow">IF</span>(<a class="code" href="../../d6/d21/fasthadv4_8h.html#abba6f2966242cfd40c1777674fb1df30">ntry</a>.GE.100) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">C...Kill this event and start another.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a8a7efe2037220dc632000fb06895ebca">pyerrm</a>(11,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;     &amp;    <span class="stringliteral">&#39;(PYMIRM:) Negative beam remnant mass squared unavoidable&#39;</span>)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(51)=1</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          goto 100</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">C...Assign unscaled x values to partons/hadrons in each of the</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">C...beam remnants and calculate unscaled W+ and W- from them.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      ntryx=0</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  210 ntryx=ntryx+1</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">DO</span> 280 js=1,2</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,1)=0d0</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,2)=0d0</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">DO</span> 270 im=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(31)+1,nmi(js)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=imi(js,im,1)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          kf=<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,2)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          kfa=iabs(kf)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;          icomp=imi(js,im,2)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">C...Skip collapsed gluons and junctions. Reset.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          <span class="keywordflow">IF</span> (kfa.EQ.21.AND.<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,1).EQ.14) goto 270</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;          <span class="keywordflow">IF</span> (kfa.EQ.88) goto 270</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          <a class="code" href="../../d7/d87/fasthadv4_8C.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>=0d0</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          ivalq(1)=0</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          ivalq(2)=0</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          icomq(1)=0</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          icomq(2)=0</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">C...If gluon then only beam remnant, so takes all.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          <span class="keywordflow">IF</span>(kfa.EQ.21) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <a class="code" href="../../d7/d87/fasthadv4_8C.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>=1d0</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">C...If valence quark then use parametrized valence distribution.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          <span class="keywordflow">ELSEIF</span>(kfa.LE.6.AND.icomp.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            ivalq(1)=kf</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">C...If companion quark then derive from companion x.</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          <span class="keywordflow">ELSEIF</span>(kfa.LE.6) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            icomq(1)=icomp</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">C...If valence diquark then use two parametrized valence distributions.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          <span class="keywordflow">ELSEIF</span>(kfa.GT.1000.AND.mod(kfa/10,10).EQ.0.AND.</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     &amp;    icomp.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            ivalq(1)=isign(kfa/1000,kf)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            ivalq(2)=isign(mod(kfa/100,10),kf)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">C...If valence+sea diquark then combine valence + companion choices.</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          <span class="keywordflow">ELSEIF</span>(kfa.GT.1000.AND.mod(kfa/10,10).EQ.0.AND.</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;     &amp;    icomp.LT.mstu(5)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">IF</span>(kfa/1000.EQ.iabs(<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(icomp,2))) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;              ivalq(1)=isign(mod(kfa/100,10),kf)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;              ivalq(1)=isign(kfa/1000,kf)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            icomq(1)=icomp</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">C...Extra code: workaround for diquark made out of two sea</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">C...quarks, but where not (yet) ICOMP &gt; MSTU(5).</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">DO</span> 220 im1=1,<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(31)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;              <span class="keywordflow">IF</span>(imi(js,im1,2).EQ.<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>.AND.imi(js,im1,1).NE.icomp) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                icomq(2)=imi(js,im1,1)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                ivalq(1)=0</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;              <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  220       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">C...If sea diquark then sum of two derived from companion x.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          <span class="keywordflow">ELSEIF</span>(kfa.GT.1000.AND.mod(kfa/10,10).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;             icomq(1)=mod(icomp,mstu(5))</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;             icomq(2)=icomp/mstu(5)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">C...If meson or baryon then use fragmentation function.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">C...Somewhat arbitrary split into old and new flavour, but OK normally.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            kfl3=mod(kfa/10,10)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordflow">IF</span>(mod(kfa/1000,10).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;              kfl1=mod(kfa/100,10)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;              kfl1=mod(kfa,10000)-10*kfl3-1</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;              <span class="keywordflow">IF</span>(mod(kfa/1000,10).EQ.mod(kfa/100,10).AND.</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;     &amp;        mod(kfa,10).EQ.2) kfl1=kfl1+2</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            pr=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,5)**2+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,1)**2+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,2)**2</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#afb341942695f61070b394bd15ac8dc30">pyzdis</a>(kfl1,kfl3,pr,<a class="code" href="../../d7/d87/fasthadv4_8C.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          <span class="keywordflow">DO</span> 260 iq=1,2</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">C...Calculation of x of valence quark: assume form (1-x)^a/sqrt(x),</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">C...where a=3.5 for u in proton, =2 for d in proton and =0.8 for meson.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">C...In other baryons combine u and d from proton appropriately.</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="keywordflow">IF</span>(ivalq(iq).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;              nval=0</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;              <span class="keywordflow">IF</span>(kfival(js,1).EQ.ivalq(iq)) nval=nval+1</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;              <span class="keywordflow">IF</span>(kfival(js,2).EQ.ivalq(iq)) nval=nval+1</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;              <span class="keywordflow">IF</span>(kfival(js,3).EQ.ivalq(iq)) nval=nval+1</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">C...Meson.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;              <span class="keywordflow">IF</span>(kfival(js,3).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                mdu=0</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">C...Baryon with three identical quarks: mix u and d forms.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;              <span class="keywordflow">ELSEIF</span>(nval.EQ.3) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                mdu=int(<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)+5d0/3d0)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">C...Baryon, one of two identical quarks: u form.</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;              <span class="keywordflow">ELSEIF</span>(nval.EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                mdu=2</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">C...Baryon with two identical quarks, but not the one picked: d form.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;              <span class="keywordflow">ELSEIF</span>(kfival(js,1).EQ.kfival(js,2).OR.kfival(js,2).EQ.</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;     &amp;        kfival(js,3).OR.kfival(js,1).EQ.kfival(js,3)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                mdu=1</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">C...Baryon with three nonidentical quarks: mix u and d forms.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                mdu=int(<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)+5d0/3d0)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;              <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;              xpow=0.8d0</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;              <span class="keywordflow">IF</span>(mdu.EQ.1) xpow=3.5d0</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;              <span class="keywordflow">IF</span>(mdu.EQ.2) xpow=2d0</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  230         xx=<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)**2</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;              <span class="keywordflow">IF</span>((1d0-xx)**xpow.LT.<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)) goto 230</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;              <a class="code" href="../../d7/d87/fasthadv4_8C.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>=<a class="code" href="../../d7/d87/fasthadv4_8C.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>+xx</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">C...Calculation of x of companion quark.</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keywordflow">IF</span>(icomq(iq).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;              xcomp=1d-4</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;              <span class="keywordflow">DO</span> 240 im1=1,<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(31)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="keywordflow">IF</span>(imi(js,im1,1).EQ.icomq(iq)) xcomp=xmi(js,im1)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  240         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;              npow=<a class="code" href="../../da/d72/structActs_1_1detail_1_1PhiBoundParameterLimits.html#a04ea1c8ef7fa6ef9596ffec9da84eae1">max</a>(0,min(4,<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(87)))</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  250         xx=xcomp*(1d0/(1d0-<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)*(1d0-xcomp))-1d0)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;              <a class="code" href="../../d7/dc9/make__EmcCorr_8C.html#a723ba1c9dc78fd562ca79f29f8cf0bc9">corr</a>=((1d0-xcomp-xx)/(1d0-xcomp))**npow*</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;     &amp;        (xcomp**2+xx**2)/(xcomp+xx)**2</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;              <span class="keywordflow">IF</span>(<a class="code" href="../../d7/dc9/make__EmcCorr_8C.html#a723ba1c9dc78fd562ca79f29f8cf0bc9">corr</a>.LT.<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)) goto 250</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;              <a class="code" href="../../d7/d87/fasthadv4_8C.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>=<a class="code" href="../../d7/d87/fasthadv4_8C.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>+xx</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  260     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">C...Optionally enchance x of composite systems (e.g. diquarks)</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          <span class="keywordflow">IF</span> (kfa.GT.100) <a class="code" href="../../d7/d87/fasthadv4_8C.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>=<a class="code" href="../../db/d14/pythia__commons_8h.html#a58a4d650f8bc0e19901fff18146f039b">parp</a>(79)*<a class="code" href="../../d7/d87/fasthadv4_8C.html#af88b946fb90d5f08b5fb740c70e98c10">x</a></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">C...Store x. Also calculate light cone energies of each system.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          xmi(js,im)=<a class="code" href="../../d7/d87/fasthadv4_8C.html#af88b946fb90d5f08b5fb740c70e98c10">x</a></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;          <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,js)=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,js)+<a class="code" href="../../d7/d87/fasthadv4_8C.html#af88b946fb90d5f08b5fb740c70e98c10">x</a></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,3-js)=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,3-js)+(<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,5)**2+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,1)**2+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,2)**2)/<a class="code" href="../../d7/d87/fasthadv4_8C.html#af88b946fb90d5f08b5fb740c70e98c10">x</a></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  270   <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,js)=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,js)*<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,js)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,3-js)=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,3-js)/<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,js)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,0)=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,1)*<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(js,2)</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  280 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">C...Check W1 W2 &lt; Wrem (can be done before rescaling, since W</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">C...insensitive to global rescalings of the BR x values).</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">IF</span> (sqrt(<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(1,0))+sqrt(<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(2,0)).GT.sqrt(<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,0)).AND.ntryx.LE.100)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;     &amp;     <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        goto 210</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordflow">ELSEIF</span> (ntryx.GT.100.AND.<a class="code" href="../../d6/d21/fasthadv4_8h.html#abba6f2966242cfd40c1777674fb1df30">ntry</a>.LE.100) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        goto 100</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">ELSEIF</span> (ntryx.GT.100) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a8a7efe2037220dc632000fb06895ebca">pyerrm</a>(11,<span class="stringliteral">&#39;(PYMIRM:) No consistent (x,kT) sets found&#39;</span>)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(57)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(57)+1</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(51)=1</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">C...Compute x rescaling factors</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      comtrm=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,0)+sqrt(flam(<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,0),<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(1,0),<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(2,0)))</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <a class="code" href="../../d0/d22/DetectorVolumeFindersTests_8cpp.html#ae1281efcda7144587a6f532807f9259e">r1</a>=(comtrm+<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(1,0)-<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(2,0))/(2d0*<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(1,1)*<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,2))</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <a class="code" href="../../d0/d22/DetectorVolumeFindersTests_8cpp.html#a9889f548d7319f52d0c04c344389ab84">r2</a>=(comtrm+<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(2,0)-<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(1,0))/(2d0*<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(2,2)*<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,1))</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="../../d0/d22/DetectorVolumeFindersTests_8cpp.html#ae1281efcda7144587a6f532807f9259e">r1</a>.LT.0.OR.<a class="code" href="../../d0/d22/DetectorVolumeFindersTests_8cpp.html#a9889f548d7319f52d0c04c344389ab84">r2</a>.LT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a8a7efe2037220dc632000fb06895ebca">pyerrm</a>(19,<span class="stringliteral">&#39;(PYMIRM:) negative rescaling factors !&#39;</span>)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(57)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(57)+1</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(51)=1</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">C...Rescale W(1,*) and W(2,*) (not really necessary, but consistent).</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(1,1)=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(1,1)*<a class="code" href="../../d0/d22/DetectorVolumeFindersTests_8cpp.html#ae1281efcda7144587a6f532807f9259e">r1</a></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(1,2)=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(1,2)/<a class="code" href="../../d0/d22/DetectorVolumeFindersTests_8cpp.html#ae1281efcda7144587a6f532807f9259e">r1</a></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(2,1)=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(2,1)/<a class="code" href="../../d0/d22/DetectorVolumeFindersTests_8cpp.html#a9889f548d7319f52d0c04c344389ab84">r2</a></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(2,2)=<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(2,2)*<a class="code" href="../../d0/d22/DetectorVolumeFindersTests_8cpp.html#a9889f548d7319f52d0c04c344389ab84">r2</a></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">C...Rescale BR x values.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">DO</span> 290 im=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(31)+1,<a class="code" href="../../da/d72/structActs_1_1detail_1_1PhiBoundParameterLimits.html#a04ea1c8ef7fa6ef9596ffec9da84eae1">max</a>(nmi(1),nmi(2))</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        xmi(1,im)=xmi(1,im)*<a class="code" href="../../d0/d22/DetectorVolumeFindersTests_8cpp.html#ae1281efcda7144587a6f532807f9259e">r1</a></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        xmi(2,im)=xmi(2,im)*<a class="code" href="../../d0/d22/DetectorVolumeFindersTests_8cpp.html#a9889f548d7319f52d0c04c344389ab84">r2</a></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  290 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">C...Now we have a consistent set of x and kT values.</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">C...First set up the initiators and their daughters correctly.</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">DO</span> 300 im=1,<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(31)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>=imi(1,im,1)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>=imi(2,im,1)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        st=xmi(1,im)*xmi(2,im)*<a class="code" href="../../db/d14/pythia__commons_8h.html#ab2af52c6eb9d154e3175fdac9c86682e">vint</a>(2)+(<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,1)+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,1))**2+</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;     &amp;       (<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,2)+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,2))**2</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        pt12=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,1)**2+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,2)**2</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        pt22=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,1)**2+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,2)**2</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">C...p_z</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,3)=sqrt(flam(st,pt12,pt22)/(4d0*st))</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,3)=-<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,3)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">C...Energies (masses should be zero at this stage)</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,4)=sqrt(pt12+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,3)**2)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,4)=sqrt(pt22+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,3)**2)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">C...Transverse 12 system initiator velocity:</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        vb(1)=(<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,1)+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,1))/sqrt(st)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        vb(2)=(<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,2)+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,2))/sqrt(st)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">C...Boost to overall initiator system rest frame</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a98ffa3df00dbe1c8a9944e3453e44580">pyrobo</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,0d0,0d0,-vb(1),-vb(2),0d0)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a98ffa3df00dbe1c8a9944e3453e44580">pyrobo</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,0d0,0d0,-vb(1),-vb(2),0d0)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">C...Compute phi,theta coordinates of I1 and rotate z axis.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a6c0a3a339b7402e811475a7660b798c0">phi</a>=<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#aa8c99978a55999fa0b1fd2a946d8553a">pyangl</a>(<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,1),<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,2))</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        the=<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#aa8c99978a55999fa0b1fd2a946d8553a">pyangl</a>(<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,3),sqrt(<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,1)**2+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,2)**2))</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a98ffa3df00dbe1c8a9944e3453e44580">pyrobo</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,0d0,-<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a6c0a3a339b7402e811475a7660b798c0">phi</a>,0d0,0d0,0d0)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a98ffa3df00dbe1c8a9944e3453e44580">pyrobo</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,0d0,-<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a6c0a3a339b7402e811475a7660b798c0">phi</a>,0d0,0d0,0d0)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a98ffa3df00dbe1c8a9944e3453e44580">pyrobo</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,<a class="code" href="../../d5/d89/classValueGen1.html#a9558bbb6f1b9bfcb2631b70b720742fc">i1</a>,-the,0d0,0d0,0d0,0d0)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a98ffa3df00dbe1c8a9944e3453e44580">pyrobo</a>(<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,<a class="code" href="../../d5/d89/classValueGen1.html#a072deb230ac8bf0f6742e0484e030c52">i2</a>,-the,0d0,0d0,0d0,0d0)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">C...Now boost initiators + daughters back to LAB system</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">C...(also update documentation lines for MI = 1.)</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        vb(3)=(xmi(1,im)-xmi(2,im))/(xmi(1,im)+xmi(2,im))</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        imin=imisep(im-1)+1</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">IF</span> (im.EQ.1) imin=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(83)+5</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        imax=imisep(im)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a98ffa3df00dbe1c8a9944e3453e44580">pyrobo</a>(imin,imax,the,<a class="code" href="../../db/d04/EMCalTowerRingStudy_8C.html#a6c0a3a339b7402e811475a7660b798c0">phi</a>,vb(1),vb(2),0d0)</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a98ffa3df00dbe1c8a9944e3453e44580">pyrobo</a>(imin,imax,0d0,0d0,0d0,0d0,vb(3))</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  300 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">C...For the beam remnant partons/hadrons, we only need to set pz and E.</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">DO</span> 320 js=1,2</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keywordflow">DO</span> 310 im=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(31)+1,nmi(js)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;          <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=imi(js,im,1)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">C...Skip collapsed gluons and junctions.</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          <span class="keywordflow">IF</span> (<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,2).EQ.21.AND.<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,1).EQ.14) goto 310</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;          <span class="keywordflow">IF</span> (kfa.EQ.88) goto 310</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;          rmt2=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,5)**2+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,1)**2+<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,2)**2</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,4)=0.5d0*(xmi(js,im)*<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,js)+rmt2/(xmi(js,im)*<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,js)))</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,3)=0.5d0*(xmi(js,im)*<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,js)-rmt2/(xmi(js,im)*<a class="code" href="../../d1/d5e/classsHelix.html#a44ff83bf3956f25a18308cc3c7fc1873">w</a>(0,js)))</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          <span class="keywordflow">IF</span> (js.EQ.2) <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,3)=-<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,3)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  310   <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  320 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">C...Documentation lines</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordflow">DO</span> 340 js=1,2</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(83)+js+2</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        io=imi(js,1,1)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(<a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>,1)=21</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(<a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>,2)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(io,2)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(<a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>,3)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(83)+js</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(<a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>,4)=0</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(<a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>,5)=0</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">DO</span> 330 <a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>=1,5</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;          <a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(<a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>,<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a1390ebd2c7277c0a43969507012a4901">p</a>(io,<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;          <a class="code" href="../../de/de0/matchedfilter_8C.html#a49fd164be887fa48b36a4b165f1a8e7f">v</a>(<a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>,<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>)=<a class="code" href="../../de/de0/matchedfilter_8C.html#a49fd164be887fa48b36a4b165f1a8e7f">v</a>(io,<a class="code" href="../../d7/d87/fasthadv4_8C.html#a37d972ae0b47b9099e30983131d31916">j</a>)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  330   <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        mct(<a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>,1)=mct(io,1)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        mct(<a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>,2)=mct(io,2)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  340 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">C...Final state colour reconnections.</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="../../db/d14/pythia__commons_8h.html#a2377ed5e6e420a6ab179a75941583701">mstp</a>(95).NE.1.OR.<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(31).LE.1) goto 380</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">C...Number of colour tags for which a recoupling will be tried.</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      ntot=nct</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">C...Number of recouplings to try</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(34)=0</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      nrecp=0</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      niter=0</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  350 nrecp=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(34)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      niter=niter+1</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      iiter=0</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  360 iiter=iiter+1</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordflow">IF</span> (iiter.LE.<a class="code" href="../../db/d14/pythia__commons_8h.html#a58a4d650f8bc0e19901fff18146f039b">parp</a>(78)*ntot) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">C...Select two colour tags at random</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">C...NB: jj strings do not have colour tags assigned to them,</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">C...thus they are as yet not affected by anything done here.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        jct=<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)*nct+1</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        kct=mod(int(jct+<a class="code" href="../../d6/dcf/pythia6425mod_8f.html#ac28b7ef95cee2881a46f71d3a88d05ac">pyr</a>(0)*nct),nct)+1</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        ij1=0</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        ij2=0</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        ik1=0</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        ik2=0</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">C...Find final state partons with this (anti)colour</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordflow">DO</span> 370 <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(84)+1,<a class="code" href="../../da/de5/ThicknessScan_8m.html#aff454a14d9dc8148930abb4b532e211d">n</a></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;          <span class="keywordflow">IF</span> (<a class="code" href="../../db/d14/pythia__commons_8h.html#a7a16daa873b7e70e2e15b8e71b1fa971">k</a>(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,1).EQ.3) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="keywordflow">IF</span> (mct(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,1).EQ.jct) ij1=<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordflow">IF</span> (mct(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,2).EQ.jct) ij2=<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keywordflow">IF</span> (mct(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,1).EQ.kct) ik1=<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            <span class="keywordflow">IF</span> (mct(<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>,2).EQ.kct) ik2=<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  370   <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">C...Only consider recouplings not involving junctions for now.</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">IF</span> (ij1.EQ.0.OR.ij2.EQ.0.OR.ik1.EQ.0.OR.ik2.EQ.0) goto 360</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        rlo=2d0*four(ij1,ij2)*2d0*four(ik1,ik2)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        rln=2d0*four(ij1,ik2)*2d0*four(ik1,ij2)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">IF</span> (rln.LT.rlo.AND.mct(ij2,1).NE.kct.AND.mct(ik2,1).NE.jct) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;          mct(ij2,2)=kct</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;          mct(ik2,2)=jct</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">C...Count up number of reconnections</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;          <a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(34)=<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(34)+1</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">IF</span> (<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(34).LE.1000) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;          goto 360</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;          CALL <a class="code" href="../../d6/dcf/pythia6425mod_8f.html#a8a7efe2037220dc632000fb06895ebca">pyerrm</a>(4,<span class="stringliteral">&#39;(PYMIRM:) caught in infinite loop&#39;</span>)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;          goto 380</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keywordflow">IF</span> (nrecp.LT.<a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(34)) goto 350</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">C...Signal PYPREP to use /PYCTAG/ information rather than K(I,KCS).</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  380 <a class="code" href="../../db/d14/pythia__commons_8h.html#a79d56c63372bdf9b19fbb5fb47fe0c10">mint</a>(33)=1</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">END</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath">
	<!-- id is needed for treeview function! -->
	<ul>
		<li class="navelem"><a class="el" href="../../dir_b0a353a08175e4dafee34d1c18bc2ea3.html">pythia6</a></li><li class="navelem"><a class="el" href="../../dir_f27e8a183b764bc08184e78542ae6a1d.html">blob</a></li><li class="navelem"><a class="el" href="../../dir_57acf46c31410d6450bc572f744c790f.html">master</a></li><li class="navelem"><a class="el" href="../../dir_934addced62a56d6038757f643f967e8.html">pythiaeRHIC</a></li><li class="navelem"><a class="el" href="../../dir_bc24c1ee2bc3b49331292cc0ff337e7b.html">pythia</a></li><li class="navelem"><a class="el" href="../../d2/daa/pymirm_8f.html">pymirm.f</a></li>
		<li class="footer">
		Built by <a href="mailto:jhuang@bnl.gov">Jin Huang</a></em>.
			updated: <em>Sat Feb 17 2024 22:18:42</em> using <a
			href="http://www.doxygen.org/index.html"> <img class="footer"
				src="../../doxygen.png" alt="doxygen" /></a> 1.8.2 
				with <a href="https://github.com/sPHENIX-Collaboration">sPHENIX GitHub integration</a>
		</li>
	</ul>
</div>
</body>
</html>
