<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<title>Analysis Software: acts/blob/sPHENIX/Tests/UnitTests/Core/Propagator/EigenStepperTests.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script> <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script> 
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-155388685-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-155388685-2');
</script>
</head>
<body>
	<div id="top">
		<!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><a href="https://wiki.bnl.gov/sPHENIX/index.php/Main_Page"><img
								alt="Logo" src="../../sphenix.png" /></a></td>
						<td style="padding-left: 0.5em;">
							<div id="projectname">
								Analysis Software
							</div> 
							<div id="projectbrief">
								Documentation for <a href="https://wiki.bnl.gov/sPHENIX/index.php/Main_Page">sPHENIX</a> simulation software
							</div> 
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Home&#160;page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li><a href="../../usergroup0.html"><span>External&#160;Links</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d4/d63/EigenStepperTests_8cpp_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">EigenStepperTests.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/d63/EigenStepperTests_8cpp.html">Go to the documentation of this file.</a> Or view <a target="top" href="https://github.com/sPHENIX-Collaboration/acts/blob/sPHENIX/Tests/UnitTests/Core/Propagator/EigenStepperTests.cpp">the newest version in sPHENIX GitHub for file EigenStepperTests.cpp</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// This file is part of the Acts project.</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright (C) 2018-2020 CERN for the benefit of the Acts project</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This Source Code Form is subject to the terms of the Mozilla Public</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License, v. 2.0. If a copy of the MPL was not distributed with this</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// file, You can obtain one at http://mozilla.org/MPL/2.0/.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;boost/test/unit_test.hpp&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/dd2/Algebra_8hpp.html">Acts/Definitions/Algebra.hpp</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d33/Direction_8hpp.html">Acts/Definitions/Direction.hpp</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d3a/TrackParametrization_8hpp.html">Acts/Definitions/TrackParametrization.hpp</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d6f/Units_8hpp.html">Acts/Definitions/Units.hpp</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/dc3/Charge_8hpp.html">Acts/EventData/Charge.hpp</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d46/GenericBoundTrackParameters_8hpp.html">Acts/EventData/GenericBoundTrackParameters.hpp</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d68/GenericCurvilinearTrackParameters_8hpp.html">Acts/EventData/GenericCurvilinearTrackParameters.hpp</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/db1/ParticleHypothesis_8hpp.html">Acts/EventData/ParticleHypothesis.hpp</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d81/TrackParameters_8hpp.html">Acts/EventData/TrackParameters.hpp</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d57/TransformationBoundToFree_8hpp.html">Acts/EventData/detail/TransformationBoundToFree.hpp</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d5f/BoundarySurfaceT_8hpp.html">Acts/Geometry/BoundarySurfaceT.hpp</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/de6/CuboidVolumeBuilder_8hpp.html">Acts/Geometry/CuboidVolumeBuilder.hpp</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/db8/GeometryContext_8hpp.html">Acts/Geometry/GeometryContext.hpp</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d24/TrackingGeometry_8hpp.html">Acts/Geometry/TrackingGeometry.hpp</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/dbb/TrackingGeometryBuilder_8hpp.html">Acts/Geometry/TrackingGeometryBuilder.hpp</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d37/TrackingVolume_8hpp.html">Acts/Geometry/TrackingVolume.hpp</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d07/ConstantBField_8hpp.html">Acts/MagneticField/ConstantBField.hpp</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/da8/MagneticFieldContext_8hpp.html">Acts/MagneticField/MagneticFieldContext.hpp</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d3f/MagneticFieldProvider_8hpp.html">Acts/MagneticField/MagneticFieldProvider.hpp</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d7f/NullBField_8hpp.html">Acts/MagneticField/NullBField.hpp</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/dfe/HomogeneousSurfaceMaterial_8hpp.html">Acts/Material/HomogeneousSurfaceMaterial.hpp</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d0f/HomogeneousVolumeMaterial_8hpp.html">Acts/Material/HomogeneousVolumeMaterial.hpp</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/dd1/MaterialSlab_8hpp.html">Acts/Material/MaterialSlab.hpp</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/dfe/AbortList_8hpp.html">Acts/Propagator/AbortList.hpp</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/da9/ActionList_8hpp.html">Acts/Propagator/ActionList.hpp</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d18/ConstrainedStep_8hpp.html">Acts/Propagator/ConstrainedStep.hpp</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/df3/DefaultExtension_8hpp.html">Acts/Propagator/DefaultExtension.hpp</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/d44/DenseEnvironmentExtension_8hpp.html">Acts/Propagator/DenseEnvironmentExtension.hpp</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d18/EigenStepper_8hpp.html">Acts/Propagator/EigenStepper.hpp</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d5a/EigenStepperError_8hpp.html">Acts/Propagator/EigenStepperError.hpp</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d56/MaterialInteractor_8hpp.html">Acts/Propagator/MaterialInteractor.hpp</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/de2/Navigator_8hpp.html">Acts/Propagator/Navigator.hpp</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d20/Propagator_8hpp.html">Acts/Propagator/Propagator.hpp</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d81/StepperExtensionList_8hpp.html">Acts/Propagator/StepperExtensionList.hpp</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d69/Auctioneer_8hpp.html">Acts/Propagator/detail/Auctioneer.hpp</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d50/BoundaryCheck_8hpp.html">Acts/Surfaces/BoundaryCheck.hpp</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/dec/PlaneSurface_8hpp.html">Acts/Surfaces/PlaneSurface.hpp</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d7d/RectangleBounds_8hpp.html">Acts/Surfaces/RectangleBounds.hpp</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/ddd/Surface_8hpp.html">Acts/Surfaces/Surface.hpp</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d47/FloatComparisons_8hpp.html">Acts/Tests/CommonHelpers/FloatComparisons.hpp</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d59/PredefinedMaterials_8hpp.html" title="Predefined materials for test.">Acts/Tests/CommonHelpers/PredefinedMaterials.hpp</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/db2/Result_8hpp.html">Acts/Utilities/Result.hpp</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d5d/UnitVectors_8hpp.html">Acts/Utilities/UnitVectors.hpp</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &lt;tuple&gt;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &lt;type_traits&gt;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword">namespace </span>Acts {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">class </span>ISurfaceMaterial;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">class </span>Logger;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}  <span class="comment">// namespace Acts</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">namespace </span>tt = boost::test_tools;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">using namespace </span>Acts::UnitLiterals;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keyword">using</span> <a class="code" href="../../df/da1/namespaceActs_1_1VectorHelpers.html#aee596cee9f20711ff9548f38973c2e1b" title="Construct a four-vector from a three-vector and scalar fourth component.">Acts::VectorHelpers::makeVector4</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keyword">namespace </span>Acts {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">namespace </span>Test {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keyword">using</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a913d49139751b648d6713fde8e3aaf18">Covariance</a> = <a class="code" href="../../da/d7b/namespaceActs.html#ae270e959abf019daff44ec3892595976">BoundSquareMatrix</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keyword">static</span> constexpr <span class="keyword">auto</span> <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a> = 3 * std::numeric_limits&lt;double&gt;::epsilon();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">// Create a test context</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<a class="code" href="../../da/d7b/namespaceActs.html#ac6cb18f36f908851bb60c08f283d97a3" title="This is the central definition of the Acts payload object regarding detector geometry status (e...">GeometryContext</a> <a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a> = <a class="code" href="../../da/d7b/namespaceActs.html#ac6cb18f36f908851bb60c08f283d97a3" title="This is the central definition of the Acts payload object regarding detector geometry status (e...">GeometryContext</a>();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<a class="code" href="../../da/d7b/namespaceActs.html#a8d31a3d8704ec439cc207b46ad53183d" title="This is the central definition of the Acts payload object regarding magnetic field status...">MagneticFieldContext</a> <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a> = <a class="code" href="../../da/d7b/namespaceActs.html#a8d31a3d8704ec439cc207b46ad53183d" title="This is the central definition of the Acts payload object regarding magnetic field status...">MagneticFieldContext</a>();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> stepper_state_t&gt;</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html">   91</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html" title="Simplified propagator state.">PropState</a> {</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a503f4e9eece90aa843d06e4633f7ffe4">   93</a></span>&#160;  <a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html" title="Simplified propagator state.">PropState</a>(<a class="code" href="../../d3/d8d/exceptionActs_1_1Direction.html">Direction</a> direction, stepper_state_t sState)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      : stepping(std::<a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a0f6d06bf8c3093b9c22bb08723db201e">move</a>(sState)) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="../../d6/dee/namespaceckf.html#a9f00a906232a71b4737b5f772bf94fac">options</a>.direction = direction;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297">   98</a></span>&#160;  stepper_state_t <a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a0a6fb45f42abac2cad83da677a7d47c8">  101</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#aaebc9211ac34cbcd1acb1d764630d9c7">tolerance</a> = 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-4;</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#ab7e42936cc0bf4e60668598748cb8982">  102</a></span>&#160;    <span class="keywordtype">double</span> stepSizeCutOff = 0.;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a4b1a8374ce28b99f32392da1eca0fb4f">  103</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxRungeKuttaStepTrials = 10000;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a9b5e74b329fea3c794d92a57e2be72a6">  104</a></span>&#160;    <a class="code" href="../../d3/d8d/exceptionActs_1_1Direction.html">Direction</a> direction = <a class="code" href="../../d3/d8d/exceptionActs_1_1Direction.html#a968b23f66587e2ffd3dd3fefef9d25b3">Direction::Forward</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  } <a class="code" href="../../d6/dee/namespaceckf.html#a9f00a906232a71b4737b5f772bf94fac">options</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;};</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keyword">struct </span>MockNavigator {};</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a1e8cc2bba301039e6889a52f99fdc67c">  110</a></span>&#160;<span class="keyword">static</span> constexpr <a class="code" href="../../d3/dea/structActs_1_1Test_1_1MockNavigator.html">MockNavigator</a> <a class="code" href="../../df/d10/MultiStepperTests_8cpp.html#acadb76e1d84df1bb0159c3c9c83a6439">mockNavigator</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="code" href="../../d1/db4/structActs_1_1Test_1_1EndOfWorld.html">  115</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d1/db4/structActs_1_1Test_1_1EndOfWorld.html" title="Aborter for the case that a particle leaves the detector or reaches a custom made threshold...">EndOfWorld</a> {</div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="code" href="../../d1/db4/structActs_1_1Test_1_1EndOfWorld.html#a1020d4d31f53475100dd6dca75f9989c">  117</a></span>&#160;  <span class="keywordtype">double</span> maxX = 1_m;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="../../d1/db4/structActs_1_1Test_1_1EndOfWorld.html" title="Aborter for the case that a particle leaves the detector or reaches a custom made threshold...">EndOfWorld</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> propagator_state_t, <span class="keyword">typename</span> stepper_t,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keyword">typename</span> navigator_t&gt;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="code" href="../../d1/db4/structActs_1_1Test_1_1EndOfWorld.html#a9bda75ef5189667ebc53666a113f34a0">  135</a></span>&#160;  <span class="keywordtype">bool</span> operator()(propagator_state_t&amp; <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>, <span class="keyword">const</span> stepper_t&amp; <a class="code" href="../../dc/dd5/namespacepropagation__timing.html#a73ac659fd9b60e49ebcce460d4268319">stepper</a>,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                  <span class="keyword">const</span> navigator_t&amp; <span class="comment">/*navigator*/</span>,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                  <span class="keyword">const</span> <a class="code" href="../../d4/d3e/classActs_1_1Logger.html" title="class for printing debug output">Logger</a>&amp; <span class="comment">/*logger*/</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#aaebc9211ac34cbcd1acb1d764630d9c7">tolerance</a> = state.options.targetTolerance;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">if</span> (maxX - std::abs(stepper.position(state.stepping).x()) &lt;= tolerance ||</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        std::abs(stepper.position(state.stepping).y()) &gt;= 0.5_m ||</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        std::abs(stepper.position(state.stepping).z()) &gt;= 0.5_m) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;};</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="code" href="../../dc/ddc/structActs_1_1Test_1_1StepCollector.html">  151</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dc/ddc/structActs_1_1Test_1_1StepCollector.html" title="Data collector while propagation.">StepCollector</a> {</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html">  155</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">this_result</a> {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// Position of the propagator after each step</span></div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">  157</a></span>&#160;    std::vector&lt;Vector3&gt; <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// Momentum of the propagator after each step</span></div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">  159</a></span>&#160;    std::vector&lt;Vector3&gt; <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  };</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="code" href="../../dc/ddc/structActs_1_1Test_1_1StepCollector.html#a8ca7981d5853d4cb547546add9bc4ffb">  162</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">result_type</a> = <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">this_result</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> propagator_state_t, <span class="keyword">typename</span> stepper_t,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keyword">typename</span> navigator_t&gt;</div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="code" href="../../dc/ddc/structActs_1_1Test_1_1StepCollector.html#a57152c720f417bd478867d16a9fb7f59">  177</a></span>&#160;  <span class="keywordtype">void</span> operator()(propagator_state_t&amp; <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>, <span class="keyword">const</span> stepper_t&amp; <a class="code" href="../../dc/dd5/namespacepropagation__timing.html#a73ac659fd9b60e49ebcce460d4268319">stepper</a>,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                  <span class="keyword">const</span> navigator_t&amp; <span class="comment">/*navigator*/</span>, <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">result_type</a>&amp; result,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                  <span class="keyword">const</span> <a class="code" href="../../d4/d3e/classActs_1_1Logger.html" title="class for printing debug output">Logger</a>&amp; <span class="comment">/*logger*/</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    result.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.push_back(stepper.position(state.stepping));</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    result.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>.push_back(stepper.momentum(state.stepping));</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;};</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a6f504c962517e5e1e05da26fd076f103">  186</a></span>&#160;<a class="code" href="../../d6/d8a/ATLSeedingIntegrationTest_8cpp.html#a8e4d7293c1ca4b2f789d5bf8ca5b31c1">BOOST_AUTO_TEST_CASE</a>(eigen_stepper_state_test) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// Set up some variables</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a806c829a8350e9ffc7ec007285853e4e">stepSize</a> = 123.;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a> = std::make_shared&lt;ConstantBField&gt;(<a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a>(1., 2.5, 33.33));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>(1., 2., 3.);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> dir(4., 5., 6.);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a63090343a87034416b0e60c080f9142f">time</a> = 7.;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#ade50760cec61dd0500861d0417cc27b1">absMom</a> = 8.;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d0/dbc/pdgidfunc_8h.html#a9f9685e4a65c5e7a2b7e17213ae77cf3">charge</a> = -1.;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// Test charged parameters without covariance matrix</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="code" href="../../d7/d67/classActs_1_1GenericCurvilinearTrackParameters.html">CurvilinearTrackParameters</a> cp(<a class="code" href="../../df/da1/namespaceActs_1_1VectorHelpers.html#aee596cee9f20711ff9548f38973c2e1b" title="Construct a four-vector from a three-vector and scalar fourth component.">makeVector4</a>(pos, time), dir, charge / absMom,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                std::nullopt, <a class="code" href="../../dc/d1b/classActs_1_1ParticleHypothesis.html#a963c15014185a0480f89ce287524fc2a">ParticleHypothesis::pion</a>());</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html" title="State for track parameter propagation.">EigenStepper&lt;&gt;::State</a> esState(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>-&gt;makeCache(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>), cp,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a806c829a8350e9ffc7ec007285853e4e">stepSize</a>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper&lt;&gt;</a> es(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// Test the result &amp; compare with the input/test for reasonable members</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  BOOST_CHECK_EQUAL(esState.jacToGlobal, BoundToFreeMatrix::Zero());</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  BOOST_CHECK_EQUAL(esState.jacTransport, FreeMatrix::Identity());</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  BOOST_CHECK_EQUAL(esState.derivative, FreeVector::Zero());</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  BOOST_CHECK(!esState.covTransport);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  BOOST_CHECK_EQUAL(esState.cov, Covariance::Zero());</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  BOOST_CHECK_EQUAL(esState.pathAccumulated, 0.);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  BOOST_CHECK_EQUAL(esState.stepSize.value(), <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a806c829a8350e9ffc7ec007285853e4e">stepSize</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  BOOST_CHECK_EQUAL(esState.previousStepSize, 0.);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// Test without charge and covariance matrix</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <a class="code" href="../../d7/d67/classActs_1_1GenericCurvilinearTrackParameters.html">CurvilinearTrackParameters</a> ncp(<a class="code" href="../../df/da1/namespaceActs_1_1VectorHelpers.html#aee596cee9f20711ff9548f38973c2e1b" title="Construct a four-vector from a three-vector and scalar fourth component.">makeVector4</a>(pos, time), dir, 1 / absMom,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                 std::nullopt, <a class="code" href="../../dc/d1b/classActs_1_1ParticleHypothesis.html#a37bc2041eb181d0c3bd897dedd3fa3ea">ParticleHypothesis::pion0</a>());</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  esState = <a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html" title="State for track parameter propagation.">EigenStepper&lt;&gt;::State</a>(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>-&gt;makeCache(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>), ncp,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                  <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a806c829a8350e9ffc7ec007285853e4e">stepSize</a>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a597ed983e1f80ac7308bff5185c4a74d">charge</a>(esState), 0.);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">// Test with covariance matrix</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a913d49139751b648d6713fde8e3aaf18">Covariance</a> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a59990ed0e1a5a644f027fa28a1cf954c">cov</a> = 8. * Covariance::Identity();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  ncp = <a class="code" href="../../da/d7b/namespaceActs.html#a76d467084d19080ccc9ca67b9b8ca8b3" title="CurvilinearTrackParameters can hold any kind of charge.">CurvilinearTrackParameters</a>(<a class="code" href="../../df/da1/namespaceActs_1_1VectorHelpers.html#aee596cee9f20711ff9548f38973c2e1b" title="Construct a four-vector from a three-vector and scalar fourth component.">makeVector4</a>(pos, time), dir, 1 / absMom, cov,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                   <a class="code" href="../../dc/d1b/classActs_1_1ParticleHypothesis.html#a37bc2041eb181d0c3bd897dedd3fa3ea">ParticleHypothesis::pion0</a>());</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  esState = <a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html" title="State for track parameter propagation.">EigenStepper&lt;&gt;::State</a>(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>-&gt;makeCache(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>), ncp,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                  <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a806c829a8350e9ffc7ec007285853e4e">stepSize</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  BOOST_CHECK_NE(esState.jacToGlobal, BoundToFreeMatrix::Zero());</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  BOOST_CHECK(esState.covTransport);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  BOOST_CHECK_EQUAL(esState.cov, cov);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a562a9fb4bd42354ee4b7f58b32b2acac">  235</a></span>&#160;<a class="code" href="../../d6/d8a/ATLSeedingIntegrationTest_8cpp.html#a8e4d7293c1ca4b2f789d5bf8ca5b31c1">BOOST_AUTO_TEST_CASE</a>(eigen_stepper_test) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// Set up some variables for the state</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <a class="code" href="../../d3/d8d/exceptionActs_1_1Direction.html">Direction</a> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#aebbee2114bf85cd5b56ebd3f086d5ec0">navDir</a> = <a class="code" href="../../d3/d8d/exceptionActs_1_1Direction.html#a06ba3a8f405f38c7991f9d2702240aeb">Direction::Backward</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a806c829a8350e9ffc7ec007285853e4e">stepSize</a> = 123.;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a> = std::make_shared&lt;ConstantBField&gt;(<a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a>(1., 2.5, 33.33));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a7ccab2a9e43f87c48b7ef029377995ce">bCache</a> = <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>-&gt;makeCache(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">// Construct the parameters</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>(1., 2., 3.);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> dir = <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a>(4., 5., 6.).normalized();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a63090343a87034416b0e60c080f9142f">time</a> = 7.;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#ade50760cec61dd0500861d0417cc27b1">absMom</a> = 8.;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d0/dbc/pdgidfunc_8h.html#a9f9685e4a65c5e7a2b7e17213ae77cf3">charge</a> = -1.;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a913d49139751b648d6713fde8e3aaf18">Covariance</a> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a59990ed0e1a5a644f027fa28a1cf954c">cov</a> = 8. * Covariance::Identity();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="../../d7/d67/classActs_1_1GenericCurvilinearTrackParameters.html">CurvilinearTrackParameters</a> cp(<a class="code" href="../../df/da1/namespaceActs_1_1VectorHelpers.html#aee596cee9f20711ff9548f38973c2e1b" title="Construct a four-vector from a three-vector and scalar fourth component.">makeVector4</a>(pos, time), dir, charge / absMom,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                cov, <a class="code" href="../../dc/d1b/classActs_1_1ParticleHypothesis.html#a963c15014185a0480f89ce287524fc2a">ParticleHypothesis::pion</a>());</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// Build the state and the stepper</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html" title="State for track parameter propagation.">EigenStepper&lt;&gt;::State</a> esState(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>-&gt;makeCache(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>), cp,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a806c829a8350e9ffc7ec007285853e4e">stepSize</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper&lt;&gt;</a> es(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">// Test the getters</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ab4d702238e1008694cb3d101e8cde5ee">position</a>(esState), <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a5d8e72d9ea489e7b1a2b2f43c4a396ab">direction</a>(esState), dir, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a55cc9c59296323b02a6899cbea827064">absoluteMomentum</a>(esState), <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#ade50760cec61dd0500861d0417cc27b1">absMom</a>, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a597ed983e1f80ac7308bff5185c4a74d">charge</a>(esState), <a class="code" href="../../d0/dbc/pdgidfunc_8h.html#a9f9685e4a65c5e7a2b7e17213ae77cf3">charge</a>, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a849f82021d3c5e95d56717ea3b9b3885">time</a>(esState), <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a63090343a87034416b0e60c080f9142f">time</a>, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a4975d55c11a155b8041dc81cc687d305">getField</a>(esState, pos).value(),</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>-&gt;getField(pos, bCache).value());</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// Step size modifies</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a> originalStepSize = esState.stepSize.toString();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#abbdec73e3b09840ee918a6fe58d76860">setStepSize</a>(esState, -1337.);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  BOOST_CHECK_EQUAL(esState.previousStepSize, stepSize);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  BOOST_CHECK_EQUAL(esState.stepSize.value(), -1337.);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#adfd34d2fc07c026b2d1c5f9e7bb3c702">releaseStepSize</a>(esState);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  BOOST_CHECK_EQUAL(esState.stepSize.value(), <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a806c829a8350e9ffc7ec007285853e4e">stepSize</a>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a47e750b2064da6be03bf333649d7e08d">outputStepSize</a>(esState), originalStepSize);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// Test the curvilinear state construction</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keyword">auto</span> curvState = es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#aed6774f6a158f11ae56b4b8d28e6b787" title="This transports (if necessary) the covariance to the current position and creates a curvilinear state...">curvilinearState</a>(esState);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keyword">auto</span> curvPars = std::get&lt;0&gt;(curvState);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(curvPars.position(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>), cp.<a class="code" href="../../d7/d67/classActs_1_1GenericCurvilinearTrackParameters.html#ab8bd74d3c9027cfa64bc92dbba3a19c0" title="Spatial position three-vector.">position</a>(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>), <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(curvPars.momentum(), cp.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#a0db4410d3d9ba34b79bec98e4d43fb61" title="Momentum three-vector.">momentum</a>(), 10<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-6);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(curvPars.charge(), cp.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#af7a6cfbefd0970fa092f166ed244328b" title="Particle electric charge.">charge</a>(), <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(curvPars.time(), cp.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#a2e813c104b1aae0c6ff3145754fb8caa" title="Time coordinate.">time</a>(), <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  BOOST_CHECK(curvPars.covariance().has_value());</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  BOOST_CHECK_NE(*curvPars.covariance(), <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a59990ed0e1a5a644f027fa28a1cf954c">cov</a>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#ad2eb3237d0fc8a6fe90d703f245e16fc">CHECK_CLOSE_COVARIANCE</a>(std::get&lt;1&gt;(curvState),</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                         <a class="code" href="../../da/d7b/namespaceActs.html#af635ccf624d33ad03fa8500a64b24323">BoundMatrix</a>(BoundMatrix::Identity()), <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(std::get&lt;2&gt;(curvState), 0., <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// Test the update method</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> newPos(2., 4., 8.);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> newMom(3., 9., 27.);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordtype">double</span> newTime(321.);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a11fc76e64e1c38387c635d96ce83f386">update</a>(esState, newPos, newMom.normalized(), charge / newMom.norm(),</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            newTime);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ab4d702238e1008694cb3d101e8cde5ee">position</a>(esState), newPos);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a5d8e72d9ea489e7b1a2b2f43c4a396ab">direction</a>(esState), newMom.normalized());</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a55cc9c59296323b02a6899cbea827064">absoluteMomentum</a>(esState), newMom.norm());</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a597ed983e1f80ac7308bff5185c4a74d">charge</a>(esState), <a class="code" href="../../d0/dbc/pdgidfunc_8h.html#a9f9685e4a65c5e7a2b7e17213ae77cf3">charge</a>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a849f82021d3c5e95d56717ea3b9b3885">time</a>(esState), newTime);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">// The covariance transport</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  esState.cov = <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a59990ed0e1a5a644f027fa28a1cf954c">cov</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a8d75de3f6c3071e21b26e347b074dc05">transportCovarianceToCurvilinear</a>(esState);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  BOOST_CHECK_NE(esState.cov, cov);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  BOOST_CHECK_NE(esState.jacToGlobal, BoundToFreeMatrix::Zero());</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  BOOST_CHECK_EQUAL(esState.jacTransport, FreeMatrix::Identity());</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  BOOST_CHECK_EQUAL(esState.derivative, FreeVector::Zero());</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">// Perform a step without and with covariance transport</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  esState.cov = <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a59990ed0e1a5a644f027fa28a1cf954c">cov</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html" title="Simplified propagator state.">PropState</a> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a47c413a927a47ea8842b348139e18c32">ps</a>(navDir, <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a0f6d06bf8c3093b9c22bb08723db201e">std::move</a>(esState));</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.covTransport = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a621178e1291f1885f5aa80d6e1d6da97">step</a>(ps, <a class="code" href="../../df/d10/MultiStepperTests_8cpp.html#acadb76e1d84df1bb0159c3c9c83a6439">mockNavigator</a>).value();</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#ad2eb3237d0fc8a6fe90d703f245e16fc">CHECK_CLOSE_COVARIANCE</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.cov, cov, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  BOOST_CHECK_NE(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ab4d702238e1008694cb3d101e8cde5ee">position</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>).norm(), newPos.norm());</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  BOOST_CHECK_NE(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a5d8e72d9ea489e7b1a2b2f43c4a396ab">direction</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>), newMom.normalized());</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a597ed983e1f80ac7308bff5185c4a74d">charge</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>), <a class="code" href="../../d0/dbc/pdgidfunc_8h.html#a9f9685e4a65c5e7a2b7e17213ae77cf3">charge</a>);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  BOOST_CHECK_LT(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a849f82021d3c5e95d56717ea3b9b3885">time</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>), newTime);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  BOOST_CHECK_EQUAL(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.derivative, FreeVector::Zero());</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  BOOST_CHECK_EQUAL(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.jacTransport, FreeMatrix::Identity());</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.covTransport = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a621178e1291f1885f5aa80d6e1d6da97">step</a>(ps, <a class="code" href="../../df/d10/MultiStepperTests_8cpp.html#acadb76e1d84df1bb0159c3c9c83a6439">mockNavigator</a>).value();</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#ad2eb3237d0fc8a6fe90d703f245e16fc">CHECK_CLOSE_COVARIANCE</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.cov, cov, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  BOOST_CHECK_NE(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ab4d702238e1008694cb3d101e8cde5ee">position</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>).norm(), newPos.norm());</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  BOOST_CHECK_NE(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a5d8e72d9ea489e7b1a2b2f43c4a396ab">direction</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>), newMom.normalized());</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a597ed983e1f80ac7308bff5185c4a74d">charge</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>), <a class="code" href="../../d0/dbc/pdgidfunc_8h.html#a9f9685e4a65c5e7a2b7e17213ae77cf3">charge</a>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  BOOST_CHECK_LT(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a849f82021d3c5e95d56717ea3b9b3885">time</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>), newTime);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  BOOST_CHECK_NE(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.derivative, FreeVector::Zero());</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  BOOST_CHECK_NE(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.jacTransport, FreeMatrix::Identity());</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// Construct the parameters</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> pos2(1.5, -2.5, 3.5);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> dir2 = <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a>(4.5, -5.5, 6.5).normalized();</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordtype">double</span> time2 = 7.5;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordtype">double</span> absMom2 = 8.5;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordtype">double</span> charge2 = 1.;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="../../da/d7b/namespaceActs.html#ae270e959abf019daff44ec3892595976">BoundSquareMatrix</a> cov2 = 8.5 * Covariance::Identity();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <a class="code" href="../../d7/d67/classActs_1_1GenericCurvilinearTrackParameters.html">CurvilinearTrackParameters</a> cp2(<a class="code" href="../../df/da1/namespaceActs_1_1VectorHelpers.html#aee596cee9f20711ff9548f38973c2e1b" title="Construct a four-vector from a three-vector and scalar fourth component.">makeVector4</a>(pos2, time2), dir2,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                 charge2 / absMom2, cov2,</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                 <a class="code" href="../../dc/d1b/classActs_1_1ParticleHypothesis.html#a963c15014185a0480f89ce287524fc2a">ParticleHypothesis::pion</a>());</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <a class="code" href="../../da/d7b/namespaceActs.html#aed1d920cbfd8e879dcfaba276afc4d01">FreeVector</a> freeParams = <a class="code" href="../../d6/d06/namespaceActs_1_1detail.html#a2d329cb6dbd21114be502950a0e2e49c">detail::transformBoundToFreeParameters</a>(</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      cp2.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#acf6667ee4d7e718b6717e65c3a0372f1" title="Reference surface onto which the parameters are bound.">referenceSurface</a>(), <a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, cp2.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#acd32f78737b57bc00af9cf34198caf60" title="Parameters vector.">parameters</a>());</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  navDir = <a class="code" href="../../d3/d8d/exceptionActs_1_1Direction.html#a968b23f66587e2ffd3dd3fefef9d25b3">Direction::Forward</a>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordtype">double</span> stepSize2 = -2. * <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a806c829a8350e9ffc7ec007285853e4e">stepSize</a>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keyword">auto</span> copyState = [&amp;](<span class="keyword">auto</span>&amp; <a class="code" href="../../d6/dee/namespaceckf.html#a46f483ab4625b683ee66025e18a10825">field</a>, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keyword">using</span> field_t = std::decay_t&lt;decltype(field)&gt;;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    std::decay_t&lt;decltype(state)&gt; copy(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d6/dee/namespaceckf.html#a46f483ab4625b683ee66025e18a10825">field</a>.makeCache(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>),</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                       cp, <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a806c829a8350e9ffc7ec007285853e4e">stepSize</a>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    copy.pars = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.pars;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    copy.covTransport = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.covTransport;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    copy.cov = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.cov;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    copy.jacobian = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.jacobian;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    copy.jacToGlobal = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.jacToGlobal;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    copy.jacTransport = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.jacTransport;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    copy.derivative = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.derivative;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    copy.pathAccumulated = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.pathAccumulated;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    copy.stepSize = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.stepSize;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    copy.previousStepSize = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.previousStepSize;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    copy.fieldCache =</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        MagneticFieldProvider::Cache::make&lt;typename field_t::Cache&gt;(</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.fieldCache.template get&lt;typename field_t::Cache&gt;());</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    copy.geoContext = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.geoContext;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    copy.extension = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.extension;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    copy.auctioneer = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.auctioneer;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    copy.stepData = <a class="code" href="../../d1/da4/namespacefilter.html#a7ddbae181c53b04cce853b5138130875">state</a>.stepData;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">return</span> copy;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  };</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="comment">// Reset all possible parameters</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html" title="State for track parameter propagation.">EigenStepper&lt;&gt;::State</a> esStateCopy(copyState(*<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>, ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>));</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  BOOST_CHECK(cp2.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#ae57edb391738d5e7c436e01c96dce045" title="Optional covariance matrix.">covariance</a>().has_value());</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a47a252573cc3e43d300e30a882cb155e" title="Resets the state.">resetState</a>(esStateCopy, cp2.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#acd32f78737b57bc00af9cf34198caf60" title="Parameters vector.">parameters</a>(), *cp2.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#ae57edb391738d5e7c436e01c96dce045" title="Optional covariance matrix.">covariance</a>(),</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                cp2.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#acf6667ee4d7e718b6717e65c3a0372f1" title="Reference surface onto which the parameters are bound.">referenceSurface</a>(), stepSize2);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="comment">// Test all components</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  BOOST_CHECK_NE(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a44bbd6ea4da4075f14bf83f2a873f2c3" title="Jacobian from local to the global frame.">jacToGlobal</a>, BoundToFreeMatrix::Zero());</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  BOOST_CHECK_NE(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a44bbd6ea4da4075f14bf83f2a873f2c3" title="Jacobian from local to the global frame.">jacToGlobal</a>, ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.jacToGlobal);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a31f9730e4a72d7b02252c88cf24e251b" title="Pure transport jacobian part from runge kutta integration.">jacTransport</a>, FreeMatrix::Identity());</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a0765b0e1b70dc9034056b06e4b85880f" title="The propagation derivative.">derivative</a>, FreeVector::Zero());</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  BOOST_CHECK(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a4e6eee16e37c15b8c4402df8434d2cc9">covTransport</a>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#ad99ed63e823f0ad4d947ce34fa83ad94">cov</a>, cov2);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ab4d702238e1008694cb3d101e8cde5ee">position</a>(esStateCopy),</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                    freeParams.template segment&lt;3&gt;(<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92ca4f1d0ebd2431f946d8f901bac6617db9">eFreePos0</a>));</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a5d8e72d9ea489e7b1a2b2f43c4a396ab">direction</a>(esStateCopy),</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                    freeParams.template segment&lt;3&gt;(<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92ca3994d4b5c6c143561e23cd964d61f916">eFreeDir0</a>).normalized());</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a55cc9c59296323b02a6899cbea827064">absoluteMomentum</a>(esStateCopy),</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                    std::abs(1. / freeParams[<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92cab2fad9ef29e2cec612213d6174338fed">eFreeQOverP</a>]));</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a597ed983e1f80ac7308bff5185c4a74d">charge</a>(esStateCopy), -es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a597ed983e1f80ac7308bff5185c4a74d">charge</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>));</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a849f82021d3c5e95d56717ea3b9b3885">time</a>(esStateCopy), freeParams[<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92ca73bbfd1eb6084375bbd8cf207abcf2d2">eFreeTime</a>]);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#af69c109956d50130633f6115c1825c51" title="Accummulated path length state.">pathAccumulated</a>, 0.);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a0f7eb13f77c7e4a9ddbb12a87ee3d447" title="Adaptive step size of the runge-kutta integration.">stepSize</a>.<a class="code" href="../../da/d23/classActs_1_1ConstrainedStep.html#ab97024f804458aa6467a6a4b10dc9a9e" title="returns the min step size">value</a>(), navDir * stepSize2);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a68311fb7e14092f7c0f3c467779d515b" title="Last performed step (for overstep limit calculation)">previousStepSize</a>, ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.previousStepSize);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// Reset all possible parameters except the step size</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  esStateCopy = copyState(*<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>, ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a47a252573cc3e43d300e30a882cb155e" title="Resets the state.">resetState</a>(esStateCopy, cp2.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#acd32f78737b57bc00af9cf34198caf60" title="Parameters vector.">parameters</a>(), *cp2.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#ae57edb391738d5e7c436e01c96dce045" title="Optional covariance matrix.">covariance</a>(),</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                cp2.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#acf6667ee4d7e718b6717e65c3a0372f1" title="Reference surface onto which the parameters are bound.">referenceSurface</a>());</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// Test all components</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  BOOST_CHECK_NE(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a44bbd6ea4da4075f14bf83f2a873f2c3" title="Jacobian from local to the global frame.">jacToGlobal</a>, BoundToFreeMatrix::Zero());</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  BOOST_CHECK_NE(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a44bbd6ea4da4075f14bf83f2a873f2c3" title="Jacobian from local to the global frame.">jacToGlobal</a>, ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.jacToGlobal);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a31f9730e4a72d7b02252c88cf24e251b" title="Pure transport jacobian part from runge kutta integration.">jacTransport</a>, FreeMatrix::Identity());</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a0765b0e1b70dc9034056b06e4b85880f" title="The propagation derivative.">derivative</a>, FreeVector::Zero());</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  BOOST_CHECK(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a4e6eee16e37c15b8c4402df8434d2cc9">covTransport</a>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#ad99ed63e823f0ad4d947ce34fa83ad94">cov</a>, cov2);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ab4d702238e1008694cb3d101e8cde5ee">position</a>(esStateCopy),</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    freeParams.template segment&lt;3&gt;(<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92ca4f1d0ebd2431f946d8f901bac6617db9">eFreePos0</a>));</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a5d8e72d9ea489e7b1a2b2f43c4a396ab">direction</a>(esStateCopy),</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    freeParams.template segment&lt;3&gt;(<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92ca3994d4b5c6c143561e23cd964d61f916">eFreeDir0</a>).normalized());</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a55cc9c59296323b02a6899cbea827064">absoluteMomentum</a>(esStateCopy),</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    std::abs(1. / freeParams[eFreeQOverP]));</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a597ed983e1f80ac7308bff5185c4a74d">charge</a>(esStateCopy), -es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a597ed983e1f80ac7308bff5185c4a74d">charge</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>));</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a849f82021d3c5e95d56717ea3b9b3885">time</a>(esStateCopy), freeParams[<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92ca73bbfd1eb6084375bbd8cf207abcf2d2">eFreeTime</a>]);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#af69c109956d50130633f6115c1825c51" title="Accummulated path length state.">pathAccumulated</a>, 0.);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a0f7eb13f77c7e4a9ddbb12a87ee3d447" title="Adaptive step size of the runge-kutta integration.">stepSize</a>.<a class="code" href="../../da/d23/classActs_1_1ConstrainedStep.html#ab97024f804458aa6467a6a4b10dc9a9e" title="returns the min step size">value</a>(),</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    std::numeric_limits&lt;double&gt;::max());</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a68311fb7e14092f7c0f3c467779d515b" title="Last performed step (for overstep limit calculation)">previousStepSize</a>, ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.previousStepSize);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">// Reset the least amount of parameters</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  esStateCopy = copyState(*<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>, ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a47a252573cc3e43d300e30a882cb155e" title="Resets the state.">resetState</a>(esStateCopy, cp2.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#acd32f78737b57bc00af9cf34198caf60" title="Parameters vector.">parameters</a>(), *cp2.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#ae57edb391738d5e7c436e01c96dce045" title="Optional covariance matrix.">covariance</a>(),</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                cp2.<a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#acf6667ee4d7e718b6717e65c3a0372f1" title="Reference surface onto which the parameters are bound.">referenceSurface</a>());</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">// Test all components</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  BOOST_CHECK_NE(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a44bbd6ea4da4075f14bf83f2a873f2c3" title="Jacobian from local to the global frame.">jacToGlobal</a>, BoundToFreeMatrix::Zero());</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  BOOST_CHECK_NE(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a44bbd6ea4da4075f14bf83f2a873f2c3" title="Jacobian from local to the global frame.">jacToGlobal</a>, ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.jacToGlobal);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a31f9730e4a72d7b02252c88cf24e251b" title="Pure transport jacobian part from runge kutta integration.">jacTransport</a>, FreeMatrix::Identity());</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a0765b0e1b70dc9034056b06e4b85880f" title="The propagation derivative.">derivative</a>, FreeVector::Zero());</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  BOOST_CHECK(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a4e6eee16e37c15b8c4402df8434d2cc9">covTransport</a>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#ad99ed63e823f0ad4d947ce34fa83ad94">cov</a>, cov2);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ab4d702238e1008694cb3d101e8cde5ee">position</a>(esStateCopy),</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                    freeParams.template segment&lt;3&gt;(<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92ca4f1d0ebd2431f946d8f901bac6617db9">eFreePos0</a>));</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a5d8e72d9ea489e7b1a2b2f43c4a396ab">direction</a>(esStateCopy),</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                    freeParams.template segment&lt;3&gt;(<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92ca3994d4b5c6c143561e23cd964d61f916">eFreeDir0</a>).normalized());</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a55cc9c59296323b02a6899cbea827064">absoluteMomentum</a>(esStateCopy),</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                    std::abs(1. / freeParams[eFreeQOverP]));</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a597ed983e1f80ac7308bff5185c4a74d">charge</a>(esStateCopy), -es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a597ed983e1f80ac7308bff5185c4a74d">charge</a>(ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>));</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a849f82021d3c5e95d56717ea3b9b3885">time</a>(esStateCopy), freeParams[<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92ca73bbfd1eb6084375bbd8cf207abcf2d2">eFreeTime</a>]);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#af69c109956d50130633f6115c1825c51" title="Accummulated path length state.">pathAccumulated</a>, 0.);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a0f7eb13f77c7e4a9ddbb12a87ee3d447" title="Adaptive step size of the runge-kutta integration.">stepSize</a>.<a class="code" href="../../da/d23/classActs_1_1ConstrainedStep.html#ab97024f804458aa6467a6a4b10dc9a9e" title="returns the min step size">value</a>(),</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    std::numeric_limits&lt;double&gt;::max());</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  BOOST_CHECK_EQUAL(esStateCopy.<a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html#a68311fb7e14092f7c0f3c467779d515b" title="Last performed step (for overstep limit calculation)">previousStepSize</a>, ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a29a2643cc2b593d4f976f566180d8297" title="State of the eigen stepper.">stepping</a>.previousStepSize);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d8/d44/namespaceActs_1_1PrimitivesView3DTest.html#a4b6fa90d5676ca27bbbc4aab74eabf9f">plane</a> = Surface::makeShared&lt;PlaneSurface&gt;(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>, dir.normalized());</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keyword">auto</span> bp = <a class="code" href="../../d9/dd7/classActs_1_1GenericBoundTrackParameters.html#a721d9b81763776fa59ae5552961c4855">BoundTrackParameters::create</a>(</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                <a class="code" href="../../d8/d44/namespaceActs_1_1PrimitivesView3DTest.html#a4b6fa90d5676ca27bbbc4aab74eabf9f">plane</a>, <a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../df/da1/namespaceActs_1_1VectorHelpers.html#aee596cee9f20711ff9548f38973c2e1b" title="Construct a four-vector from a three-vector and scalar fourth component.">makeVector4</a>(pos, time), dir, charge / absMom,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                cov, <a class="code" href="../../dc/d1b/classActs_1_1ParticleHypothesis.html#a963c15014185a0480f89ce287524fc2a">ParticleHypothesis::pion</a>())</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                .value();</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  esState = <a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html" title="State for track parameter propagation.">EigenStepper&lt;&gt;::State</a>(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>-&gt;makeCache(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>), cp,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                  <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a806c829a8350e9ffc7ec007285853e4e">stepSize</a>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="comment">// Test the intersection in the context of a surface</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keyword">auto</span> targetSurface =</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      Surface::makeShared&lt;PlaneSurface&gt;(pos + navDir * 2. * dir, dir);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a243efcd6ebfc0e7bbf269b41acc453be">updateSurfaceStatus</a>(esState, *targetSurface, navDir, <a class="code" href="../../d8/d3d/classActs_1_1BoundaryCheck.html">BoundaryCheck</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(esState.stepSize.value(<a class="code" href="../../da/d23/classActs_1_1ConstrainedStep.html#a0eecb2e9c95a2c252b3fea20e69b0ba5a6a1b3292cf6c2675c1612a376d16dfb6">ConstrainedStep::actor</a>), navDir * 2.,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                  <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="comment">// Test the step size modification in the context of a surface</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ac54d3ed9b772c837e6f968245de79c4c">updateStepSize</a>(esState,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    targetSurface</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                        -&gt;<a class="code" href="../../d1/da5/namespaceActs_1_1PlanarHelper.html#a6e6e5b71689d1836e917927fdedd18d9">intersect</a>(esState.geoContext, es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ab4d702238e1008694cb3d101e8cde5ee">position</a>(esState),</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                    navDir * es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a5d8e72d9ea489e7b1a2b2f43c4a396ab">direction</a>(esState), <span class="keyword">false</span>)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                        .<a class="code" href="../../dc/d25/Fun4All__FillDCMap_8C.html#a90e3b243519cdf73802cbf9811fa0f42">closest</a>(),</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                    <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#aebbee2114bf85cd5b56ebd3f086d5ec0">navDir</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(esState.stepSize.value(), 2., <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  esState.stepSize.setUser(navDir * stepSize);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ac54d3ed9b772c837e6f968245de79c4c">updateStepSize</a>(esState,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                    targetSurface</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                        -&gt;<a class="code" href="../../d1/da5/namespaceActs_1_1PlanarHelper.html#a6e6e5b71689d1836e917927fdedd18d9">intersect</a>(esState.geoContext, es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ab4d702238e1008694cb3d101e8cde5ee">position</a>(esState),</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                    navDir * es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a5d8e72d9ea489e7b1a2b2f43c4a396ab">direction</a>(esState), <span class="keyword">false</span>)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                        .<a class="code" href="../../dc/d25/Fun4All__FillDCMap_8C.html#a90e3b243519cdf73802cbf9811fa0f42">closest</a>(),</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                    <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#aebbee2114bf85cd5b56ebd3f086d5ec0">navDir</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(esState.stepSize.value(), 2., <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="comment">// Test the bound state construction</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d6/d06/namespaceActs_1_1detail.html#a0e0f42ca1e85e039921add1ba7a948f2" title="It does not check if the transported state is at the surface, this needs to be guaranteed by the prop...">boundState</a> = es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#abebd41dbfade782b2f41df7db036cb1f" title="This transports (if necessary) the covariance to the surface and creates a bound state. It does not check if the transported state is at the surface, this needs to be guaranteed by the propagator.">boundState</a>(esState, *<a class="code" href="../../d8/d44/namespaceActs_1_1PrimitivesView3DTest.html#a4b6fa90d5676ca27bbbc4aab74eabf9f">plane</a>).value();</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keyword">auto</span> boundPars = std::get&lt;0&gt;(<a class="code" href="../../d6/d06/namespaceActs_1_1detail.html#a0e0f42ca1e85e039921add1ba7a948f2" title="It does not check if the transported state is at the surface, this needs to be guaranteed by the prop...">boundState</a>);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(boundPars.position(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>), bp.position(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>), <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(boundPars.momentum(), bp.momentum(), 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-7);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(boundPars.charge(), bp.charge(), <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(boundPars.time(), bp.time(), <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  BOOST_CHECK(boundPars.covariance().has_value());</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  BOOST_CHECK_NE(*boundPars.covariance(), <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a59990ed0e1a5a644f027fa28a1cf954c">cov</a>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#ad2eb3237d0fc8a6fe90d703f245e16fc">CHECK_CLOSE_COVARIANCE</a>(std::get&lt;1&gt;(boundState),</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                         <a class="code" href="../../da/d7b/namespaceActs.html#af635ccf624d33ad03fa8500a64b24323">BoundMatrix</a>(BoundMatrix::Identity()), <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(std::get&lt;2&gt;(boundState), 0., <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// Transport the covariance in the context of a surface</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ab4d6dc34bf0c64335632bbab5cd390e8">transportCovarianceToBound</a>(esState, *<a class="code" href="../../d8/d44/namespaceActs_1_1PrimitivesView3DTest.html#a4b6fa90d5676ca27bbbc4aab74eabf9f">plane</a>);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  BOOST_CHECK_NE(esState.cov, cov);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  BOOST_CHECK_NE(esState.jacToGlobal, BoundToFreeMatrix::Zero());</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  BOOST_CHECK_EQUAL(esState.jacTransport, FreeMatrix::Identity());</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  BOOST_CHECK_EQUAL(esState.derivative, FreeVector::Zero());</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// Update in context of a surface</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  freeParams = <a class="code" href="../../d6/d06/namespaceActs_1_1detail.html#a2d329cb6dbd21114be502950a0e2e49c">detail::transformBoundToFreeParameters</a>(</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      bp.referenceSurface(), <a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, bp.parameters());</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  freeParams.segment&lt;3&gt;(<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92ca4f1d0ebd2431f946d8f901bac6617db9">eFreePos0</a>) *= 2;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  freeParams[<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92ca73bbfd1eb6084375bbd8cf207abcf2d2">eFreeTime</a>] *= 2;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  freeParams[<a class="code" href="../../da/d7b/namespaceActs.html#a6c086a09086424ffb3ace68710e8e92cab2fad9ef29e2cec612213d6174338fed">eFreeQOverP</a>] *= -0.5;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a11fc76e64e1c38387c635d96ce83f386">update</a>(esState, freeParams, bp.parameters(), 2 * (*bp.covariance()),</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            *<a class="code" href="../../d8/d44/namespaceActs_1_1PrimitivesView3DTest.html#a4b6fa90d5676ca27bbbc4aab74eabf9f">plane</a>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#ab3ba4b09d9575e129c76293dc637b39b">CHECK_CLOSE_OR_SMALL</a>(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#ab4d702238e1008694cb3d101e8cde5ee">position</a>(esState), 2. * <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#ab3ba4b09d9575e129c76293dc637b39b">CHECK_CLOSE_OR_SMALL</a>(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a5d8e72d9ea489e7b1a2b2f43c4a396ab">direction</a>(esState), dir, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#aa522de21314feb0a5e84fa7d370c95e1">CHECK_CLOSE_REL</a>(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a55cc9c59296323b02a6899cbea827064">absoluteMomentum</a>(esState), 2 * <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#ade50760cec61dd0500861d0417cc27b1">absMom</a>, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  BOOST_CHECK_EQUAL(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a597ed983e1f80ac7308bff5185c4a74d">charge</a>(esState), -1. * <a class="code" href="../../d0/dbc/pdgidfunc_8h.html#a9f9685e4a65c5e7a2b7e17213ae77cf3">charge</a>);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#ab3ba4b09d9575e129c76293dc637b39b">CHECK_CLOSE_OR_SMALL</a>(es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a849f82021d3c5e95d56717ea3b9b3885">time</a>(esState), 2. * <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a63090343a87034416b0e60c080f9142f">time</a>, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>, <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#ad2eb3237d0fc8a6fe90d703f245e16fc">CHECK_CLOSE_COVARIANCE</a>(esState.cov, <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a913d49139751b648d6713fde8e3aaf18">Covariance</a>(2. * cov), eps);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// Test a case where no step size adjustment is required</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  ps.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a60a02b6cf4319c957983d0d93e94bbd2">options</a>.<a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html#a0a6fb45f42abac2cad83da677a7d47c8">tolerance</a> = 2. * 4.4258e+09;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordtype">double</span> h0 = esState.stepSize.value();</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  es.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a621178e1291f1885f5aa80d6e1d6da97">step</a>(ps, <a class="code" href="../../df/d10/MultiStepperTests_8cpp.html#acadb76e1d84df1bb0159c3c9c83a6439">mockNavigator</a>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(h0, esState.stepSize.value(), <a class="code" href="../../dd/d37/MaterialSlab_8cpp.html#a47537a81108fa8a58099f523a03d47a5">eps</a>);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="comment">// Produce some errors</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keyword">auto</span> nBfield = std::make_shared&lt;NullBField&gt;();</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper&lt;&gt;</a> nes(nBfield);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <a class="code" href="../../d0/d11/structActs_1_1EigenStepper_1_1State.html" title="State for track parameter propagation.">EigenStepper&lt;&gt;::State</a> nesState(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, nBfield-&gt;makeCache(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>), cp,</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                 <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a806c829a8350e9ffc7ec007285853e4e">stepSize</a>);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <a class="code" href="../../dd/d16/structActs_1_1Test_1_1PropState.html" title="Simplified propagator state.">PropState</a> nps(navDir, copyState(*nBfield, nesState));</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">// Test that we can reach the minimum step size</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  nps.options.tolerance = 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-21;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  nps.options.stepSizeCutOff = 1e20;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keyword">auto</span> res = nes.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a621178e1291f1885f5aa80d6e1d6da97">step</a>(nps, <a class="code" href="../../df/d10/MultiStepperTests_8cpp.html#acadb76e1d84df1bb0159c3c9c83a6439">mockNavigator</a>);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  BOOST_CHECK(!res.ok());</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  BOOST_CHECK_EQUAL(res.error(), EigenStepperError::StepSizeStalled);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// Test that the number of trials exceeds</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  nps.options.stepSizeCutOff = 0.;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  nps.options.maxRungeKuttaStepTrials = 0.;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  res = nes.<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html#a621178e1291f1885f5aa80d6e1d6da97">step</a>(nps, <a class="code" href="../../df/d10/MultiStepperTests_8cpp.html#acadb76e1d84df1bb0159c3c9c83a6439">mockNavigator</a>);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  BOOST_CHECK(!res.ok());</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  BOOST_CHECK_EQUAL(res.error(), EigenStepperError::StepSizeAdjustmentFailed);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;}</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">// Test case a). The DenseEnvironmentExtension should state that it is not</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">// valid in this case.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno"><a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a6adf3fec31dc633e25f4f248efd3649d">  556</a></span>&#160;<a class="code" href="../../d6/d8a/ATLSeedingIntegrationTest_8cpp.html#a8e4d7293c1ca4b2f789d5bf8ca5b31c1">BOOST_AUTO_TEST_CASE</a>(step_extension_vacuum_test) {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <a class="code" href="../../d1/d48/classActs_1_1CuboidVolumeBuilder.html" title="This class builds a box detector with a configurable amount of surfaces in it. The idea is to allow a...">CuboidVolumeBuilder</a> cvb;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html" title="This struct stores the data for the construction of a cuboid TrackingVolume with a given number of Pl...">CuboidVolumeBuilder::VolumeConfig</a> vConf;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  vConf.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aca8d7b10382861e417a46d50c7d34bd2">position</a> = {0.5_m, 0., 0.};</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  vConf.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aaedfa42634aec6086960a258040526ca">length</a> = {1_m, 1_m, 1_m};</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html" title="This struct stores the configuration of the tracking geometry.">CuboidVolumeBuilder::Config</a> conf;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  conf.<a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html#acfb99d5ca661f630a911d7c1fc3b38b3">volumeCfg</a>.push_back(vConf);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  conf.<a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html#a00f24e2c87c886297b6fadfd1aa6d08e">position</a> = {0.5_m, 0., 0.};</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  conf.<a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html#a84bcca381c085fabe341b25b0e857435">length</a> = {1_m, 1_m, 1_m};</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">// Build detector</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  cvb.<a class="code" href="../../d1/d48/classActs_1_1CuboidVolumeBuilder.html#a2aae32c1b8fc364a40999467560fcb7b" title="Setter of the config.">setConfig</a>(conf);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <a class="code" href="../../d1/d31/structActs_1_1TrackingGeometryBuilder_1_1Config.html">TrackingGeometryBuilder::Config</a> tgbCfg;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  tgbCfg.<a class="code" href="../../d1/d31/structActs_1_1TrackingGeometryBuilder_1_1Config.html#a128ad1e986eba0cb9f922213f2c824dc" title="The list of tracking volume builders.">trackingVolumeBuilders</a>.push_back(</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      [=](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; context, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; inner, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; vb) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="keywordflow">return</span> cvb.<a class="code" href="../../d1/d48/classActs_1_1CuboidVolumeBuilder.html#aa10844c2fbce315118faf19cc4c53425" title="This function builds a world TrackingVolume based on a given configuration.">trackingVolume</a>(context, inner, vb);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      });</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <a class="code" href="../../df/d54/classActs_1_1TrackingGeometryBuilder.html">TrackingGeometryBuilder</a> tgb(tgbCfg);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  std::shared_ptr&lt;const TrackingGeometry&gt; vacuum =</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      tgb.<a class="code" href="../../df/d54/classActs_1_1TrackingGeometryBuilder.html#a65a50311a2828d5ec4c6883318925733">trackingGeometry</a>(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">// Build navigator</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a> naviVac({vacuum, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>});</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">// Set initial parameters for the particle track</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a913d49139751b648d6713fde8e3aaf18">Covariance</a> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a59990ed0e1a5a644f027fa28a1cf954c">cov</a> = Covariance::Identity();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> startDir = <a class="code" href="../../da/d7b/namespaceActs.html#ade380e3fafcce0335e8f7564adb4af58">makeDirectionFromPhiTheta</a>(0_degree, 90_degree);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> startMom = 1_GeV * startDir;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d7/d67/classActs_1_1GenericCurvilinearTrackParameters.html">CurvilinearTrackParameters</a> sbtp(Vector4::Zero(), startDir, 1_e / 1_GeV,</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                                        cov, <a class="code" href="../../dc/d1b/classActs_1_1ParticleHypothesis.html#a963c15014185a0480f89ce287524fc2a">ParticleHypothesis::pion</a>());</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="comment">// Create action list for surface collection</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  ActionList&lt;StepCollector&gt; aList;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  AbortList&lt;EndOfWorld&gt; abortList;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment">// Set options for propagator</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <a class="code" href="../../d6/dc3/structActs_1_1DenseStepperPropagatorOptions.html">DenseStepperPropagatorOptions&lt;ActionList&lt;StepCollector&gt;</a>,</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                AbortList&lt;EndOfWorld&gt;&gt;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      propOpts(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  propOpts.<a class="code" href="../../d6/d89/structActs_1_1PropagatorOptions.html#a27e853592036584f27e14742c667cfe9" title="List of actions.">actionList</a> = aList;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  propOpts.<a class="code" href="../../d6/d89/structActs_1_1PropagatorOptions.html#a31615ff4dcd1c707e51d884272f64a70" title="List of abort conditions.">abortList</a> = abortList;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  propOpts.<a class="code" href="../../d2/d8d/structActs_1_1PropagatorPlainOptions.html#a2fa6cd5f05be50d6157d826e6017cbb2" title="Maximum number of steps for one propagate call.">maxSteps</a> = 100;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  propOpts.<a class="code" href="../../d2/d8d/structActs_1_1PropagatorPlainOptions.html#a67b53d6b753e55b218de86d15dc8a5e1" title="Absolute maximum step size.">maxStepSize</a> = 1.5_m;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="comment">// Build stepper and propagator</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a> = std::make_shared&lt;ConstantBField&gt;(<a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a>(0., 0., 0.));</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper</a>&lt;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <a class="code" href="../../d2/d64/structActs_1_1StepperExtensionList.html" title="Container of extensions used in the stepper of the propagation. This struct allows a broadcast of fun...">StepperExtensionList&lt;DefaultExtension, DenseEnvironmentExtension&gt;</a>,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <a class="code" href="../../d3/d5e/structActs_1_1detail_1_1HighestValidAuctioneer.html" title="Auctioneer that makes only the highest bidding extension valid. If multiple elements have the same in...">detail::HighestValidAuctioneer</a>&gt;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      es(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html" title="Propagator for particles (optionally in a magnetic field)">Propagator</a>&lt;<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper</a>&lt;<a class="code" href="../../d2/d64/structActs_1_1StepperExtensionList.html" title="Container of extensions used in the stepper of the propagation. This struct allows a broadcast of fun...">StepperExtensionList</a>&lt;<a class="code" href="../../da/d7b/namespaceActs.html#a2cac5eb23f2ce3a6e90930791b0c1fe2" title="A typedef for the default GenericDefaultExtension with double.">DefaultExtension</a>,</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                               <a class="code" href="../../da/daf/structActs_1_1detail_1_1GenericDenseEnvironmentExtension.html" title="Evaluater of the k_i&#39;s and elements of the transport matrix D of the RKN4 stepping. This implementation involves energy loss due to ioninisation, bremsstrahlung, pair production and photonuclear interaction in the propagation and the jacobian. These effects will only occur if the propagation is in a TrackingVolume with attached material.">DenseEnvironmentExtension</a>&gt;,</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                          <a class="code" href="../../d3/d5e/structActs_1_1detail_1_1HighestValidAuctioneer.html" title="Auctioneer that makes only the highest bidding extension valid. If multiple elements have the same in...">detail::HighestValidAuctioneer</a>&gt;,</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;             <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a>&gt;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      prop(es, naviVac);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">// Launch and collect results</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; result = prop.propagate(sbtp, propOpts).value();</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::this_result</a>&amp; stepResult =</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      result.get&lt;<span class="keyword">typename</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::result_type</a>&gt;();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="comment">// Check that the propagation happened without interactions</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a> : stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a491df7e39e3fb3b5aaec759ea79d377d">CHECK_SMALL</a>(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>.y(), 1_um);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a491df7e39e3fb3b5aaec759ea79d377d">CHECK_SMALL</a>(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>.z(), 1_um);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a> == stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.back()) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>.x(), 1_m, 1_um);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; mom : stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>) {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(mom, startMom, 1_keV);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="comment">// Rebuild and check the choice of extension</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  ActionList&lt;StepCollector&gt; aListDef;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="comment">// Set options for propagator</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <a class="code" href="../../d6/d89/structActs_1_1PropagatorOptions.html" title="Options for propagate() call.">PropagatorOptions&lt;ActionList&lt;StepCollector&gt;</a>, AbortList&lt;EndOfWorld&gt;&gt;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      propOptsDef(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  propOptsDef.<a class="code" href="../../d6/d89/structActs_1_1PropagatorOptions.html#a27e853592036584f27e14742c667cfe9" title="List of actions.">actionList</a> = aListDef;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  propOptsDef.<a class="code" href="../../d6/d89/structActs_1_1PropagatorOptions.html#a31615ff4dcd1c707e51d884272f64a70" title="List of abort conditions.">abortList</a> = abortList;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  propOptsDef.<a class="code" href="../../d2/d8d/structActs_1_1PropagatorPlainOptions.html#a2fa6cd5f05be50d6157d826e6017cbb2" title="Maximum number of steps for one propagate call.">maxSteps</a> = 100;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  propOptsDef.<a class="code" href="../../d2/d8d/structActs_1_1PropagatorPlainOptions.html#a67b53d6b753e55b218de86d15dc8a5e1" title="Absolute maximum step size.">maxStepSize</a> = 1.5_m;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper&lt;StepperExtensionList&lt;DefaultExtension&gt;</a>&gt; esDef(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html" title="Propagator for particles (optionally in a magnetic field)">Propagator&lt;EigenStepper&lt;StepperExtensionList&lt;DefaultExtension&gt;</a>&gt;, <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a>&gt;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      propDef(esDef, naviVac);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="comment">// Launch and collect results</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; resultDef = propDef.<a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html#a64846373939d8431fc67e4e854a94452" title="Propagate track parameters.">propagate</a>(sbtp, propOptsDef).value();</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::this_result</a>&amp; stepResultDef =</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      resultDef.get&lt;<span class="keyword">typename</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::result_type</a>&gt;();</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="comment">// Check that the right extension was chosen</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="comment">// If chosen correctly, the number of elements should be identical</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  BOOST_CHECK_EQUAL(stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.size(), stepResultDef.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.size());</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>], stepResultDef.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>], 1_um);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  BOOST_CHECK_EQUAL(stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>.size(), stepResultDef.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>.size());</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>], stepResultDef.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>], 1_keV);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;}</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">// Test case b). The DefaultExtension should state that it is invalid here.</span></div>
<div class="line"><a name="l00661"></a><span class="lineno"><a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a89d1d373e41235e6b7823d7e778334ff">  661</a></span>&#160;<a class="code" href="../../d6/d8a/ATLSeedingIntegrationTest_8cpp.html#a8e4d7293c1ca4b2f789d5bf8ca5b31c1">BOOST_AUTO_TEST_CASE</a>(step_extension_material_test) {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <a class="code" href="../../d1/d48/classActs_1_1CuboidVolumeBuilder.html" title="This class builds a box detector with a configurable amount of surfaces in it. The idea is to allow a...">CuboidVolumeBuilder</a> cvb;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html" title="This struct stores the data for the construction of a cuboid TrackingVolume with a given number of Pl...">CuboidVolumeBuilder::VolumeConfig</a> vConf;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  vConf.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aca8d7b10382861e417a46d50c7d34bd2">position</a> = {0.5_m, 0., 0.};</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  vConf.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aaedfa42634aec6086960a258040526ca">length</a> = {1_m, 1_m, 1_m};</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  vConf.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#afc8f82913ae419fea66e9ca1a0101596">volumeMaterial</a> =</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      std::make_shared&lt;HomogeneousVolumeMaterial&gt;(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a3b114620128e37b9f544bfa2febfcd64">makeBeryllium</a>());</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html" title="This struct stores the configuration of the tracking geometry.">CuboidVolumeBuilder::Config</a> conf;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  conf.<a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html#acfb99d5ca661f630a911d7c1fc3b38b3">volumeCfg</a>.push_back(vConf);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  conf.position = {0.5_m, 0., 0.};</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  conf.length = {1_m, 1_m, 1_m};</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// Build detector</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  cvb.<a class="code" href="../../d1/d48/classActs_1_1CuboidVolumeBuilder.html#a2aae32c1b8fc364a40999467560fcb7b" title="Setter of the config.">setConfig</a>(conf);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <a class="code" href="../../d1/d31/structActs_1_1TrackingGeometryBuilder_1_1Config.html">TrackingGeometryBuilder::Config</a> tgbCfg;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  tgbCfg.<a class="code" href="../../d1/d31/structActs_1_1TrackingGeometryBuilder_1_1Config.html#a128ad1e986eba0cb9f922213f2c824dc" title="The list of tracking volume builders.">trackingVolumeBuilders</a>.push_back(</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      [=](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; context, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; inner, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; vb) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">return</span> cvb.<a class="code" href="../../d1/d48/classActs_1_1CuboidVolumeBuilder.html#aa10844c2fbce315118faf19cc4c53425" title="This function builds a world TrackingVolume based on a given configuration.">trackingVolume</a>(context, inner, vb);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      });</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <a class="code" href="../../df/d54/classActs_1_1TrackingGeometryBuilder.html">TrackingGeometryBuilder</a> tgb(tgbCfg);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  std::shared_ptr&lt;const TrackingGeometry&gt; <a class="code" href="../../d2/dcb/InteractionsTests_8cpp.html#a2c927bb3d4ba864bc75f078aaa87bfe1">material</a> =</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      tgb.<a class="code" href="../../df/d54/classActs_1_1TrackingGeometryBuilder.html#a65a50311a2828d5ec4c6883318925733">trackingGeometry</a>(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="comment">// Build navigator</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a> naviMat({<a class="code" href="../../d2/dcb/InteractionsTests_8cpp.html#a2c927bb3d4ba864bc75f078aaa87bfe1">material</a>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>});</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="comment">// Set initial parameters for the particle track</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a913d49139751b648d6713fde8e3aaf18">Covariance</a> <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a59990ed0e1a5a644f027fa28a1cf954c">cov</a> = Covariance::Identity();</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> startDir = <a class="code" href="../../da/d7b/namespaceActs.html#ade380e3fafcce0335e8f7564adb4af58">makeDirectionFromPhiTheta</a>(0_degree, 90_degree);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> startMom = 5_GeV * startDir;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d7/d67/classActs_1_1GenericCurvilinearTrackParameters.html">CurvilinearTrackParameters</a> sbtp(Vector4::Zero(), startDir, 1_e / 5_GeV,</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                        cov, <a class="code" href="../../dc/d1b/classActs_1_1ParticleHypothesis.html#a963c15014185a0480f89ce287524fc2a">ParticleHypothesis::pion</a>());</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="comment">// Create action list for surface collection</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  ActionList&lt;StepCollector&gt; aList;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  AbortList&lt;EndOfWorld&gt; abortList;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="comment">// Set options for propagator</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <a class="code" href="../../d6/dc3/structActs_1_1DenseStepperPropagatorOptions.html">DenseStepperPropagatorOptions&lt;ActionList&lt;StepCollector&gt;</a>,</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                AbortList&lt;EndOfWorld&gt;&gt;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      propOpts(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  propOpts.<a class="code" href="../../d6/d89/structActs_1_1PropagatorOptions.html#a27e853592036584f27e14742c667cfe9" title="List of actions.">actionList</a> = aList;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  propOpts.<a class="code" href="../../d6/d89/structActs_1_1PropagatorOptions.html#a31615ff4dcd1c707e51d884272f64a70" title="List of abort conditions.">abortList</a> = abortList;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  propOpts.<a class="code" href="../../d2/d8d/structActs_1_1PropagatorPlainOptions.html#a2fa6cd5f05be50d6157d826e6017cbb2" title="Maximum number of steps for one propagate call.">maxSteps</a> = 10000;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  propOpts.<a class="code" href="../../d2/d8d/structActs_1_1PropagatorPlainOptions.html#a67b53d6b753e55b218de86d15dc8a5e1" title="Absolute maximum step size.">maxStepSize</a> = 1.5_m;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="comment">// Build stepper and propagator</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a> = std::make_shared&lt;ConstantBField&gt;(<a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a>(0., 0., 0.));</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper</a>&lt;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <a class="code" href="../../d2/d64/structActs_1_1StepperExtensionList.html" title="Container of extensions used in the stepper of the propagation. This struct allows a broadcast of fun...">StepperExtensionList&lt;DefaultExtension, DenseEnvironmentExtension&gt;</a>,</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <a class="code" href="../../d3/d5e/structActs_1_1detail_1_1HighestValidAuctioneer.html" title="Auctioneer that makes only the highest bidding extension valid. If multiple elements have the same in...">detail::HighestValidAuctioneer</a>&gt;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      es(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html" title="Propagator for particles (optionally in a magnetic field)">Propagator</a>&lt;<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper</a>&lt;<a class="code" href="../../d2/d64/structActs_1_1StepperExtensionList.html" title="Container of extensions used in the stepper of the propagation. This struct allows a broadcast of fun...">StepperExtensionList</a>&lt;<a class="code" href="../../da/d7b/namespaceActs.html#a2cac5eb23f2ce3a6e90930791b0c1fe2" title="A typedef for the default GenericDefaultExtension with double.">DefaultExtension</a>,</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                               <a class="code" href="../../da/daf/structActs_1_1detail_1_1GenericDenseEnvironmentExtension.html" title="Evaluater of the k_i&#39;s and elements of the transport matrix D of the RKN4 stepping. This implementation involves energy loss due to ioninisation, bremsstrahlung, pair production and photonuclear interaction in the propagation and the jacobian. These effects will only occur if the propagation is in a TrackingVolume with attached material.">DenseEnvironmentExtension</a>&gt;,</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                          <a class="code" href="../../d3/d5e/structActs_1_1detail_1_1HighestValidAuctioneer.html" title="Auctioneer that makes only the highest bidding extension valid. If multiple elements have the same in...">detail::HighestValidAuctioneer</a>&gt;,</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;             <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a>&gt;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      prop(es, naviMat);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="comment">// Launch and collect results</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; result = prop.propagate(sbtp, propOpts).value();</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::this_result</a>&amp; stepResult =</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      result.get&lt;<span class="keyword">typename</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::result_type</a>&gt;();</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="comment">// Check that there occurred interaction</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a> : stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>) {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a491df7e39e3fb3b5aaec759ea79d377d">CHECK_SMALL</a>(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>.y(), 1_um);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a491df7e39e3fb3b5aaec759ea79d377d">CHECK_SMALL</a>(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>.z(), 1_um);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a> == stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.front()) {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a491df7e39e3fb3b5aaec759ea79d377d">CHECK_SMALL</a>(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>.x(), 1_um);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      BOOST_CHECK_GT(std::abs(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>.x()), 1_um);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; mom : stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a491df7e39e3fb3b5aaec759ea79d377d">CHECK_SMALL</a>(mom.y(), 1_keV);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a491df7e39e3fb3b5aaec759ea79d377d">CHECK_SMALL</a>(mom.z(), 1_keV);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (mom == stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>.front()) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(mom.x(), 5_GeV, 1_keV);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      BOOST_CHECK_LT(mom.x(), 5_GeV);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="comment">// Rebuild and check the choice of extension</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="comment">// Set options for propagator</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <a class="code" href="../../d6/dc3/structActs_1_1DenseStepperPropagatorOptions.html">DenseStepperPropagatorOptions&lt;ActionList&lt;StepCollector&gt;</a>,</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                                AbortList&lt;EndOfWorld&gt;&gt;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      propOptsDense(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  propOptsDense.<a class="code" href="../../d6/d89/structActs_1_1PropagatorOptions.html#a27e853592036584f27e14742c667cfe9" title="List of actions.">actionList</a> = aList;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  propOptsDense.<a class="code" href="../../d6/d89/structActs_1_1PropagatorOptions.html#a31615ff4dcd1c707e51d884272f64a70" title="List of abort conditions.">abortList</a> = abortList;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  propOptsDense.<a class="code" href="../../d2/d8d/structActs_1_1PropagatorPlainOptions.html#a2fa6cd5f05be50d6157d826e6017cbb2" title="Maximum number of steps for one propagate call.">maxSteps</a> = 1000;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  propOptsDense.<a class="code" href="../../d2/d8d/structActs_1_1PropagatorPlainOptions.html#a67b53d6b753e55b218de86d15dc8a5e1" title="Absolute maximum step size.">maxStepSize</a> = 1.5_m;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">// Build stepper and propagator</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper&lt;StepperExtensionList&lt;DenseEnvironmentExtension&gt;</a>&gt; esDense(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html" title="Propagator for particles (optionally in a magnetic field)">Propagator&lt;EigenStepper&lt;StepperExtensionList&lt;DenseEnvironmentExtension&gt;</a>&gt;,</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;             <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a>&gt;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      propDense(esDense, naviMat);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="comment">// Launch and collect results</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; resultDense = propDense.<a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html#a64846373939d8431fc67e4e854a94452" title="Propagate track parameters.">propagate</a>(sbtp, propOptsDense).value();</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::this_result</a>&amp; stepResultDense =</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      resultDense.get&lt;<span class="keyword">typename</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::result_type</a>&gt;();</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="comment">// Check that the right extension was chosen</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="comment">// If chosen correctly, the number of elements should be identical</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  BOOST_CHECK_EQUAL(stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.size(),</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                    stepResultDense.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.size());</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>], stepResultDense.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>], 1_um);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  BOOST_CHECK_EQUAL(stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>.size(),</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                    stepResultDense.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>.size());</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>], stepResultDense.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>], 1_keV);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="comment">// Re-launch the configuration with magnetic field</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>-&gt;setField(<a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a>{0., 1_T, 0.});</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper</a>&lt;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      StepperExtensionList&lt;DefaultExtension, DenseEnvironmentExtension&gt;,</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      detail::HighestValidAuctioneer&gt;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      esB(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html" title="Propagator for particles (optionally in a magnetic field)">Propagator</a>&lt;<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper</a>&lt;<a class="code" href="../../d2/d64/structActs_1_1StepperExtensionList.html" title="Container of extensions used in the stepper of the propagation. This struct allows a broadcast of fun...">StepperExtensionList</a>&lt;<a class="code" href="../../da/d7b/namespaceActs.html#a2cac5eb23f2ce3a6e90930791b0c1fe2" title="A typedef for the default GenericDefaultExtension with double.">DefaultExtension</a>,</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                                               DenseEnvironmentExtension&gt;,</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                          detail::HighestValidAuctioneer&gt;,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;             <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a>&gt;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      propB(esB, naviMat);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; resultB = propB.propagate(sbtp, propOptsDense).value();</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::this_result</a>&amp; stepResultB =</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      resultB.get&lt;<span class="keyword">typename</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::result_type</a>&gt;();</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="comment">// Check that there occurred interaction</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a> : stepResultB.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>) {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a> == stepResultB.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.front()) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a491df7e39e3fb3b5aaec759ea79d377d">CHECK_SMALL</a>(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>, 1_um);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      BOOST_CHECK_GT(std::abs(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>.x()), 1_um);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a491df7e39e3fb3b5aaec759ea79d377d">CHECK_SMALL</a>(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>.y(), 1_um);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      BOOST_CHECK_GT(std::abs(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a182617618c30f1ba6a9c7540ae655340">pos</a>.z()), 0.125_um);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; mom : stepResultB.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>) {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (mom == stepResultB.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>.front()) {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(mom, startMom, 1_keV);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      BOOST_CHECK_NE(mom.x(), 5_GeV);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a491df7e39e3fb3b5aaec759ea79d377d">CHECK_SMALL</a>(mom.y(), 1_keV);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      BOOST_CHECK_NE(mom.z(), 0.);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;}</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">// Test case c). Both should be involved in their part of the detector</span></div>
<div class="line"><a name="l00817"></a><span class="lineno"><a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a59e7ba2c029a4b2cc6a722ada1595121">  817</a></span>&#160;<a class="code" href="../../d6/d8a/ATLSeedingIntegrationTest_8cpp.html#a8e4d7293c1ca4b2f789d5bf8ca5b31c1">BOOST_AUTO_TEST_CASE</a>(step_extension_vacmatvac_test) {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <a class="code" href="../../d1/d48/classActs_1_1CuboidVolumeBuilder.html" title="This class builds a box detector with a configurable amount of surfaces in it. The idea is to allow a...">CuboidVolumeBuilder</a> cvb;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html" title="This struct stores the data for the construction of a cuboid TrackingVolume with a given number of Pl...">CuboidVolumeBuilder::VolumeConfig</a> vConfVac1;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  vConfVac1.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aca8d7b10382861e417a46d50c7d34bd2">position</a> = {0.5_m, 0., 0.};</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  vConfVac1.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aaedfa42634aec6086960a258040526ca">length</a> = {1_m, 1_m, 1_m};</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  vConfVac1.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#a14edec6ebc3767c48ced05924ac5e200">name</a> = <span class="stringliteral">&quot;First vacuum volume&quot;</span>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html" title="This struct stores the data for the construction of a cuboid TrackingVolume with a given number of Pl...">CuboidVolumeBuilder::VolumeConfig</a> vConfMat;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  vConfMat.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aca8d7b10382861e417a46d50c7d34bd2">position</a> = {1.5_m, 0., 0.};</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  vConfMat.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aaedfa42634aec6086960a258040526ca">length</a> = {1_m, 1_m, 1_m};</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  vConfMat.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#afc8f82913ae419fea66e9ca1a0101596">volumeMaterial</a> =</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      std::make_shared&lt;const HomogeneousVolumeMaterial&gt;(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a3b114620128e37b9f544bfa2febfcd64">makeBeryllium</a>());</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  vConfMat.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#a14edec6ebc3767c48ced05924ac5e200">name</a> = <span class="stringliteral">&quot;Material volume&quot;</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html" title="This struct stores the data for the construction of a cuboid TrackingVolume with a given number of Pl...">CuboidVolumeBuilder::VolumeConfig</a> vConfVac2;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  vConfVac2.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aca8d7b10382861e417a46d50c7d34bd2">position</a> = {2.5_m, 0., 0.};</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  vConfVac2.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aaedfa42634aec6086960a258040526ca">length</a> = {1_m, 1_m, 1_m};</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  vConfVac2.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#a14edec6ebc3767c48ced05924ac5e200">name</a> = <span class="stringliteral">&quot;Second vacuum volume&quot;</span>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html" title="This struct stores the configuration of the tracking geometry.">CuboidVolumeBuilder::Config</a> conf;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  conf.<a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html#acfb99d5ca661f630a911d7c1fc3b38b3">volumeCfg</a> = {vConfVac1, vConfMat, vConfVac2};</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  conf.<a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html#a00f24e2c87c886297b6fadfd1aa6d08e">position</a> = {1.5_m, 0., 0.};</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  conf.<a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html#a84bcca381c085fabe341b25b0e857435">length</a> = {3_m, 1_m, 1_m};</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="comment">// Build detector</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  cvb.<a class="code" href="../../d1/d48/classActs_1_1CuboidVolumeBuilder.html#a2aae32c1b8fc364a40999467560fcb7b" title="Setter of the config.">setConfig</a>(conf);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <a class="code" href="../../d1/d31/structActs_1_1TrackingGeometryBuilder_1_1Config.html">TrackingGeometryBuilder::Config</a> tgbCfg;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  tgbCfg.<a class="code" href="../../d1/d31/structActs_1_1TrackingGeometryBuilder_1_1Config.html#a128ad1e986eba0cb9f922213f2c824dc" title="The list of tracking volume builders.">trackingVolumeBuilders</a>.push_back(</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      [=](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; context, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; inner, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; vb) {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keywordflow">return</span> cvb.<a class="code" href="../../d1/d48/classActs_1_1CuboidVolumeBuilder.html#aa10844c2fbce315118faf19cc4c53425" title="This function builds a world TrackingVolume based on a given configuration.">trackingVolume</a>(context, inner, vb);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      });</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <a class="code" href="../../df/d54/classActs_1_1TrackingGeometryBuilder.html">TrackingGeometryBuilder</a> tgb(tgbCfg);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  std::shared_ptr&lt;const TrackingGeometry&gt; det = tgb.<a class="code" href="../../df/d54/classActs_1_1TrackingGeometryBuilder.html#a65a50311a2828d5ec4c6883318925733">trackingGeometry</a>(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="comment">// Build navigator</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a> naviDet({det, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>});</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="comment">// Set initial parameters for the particle track</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <a class="code" href="../../d7/d67/classActs_1_1GenericCurvilinearTrackParameters.html">CurvilinearTrackParameters</a> sbtp(Vector4::Zero(), 0_degree, 90_degree,</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                                  1_e / 5_GeV, Covariance::Identity(),</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                  <a class="code" href="../../dc/d1b/classActs_1_1ParticleHypothesis.html#a963c15014185a0480f89ce287524fc2a">ParticleHypothesis::pion</a>());</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">// Create action list for surface collection</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  AbortList&lt;EndOfWorld&gt; abortList;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  abortList.get&lt;<a class="code" href="../../d1/db4/structActs_1_1Test_1_1EndOfWorld.html" title="Aborter for the case that a particle leaves the detector or reaches a custom made threshold...">EndOfWorld</a>&gt;().maxX = 3_m;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">// Set options for propagator</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <a class="code" href="../../d6/dc3/structActs_1_1DenseStepperPropagatorOptions.html">DenseStepperPropagatorOptions&lt;ActionList&lt;StepCollector&gt;</a>,</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                AbortList&lt;EndOfWorld&gt;&gt;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      propOpts(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  propOpts.abortList = abortList;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  propOpts.maxSteps = 1000;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  propOpts.maxStepSize = 1.5_m;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="comment">// Build stepper and propagator</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a> = std::make_shared&lt;ConstantBField&gt;(<a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a>(0., 1_T, 0.));</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper</a>&lt;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <a class="code" href="../../d2/d64/structActs_1_1StepperExtensionList.html" title="Container of extensions used in the stepper of the propagation. This struct allows a broadcast of fun...">StepperExtensionList&lt;DefaultExtension, DenseEnvironmentExtension&gt;</a>,</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <a class="code" href="../../d3/d5e/structActs_1_1detail_1_1HighestValidAuctioneer.html" title="Auctioneer that makes only the highest bidding extension valid. If multiple elements have the same in...">detail::HighestValidAuctioneer</a>&gt;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      es(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html" title="Propagator for particles (optionally in a magnetic field)">Propagator</a>&lt;<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper</a>&lt;<a class="code" href="../../d2/d64/structActs_1_1StepperExtensionList.html" title="Container of extensions used in the stepper of the propagation. This struct allows a broadcast of fun...">StepperExtensionList</a>&lt;<a class="code" href="../../da/d7b/namespaceActs.html#a2cac5eb23f2ce3a6e90930791b0c1fe2" title="A typedef for the default GenericDefaultExtension with double.">DefaultExtension</a>,</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                               <a class="code" href="../../da/daf/structActs_1_1detail_1_1GenericDenseEnvironmentExtension.html" title="Evaluater of the k_i&#39;s and elements of the transport matrix D of the RKN4 stepping. This implementation involves energy loss due to ioninisation, bremsstrahlung, pair production and photonuclear interaction in the propagation and the jacobian. These effects will only occur if the propagation is in a TrackingVolume with attached material.">DenseEnvironmentExtension</a>&gt;,</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                          <a class="code" href="../../d3/d5e/structActs_1_1detail_1_1HighestValidAuctioneer.html" title="Auctioneer that makes only the highest bidding extension valid. If multiple elements have the same in...">detail::HighestValidAuctioneer</a>&gt;,</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;             <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a>&gt;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      prop(es, naviDet);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="comment">// Launch and collect results</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; result = prop.propagate(sbtp, propOpts).value();</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::this_result</a>&amp; stepResult =</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      result.get&lt;<span class="keyword">typename</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::result_type</a>&gt;();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="comment">// Manually set the extensions for each step and propagate through each</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="comment">// volume by propagation to the boundaries</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="comment">// Collect boundaries</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  std::vector&lt;Surface const*&gt; surs;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  std::vector&lt;std::shared_ptr&lt;const BoundarySurfaceT&lt;TrackingVolume&gt;&gt;&gt;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      boundaries = det-&gt;lowestTrackingVolume(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, {0.5_m, 0., 0.})</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                       -&gt;boundarySurfaces();</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a> : boundaries) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>-&gt;surfaceRepresentation().center(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>).x() == 1_m) {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      surs.push_back(&amp;(<a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>-&gt;surfaceRepresentation()));</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  boundaries =</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      det-&gt;lowestTrackingVolume(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, {1.5_m, 0., 0.})-&gt;boundarySurfaces();</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a> : boundaries) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>-&gt;surfaceRepresentation().center(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>).x() == 2_m) {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      surs.push_back(&amp;(<a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>-&gt;surfaceRepresentation()));</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    }</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  boundaries =</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      det-&gt;lowestTrackingVolume(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, {2.5_m, 0., 0.})-&gt;boundarySurfaces();</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a> : boundaries) {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>-&gt;surfaceRepresentation().center(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>).x() == 3_m) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      surs.push_back(&amp;(<a class="code" href="../../d7/da4/namespaceKFPMath.html#a1a60fb62c82cf122ca7923fc09cc1f84">b</a>-&gt;surfaceRepresentation()));</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">// Build launcher through vacuum</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">// Set options for propagator</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <a class="code" href="../../d6/d89/structActs_1_1PropagatorOptions.html" title="Options for propagate() call.">PropagatorOptions&lt;ActionList&lt;StepCollector&gt;</a>, AbortList&lt;EndOfWorld&gt;&gt;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      propOptsDef(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  abortList.get&lt;<a class="code" href="../../d1/db4/structActs_1_1Test_1_1EndOfWorld.html" title="Aborter for the case that a particle leaves the detector or reaches a custom made threshold...">EndOfWorld</a>&gt;().maxX = 1_m;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  propOptsDef.<a class="code" href="../../d6/d89/structActs_1_1PropagatorOptions.html#a31615ff4dcd1c707e51d884272f64a70" title="List of abort conditions.">abortList</a> = abortList;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  propOptsDef.<a class="code" href="../../d2/d8d/structActs_1_1PropagatorPlainOptions.html#a2fa6cd5f05be50d6157d826e6017cbb2" title="Maximum number of steps for one propagate call.">maxSteps</a> = 1000;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  propOptsDef.<a class="code" href="../../d2/d8d/structActs_1_1PropagatorPlainOptions.html#a67b53d6b753e55b218de86d15dc8a5e1" title="Absolute maximum step size.">maxStepSize</a> = 1.5_m;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="comment">// Build stepper and propagator</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper&lt;StepperExtensionList&lt;DefaultExtension&gt;</a>&gt; esDef(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html" title="Propagator for particles (optionally in a magnetic field)">Propagator&lt;EigenStepper&lt;StepperExtensionList&lt;DefaultExtension&gt;</a>&gt;, <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a>&gt;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      propDef(esDef, naviDet);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="comment">// Launch and collect results</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; resultDef =</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      propDef.<a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html#a64846373939d8431fc67e4e854a94452" title="Propagate track parameters.">propagate</a>(sbtp, *(surs[0]), propOptsDef).value();</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::this_result</a>&amp; stepResultDef =</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      resultDef.get&lt;<span class="keyword">typename</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::result_type</a>&gt;();</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="comment">// Check the exit situation of the first volume</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  std::pair&lt;Vector3, Vector3&gt; endParams, endParamsControl;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; stepResultDef.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keywordflow">if</span> (1_m - stepResultDef.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt; 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-4) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      endParams =</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;          std::make_pair(stepResultDef.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>], stepResultDef.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">if</span> (1_m - stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt; 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-4) {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      endParamsControl =</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;          std::make_pair(stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>], stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    }</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(endParams.first, endParamsControl.first, 1_um);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(endParams.second, endParamsControl.second, 1_um);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(endParams.first.x(), endParamsControl.first.x(), 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-5);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(endParams.first.y(), endParamsControl.first.y(), 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-5);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(endParams.first.z(), endParamsControl.first.z(), 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-5);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(endParams.second.x(), endParamsControl.second.x(), 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-5);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(endParams.second.y(), endParamsControl.second.y(), 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-5);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(endParams.second.z(), endParamsControl.second.z(), 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-5);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <span class="comment">// Build launcher through material</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="comment">// Set initial parameters for the particle track by using the result of the</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="comment">// first volume</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <a class="code" href="../../d7/d67/classActs_1_1GenericCurvilinearTrackParameters.html">CurvilinearTrackParameters</a> sbtpPiecewise(</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <a class="code" href="../../df/da1/namespaceActs_1_1VectorHelpers.html#aee596cee9f20711ff9548f38973c2e1b" title="Construct a four-vector from a three-vector and scalar fourth component.">makeVector4</a>(endParams.first, 0), endParams.second,</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      1_e / endParams.second.norm(), std::nullopt, <a class="code" href="../../dc/d1b/classActs_1_1ParticleHypothesis.html#a963c15014185a0480f89ce287524fc2a">ParticleHypothesis::pion</a>());</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="comment">// Set options for propagator</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  DenseStepperPropagatorOptions&lt;ActionList&lt;StepCollector&gt;,</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                                AbortList&lt;EndOfWorld&gt;&gt;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      propOptsDense(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  abortList.get&lt;<a class="code" href="../../d1/db4/structActs_1_1Test_1_1EndOfWorld.html" title="Aborter for the case that a particle leaves the detector or reaches a custom made threshold...">EndOfWorld</a>&gt;().maxX = 2_m;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  propOptsDense.abortList = abortList;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  propOptsDense.maxSteps = 1000;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  propOptsDense.maxStepSize = 1.5_m;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="comment">// Build stepper and propagator</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper&lt;StepperExtensionList&lt;DenseEnvironmentExtension&gt;</a>&gt; esDense(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html" title="Propagator for particles (optionally in a magnetic field)">Propagator&lt;EigenStepper&lt;StepperExtensionList&lt;DenseEnvironmentExtension&gt;</a>&gt;,</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;             <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a>&gt;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      propDense(esDense, naviDet);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="comment">// Launch and collect results</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; resultDense =</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      propDense.<a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html#a64846373939d8431fc67e4e854a94452" title="Propagate track parameters.">propagate</a>(sbtpPiecewise, *(surs[1]), propOptsDense).value();</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::this_result</a>&amp; stepResultDense =</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      resultDense.get&lt;<span class="keyword">typename</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::result_type</a>&gt;();</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="comment">// Check the exit situation of the second volume</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; stepResultDense.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">if</span> (2_m - stepResultDense.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt; 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-4) {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      endParams = std::make_pair(stepResultDense.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>],</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                                 stepResultDense.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">if</span> (2_m - stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt; 1<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a" title="Charge, native unit e (elementary charge)">e</a>-4) {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      endParamsControl =</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;          std::make_pair(stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>], stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>]);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(endParams.first, endParamsControl.first, 1_um);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <a class="code" href="../../d4/d47/FloatComparisons_8hpp.html#a4843ccd4d2c926868f03a191ce5e5889">CHECK_CLOSE_ABS</a>(endParams.second, endParamsControl.second, 1_um);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;}</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">// Test case a). The DenseEnvironmentExtension should state that it is not</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">// valid in this case.</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"><a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a046bcce4eb2c0cb558293a74ee51808a"> 1013</a></span>&#160;<a class="code" href="../../d6/d8a/ATLSeedingIntegrationTest_8cpp.html#a8e4d7293c1ca4b2f789d5bf8ca5b31c1">BOOST_AUTO_TEST_CASE</a>(step_extension_trackercalomdt_test) {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="keywordtype">double</span> rotationAngle = M_PI * 0.5;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> xPos(cos(rotationAngle), 0., sin(rotationAngle));</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> yPos(0., 1., 0.);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a> zPos(-sin(rotationAngle), 0., cos(rotationAngle));</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <a class="code" href="../../da/ddf/classActs_1_1MaterialSlab.html">MaterialSlab</a> matProp(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a3b114620128e37b9f544bfa2febfcd64">makeBeryllium</a>(), 0.5_mm);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <a class="code" href="../../d1/d48/classActs_1_1CuboidVolumeBuilder.html" title="This class builds a box detector with a configurable amount of surfaces in it. The idea is to allow a...">CuboidVolumeBuilder</a> cvb;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html" title="This struct stores the data for the construction of a single PlaneSurface.">CuboidVolumeBuilder::SurfaceConfig</a> sConf1;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  sConf1.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#a539ea65f309a1970d2a3d7c14fba809f">position</a> = <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a>(0.3_m, 0., 0.);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  sConf1.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#a8e916ee38b04771877cd649bf8d4c35f">rotation</a>.col(0) = xPos;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  sConf1.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#a8e916ee38b04771877cd649bf8d4c35f">rotation</a>.col(1) = yPos;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  sConf1.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#a8e916ee38b04771877cd649bf8d4c35f">rotation</a>.col(2) = zPos;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  sConf1.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#aa36d1357088dd35e4165f1944516a308">rBounds</a> =</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      std::make_shared&lt;const RectangleBounds&gt;(<a class="code" href="../../da/d28/classActs_1_1RectangleBounds.html">RectangleBounds</a>(0.5_m, 0.5_m));</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  sConf1.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#a042b45d9d149a0f5c7f4c5dbc153dce9">surMat</a> = std::shared_ptr&lt;const ISurfaceMaterial&gt;(</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keyword">new</span> <a class="code" href="../../db/df4/classActs_1_1HomogeneousSurfaceMaterial.html">HomogeneousSurfaceMaterial</a>(matProp));</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  sConf1.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#ab8d43c2762ed9663a79410a79864c73c">thickness</a> = 1._mm;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <a class="code" href="../../df/d6e/structActs_1_1CuboidVolumeBuilder_1_1LayerConfig.html" title="This struct stores the data for the construction of a PlaneLayer.">CuboidVolumeBuilder::LayerConfig</a> lConf1;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  lConf1.<a class="code" href="../../df/d6e/structActs_1_1CuboidVolumeBuilder_1_1LayerConfig.html#a2e9f0a59f5fe5f290057dc4b64f5ad80">surfaceCfg</a> = {sConf1};</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html" title="This struct stores the data for the construction of a single PlaneSurface.">CuboidVolumeBuilder::SurfaceConfig</a> sConf2;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  sConf2.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#a539ea65f309a1970d2a3d7c14fba809f">position</a> = <a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a>(0.6_m, 0., 0.);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  sConf2.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#a8e916ee38b04771877cd649bf8d4c35f">rotation</a>.col(0) = xPos;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  sConf2.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#a8e916ee38b04771877cd649bf8d4c35f">rotation</a>.col(1) = yPos;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  sConf2.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#a8e916ee38b04771877cd649bf8d4c35f">rotation</a>.col(2) = zPos;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  sConf2.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#aa36d1357088dd35e4165f1944516a308">rBounds</a> =</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      std::make_shared&lt;const RectangleBounds&gt;(<a class="code" href="../../da/d28/classActs_1_1RectangleBounds.html">RectangleBounds</a>(0.5_m, 0.5_m));</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  sConf2.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#a042b45d9d149a0f5c7f4c5dbc153dce9">surMat</a> = std::shared_ptr&lt;const ISurfaceMaterial&gt;(</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      <span class="keyword">new</span> <a class="code" href="../../db/df4/classActs_1_1HomogeneousSurfaceMaterial.html">HomogeneousSurfaceMaterial</a>(matProp));</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  sConf2.<a class="code" href="../../d0/dd1/structActs_1_1CuboidVolumeBuilder_1_1SurfaceConfig.html#ab8d43c2762ed9663a79410a79864c73c">thickness</a> = 1._mm;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <a class="code" href="../../df/d6e/structActs_1_1CuboidVolumeBuilder_1_1LayerConfig.html" title="This struct stores the data for the construction of a PlaneLayer.">CuboidVolumeBuilder::LayerConfig</a> lConf2;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  lConf2.<a class="code" href="../../df/d6e/structActs_1_1CuboidVolumeBuilder_1_1LayerConfig.html#a2e9f0a59f5fe5f290057dc4b64f5ad80">surfaceCfg</a> = {sConf2};</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html" title="This struct stores the data for the construction of a cuboid TrackingVolume with a given number of Pl...">CuboidVolumeBuilder::VolumeConfig</a> muConf1;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  muConf1.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aca8d7b10382861e417a46d50c7d34bd2">position</a> = {2.3_m, 0., 0.};</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  muConf1.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aaedfa42634aec6086960a258040526ca">length</a> = {20._cm, 20._cm, 20._cm};</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  muConf1.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#afc8f82913ae419fea66e9ca1a0101596">volumeMaterial</a> =</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      std::make_shared&lt;HomogeneousVolumeMaterial&gt;(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a3b114620128e37b9f544bfa2febfcd64">makeBeryllium</a>());</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  muConf1.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#a14edec6ebc3767c48ced05924ac5e200">name</a> = <span class="stringliteral">&quot;MDT1&quot;</span>;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html" title="This struct stores the data for the construction of a cuboid TrackingVolume with a given number of Pl...">CuboidVolumeBuilder::VolumeConfig</a> muConf2;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  muConf2.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aca8d7b10382861e417a46d50c7d34bd2">position</a> = {2.7_m, 0., 0.};</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  muConf2.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aaedfa42634aec6086960a258040526ca">length</a> = {20._cm, 20._cm, 20._cm};</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  muConf2.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#afc8f82913ae419fea66e9ca1a0101596">volumeMaterial</a> =</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      std::make_shared&lt;HomogeneousVolumeMaterial&gt;(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a3b114620128e37b9f544bfa2febfcd64">makeBeryllium</a>());</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  muConf2.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#a14edec6ebc3767c48ced05924ac5e200">name</a> = <span class="stringliteral">&quot;MDT2&quot;</span>;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html" title="This struct stores the data for the construction of a cuboid TrackingVolume with a given number of Pl...">CuboidVolumeBuilder::VolumeConfig</a> vConf1;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  vConf1.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aca8d7b10382861e417a46d50c7d34bd2">position</a> = {0.5_m, 0., 0.};</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  vConf1.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aaedfa42634aec6086960a258040526ca">length</a> = {1._m, 1._m, 1._m};</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  vConf1.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#a7ba0e96a23d9f941290d209eaa410ee5">layerCfg</a> = {lConf1, lConf2};</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  vConf1.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#a14edec6ebc3767c48ced05924ac5e200">name</a> = <span class="stringliteral">&quot;Tracker&quot;</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html" title="This struct stores the data for the construction of a cuboid TrackingVolume with a given number of Pl...">CuboidVolumeBuilder::VolumeConfig</a> vConf2;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  vConf2.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aca8d7b10382861e417a46d50c7d34bd2">position</a> = {1.5_m, 0., 0.};</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  vConf2.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aaedfa42634aec6086960a258040526ca">length</a> = {1._m, 1._m, 1._m};</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  vConf2.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#afc8f82913ae419fea66e9ca1a0101596">volumeMaterial</a> =</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      std::make_shared&lt;HomogeneousVolumeMaterial&gt;(<a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a3b114620128e37b9f544bfa2febfcd64">makeBeryllium</a>());</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  vConf2.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#a14edec6ebc3767c48ced05924ac5e200">name</a> = <span class="stringliteral">&quot;Calorimeter&quot;</span>;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html" title="This struct stores the data for the construction of a cuboid TrackingVolume with a given number of Pl...">CuboidVolumeBuilder::VolumeConfig</a> vConf3;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  vConf3.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aca8d7b10382861e417a46d50c7d34bd2">position</a> = {2.5_m, 0., 0.};</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  vConf3.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aaedfa42634aec6086960a258040526ca">length</a> = {1._m, 1._m, 1._m};</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  vConf3.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#aa0191e0acb621f266bffab7266b49c2d">volumeCfg</a> = {muConf1, muConf2};</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  vConf3.<a class="code" href="../../d7/dd6/structActs_1_1CuboidVolumeBuilder_1_1VolumeConfig.html#a14edec6ebc3767c48ced05924ac5e200">name</a> = <span class="stringliteral">&quot;Muon system&quot;</span>;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html" title="This struct stores the configuration of the tracking geometry.">CuboidVolumeBuilder::Config</a> conf;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  conf.<a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html#acfb99d5ca661f630a911d7c1fc3b38b3">volumeCfg</a> = {vConf1, vConf2, vConf3};</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  conf.<a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html#a00f24e2c87c886297b6fadfd1aa6d08e">position</a> = {1.5_m, 0., 0.};</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  conf.<a class="code" href="../../d8/d30/structActs_1_1CuboidVolumeBuilder_1_1Config.html#a84bcca381c085fabe341b25b0e857435">length</a> = {3._m, 1._m, 1._m};</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="comment">// Build detector</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  cvb.<a class="code" href="../../d1/d48/classActs_1_1CuboidVolumeBuilder.html#a2aae32c1b8fc364a40999467560fcb7b" title="Setter of the config.">setConfig</a>(conf);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <a class="code" href="../../d1/d31/structActs_1_1TrackingGeometryBuilder_1_1Config.html">TrackingGeometryBuilder::Config</a> tgbCfg;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  tgbCfg.<a class="code" href="../../d1/d31/structActs_1_1TrackingGeometryBuilder_1_1Config.html#a128ad1e986eba0cb9f922213f2c824dc" title="The list of tracking volume builders.">trackingVolumeBuilders</a>.push_back(</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      [=](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; context, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; inner, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; vb) {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="keywordflow">return</span> cvb.<a class="code" href="../../d1/d48/classActs_1_1CuboidVolumeBuilder.html#aa10844c2fbce315118faf19cc4c53425" title="This function builds a world TrackingVolume based on a given configuration.">trackingVolume</a>(context, inner, vb);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      });</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <a class="code" href="../../df/d54/classActs_1_1TrackingGeometryBuilder.html">TrackingGeometryBuilder</a> tgb(tgbCfg);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  std::shared_ptr&lt;const TrackingGeometry&gt; <a class="code" href="../../de/d5d/structActs_1_1detail_1_1detector.html">detector</a> =</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      tgb.<a class="code" href="../../df/d54/classActs_1_1TrackingGeometryBuilder.html#a65a50311a2828d5ec4c6883318925733">trackingGeometry</a>(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="comment">// Build navigator</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a> naviVac({<a class="code" href="../../d2/d2c/LivePlot-Energy-EMC_8C.html#a2e2cc69bf023676b0749903f295a507e">detector</a>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>});</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="comment">// Set initial parameters for the particle track</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <a class="code" href="../../d7/d67/classActs_1_1GenericCurvilinearTrackParameters.html">CurvilinearTrackParameters</a> sbtp(Vector4::Zero(), 0_degree, 90_degree,</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                                  1_e / 1_GeV, Covariance::Identity(),</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                                  <a class="code" href="../../dc/d1b/classActs_1_1ParticleHypothesis.html#a963c15014185a0480f89ce287524fc2a">ParticleHypothesis::pion</a>());</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">// Set options for propagator</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <a class="code" href="../../d6/dc3/structActs_1_1DenseStepperPropagatorOptions.html">DenseStepperPropagatorOptions&lt;ActionList&lt;StepCollector, MaterialInteractor&gt;</a>,</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                                AbortList&lt;EndOfWorld&gt;&gt;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      propOpts(<a class="code" href="../../da/d7b/namespaceActs.html#ae338269a65c36d2013a03ec8c1ef09ff">tgContext</a>, <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a9d63d8f1220236f1adf0d870ee588680">mfContext</a>);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  propOpts.<a class="code" href="../../d6/d89/structActs_1_1PropagatorOptions.html#a31615ff4dcd1c707e51d884272f64a70" title="List of abort conditions.">abortList</a>.get&lt;<a class="code" href="../../d1/db4/structActs_1_1Test_1_1EndOfWorld.html" title="Aborter for the case that a particle leaves the detector or reaches a custom made threshold...">EndOfWorld</a>&gt;().maxX = 3._m;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  propOpts.<a class="code" href="../../d2/d8d/structActs_1_1PropagatorPlainOptions.html#a2fa6cd5f05be50d6157d826e6017cbb2" title="Maximum number of steps for one propagate call.">maxSteps</a> = 10000;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="comment">// Build stepper and propagator</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a> = std::make_shared&lt;ConstantBField&gt;(<a class="code" href="../../de/d0a/group__coordinates-types.html#gaa57032f45b21d71af17514ff34cf1de1">Vector3</a>(0., 0., 0.));</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper</a>&lt;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <a class="code" href="../../d2/d64/structActs_1_1StepperExtensionList.html" title="Container of extensions used in the stepper of the propagation. This struct allows a broadcast of fun...">StepperExtensionList&lt;DefaultExtension, DenseEnvironmentExtension&gt;</a>,</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <a class="code" href="../../d3/d5e/structActs_1_1detail_1_1HighestValidAuctioneer.html" title="Auctioneer that makes only the highest bidding extension valid. If multiple elements have the same in...">detail::HighestValidAuctioneer</a>&gt;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      es(<a class="code" href="../../d4/d0e/namespaceActs_1_1IntegrationTest.html#a91c3b20cafd8e7401c88d8274bb1a6f8">bField</a>);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <a class="code" href="../../d5/daa/exceptionActs_1_1Propagator.html" title="Propagator for particles (optionally in a magnetic field)">Propagator</a>&lt;<a class="code" href="../../d3/d5a/classActs_1_1EigenStepper.html" title="Runge-Kutta-Nystroem stepper based on Eigen implementation for the following ODE:">EigenStepper</a>&lt;<a class="code" href="../../d2/d64/structActs_1_1StepperExtensionList.html" title="Container of extensions used in the stepper of the propagation. This struct allows a broadcast of fun...">StepperExtensionList</a>&lt;<a class="code" href="../../da/d7b/namespaceActs.html#a2cac5eb23f2ce3a6e90930791b0c1fe2" title="A typedef for the default GenericDefaultExtension with double.">DefaultExtension</a>,</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                                               <a class="code" href="../../da/daf/structActs_1_1detail_1_1GenericDenseEnvironmentExtension.html" title="Evaluater of the k_i&#39;s and elements of the transport matrix D of the RKN4 stepping. This implementation involves energy loss due to ioninisation, bremsstrahlung, pair production and photonuclear interaction in the propagation and the jacobian. These effects will only occur if the propagation is in a TrackingVolume with attached material.">DenseEnvironmentExtension</a>&gt;,</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                          <a class="code" href="../../d3/d5e/structActs_1_1detail_1_1HighestValidAuctioneer.html" title="Auctioneer that makes only the highest bidding extension valid. If multiple elements have the same in...">detail::HighestValidAuctioneer</a>&gt;,</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;             <a class="code" href="../../db/d4b/structActs_1_1Test_1_1Navigator.html" title="Simplified navigator.">Navigator</a>&gt;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      prop(es, naviVac);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <span class="comment">// Launch and collect results</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; result = prop.propagate(sbtp, propOpts).value();</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::this_result</a>&amp; stepResult =</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      result.get&lt;<span class="keyword">typename</span> <a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html" title="Data container for result analysis.">StepCollector::result_type</a>&gt;();</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="comment">// Test that momentum changes only occurred at the right detector parts</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keywordtype">double</span> lastMomentum = stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>[0].x();</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>.size(); <a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>++) {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="comment">// Test for changes</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">if</span> ((stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &gt; 0.3_m &amp;&amp;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;         stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt; 0.6_m) ||</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        (stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &gt; 0.6_m &amp;&amp;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;         stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt;= 1._m) ||</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        (stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &gt; 1._m &amp;&amp;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;         stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt;= 2._m) ||</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        (stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &gt; 2.2_m &amp;&amp;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;         stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt;= 2.4_m) ||</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        (stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &gt; 2.6_m &amp;&amp;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;         stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt;= 2.8_m)) {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      BOOST_CHECK_LE(stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x(), lastMomentum);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      lastMomentum = stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x();</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="comment">// Test the absence of momentum loss</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <span class="keywordflow">if</span> (stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt; 0.3_m ||</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;          (stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &gt; 2._m &amp;&amp;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;           stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt;= 2.2_m) ||</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;          (stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &gt; 2.4_m &amp;&amp;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;           stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt;= 2.6_m) ||</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;          (stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &gt; 2.8_m &amp;&amp;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;           stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#aa2f72a8b7d12ea0e6789c94a646ea393">position</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x() &lt;= 3._m)) {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        BOOST_CHECK_EQUAL(stepResult.<a class="code" href="../../da/d46/structActs_1_1Test_1_1StepCollector_1_1this__result.html#added27ca5daca51b26a1bbb1cd93382a">momentum</a>[<a class="code" href="../../d7/d87/fasthadv4_8C.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>].x(), lastMomentum);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;}</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;}  <span class="comment">// namespace Test</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;}  <span class="comment">// namespace Acts</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath">
	<!-- id is needed for treeview function! -->
	<ul>
		<li class="navelem"><a class="el" href="../../dir_8a083ba67d76eaacec681de2105f81ce.html">acts</a></li><li class="navelem"><a class="el" href="../../dir_dd639112a1a9a96ce5326d38dc5b798f.html">blob</a></li><li class="navelem"><a class="el" href="../../dir_ed4d3476f51c55226233cecea75738c3.html">sPHENIX</a></li><li class="navelem"><a class="el" href="../../dir_119f756602098bc5fc826584c122f43a.html">Tests</a></li><li class="navelem"><a class="el" href="../../dir_213783c11ff7922e34bb9b5a8f7f191f.html">UnitTests</a></li><li class="navelem"><a class="el" href="../../dir_f83d7617a0c5ed44a69a246bb573cf8b.html">Core</a></li><li class="navelem"><a class="el" href="../../dir_598b399f06ec2ef5ea3da6a72d98d131.html">Propagator</a></li><li class="navelem"><a class="el" href="../../d4/d63/EigenStepperTests_8cpp.html">EigenStepperTests.cpp</a></li>
		<li class="footer">
		Built by <a href="mailto:jhuang@bnl.gov">Jin Huang</a></em>.
			updated: <em>Sat Feb 17 2024 22:17:43</em> using <a
			href="http://www.doxygen.org/index.html"> <img class="footer"
				src="../../doxygen.png" alt="doxygen" /></a> 1.8.2 
				with <a href="https://github.com/sPHENIX-Collaboration">sPHENIX GitHub integration</a>
		</li>
	</ul>
</div>
</body>
</html>
